<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/cpp_utils/BLERemoteDescriptor.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_l_e_remote_descriptor_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLERemoteDescriptor.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_b_l_e_remote_descriptor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * BLERemoteDescriptor.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Jul 8, 2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#if defined(CONFIG_BT_ENABLED)</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_remote_descriptor_8h.html">BLERemoteDescriptor.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_general_utils_8h.html">GeneralUtils.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;esp_log.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifdef ARDUINO_ARCH_ESP32</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;esp32-hal-log.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* LOG_TAG = <span class="stringliteral">&quot;BLERemoteDescriptor&quot;</span>;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;BLERemoteDescriptor::BLERemoteDescriptor(</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    uint16_t                 handle,</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>                  uuid,</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="class_b_l_e_remote_characteristic.html">BLERemoteCharacteristic</a>* pRemoteCharacteristic) {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    m_handle                = handle;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    m_uuid                  = uuid;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    m_pRemoteCharacteristic = pRemoteCharacteristic;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">   35</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">BLERemoteDescriptor::getHandle</a>() {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> m_handle;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;} <span class="comment">// getHandle</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#a409e7c2bde0b038582aba698b112135c">   44</a></span>&#160;<a class="code" href="class_b_l_e_remote_characteristic.html">BLERemoteCharacteristic</a>* <a class="code" href="class_b_l_e_remote_descriptor.html#a409e7c2bde0b038582aba698b112135c">BLERemoteDescriptor::getRemoteCharacteristic</a>() {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> m_pRemoteCharacteristic;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;} <span class="comment">// getRemoteCharacteristic</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#a252bfa5b0e62a5276b337d95fd98d51a">   53</a></span>&#160;<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> <a class="code" href="class_b_l_e_remote_descriptor.html#a252bfa5b0e62a5276b337d95fd98d51a">BLERemoteDescriptor::getUUID</a>() {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> m_uuid;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;} <span class="comment">// getUUID</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">   58</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">BLERemoteDescriptor::readValue</a>() {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; readValue: %s&quot;</span>, <a class="code" href="class_b_l_e_remote_descriptor.html#aca23b01036531cbef12528a62167a5aa">toString</a>().c_str());</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// Check to see that we are connected.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_b_l_e_remote_descriptor.html#a409e7c2bde0b038582aba698b112135c">getRemoteCharacteristic</a>()-&gt;getRemoteService()-&gt;getClient()-&gt;isConnected()) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Disconnected&quot;</span>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a>();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    m_semaphoreReadDescrEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;readValue&quot;</span>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Ask the BLE subsystem to retrieve the value for the remote hosted characteristic.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_read_char_descr(</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        m_pRemoteCharacteristic-&gt;getRemoteService()-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        m_pRemoteCharacteristic-&gt;getRemoteService()-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>(),    <span class="comment">// The connection ID to the BLE server</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">getHandle</a>(),                                   <span class="comment">// The handle of this characteristic</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        ESP_GATT_AUTH_REQ_NONE);                       <span class="comment">// Security</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_read_char: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Block waiting for the event that indicates that the read has completed.  When it has, the std::string found</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// in m_value will contain our data.</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    m_semaphoreReadDescrEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;readValue&quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; readValue(): length: %d&quot;</span>, m_value.length());</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> m_value;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;} <span class="comment">// readValue</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#aadbb80f092fe843ac175983ae0c8cc4c">   90</a></span>&#160;uint8_t <a class="code" href="class_b_l_e_remote_descriptor.html#aadbb80f092fe843ac175983ae0c8cc4c">BLERemoteDescriptor::readUInt8</a>() {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">readValue</a>();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 1) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> (uint8_t) <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[0];</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;} <span class="comment">// readUInt8</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#a73b438a22df1168451ac9a39af366cce">   99</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_remote_descriptor.html#a73b438a22df1168451ac9a39af366cce">BLERemoteDescriptor::readUInt16</a>() {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">readValue</a>();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 2) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span> *(uint16_t*) <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;} <span class="comment">// readUInt16</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#aa99ef742cc11bf283f28a757205b6567">  108</a></span>&#160;uint32_t <a class="code" href="class_b_l_e_remote_descriptor.html#aa99ef742cc11bf283f28a757205b6567">BLERemoteDescriptor::readUInt32</a>() {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">readValue</a>();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 4) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">return</span> *(uint32_t*) <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;} <span class="comment">// readUInt32</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#aca23b01036531cbef12528a62167a5aa">  121</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_remote_descriptor.html#aca23b01036531cbef12528a62167a5aa">BLERemoteDescriptor::toString</a>() {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;handle: &quot;</span> &lt;&lt; <a class="code" href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">getHandle</a>() &lt;&lt; <span class="stringliteral">&quot;, uuid: &quot;</span> &lt;&lt; <a class="code" href="class_b_l_e_remote_descriptor.html#a252bfa5b0e62a5276b337d95fd98d51a">getUUID</a>().<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> ss.str();</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;} <span class="comment">// toString</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">  134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">BLERemoteDescriptor::writeValue</a>(uint8_t* <a class="code" href="structdata.html">data</a>, <span class="keywordtype">size_t</span> length, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; writeValue: %s&quot;</span>, <a class="code" href="class_b_l_e_remote_descriptor.html#aca23b01036531cbef12528a62167a5aa">toString</a>().c_str());</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Check to see that we are connected.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_b_l_e_remote_descriptor.html#a409e7c2bde0b038582aba698b112135c">getRemoteCharacteristic</a>()-&gt;getRemoteService()-&gt;getClient()-&gt;isConnected()) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Disconnected&quot;</span>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a>();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_write_char_descr(</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        m_pRemoteCharacteristic-&gt;getRemoteService()-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        m_pRemoteCharacteristic-&gt;getRemoteService()-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>(),</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">getHandle</a>(),</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        length,                           <span class="comment">// Data length</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>,                             <span class="comment">// Data</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        response ? ESP_GATT_WRITE_TYPE_RSP : ESP_GATT_WRITE_TYPE_NO_RSP,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        ESP_GATT_AUTH_REQ_NONE</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    );</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_write_char_descr: %d&quot;</span>, errRc);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; writeValue&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#ac60e8c8cc234bb173e61c5ed1baac4dc">  163</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">BLERemoteDescriptor::writeValue</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> newValue, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">writeValue</a>((uint8_t*) newValue.data(), newValue.length(), response);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_descriptor.html#aa186cfe1f589b5850fee0f8a62e094b0">  173</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">BLERemoteDescriptor::writeValue</a>(uint8_t newValue, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">writeValue</a>(&amp;newValue, 1, response);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CONFIG_BT_ENABLED */</span><span class="preprocessor"></span></div><div class="ttc" id="class_b_l_e_u_u_i_d_html"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html">BLEUUID</a></div><div class="ttdoc">A model of a BLE UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8h_source.html#l00018">BLEUUID.h:18</a></div></div>
<div class="ttc" id="_general_utils_8h_html"><div class="ttname"><a href="_general_utils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a1a3c8d45173da935e073c4c797d4e7f1"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a1a3c8d45173da935e073c4c797d4e7f1">BLERemoteDescriptor::getHandle</a></div><div class="ttdeci">uint16_t getHandle()</div><div class="ttdoc">Retrieve the handle associated with this remote descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00035">BLERemoteDescriptor.cpp:35</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a2506be1a156d23cbba0f417fb92cf1c2"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">BLERemoteDescriptor::writeValue</a></div><div class="ttdeci">void writeValue(uint8_t *data, size_t length, bool response=false)</div><div class="ttdoc">Write data to the BLE Remote Descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00134">BLERemoteDescriptor.cpp:134</a></div></div>
<div class="ttc" id="_b_l_e_remote_descriptor_8h_html"><div class="ttname"><a href="_b_l_e_remote_descriptor_8h.html">BLERemoteDescriptor.h</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a409e7c2bde0b038582aba698b112135c"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a409e7c2bde0b038582aba698b112135c">BLERemoteDescriptor::getRemoteCharacteristic</a></div><div class="ttdeci">BLERemoteCharacteristic * getRemoteCharacteristic()</div><div class="ttdoc">Get the characteristic that owns this descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00044">BLERemoteDescriptor.cpp:44</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_aadbb80f092fe843ac175983ae0c8cc4c"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#aadbb80f092fe843ac175983ae0c8cc4c">BLERemoteDescriptor::readUInt8</a></div><div class="ttdeci">uint8_t readUInt8(void)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00090">BLERemoteDescriptor.cpp:90</a></div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_b_l_e_disconnected_exception_html"><div class="ttname"><a href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a></div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_exceptions_8h_source.html#l00019">BLEExceptions.h:19</a></div></div>
<div class="ttc" id="class_b_l_e_remote_service_html_a4a05b11fa74971db7966639a4423a365"><div class="ttname"><a href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">BLERemoteService::getClient</a></div><div class="ttdeci">BLEClient * getClient(void)</div><div class="ttdoc">Get the client associated with this service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_service_8cpp_source.html#l00244">BLERemoteService.cpp:244</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a0f6325af99860af39fe15372864c0786"><div class="ttname"><a href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">BLEClient::getConnId</a></div><div class="ttdeci">uint16_t getConnId()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00317">BLEClient.cpp:317</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a73b438a22df1168451ac9a39af366cce"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a73b438a22df1168451ac9a39af366cce">BLERemoteDescriptor::readUInt16</a></div><div class="ttdeci">uint16_t readUInt16(void)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00099">BLERemoteDescriptor.cpp:99</a></div></div>
<div class="ttc" id="class_general_utils_html_a25e466e54ff002f54bfb7e1f43bd401b"><div class="ttname"><a href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a></div><div class="ttdeci">static const char * errorToString(esp_err_t errCode)</div><div class="ttdoc">Convert an ESP error code to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_general_utils_8cpp_source.html#l00366">GeneralUtils.cpp:366</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_aca23b01036531cbef12528a62167a5aa"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#aca23b01036531cbef12528a62167a5aa">BLERemoteDescriptor::toString</a></div><div class="ttdeci">std::string toString(void)</div><div class="ttdoc">Return a string representation of this BLE Remote Descriptor.  A string representation of this BLE Re...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00121">BLERemoteDescriptor.cpp:121</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a023cb404ff897bb39064b454732ccf21"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">FreeRTOS::Semaphore::wait</a></div><div class="ttdeci">uint32_t wait(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Wait for a semaphore to be released by trying to take it and then releasing it again. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00064">FreeRTOS.cpp:64</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a252bfa5b0e62a5276b337d95fd98d51a"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a252bfa5b0e62a5276b337d95fd98d51a">BLERemoteDescriptor::getUUID</a></div><div class="ttdeci">BLEUUID getUUID()</div><div class="ttdoc">Retrieve the UUID associated this remote descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00053">BLERemoteDescriptor.cpp:53</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_aa99ef742cc11bf283f28a757205b6567"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#aa99ef742cc11bf283f28a757205b6567">BLERemoteDescriptor::readUInt32</a></div><div class="ttdeci">uint32_t readUInt32(void)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00108">BLERemoteDescriptor.cpp:108</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html_a52e30a254e1ff10a429c2e0a36a6131d"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">BLEUUID::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Get a string representation of the UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8cpp_source.html#l00355">BLEUUID.cpp:355</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a68566b6eeeae65ea12c7b361e1f23add"><div class="ttname"><a href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">BLEClient::getGattcIf</a></div><div class="ttdeci">esp_gatt_if_t getGattcIf()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00323">BLEClient.cpp:323</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_af927ad866e0dbd5b343976f8f31edc17"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#af927ad866e0dbd5b343976f8f31edc17">BLERemoteDescriptor::readValue</a></div><div class="ttdeci">std::string readValue(void)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00058">BLERemoteDescriptor.cpp:58</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html">BLERemoteCharacteristic</a></div><div class="ttdoc">A model of a remote BLE characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8h_source.html#l00029">BLERemoteCharacteristic.h:29</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a67fa9bf777be48332a30154e006827fd"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">FreeRTOS::Semaphore::take</a></div><div class="ttdeci">bool take(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Take a semaphore. Take a semaphore and wait indefinitely. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00159">FreeRTOS.cpp:159</a></div></div>
<div class="ttc" id="get_8d_html_a38b0ef81b65f2aee282c8c217a123176"><div class="ttname"><a href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a></div><div class="ttdeci">Long this option will make all data specified with data</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e66062f3a4d2a5b6b6746a6b0f9c85ac.html">cpp_utils</a></li><li class="navelem"><a class="el" href="_b_l_e_remote_descriptor_8cpp.html">BLERemoteDescriptor.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
