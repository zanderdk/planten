<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/networking/FTPServer/FTPServer.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('networking_2_f_t_p_server_2_f_t_p_server_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FTPServer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="networking_2_f_t_p_server_2_f_t_p_server_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * FTPServer.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: May 6, 2018</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="networking_2_f_t_p_server_2_f_t_p_server_8h.html">FTPServer.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cctype&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// trim from start (in place)</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ltrim(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> &amp;s) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    s.erase(s.begin(), std::find_if(s.begin(), s.end(), [](<span class="keywordtype">int</span> ch) {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keywordflow">return</span> !std::isspace(ch);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }));</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;} <span class="comment">// ltrim</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// trim from end (in place)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> rtrim(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> &amp;s) {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    s.erase(std::find_if(s.rbegin(), s.rend(), [](<span class="keywordtype">int</span> ch) {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">return</span> !std::isspace(ch);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }).base(), s.end());</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;} <span class="comment">// rtrim</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// trim from both ends (in place)</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> trim(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> &amp;s) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    ltrim(s);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    rtrim(s);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;} <span class="comment">// trim</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="class_f_t_p_server.html#a9adbbb813fae5e2bb1572d18c77e0b34">FTPServer::FTPServer</a>() {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; FTPServer()\n&quot;</span>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    m_dataSocket    = -1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    m_clientSocket  = -1;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    m_dataPort      = -1;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    m_dataIp        = -1;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    m_passiveSocket = -1;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    m_serverSocket  = -1;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    m_callbacks       = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    m_isPassive       = <span class="keyword">false</span>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    m_isImage         = <span class="keyword">true</span>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    m_chunkSize       = 4096;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    m_port            = 21; <span class="comment">// The default Server-PI port</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    m_loginRequired   = <span class="keyword">false</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    m_isAuthenticated = <span class="keyword">false</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    m_userid = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    m_password = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; FTPServer()\n&quot;</span>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;} <span class="comment">// FTPServer#FTPServer</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="class_f_t_p_server.html#abd35ac45c080a9f19bb45c493a437e6c">FTPServer::~FTPServer</a>() {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// Nothing to do here by default.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;} <span class="comment">// FTPServer#~FTPServer</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordtype">void</span> FTPServer::closeConnection() {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; closeConnection\n&quot;</span>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    close(m_clientSocket);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; closeConnection\n&quot;</span>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;} <span class="comment">// FTPServer#closeConnection</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">void</span> FTPServer::closeData() {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; closeData\n&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    close(m_dataSocket);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    m_dataSocket = -1;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; closeData\n&quot;</span>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;} <span class="comment">// FTPServer#closeData</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordtype">void</span> FTPServer::closePassive() {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; closePassive\n&quot;</span>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    close(m_passiveSocket);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    m_passiveSocket = -1;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; closePassive\n&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;} <span class="comment">// FTPServer#closePassive</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/* STATIC */</span> <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_f_t_p_server.html#a89b431ba6aab76fc1da8f9aa3a4c3cc6">FTPServer::getCurrentDirectory</a>() {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">char</span> maxDirectory[256];</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> currentDirectory = getcwd(maxDirectory, <span class="keyword">sizeof</span>(maxDirectory));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span> currentDirectory;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;} <span class="comment">// FTPServer#getCurrentDirectory</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> FTPServer::listenPassive() {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; listenPassive\n&quot;</span>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    m_passiveSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (m_passiveSocket == -1) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;socket: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">struct </span>sockaddr_in clientAddrInfo;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> addrInfoSize = <span class="keyword">sizeof</span>(clientAddrInfo);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    getsockname(m_clientSocket, (<span class="keyword">struct</span> sockaddr*)&amp;clientAddrInfo, &amp;addrInfoSize);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">struct </span>sockaddr_in serverAddress;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    serverAddress.sin_family = AF_INET;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    serverAddress.sin_addr.s_addr = htonl(<a class="code" href="namespaceimpacket_1_1nmb.html#a69d5b2daf8dd402fc8b43abb4ffbd44e">INADDR_ANY</a>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    serverAddress.sin_port = htons(0);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#af65cc88d9ccb2274b94e0025d25d965f">bind</a>(m_passiveSocket, (<span class="keyword">struct</span> sockaddr *)&amp;serverAddress, <span class="keyword">sizeof</span>(serverAddress));</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;bind: %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = listen(m_passiveSocket, 5);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;listen: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> addrLen = <span class="keyword">sizeof</span>(serverAddress);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = getsockname(m_passiveSocket, (<span class="keyword">struct</span> sockaddr*)&amp;serverAddress, &amp;addrLen);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;getsockname: %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    ss    &lt;&lt; ((clientAddrInfo.sin_addr.s_addr &gt;&gt; 0)  &amp; 0xff) &lt;&lt;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ((clientAddrInfo.sin_addr.s_addr &gt;&gt; 8)  &amp; 0xff) &lt;&lt;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ((clientAddrInfo.sin_addr.s_addr &gt;&gt; 16) &amp; 0xff) &lt;&lt;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ((clientAddrInfo.sin_addr.s_addr &gt;&gt; 24) &amp; 0xff) &lt;&lt;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ((serverAddress.sin_port &gt;&gt; 0) &amp; 0xff) &lt;&lt;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ((serverAddress.sin_port &gt;&gt; 8) &amp; 0xff);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> retStr = ss.str();</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; listenPassive: %s\n&quot;</span>, retStr.c_str());</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> retStr;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;} <span class="comment">// FTPServer#listenPassive</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">void</span> FTPServer::onAuth(std::istringstream&amp; ss) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> param;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ss &gt;&gt; param;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onAuth: %s\n&quot;</span>, param.c_str());</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>);                <span class="comment">// Syntax error, command unrecognized.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onAuth\n&quot;</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;} <span class="comment">// FTPServer#onAuth</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">void</span> FTPServer::onCwd(std::istringstream&amp; ss) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    ss &gt;&gt; <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onCwd: path=%s\n&quot;</span>, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>.c_str());</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    chdir(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>.c_str());</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">FTPServer::RESPONSE_200_COMMAND_OK</a>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onCwd\n&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;} <span class="comment">// FTPServer#onCwd</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">void</span> FTPServer::onList(std::istringstream&amp; ss) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> directory;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    ss &gt;&gt; directory;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onList: directory=%s\n&quot;</span>, directory.c_str());</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    openData();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a8f4e8bed8ffbcde519fd3a37b985a56d">FTPServer::RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</a>); <span class="comment">// File status okay; about to open data connection.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> dirString = m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#a54c599b7b93a26486c36e6be70980ea3">onDir</a>();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        sendData((uint8_t *)dirString.data(), dirString.length());</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    closeData();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a598d4ba334755c8c8b55d0513b3f3440">FTPServer::RESPONSE_226_CLOSING_DATA_CONNECTION</a>); <span class="comment">// Closing data connection.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onList\n&quot;</span>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;} <span class="comment">// FTPServer#onList</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">void</span> FTPServer::onMkd(std::istringstream &amp;ss) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    ss &gt;&gt; <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onMkd: path=%s\n&quot;</span>, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>.c_str());</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onMkd\n&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;} <span class="comment">// FTPServer#onMkd</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">void</span> FTPServer::onNoop(std::istringstream&amp; ss) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onNoop\n&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">RESPONSE_200_COMMAND_OK</a>); <span class="comment">// Command okay.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onNoop\n&quot;</span>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;} <span class="comment">// FTPServer#onNoop</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">void</span> FTPServer::onPort(std::istringstream&amp; ss) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onPort\n&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">char</span> c;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    uint16_t h1, h2, h3, h4, p1, p2;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    ss &gt;&gt; h1 &gt;&gt; c &gt;&gt; h2 &gt;&gt; c &gt;&gt; h3 &gt;&gt; c &gt;&gt; h4 &gt;&gt; c &gt;&gt; p1 &gt;&gt; c &gt;&gt; p2;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    m_dataPort = p1*256 + p2;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;%d.%d.%d.%d %d\n&quot;</span>, h1, h2, h3, h4, m_dataPort);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    m_dataIp = h1&lt;&lt;24 | h2&lt;&lt;16 | h3&lt;&lt;8 | h4;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">RESPONSE_200_COMMAND_OK</a>); <span class="comment">// Command okay.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    m_isPassive = <span class="keyword">false</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onPort\n&quot;</span>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;} <span class="comment">// FTPServer#onPort</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordtype">void</span> FTPServer::onPass(std::istringstream&amp; ss) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> password;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    ss &gt;&gt; password;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onPass: password=%s\n&quot;</span>, password.c_str());</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// If the immediate last command wasn&#39;t USER then don&#39;t try and process PASS.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (m_lastCommand != <span class="stringliteral">&quot;USER&quot;</span>) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        sendResponse(<a class="code" href="class_f_t_p_server.html#a72818a9538714fd7d8b9fb791ef95964">RESPONSE_503_BAD_SEQUENCE</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onPass\n&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// Compare the supplied userid and passwords.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (m_userid == m_suppliedUserid &amp;&amp; password == m_password) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        sendResponse(<a class="code" href="class_f_t_p_server.html#a95111ffef0a3aef471e6969a9ee49887">RESPONSE_230_USER_LOGGED_IN</a>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        m_isAuthenticated = <span class="keyword">true</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        sendResponse(<a class="code" href="class_f_t_p_server.html#a210d971034e10c38a737e39ce154c927">RESPONSE_530_NOT_LOGGED_IN</a>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        closeConnection();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        m_isAuthenticated = <span class="keyword">false</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onPass\n&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;} <span class="comment">// FTPServer#onPass</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">void</span> FTPServer::onPasv(std::istringstream&amp; ss) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onPasv\n&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="connect__with__static__ip_8c.html#a3f808aeff17ef45a81bf2089b769709f">ipInfo</a> = listenPassive();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    std::ostringstream responseTextSS;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    responseTextSS &lt;&lt; <span class="stringliteral">&quot;Entering Passive Mode (&quot;</span> &lt;&lt; <a class="code" href="connect__with__static__ip_8c.html#a3f808aeff17ef45a81bf2089b769709f">ipInfo</a> &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> responseText;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    responseText = responseTextSS.str();</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#af2d28feeb1da65fb221e09204ff3d8cf">RESPONSE_227_ENTERING_PASSIVE_MODE</a>, responseText.c_str());</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    m_isPassive = <span class="keyword">true</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onPasv\n&quot;</span>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;} <span class="comment">// FTPServer#onPasv</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">void</span> FTPServer::onPWD(std::istringstream&amp; ss) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onPWD\n&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    sendResponse(257, <span class="stringliteral">&quot;\&quot;&quot;</span> + <a class="code" href="class_f_t_p_server.html#a89b431ba6aab76fc1da8f9aa3a4c3cc6">getCurrentDirectory</a>() + <span class="stringliteral">&quot;\&quot;&quot;</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onPWD: %s\n&quot;</span>, <a class="code" href="class_f_t_p_server.html#a89b431ba6aab76fc1da8f9aa3a4c3cc6">getCurrentDirectory</a>().c_str());</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;} <span class="comment">// FTPServer#onPWD</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">void</span> FTPServer::onQuit(std::istringstream&amp; ss) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onQuit\n&quot;</span>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#aad3b1c0d56a3f686437bcad02306f654">FTPServer::RESPONSE_221_CLOSING_CONTROL_CONNECTION</a>); <span class="comment">// Service closing control connection.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    closeConnection();  <span class="comment">// Close the connection to the client.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onQuit\n&quot;</span>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;} <span class="comment">// FTPServer#onQuit</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">void</span> FTPServer::onRetr(std::istringstream&amp; ss) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// We open a data connection back to the client.  We then invoke the callback to indicate that we have</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// started a retrieve operation.  We call the retrieve callback to request the next chunk of data and</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// transmit this down the data connection.  We repeat this until there is no more data to send at which</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// point we close the data connection and we are done.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onRetr\n&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> fileName;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    ss &gt;&gt; fileName;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    uint8_t <a class="code" href="structdata.html">data</a>[m_chunkSize];</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#a2b560c2599742629b91acf6668c4404d">onRetrieveStart</a>(fileName);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        } <span class="keywordflow">catch</span>(<a class="code" href="class_f_t_p_server_1_1_file_exception.html">FTPServer::FileException</a>&amp; e) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            sendResponse(<a class="code" href="class_f_t_p_server.html#a3ca4b22f112142fe49a1053aecc0aee0">FTPServer::RESPONSE_550_ACTION_NOT_TAKEN</a>);                                <span class="comment">// Requested action not taken.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onRetr: Returned 550 to client.\n&quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a8f4e8bed8ffbcde519fd3a37b985a56d">FTPServer::RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</a>); <span class="comment">// File status okay; about to open data connection.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    openData();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">int</span> readSize = m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#ae9d593f76a62f28dd9ce5aede0dc350f">onRetrieveData</a>(<a class="code" href="structdata.html">data</a>, m_chunkSize);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">while</span>(readSize &gt; 0) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            sendData(<a class="code" href="structdata.html">data</a>, readSize);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            readSize = m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#ae9d593f76a62f28dd9ce5aede0dc350f">onRetrieveData</a>(<a class="code" href="structdata.html">data</a>, m_chunkSize);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    closeData();</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a598d4ba334755c8c8b55d0513b3f3440">FTPServer::RESPONSE_226_CLOSING_DATA_CONNECTION</a>); <span class="comment">// Closing data connection.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#a22b0e65d56a371302cd54fa19247f2c5">onRetrieveEnd</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onRetr\n&quot;</span>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;} <span class="comment">// FTPServer#onRetr</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">void</span> FTPServer::onRmd(std::istringstream &amp;ss) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onRmd\n&quot;</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onRmd\n&quot;</span>);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;} <span class="comment">// FTPServer#onRmd</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">void</span> FTPServer::onStor(std::istringstream&amp; ss) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onStor\n&quot;</span>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> fileName;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    ss &gt;&gt; fileName;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    receiveFile(fileName);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onStor\n&quot;</span>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;} <span class="comment">// FTPServer#onStor</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">void</span> FTPServer::onSyst(std::istringstream&amp; ss) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onSyst\n&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    sendResponse(215, <span class="stringliteral">&quot;UNIX Type: L8&quot;</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onSyst\n&quot;</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;} <span class="comment">// FTPServer#onSyst</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordtype">void</span> FTPServer::onType(std::istringstream&amp; ss) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onType\n&quot;</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    ss &gt;&gt; <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>.compare(<span class="stringliteral">&quot;I&quot;</span>) == 0) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        m_isImage = <span class="keyword">true</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        m_isImage = <span class="keyword">false</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">FTPServer::RESPONSE_200_COMMAND_OK</a>);   <span class="comment">// Command okay.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onType: isImage=%d\n&quot;</span>, m_isImage);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;} <span class="comment">// FTPServer#onType</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordtype">void</span> FTPServer::onUser(std::istringstream&amp; ss) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// When we receive a user command, we next want to know if we should ask for a password.  If the m_loginRequired</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// flag is set then we do indeed want a password and will send the response that we wish one.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> userName;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    ss &gt;&gt; userName;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onUser: userName=%s\n&quot;</span>, userName.c_str());</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (m_loginRequired) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        sendResponse(<a class="code" href="class_f_t_p_server.html#a041f22bc17aa335e0da287925f5c0476">FTPServer::RESPONSE_331_PASSWORD_REQUIRED</a>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        sendResponse(<a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">FTPServer::RESPONSE_200_COMMAND_OK</a>); <span class="comment">// Command okay.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    m_suppliedUserid = userName;   <span class="comment">// Save the username that was supplied.</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onUser\n&quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;} <span class="comment">// FTPServer#onUser</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordtype">void</span> FTPServer::onXmkd(std::istringstream &amp;ss) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onXmkd\n&quot;</span>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onXmkd\n&quot;</span>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;} <span class="comment">// FTPServer#onXmkd</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordtype">void</span> FTPServer::onXrmd(std::istringstream &amp;ss) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; onXrmd\n&quot;</span>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; onXrmd\n&quot;</span>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;} <span class="comment">// FTPServer#onXrmd</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordtype">bool</span> FTPServer::openData() {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (m_isPassive) {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// Handle a passive connection ... here we receive a connection from the client from the passive socket.</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">struct </span>sockaddr_in clientAddress;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        socklen_t clientAddressLength = <span class="keyword">sizeof</span>(clientAddress);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        m_dataSocket = accept(m_passiveSocket, (<span class="keyword">struct</span> sockaddr *)&amp;clientAddress, &amp;clientAddressLength);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> (m_dataSocket == -1) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;FTPServer::openData: accept(): %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            closePassive();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        closePassive();</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// Handle an active connection ... here we connect to the client.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        m_dataSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">struct </span>sockaddr_in serverAddress;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        serverAddress.sin_family      = AF_INET;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        serverAddress.sin_addr.s_addr = htonl(m_dataIp);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        serverAddress.sin_port        = htons(m_dataPort);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a>(m_dataSocket, (<span class="keyword">struct</span> sockaddr *)&amp;serverAddress, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;FTPServer::openData: connect(): %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;} <span class="comment">// FTPServer#openData</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordtype">void</span> FTPServer::processCommand() {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a0a71e95c3a8a3c485c598bd6880f1477">FTPServer::RESPONSE_220_SERVICE_READY</a>); <span class="comment">// Service ready.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; FTPServer::processCommand\n&quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    m_lastCommand = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">while</span>(1) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordtype">char</span> currentChar;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordtype">char</span> lastChar = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = recv(m_clientSocket, &amp;currentChar, 1, 0);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">while</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != -1 &amp;&amp; <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>!=0) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a> += currentChar;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">if</span> (lastChar == <span class="charliteral">&#39;\r&#39;</span> &amp;&amp; currentChar == <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;%c\n&quot;</span>, currentChar);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            lastChar = currentChar;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = recv(m_clientSocket, &amp;currentChar, 1, 0);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        } <span class="comment">// End while we are waiting for a line.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == 0 || <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {          <span class="comment">// If we didn&#39;t get a line or an error, then we have finished processing commands.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        std::istringstream ss(<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        getline(ss, <a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        trim(<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">// We now have a command to process.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;Command: \&quot;%s\&quot;\n&quot;</span>, <a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.c_str());</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;USER&quot;</span>)==0) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            onUser(ss);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;PASS&quot;</span>)==0) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            onPass(ss);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_loginRequired &amp;&amp; !m_isAuthenticated) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            sendResponse(<a class="code" href="class_f_t_p_server.html#a210d971034e10c38a737e39ce154c927">RESPONSE_530_NOT_LOGGED_IN</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;PASV&quot;</span>)==0) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            onPasv(ss);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;SYST&quot;</span>)==0) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            onSyst(ss);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;PORT&quot;</span>)==0) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            onPort(ss);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;LIST&quot;</span>)==0) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            onList(ss);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;TYPE&quot;</span>)==0) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            onType(ss);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;RETR&quot;</span>)==0) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            onRetr(ss);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;QUIT&quot;</span>)==0) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            onQuit(ss);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;AUTH&quot;</span>)==0) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            onAuth(ss);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;STOR&quot;</span>)==0) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            onStor(ss);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;PWD&quot;</span>)==0) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            onPWD(ss);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;MKD&quot;</span>)==0) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            onMkd(ss);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;XMKD&quot;</span>)==0) {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            onXmkd(ss);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;RMD&quot;</span>)==0) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            onRmd(ss);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;XRMD&quot;</span>)==0) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            onXrmd(ss);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>.compare(<span class="stringliteral">&quot;CWD&quot;</span>)==0) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            onCwd(ss);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            sendResponse(<a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a>); <span class="comment">// Syntax error, command unrecognized.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        m_lastCommand = <a class="code" href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    } <span class="comment">// End loop processing commands.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    close(m_clientSocket); <span class="comment">// We won&#39;t be processing any further commands from this client.</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; FTPServer::processCommand\n&quot;</span>);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;} <span class="comment">// FTPServer::processCommand</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keywordtype">void</span> FTPServer::receiveFile(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> fileName) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; receiveFile: %s\n&quot;</span>, fileName.c_str());</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#a310e8643ffeec67b4049423c44ba1b23">onStoreStart</a>(fileName);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        } <span class="keywordflow">catch</span>(<a class="code" href="class_f_t_p_server_1_1_file_exception.html">FTPServer::FileException</a>&amp; e) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;Caught a file exception!\n&quot;</span>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            sendResponse(<a class="code" href="class_f_t_p_server.html#a3ca4b22f112142fe49a1053aecc0aee0">FTPServer::RESPONSE_550_ACTION_NOT_TAKEN</a>); <span class="comment">// Requested action not taken.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    openData();</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a8f4e8bed8ffbcde519fd3a37b985a56d">FTPServer::RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</a>); <span class="comment">// File status okay; about to open data connection.</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    uint8_t <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[m_chunkSize];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    uint32_t totalSizeRead = 0;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">while</span>(1) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = recv(m_dataSocket, &amp;<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, m_chunkSize, 0);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt;= 0) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#ae9d593f76a62f28dd9ce5aede0dc350f">onRetrieveData</a>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        totalSizeRead += <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    sendResponse(<a class="code" href="class_f_t_p_server.html#a598d4ba334755c8c8b55d0513b3f3440">FTPServer::RESPONSE_226_CLOSING_DATA_CONNECTION</a>); <span class="comment">// Closing data connection.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    closeData();</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (m_callbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        m_callbacks-&gt;<a class="code" href="class_f_t_p_callbacks.html#a22b0e65d56a371302cd54fa19247f2c5">onRetrieveEnd</a>();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; receiveFile: totalSizeRead=%d\n&quot;</span>, totalSizeRead);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;} <span class="comment">// FTPServer#receiveFile</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordtype">void</span> FTPServer::sendData(uint8_t* pData, uint32_t <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; FTPServer::sendData: size=%d\n&quot;</span>, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = send(m_dataSocket, pData, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, 0);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;FTPServer::sendData: send(): %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; FTPServer::sendData\n&quot;</span>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;} <span class="comment">// FTPServer#sendData</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">void</span> FTPServer::sendResponse(<span class="keywordtype">int</span> <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>, <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> text) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; sendResponse: (%d) %s\n&quot;</span>, <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>, text.c_str());</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    std::ostringstream ss;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    ss &lt;&lt; <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; text &lt;&lt; <span class="stringliteral">&quot;\r\n&quot;</span>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = send(m_clientSocket, ss.str().data(), ss.str().length(), 0);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; sendResponse\n&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;} <span class="comment">// FTPServer#sendResponse</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordtype">void</span> FTPServer::sendResponse(<span class="keywordtype">int</span> <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> text = <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>) {             <span class="comment">// Map the code to a text string.</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a8f4e8bed8ffbcde519fd3a37b985a56d">RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</a>:</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            text = <span class="stringliteral">&quot;File status okay; about to open data connection.&quot;</span>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">RESPONSE_200_COMMAND_OK</a>:</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            text = <span class="stringliteral">&quot;Command okay.&quot;</span>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a0a71e95c3a8a3c485c598bd6880f1477">RESPONSE_220_SERVICE_READY</a>:</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            text = <span class="stringliteral">&quot;Service ready.&quot;</span>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#aad3b1c0d56a3f686437bcad02306f654">RESPONSE_221_CLOSING_CONTROL_CONNECTION</a>:</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            text = <span class="stringliteral">&quot;Service closing control connection.&quot;</span>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a598d4ba334755c8c8b55d0513b3f3440">RESPONSE_226_CLOSING_DATA_CONNECTION</a>:</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            text = <span class="stringliteral">&quot;Closing data connection.&quot;</span>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a95111ffef0a3aef471e6969a9ee49887">RESPONSE_230_USER_LOGGED_IN</a>:</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            text = <span class="stringliteral">&quot;User logged in, proceed.&quot;</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a041f22bc17aa335e0da287925f5c0476">RESPONSE_331_PASSWORD_REQUIRED</a>:</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            text = <span class="stringliteral">&quot;Password required.&quot;</span>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">RESPONSE_500_COMMAND_UNRECOGNIZED</a>:</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            text = <span class="stringliteral">&quot;Syntax error, command unrecognized.&quot;</span>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a5b14a948d806b4d3a265bce15454a0c4">RESPONSE_502_COMMAND_NOT_IMPLEMENTED</a>:</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            text = <span class="stringliteral">&quot;Command not implemented.&quot;</span>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a72818a9538714fd7d8b9fb791ef95964">RESPONSE_503_BAD_SEQUENCE</a>:</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            text = <span class="stringliteral">&quot;Bad sequence of commands.&quot;</span>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a210d971034e10c38a737e39ce154c927">RESPONSE_530_NOT_LOGGED_IN</a>:</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            text = <span class="stringliteral">&quot;Not logged in.&quot;</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_f_t_p_server.html#a3ca4b22f112142fe49a1053aecc0aee0">RESPONSE_550_ACTION_NOT_TAKEN</a>:</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            text = <span class="stringliteral">&quot;Requested action not taken.&quot;</span>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    sendResponse(<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>, text);   <span class="comment">// Send the code AND the text to the FTP client.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;} <span class="comment">// FTPServer#sendResponse</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_f_t_p_server.html#a193be61985bf88aa0cc70834a801916a">FTPServer::setCallbacks</a>(<a class="code" href="class_f_t_p_callbacks.html">FTPCallbacks</a>* pCallbacks) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    m_callbacks = pCallbacks;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;} <span class="comment">// FTPServer#setCallbacks</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_f_t_p_server.html#a696aa4eff69b522268462017f8927c53">FTPServer::setCredentials</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> userid, <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> password) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; setCredentials: userid=%s\n&quot;</span>, userid.c_str());</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    m_loginRequired = <span class="keyword">true</span>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    m_userid        = userid;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    m_password      = password;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; setCredentials\n&quot;</span>);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;} <span class="comment">// FTPServer#setCredentials</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_f_t_p_server.html#adee541fc29714c9ff5f478892b0efe60">FTPServer::setPort</a>(uint16_t port) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    m_port = port;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;} <span class="comment">// FTPServer#setPort</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_f_t_p_server.html#a84264700de3f7a384a885977145ba9c0">FTPServer::start</a>() {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    m_serverSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (m_serverSocket == -1) {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;socket: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordtype">int</span> enable = 1;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    setsockopt(m_serverSocket, SOL_SOCKET, SO_REUSEADDR, &amp;enable, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keyword">struct </span>sockaddr_in serverAddress;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    serverAddress.sin_family = AF_INET;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    serverAddress.sin_addr.s_addr = htonl(<a class="code" href="namespaceimpacket_1_1nmb.html#a69d5b2daf8dd402fc8b43abb4ffbd44e">INADDR_ANY</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    serverAddress.sin_port = htons(m_port);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#af65cc88d9ccb2274b94e0025d25d965f">bind</a>(m_serverSocket, (<span class="keyword">struct</span> sockaddr *)&amp;serverAddress, <span class="keyword">sizeof</span>(serverAddress));</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;bind: %s\n&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = listen(m_serverSocket, 5);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;listen: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">while</span>(1) {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        waitForFTPClient();</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        processCommand();</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;} <span class="comment">// FTPServer#start</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordtype">int</span> FTPServer::waitForFTPClient() {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&gt;&gt; FTPServer::waitForFTPClient\n&quot;</span>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keyword">struct </span>sockaddr_in clientAddress;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    socklen_t clientAddressLength = <span class="keyword">sizeof</span>(clientAddress);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    m_clientSocket = accept(m_serverSocket, (<span class="keyword">struct</span> sockaddr *)&amp;clientAddress, &amp;clientAddressLength);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">char</span> ipAddr[<a class="code" href="ftp_8c.html#a93b37007689284fd9c4bde1a8f4b9199">INET_ADDRSTRLEN</a>];</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    inet_ntop(AF_INET, &amp;clientAddress.sin_addr, ipAddr, <span class="keyword">sizeof</span>(ipAddr));</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;Received connection from %s [%d]\n&quot;</span>, ipAddr, clientAddress.sin_port);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">struct </span>sockaddr_in socketAddressInfo;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> socketAddressInfoSize = <span class="keyword">sizeof</span>(socketAddressInfo);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    getsockname(m_clientSocket, (<span class="keyword">struct</span> sockaddr*)&amp;socketAddressInfo, &amp;socketAddressInfoSize);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    inet_ntop(AF_INET, &amp;socketAddressInfo.sin_addr, ipAddr, <span class="keyword">sizeof</span>(ipAddr));</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;Connected at %s [%d]\n&quot;</span>, ipAddr, socketAddressInfo.sin_port);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a>(<span class="stringliteral">&quot;&lt;&lt; FTPServer::waitForFTPClient: fd=%d\n&quot;</span>, m_clientSocket);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> m_clientSocket;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;} <span class="comment">// FTPServer::waitForFTPClient</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="ttc" id="setup-os400_8h_html_af65cc88d9ccb2274b94e0025d25d965f"><div class="ttname"><a href="setup-os400_8h.html#af65cc88d9ccb2274b94e0025d25d965f">bind</a></div><div class="ttdeci">#define bind</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00211">setup-os400.h:211</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a95111ffef0a3aef471e6969a9ee49887"><div class="ttname"><a href="class_f_t_p_server.html#a95111ffef0a3aef471e6969a9ee49887">FTPServer::RESPONSE_230_USER_LOGGED_IN</a></div><div class="ttdeci">static const int RESPONSE_230_USER_LOGGED_IN</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00072">FTPServer.h:72</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a210d971034e10c38a737e39ce154c927"><div class="ttname"><a href="class_f_t_p_server.html#a210d971034e10c38a737e39ce154c927">FTPServer::RESPONSE_530_NOT_LOGGED_IN</a></div><div class="ttdeci">static const int RESPONSE_530_NOT_LOGGED_IN</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00080">FTPServer.h:80</a></div></div>
<div class="ttc" id="unit1608_8c_html_afb9ed1b8a27eb20854efe6e23e297683"><div class="ttname"><a href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a></div><div class="ttdeci">CURLcode code</div><div class="ttdef"><b>Definition:</b> <a href="unit1608_8c_source.html#l00047">unit1608.c:47</a></div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html_a54c599b7b93a26486c36e6be70980ea3"><div class="ttname"><a href="class_f_t_p_callbacks.html#a54c599b7b93a26486c36e6be70980ea3">FTPCallbacks::onDir</a></div><div class="ttdeci">virtual std::string onDir()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_callbacks_8cpp_source.html#l00144">FTPCallbacks.cpp:144</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html_ae9d593f76a62f28dd9ce5aede0dc350f"><div class="ttname"><a href="class_f_t_p_callbacks.html#ae9d593f76a62f28dd9ce5aede0dc350f">FTPCallbacks::onRetrieveData</a></div><div class="ttdeci">virtual size_t onRetrieveData(uint8_t *data, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_callbacks_8cpp_source.html#l00131">FTPCallbacks.cpp:131</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a193be61985bf88aa0cc70834a801916a"><div class="ttname"><a href="class_f_t_p_server.html#a193be61985bf88aa0cc70834a801916a">FTPServer::setCallbacks</a></div><div class="ttdeci">void setCallbacks(FTPCallbacks *pFTPCallbacks)</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00728">FTPServer.cpp:728</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_abd35ac45c080a9f19bb45c493a437e6c"><div class="ttname"><a href="class_f_t_p_server.html#abd35ac45c080a9f19bb45c493a437e6c">FTPServer::~FTPServer</a></div><div class="ttdeci">virtual ~FTPServer()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00070">FTPServer.cpp:70</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a598d4ba334755c8c8b55d0513b3f3440"><div class="ttname"><a href="class_f_t_p_server.html#a598d4ba334755c8c8b55d0513b3f3440">FTPServer::RESPONSE_226_CLOSING_DATA_CONNECTION</a></div><div class="ttdeci">static const int RESPONSE_226_CLOSING_DATA_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00073">FTPServer.h:73</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a3ca4b22f112142fe49a1053aecc0aee0"><div class="ttname"><a href="class_f_t_p_server.html#a3ca4b22f112142fe49a1053aecc0aee0">FTPServer::RESPONSE_550_ACTION_NOT_TAKEN</a></div><div class="ttdeci">static const int RESPONSE_550_ACTION_NOT_TAKEN</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00081">FTPServer.h:81</a></div></div>
<div class="ttc" id="namespaceimpacket_1_1nmb_html_ae08ba7342be906ac4e49aa4746c2242d"><div class="ttname"><a href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">impacket.nmb.strerror</a></div><div class="ttdeci">def strerror(errclass, errcode)</div><div class="ttdef"><b>Definition:</b> <a href="nmb_8py_source.html#l00140">nmb.py:140</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a84264700de3f7a384a885977145ba9c0"><div class="ttname"><a href="class_f_t_p_server.html#a84264700de3f7a384a885977145ba9c0">FTPServer::start</a></div><div class="ttdeci">void start()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00753">FTPServer.cpp:753</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_ae048f57f14588271686673c10d6a5e03"><div class="ttname"><a href="class_f_t_p_server.html#ae048f57f14588271686673c10d6a5e03">FTPServer::RESPONSE_500_COMMAND_UNRECOGNIZED</a></div><div class="ttdeci">static const int RESPONSE_500_COMMAND_UNRECOGNIZED</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00077">FTPServer.h:77</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html_a2b560c2599742629b91acf6668c4404d"><div class="ttname"><a href="class_f_t_p_callbacks.html#a2b560c2599742629b91acf6668c4404d">FTPCallbacks::onRetrieveStart</a></div><div class="ttdeci">virtual void onRetrieveStart(std::string fileName)</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_callbacks_8cpp_source.html#l00125">FTPCallbacks.cpp:125</a></div></div>
<div class="ttc" id="form_8d_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00048">form.d:48</a></div></div>
<div class="ttc" id="quote_8d_html_ae7102b102f9ed4847a2862ff6984ca3f"><div class="ttname"><a href="quote_8d.html#ae7102b102f9ed4847a2862ff6984ca3f">command</a></div><div class="ttdeci">Long to be exact.To make commands take place after a successful prefix them with a dash.To make commands be sent after curl has changed the working just before the transfer command(s)</div></div>
<div class="ttc" id="class_f_t_p_server_html_ad93e84ed37ba1c5ead91d8e72b87557e"><div class="ttname"><a href="class_f_t_p_server.html#ad93e84ed37ba1c5ead91d8e72b87557e">FTPServer::RESPONSE_200_COMMAND_OK</a></div><div class="ttdeci">static const int RESPONSE_200_COMMAND_OK</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00065">FTPServer.h:65</a></div></div>
<div class="ttc" id="output_8d_html_a7bcb6a773be04cbd4890bfe10fa42696"><div class="ttname"><a href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a></div><div class="ttdeci">Long you can use specifier.That variable will be replaced with the current string for the URL being fetched.Like if you specify two URLs on the same command line</div><div class="ttdef"><b>Definition:</b> <a href="output_8d_source.html#l00008">output.d:8</a></div></div>
<div class="ttc" id="networking_2_f_t_p_server_2_f_t_p_server_8h_html"><div class="ttname"><a href="networking_2_f_t_p_server_2_f_t_p_server_8h.html">FTPServer.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3cb9f0894fab1c8fbb0753c9c7c2a8d9"><div class="ttname"><a href="curl__printf_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9">printf</a></div><div class="ttdeci">#define printf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00040">curl_printf.h:40</a></div></div>
<div class="ttc" id="ftp_8c_html_a93b37007689284fd9c4bde1a8f4b9199"><div class="ttname"><a href="ftp_8c.html#a93b37007689284fd9c4bde1a8f4b9199">INET_ADDRSTRLEN</a></div><div class="ttdeci">#define INET_ADDRSTRLEN</div><div class="ttdef"><b>Definition:</b> <a href="ftp_8c_source.html#l00090">ftp.c:90</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html_a22b0e65d56a371302cd54fa19247f2c5"><div class="ttname"><a href="class_f_t_p_callbacks.html#a22b0e65d56a371302cd54fa19247f2c5">FTPCallbacks::onRetrieveEnd</a></div><div class="ttdeci">virtual void onRetrieveEnd()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_callbacks_8cpp_source.html#l00138">FTPCallbacks.cpp:138</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_aad3b1c0d56a3f686437bcad02306f654"><div class="ttname"><a href="class_f_t_p_server.html#aad3b1c0d56a3f686437bcad02306f654">FTPServer::RESPONSE_221_CLOSING_CONTROL_CONNECTION</a></div><div class="ttdeci">static const int RESPONSE_221_CLOSING_CONTROL_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00071">FTPServer.h:71</a></div></div>
<div class="ttc" id="setup-os400_8h_html_adfd4ee688142ebda1142c1b0c7577e91"><div class="ttname"><a href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a></div><div class="ttdeci">#define connect</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00210">setup-os400.h:210</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html"><div class="ttname"><a href="class_f_t_p_callbacks.html">FTPCallbacks</a></div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00017">FTPServer.h:17</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a041f22bc17aa335e0da287925f5c0476"><div class="ttname"><a href="class_f_t_p_server.html#a041f22bc17aa335e0da287925f5c0476">FTPServer::RESPONSE_331_PASSWORD_REQUIRED</a></div><div class="ttdeci">static const int RESPONSE_331_PASSWORD_REQUIRED</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00075">FTPServer.h:75</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a89b431ba6aab76fc1da8f9aa3a4c3cc6"><div class="ttname"><a href="class_f_t_p_server.html#a89b431ba6aab76fc1da8f9aa3a4c3cc6">FTPServer::getCurrentDirectory</a></div><div class="ttdeci">static std::string getCurrentDirectory()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00110">FTPServer.cpp:110</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_af2d28feeb1da65fb221e09204ff3d8cf"><div class="ttname"><a href="class_f_t_p_server.html#af2d28feeb1da65fb221e09204ff3d8cf">FTPServer::RESPONSE_227_ENTERING_PASSIVE_MODE</a></div><div class="ttdeci">static const int RESPONSE_227_ENTERING_PASSIVE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00074">FTPServer.h:74</a></div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="connect__with__static__ip_8c_html_a3f808aeff17ef45a81bf2089b769709f"><div class="ttname"><a href="connect__with__static__ip_8c.html#a3f808aeff17ef45a81bf2089b769709f">ipInfo</a></div><div class="ttdeci">tcpip_adapter_ip_info_t ipInfo</div><div class="ttdef"><b>Definition:</b> <a href="connect__with__static__ip_8c_source.html#l00044">connect_with_static_ip.c:44</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a5b14a948d806b4d3a265bce15454a0c4"><div class="ttname"><a href="class_f_t_p_server.html#a5b14a948d806b4d3a265bce15454a0c4">FTPServer::RESPONSE_502_COMMAND_NOT_IMPLEMENTED</a></div><div class="ttdeci">static const int RESPONSE_502_COMMAND_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00078">FTPServer.h:78</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a0a71e95c3a8a3c485c598bd6880f1477"><div class="ttname"><a href="class_f_t_p_server.html#a0a71e95c3a8a3c485c598bd6880f1477">FTPServer::RESPONSE_220_SERVICE_READY</a></div><div class="ttdeci">static const int RESPONSE_220_SERVICE_READY</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00070">FTPServer.h:70</a></div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a9adbbb813fae5e2bb1572d18c77e0b34"><div class="ttname"><a href="class_f_t_p_server.html#a9adbbb813fae5e2bb1572d18c77e0b34">FTPServer::FTPServer</a></div><div class="ttdeci">FTPServer()</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00046">FTPServer.cpp:46</a></div></div>
<div class="ttc" id="namespaceimpacket_1_1nmb_html_a69d5b2daf8dd402fc8b43abb4ffbd44e"><div class="ttname"><a href="namespaceimpacket_1_1nmb.html#a69d5b2daf8dd402fc8b43abb4ffbd44e">impacket.nmb.INADDR_ANY</a></div><div class="ttdeci">string INADDR_ANY</div><div class="ttdef"><b>Definition:</b> <a href="nmb_8py_source.html#l00048">nmb.py:48</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a8f4e8bed8ffbcde519fd3a37b985a56d"><div class="ttname"><a href="class_f_t_p_server.html#a8f4e8bed8ffbcde519fd3a37b985a56d">FTPServer::RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</a></div><div class="ttdeci">static const int RESPONSE_150_ABOUT_TO_OPEN_DATA_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00064">FTPServer.h:64</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a72818a9538714fd7d8b9fb791ef95964"><div class="ttname"><a href="class_f_t_p_server.html#a72818a9538714fd7d8b9fb791ef95964">FTPServer::RESPONSE_503_BAD_SEQUENCE</a></div><div class="ttdeci">static const int RESPONSE_503_BAD_SEQUENCE</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00079">FTPServer.h:79</a></div></div>
<div class="ttc" id="class_f_t_p_server_1_1_file_exception_html"><div class="ttname"><a href="class_f_t_p_server_1_1_file_exception.html">FTPServer::FileException</a></div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8h_source.html#l00060">FTPServer.h:60</a></div></div>
<div class="ttc" id="class_f_t_p_callbacks_html_a310e8643ffeec67b4049423c44ba1b23"><div class="ttname"><a href="class_f_t_p_callbacks.html#a310e8643ffeec67b4049423c44ba1b23">FTPCallbacks::onStoreStart</a></div><div class="ttdeci">virtual void onStoreStart(std::string fileName)</div><div class="ttdoc">-— END OF FTPFileCallbacks </div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_callbacks_8cpp_source.html#l00106">FTPCallbacks.cpp:106</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_a696aa4eff69b522268462017f8927c53"><div class="ttname"><a href="class_f_t_p_server.html#a696aa4eff69b522268462017f8927c53">FTPServer::setCredentials</a></div><div class="ttdeci">void setCredentials(std::string userid, std::string password)</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00733">FTPServer.cpp:733</a></div></div>
<div class="ttc" id="class_f_t_p_server_html_adee541fc29714c9ff5f478892b0efe60"><div class="ttname"><a href="class_f_t_p_server.html#adee541fc29714c9ff5f478892b0efe60">FTPServer::setPort</a></div><div class="ttdeci">void setPort(uint16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="cpp__utils_2_f_t_p_server_8cpp_source.html#l00745">FTPServer.cpp:745</a></div></div>
<div class="ttc" id="util_8c_html_a3b02c6de5c049804444a246f7fdf46b4"><div class="ttname"><a href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a></div><div class="ttdeci">const char * path</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00194">util.c:194</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e6509e8e306afd21d8371d681599573a.html">networking</a></li><li class="navelem"><a class="el" href="dir_14e8a4c8b0d6dc1b898a9bace0ee8246.html">FTPServer</a></li><li class="navelem"><a class="el" href="networking_2_f_t_p_server_2_f_t_p_server_8cpp.html">FTPServer.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
