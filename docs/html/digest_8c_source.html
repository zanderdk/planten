<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/vauth/digest.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('digest_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">digest.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="digest_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * RFC2831 DIGEST-MD5 authentication</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * RFC7616 DIGEST-SHA256, DIGEST-SHA512-256 authentication</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_CRYPTO_AUTH)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vauth_8h.html">vauth/vauth.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="digest_8h.html">vauth/digest.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__hmac_8h.html">curl_hmac.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__md5_8h.html">curl_md5.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__sha256_8h.html">curl_sha256.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtls_8h.html">vtls/vtls.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="warnless_8h.html">warnless.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtok_8h.html">strtok.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="non-ascii_8h.html">non-ascii.h</a>&quot;</span> <span class="comment">/* included for Curl_convert_... prototypes */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rand_8h.html">rand.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/* The last #include files should be: */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if !defined(USE_WINDOWS_SSPI)</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="digest_8c.html#a2365b3e378c16273762865b31da09fe1">   52</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_AUTH             (1 &lt;&lt; 0)</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="digest_8c.html#a8fc384d80f3ed86d4443b47b774d1aa6">   53</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_AUTH_INT         (1 &lt;&lt; 1)</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="digest_8c.html#a79dcad530582256beb6018259b0cebda">   54</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_AUTH_CONF        (1 &lt;&lt; 2)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">   56</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_STRING_AUTH      &quot;auth&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="digest_8c.html#ac027f2b51154f12f020fb7f8efd14f91">   57</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_STRING_AUTH_INT  &quot;auth-int&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="digest_8c.html#ab70ce97dda687dac30f1254909b76c40">   58</a></span>&#160;<span class="preprocessor">#define DIGEST_QOP_VALUE_STRING_AUTH_CONF &quot;auth-conf&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/* The CURL_OUTPUT_DIGEST_CONV macro below is for non-ASCII machines.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">   It converts digest text to ASCII so the MD5 will be correct for</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">   what ultimately goes over the network.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">   64</a></span>&#160;<span class="preprocessor">#define CURL_OUTPUT_DIGEST_CONV(a, b) \</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">  result = Curl_convert_to_network(a, (char *)b, strlen((const char *)b)); \</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">  if(result) { \</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">    free(b); \</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">    return result; \</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !USE_WINDOWS_SSPI */</span><span class="preprocessor"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="digest_8h.html#a25aacde6b8871bae274a6b54552a6a89">   72</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="digest_8c.html#a25aacde6b8871bae274a6b54552a6a89">Curl_auth_digest_get_pair</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> **endptr)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> c;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">bool</span> starts_with_quote = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">bool</span> escape = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">for</span>(c = <a class="code" href="digest_8h.html#aadb8a3cab2395de348149b8a7811f5bb">DIGEST_MAX_VALUE_LENGTH</a> - 1; (*<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> &amp;&amp; (*<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> != <span class="charliteral">&#39;=&#39;</span>) &amp;&amp; c--);)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>++ = *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>++;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = 0;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span>(<span class="charliteral">&#39;=&#39;</span> != *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>++)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">/* eek, no match */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">if</span>(<span class="charliteral">&#39;\&quot;&#39;</span> == *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/* This starts with a quote so it must end with one as well! */</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    starts_with_quote = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">for</span>(c = <a class="code" href="digest_8h.html#a5283c45d571e13b34462343e4767bf43">DIGEST_MAX_CONTENT_LENGTH</a> - 1; *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> &amp;&amp; c--; <a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>++) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">switch</span>(*<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;\\&#39;</span>:</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span>(!escape) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="comment">/* possibly the start of an escaped quote */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        escape = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        *<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>++ = <span class="charliteral">&#39;\\&#39;</span>; <span class="comment">/* Even though this is an escape character, we still</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">                              store it as-is in the target buffer */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;,&#39;</span>:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span>(!starts_with_quote) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* This signals the end of the content if we didn&#39;t get a starting</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">           quote and then we do &quot;sloppy&quot; parsing */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        c = 0; <span class="comment">/* the end */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;\r&#39;</span>:</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;\n&#39;</span>:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="comment">/* end of string */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      c = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;\&quot;&#39;</span>:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span>(!escape &amp;&amp; starts_with_quote) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">/* end of string */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        c = 0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    escape = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    *<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>++ = *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  *<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a> = 0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  *endptr = <a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#if !defined(USE_WINDOWS_SSPI)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">/* Convert md5 chunk to RFC2617 (section 3.1.3) -suitable ascii string*/</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> auth_digest_md5_to_ascii(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *source, <span class="comment">/* 16 bytes */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *dest) <span class="comment">/* 33 bytes */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 16; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>((<span class="keywordtype">char</span> *) &amp;dest[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> * 2], 3, <span class="stringliteral">&quot;%02x&quot;</span>, source[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/* Convert sha256 chunk to RFC7616 -suitable ascii string*/</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> auth_digest_sha256_to_ascii(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *source, <span class="comment">/* 32 bytes */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *dest) <span class="comment">/* 65 bytes */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 32; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>((<span class="keywordtype">char</span> *) &amp;dest[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> * 2], 3, <span class="stringliteral">&quot;%02x&quot;</span>, source[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/* Perform quoted-string escaping as described in RFC2616 and its errata */</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *auth_digest_string_quoted(<span class="keyword">const</span> <span class="keywordtype">char</span> *source)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">char</span> *dest;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *s = source;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = 1; <span class="comment">/* null terminator */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">/* Calculate size needed */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">while</span>(*s) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    ++<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span>(*s == <span class="charliteral">&#39;&quot;&#39;</span> || *s == <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      ++<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    ++s;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  dest = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span>(dest) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">char</span> *d = dest;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    s = source;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">while</span>(*s) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span>(*s == <span class="charliteral">&#39;&quot;&#39;</span> || *s == <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        *d++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      *d++ = *s++;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    *d = 0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">return</span> dest;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/* Retrieves the value for a corresponding key from the challenge string</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> * returns TRUE if the key could be found, FALSE if it does not exists</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> auth_digest_get_key_value(<span class="keyword">const</span> <span class="keywordtype">char</span> *chlg,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                      <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                      <span class="keywordtype">size_t</span> max_val_len,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                      <span class="keywordtype">char</span> end_char)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">char</span> *find_pos;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  find_pos = strstr(chlg, <a class="code" href="unit1602_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span>(!find_pos)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  find_pos += strlen(<a class="code" href="unit1602_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; *find_pos &amp;&amp; *find_pos != end_char &amp;&amp; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; max_val_len - 1; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = *find_pos++;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> auth_digest_get_qop_values(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>, <span class="keywordtype">int</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">char</span> *tmp;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">char</span> *token;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">char</span> *tok_buf = NULL;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">/* Initialise the output */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = 0;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">/* Tokenise the list of qop values. Use a temporary clone of the buffer since</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">     strtok_r() ruins it. */</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  tmp = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  token = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(tmp, <span class="stringliteral">&quot;,&quot;</span>, &amp;tok_buf);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">while</span>(token != NULL) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(token, <a class="code" href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">DIGEST_QOP_VALUE_STRING_AUTH</a>))</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> |= <a class="code" href="digest_8c.html#a2365b3e378c16273762865b31da09fe1">DIGEST_QOP_VALUE_AUTH</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(token, <a class="code" href="digest_8c.html#ac027f2b51154f12f020fb7f8efd14f91">DIGEST_QOP_VALUE_STRING_AUTH_INT</a>))</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> |= <a class="code" href="digest_8c.html#a8fc384d80f3ed86d4443b47b774d1aa6">DIGEST_QOP_VALUE_AUTH_INT</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(token, <a class="code" href="digest_8c.html#ab70ce97dda687dac30f1254909b76c40">DIGEST_QOP_VALUE_STRING_AUTH_CONF</a>))</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> |= <a class="code" href="digest_8c.html#a79dcad530582256beb6018259b0cebda">DIGEST_QOP_VALUE_AUTH_CONF</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    token = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(NULL, <span class="stringliteral">&quot;,&quot;</span>, &amp;tok_buf);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(tmp);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> * auth_decode_digest_md5_message()</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> * This is used internally to decode an already encoded DIGEST-MD5 challenge</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> * message into the separate attributes.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> * chlg64  [in]     - The base64 encoded challenge message.</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> * nonce   [in/out] - The buffer where the nonce will be stored.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> * nlen    [in]     - The length of the nonce buffer.</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> * realm   [in/out] - The buffer where the realm will be stored.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> * rlen    [in]     - The length of the realm buffer.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * alg     [in/out] - The buffer where the algorithm will be stored.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> * alen    [in]     - The length of the algorithm buffer.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> * qop     [in/out] - The buffer where the qop-options will be stored.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> * qlen    [in]     - The length of the qop buffer.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> * Returns CURLE_OK on success.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> auth_decode_digest_md5_message(<span class="keyword">const</span> <span class="keywordtype">char</span> *chlg64,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                               <span class="keywordtype">char</span> *nonce, <span class="keywordtype">size_t</span> nlen,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                               <span class="keywordtype">char</span> *realm, <span class="keywordtype">size_t</span> rlen,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                               <span class="keywordtype">char</span> *alg, <span class="keywordtype">size_t</span> alen,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                               <span class="keywordtype">char</span> *qop, <span class="keywordtype">size_t</span> qlen)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chlg = NULL;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">size_t</span> chlglen = 0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">size_t</span> chlg64len = strlen(chlg64);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">/* Decode the base-64 encoded challenge message */</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span>(chlg64len &amp;&amp; *chlg64 != <span class="charliteral">&#39;=&#39;</span>) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a3b1d7d4873cc224ffb2ce6ff201bc2e6">Curl_base64_decode</a>(chlg64, &amp;chlg, &amp;chlglen);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">/* Ensure we have a valid challenge message */</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span>(!chlg)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">/* Retrieve nonce string from the challenge */</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(!auth_digest_get_key_value((<span class="keywordtype">char</span> *) chlg, <span class="stringliteral">&quot;nonce=\&quot;&quot;</span>, nonce, nlen,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                <span class="charliteral">&#39;\&quot;&#39;</span>)) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(chlg);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">/* Retrieve realm string from the challenge */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span>(!auth_digest_get_key_value((<span class="keywordtype">char</span> *) chlg, <span class="stringliteral">&quot;realm=\&quot;&quot;</span>, realm, rlen,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                <span class="charliteral">&#39;\&quot;&#39;</span>)) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">/* Challenge does not have a realm, set empty string [RFC2831] page 6 */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    strcpy(realm, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">/* Retrieve algorithm string from the challenge */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span>(!auth_digest_get_key_value((<span class="keywordtype">char</span> *) chlg, <span class="stringliteral">&quot;algorithm=&quot;</span>, alg, alen, <span class="charliteral">&#39;,&#39;</span>)) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(chlg);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">/* Retrieve qop-options string from the challenge */</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span>(!auth_digest_get_key_value((<span class="keywordtype">char</span> *) chlg, <span class="stringliteral">&quot;qop=\&quot;&quot;</span>, qop, qlen, <span class="charliteral">&#39;\&quot;&#39;</span>)) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(chlg);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(chlg);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> * Curl_auth_is_digest_supported()</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> * This is used to evaluate if DIGEST is supported.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> * Parameters: None</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> * Returns TRUE as DIGEST as handled by libcurl.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="vauth_8h.html#a75bcfc858ec12ca28e8b59a1ebc76c44">  329</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="digest_8c.html#a75bcfc858ec12ca28e8b59a1ebc76c44">Curl_auth_is_digest_supported</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * Curl_auth_create_digest_md5_message()</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> * This is used to generate an already encoded DIGEST-MD5 response message</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * ready for sending to the recipient.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> * data    [in]     - The session handle.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> * chlg64  [in]     - The base64 encoded challenge message.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> * userp   [in]     - The user name.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"> * passwdp [in]     - The user&#39;s password.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> * service [in]     - The service type such as http, smtp, pop or imap.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"> * outptr  [in/out] - The address where a pointer to newly allocated memory</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> *                    holding the result will be stored upon completion.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"> * outlen  [out]    - The length of the output message.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> * Returns CURLE_OK on success.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="vauth_8h.html#a67dd964e58c6eb44e08b1d91d66c41ec">  353</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="digest_8c.html#a67dd964e58c6eb44e08b1d91d66c41ec">Curl_auth_create_digest_md5_message</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *chlg64,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *userp,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *passwdp,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *service,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                             <span class="keywordtype">char</span> **outptr, <span class="keywordtype">size_t</span> *outlen)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="struct_m_d5__context.html">MD5_context</a> *ctxt;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">char</span> *response = NULL;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>[<a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>];</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">char</span> HA1_hex[2 * <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a> + 1];</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">char</span> HA2_hex[2 * <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a> + 1];</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">char</span> resp_hash_hex[2 * <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a> + 1];</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">char</span> nonce[64];</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">char</span> realm[128];</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">char</span> algorithm[64];</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">char</span> qop_options[64];</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordtype">int</span> qop_values;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordtype">char</span> cnonce[33];</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">char</span> nonceCount[] = <span class="stringliteral">&quot;00000001&quot;</span>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>[]     = <span class="stringliteral">&quot;AUTHENTICATE&quot;</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">char</span> qop[]        = <a class="code" href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">DIGEST_QOP_VALUE_STRING_AUTH</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">char</span> *spn         = NULL;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">/* Decode the challenge message */</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = auth_decode_digest_md5_message(chlg64, nonce, <span class="keyword">sizeof</span>(nonce),</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                          realm, <span class="keyword">sizeof</span>(realm),</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                          algorithm, <span class="keyword">sizeof</span>(algorithm),</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                          qop_options, <span class="keyword">sizeof</span>(qop_options));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">/* We only support md5 sessions */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span>(strcmp(algorithm, <span class="stringliteral">&quot;md5-sess&quot;</span>) != 0)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">/* Get the qop-values from the qop-options */</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = auth_digest_get_qop_values(qop_options, &amp;qop_values);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">/* We only support auth quality-of-protection */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span>(!(qop_values &amp; <a class="code" href="digest_8c.html#a2365b3e378c16273762865b31da09fe1">DIGEST_QOP_VALUE_AUTH</a>))</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">/* Generate 32 random hex chars, 32 bytes + 1 zero termination */</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="rand_8c.html#ae4bd86089b91201bafb73ad067d81f79">Curl_rand_hex</a>(<a class="code" href="structdata.html">data</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)cnonce, <span class="keyword">sizeof</span>(cnonce));</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">/* So far so good, now calculate A1 and H(A1) according to RFC 2831 */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  ctxt = <a class="code" href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a>(<a class="code" href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span>(!ctxt)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) userp,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(userp)));</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) realm,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(realm)));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) passwdp,</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(passwdp)));</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a>(ctxt, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  ctxt = <a class="code" href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a>(<a class="code" href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span>(!ctxt)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>, <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) nonce,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(nonce)));</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) cnonce,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(cnonce)));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a>(ctxt, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">/* Convert calculated 16 octet hex into 32 bytes string */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(&amp;HA1_hex[2 * <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>], 3, <span class="stringliteral">&quot;%02x&quot;</span>, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">/* Generate our SPN */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  spn = <a class="code" href="vauth_8c.html#a161d48bc8137a3699d548bc1aa9237a0">Curl_auth_build_spn</a>(service, realm, NULL);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">if</span>(!spn)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">/* Calculate H(A2) */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  ctxt = <a class="code" href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a>(<a class="code" href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span>(!ctxt) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(spn);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>,</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(<a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>)));</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) spn,</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(spn)));</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a>(ctxt, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(&amp;HA2_hex[2 * <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>], 3, <span class="stringliteral">&quot;%02x&quot;</span>, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">/* Now calculate the response hash */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  ctxt = <a class="code" href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a>(<a class="code" href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span>(!ctxt) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(spn);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) HA1_hex, 2 * <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) nonce,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(nonce)));</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) nonceCount,</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(nonceCount)));</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) cnonce,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(cnonce)));</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) qop,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                  <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(strlen(qop)));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(ctxt, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) HA2_hex, 2 * <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a>(ctxt, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(&amp;resp_hash_hex[2 * <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>], 3, <span class="stringliteral">&quot;%02x&quot;</span>, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">/* Generate the response */</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  response = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;username=\&quot;%s\&quot;,realm=\&quot;%s\&quot;,nonce=\&quot;%s\&quot;,&quot;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                     <span class="stringliteral">&quot;cnonce=\&quot;%s\&quot;,nc=\&quot;%s\&quot;,digest-uri=\&quot;%s\&quot;,response=%s,&quot;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                     <span class="stringliteral">&quot;qop=%s&quot;</span>,</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                     userp, realm, nonce,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                     cnonce, nonceCount, spn, resp_hash_hex, qop);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(spn);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span>(!response)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">/* Base64 encode the response */</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>, response, 0, outptr, outlen);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(response);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"> * Curl_auth_decode_digest_http_message()</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"> * This is used to decode a HTTP DIGEST challenge message into the separate</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"> * attributes.</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"> * chlg    [in]     - The challenge message.</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> * digest  [in/out] - The digest data struct being used and modified.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> * Returns CURLE_OK on success.</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="vauth_8h.html#afcaf5c8f5a42ea5832a4f344e5318a5d">  521</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="digest_8c.html#afcaf5c8f5a42ea5832a4f344e5318a5d">Curl_auth_decode_digest_http_message</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *chlg,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                              <span class="keyword">struct</span> <a class="code" href="structdigestdata.html">digestdata</a> *<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">bool</span> before = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* got a nonce before */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordtype">bool</span> foundAuth = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordtype">bool</span> foundAuthInt = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordtype">char</span> *token = NULL;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">char</span> *tmp = NULL;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">/* If we already have received a nonce, keep that in mind */</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce)</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    before = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">/* Clean up any former leftovers and initialise to defaults */</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="digest_8c.html#ab946e5ba03560d08796ff44bb2cc332f">Curl_auth_digest_cleanup</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[<a class="code" href="digest_8h.html#aadb8a3cab2395de348149b8a7811f5bb">DIGEST_MAX_VALUE_LENGTH</a>];</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>[<a class="code" href="digest_8h.html#a5283c45d571e13b34462343e4767bf43">DIGEST_MAX_CONTENT_LENGTH</a>];</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">/* Pass all additional spaces here */</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">while</span>(*chlg &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*chlg))</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      chlg++;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">/* Extract a value=content pair */</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="digest_8c.html#a25aacde6b8871bae274a6b54552a6a89">Curl_auth_digest_get_pair</a>(chlg, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, &amp;chlg)) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;nonce&quot;</span>)) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;stale&quot;</span>)) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;true&quot;</span>)) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;stale = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc = 1; <span class="comment">/* we make a new nonce now */</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;realm&quot;</span>)) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm)</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;opaque&quot;</span>)) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;qop&quot;</span>)) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordtype">char</span> *tok_buf = NULL;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">/* Tokenize the list and choose auth if possible, use a temporary</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">           clone of the buffer since strtok_r() ruins it */</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        tmp = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        token = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(tmp, <span class="stringliteral">&quot;,&quot;</span>, &amp;tok_buf);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">while</span>(token != NULL) {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(token, <a class="code" href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">DIGEST_QOP_VALUE_STRING_AUTH</a>)) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            foundAuth = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(token, <a class="code" href="digest_8c.html#ac027f2b51154f12f020fb7f8efd14f91">DIGEST_QOP_VALUE_STRING_AUTH_INT</a>)) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            foundAuthInt = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          token = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(NULL, <span class="stringliteral">&quot;,&quot;</span>, &amp;tok_buf);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(tmp);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">/* Select only auth or auth-int. Otherwise, ignore */</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span>(foundAuth) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">DIGEST_QOP_VALUE_STRING_AUTH</a>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(foundAuthInt) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="digest_8c.html#ac027f2b51154f12f020fb7f8efd14f91">DIGEST_QOP_VALUE_STRING_AUTH_INT</a>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;algorithm&quot;</span>)) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;MD5-sess&quot;</span>))</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4e7dce0111f47cfd0d9177b0f92f23a2">CURLDIGESTALGO_MD5SESS</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;MD5&quot;</span>))</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3add821c06d3087e8b217cebe85bb6d156">CURLDIGESTALGO_MD5</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;SHA-256&quot;</span>))</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3ab6cc07af0974fa505dc76e7e2e8091b9">CURLDIGESTALGO_SHA256</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;SHA-256-SESS&quot;</span>))</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a731181d516baf3a0e00959e10f8c8a34">CURLDIGESTALGO_SHA256SESS</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;SHA-512-256&quot;</span>))</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3aea201eb7ad6e38eb4eb070c526062f3c">CURLDIGESTALGO_SHA512_256</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;SHA-512-256-SESS&quot;</span>))</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4739d334091d63bd794112c57fa6a237">CURLDIGESTALGO_SHA512_256SESS</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="stringliteral">&quot;userhash&quot;</span>)) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, <span class="stringliteral">&quot;true&quot;</span>)) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">/* Unknown specifier, ignore it! */</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">/* We&#39;re done here */</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">/* Pass all additional spaces here */</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">while</span>(*chlg &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*chlg))</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      chlg++;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">/* Allow the list to be comma-separated */</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;,&#39;</span> == *chlg)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      chlg++;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">/* We had a nonce since before, and we got another one now without</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">     &#39;stale=true&#39;. This means we provided bad credentials in the previous</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">     request */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span>(before &amp;&amp; !<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;stale)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">/* We got this header without a nonce, that&#39;s a bad Digest line! */</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> * _Curl_auth_create_digest_http_message()</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> * This is used to generate a HTTP DIGEST response message ready for sending</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> * to the recipient.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> * data    [in]     - The session handle.</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> * userp   [in]     - The user name.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> * passwdp [in]     - The user&#39;s password.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment"> * request [in]     - The HTTP request.</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"> * uripath [in]     - The path of the HTTP uri.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"> * digest  [in/out] - The digest data struct being used and modified.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"> * outptr  [in/out] - The address where a pointer to newly allocated memory</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"> *                    holding the result will be stored upon completion.</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment"> * outlen  [out]    - The length of the output message.</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"> * Returns CURLE_OK on success.</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> _Curl_auth_create_digest_http_message(</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                  <span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *userp,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *passwdp,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *request,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *uripath,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                  <span class="keyword">struct</span> <a class="code" href="structdigestdata.html">digestdata</a> *<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                  <span class="keywordtype">char</span> **outptr, <span class="keywordtype">size_t</span> *outlen,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                  <span class="keywordtype">void</span> (*convert_to_ascii)(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *),</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                  <span class="keywordtype">void</span> (*hash)(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *))</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hashbuf[32]; <span class="comment">/* 32 bytes/256 bits */</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> request_digest[65];</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *hashthis;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ha1[65];    <span class="comment">/* 64 digits and 1 zero byte */</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ha2[65];    <span class="comment">/* 64 digits and 1 zero byte */</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordtype">char</span> userh[65];</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">char</span> *cnonce = NULL;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">size_t</span> cnonce_sz = 0;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">char</span> *userp_quoted;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">char</span> *response = NULL;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordtype">char</span> *tmp = NULL;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc = 1;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">char</span> cnoncebuf[33];</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="rand_8c.html#ae4bd86089b91201bafb73ad067d81f79">Curl_rand_hex</a>(<a class="code" href="structdata.html">data</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)cnoncebuf,</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                           <span class="keyword">sizeof</span>(cnoncebuf));</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>, cnoncebuf, strlen(cnoncebuf),</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                &amp;cnonce, &amp;cnonce_sz);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce = cnonce;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    hashthis = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s&quot;</span>, userp, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span>(!hashthis)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a>(<a class="code" href="structdata.html">data</a>, hashthis);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    hash(hashbuf, hashthis);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(hashthis);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    convert_to_ascii(hashbuf, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)userh);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">    If the algorithm is &quot;MD5&quot; or unspecified (which then defaults to MD5):</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">      A1 = unq(username-value) &quot;:&quot; unq(realm-value) &quot;:&quot; passwd</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">    If the algorithm is &quot;MD5-sess&quot; then:</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">      A1 = H(unq(username-value) &quot;:&quot; unq(realm-value) &quot;:&quot; passwd) &quot;:&quot;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">           unq(nonce-value) &quot;:&quot; unq(cnonce-value)</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  hashthis = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s:%s&quot;</span>, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash ? userh : userp,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                    <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm, passwdp);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span>(!hashthis)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <a class="code" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a>(<a class="code" href="structdata.html">data</a>, hashthis); <span class="comment">/* convert on non-ASCII machines */</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  hash(hashbuf, hashthis);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(hashthis);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  convert_to_ascii(hashbuf, ha1);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo == <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4e7dce0111f47cfd0d9177b0f92f23a2">CURLDIGESTALGO_MD5SESS</a> ||</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;     <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo == <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a731181d516baf3a0e00959e10f8c8a34">CURLDIGESTALGO_SHA256SESS</a> ||</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;     <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo == <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4739d334091d63bd794112c57fa6a237">CURLDIGESTALGO_SHA512_256SESS</a>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">/* nonce and cnonce are OUTSIDE the hash */</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    tmp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s:%s&quot;</span>, ha1, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a>(<a class="code" href="structdata.html">data</a>, tmp); <span class="comment">/* Convert on non-ASCII machines */</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    hash(hashbuf, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) tmp);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(tmp);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    convert_to_ascii(hashbuf, ha1);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">    If the &quot;qop&quot; directive&#39;s value is &quot;auth&quot; or is unspecified, then A2 is:</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">      A2 = Method &quot;:&quot; digest-uri-value</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">    If the &quot;qop&quot; value is &quot;auth-int&quot;, then A2 is:</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">      A2 = Method &quot;:&quot; digest-uri-value &quot;:&quot; H(entity-body)</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">    (The &quot;Method&quot; value is the HTTP request method as specified in section</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">    5.1.1 of RFC 2616)</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  hashthis = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s&quot;</span>, request, uripath);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">if</span>(!hashthis)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop, <span class="stringliteral">&quot;auth-int&quot;</span>)) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">/* We don&#39;t support auth-int for PUT or POST at the moment.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">       TODO: replace hash of empty string with entity-body for PUT/POST */</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">char</span> hashed[65];</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *hashthis2;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    hash(hashbuf, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    convert_to_ascii(hashbuf, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)hashed);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    hashthis2 = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s&quot;</span>, hashthis, hashed);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(hashthis);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    hashthis = hashthis2;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">if</span>(!hashthis)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a>(<a class="code" href="structdata.html">data</a>, hashthis); <span class="comment">/* convert on non-ASCII machines */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  hash(hashbuf, hashthis);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(hashthis);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  convert_to_ascii(hashbuf, ha2);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    hashthis = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s:%08x:%s:%s:%s&quot;</span>,</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                        ha1,</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce,</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce,</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop,</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                        ha2);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    hashthis = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s:%s&quot;</span>,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                        ha1,</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                        <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce,</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                        ha2);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span>(!hashthis)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <a class="code" href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a>(<a class="code" href="structdata.html">data</a>, hashthis); <span class="comment">/* convert on non-ASCII machines */</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  hash(hashbuf, hashthis);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(hashthis);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  convert_to_ascii(hashbuf, request_digest);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">/* For test case 64 (snooped from a Mozilla 1.3a request)</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">     Authorization: Digest username=&quot;testuser&quot;, realm=&quot;testrealm&quot;, \</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">     nonce=&quot;1053604145&quot;, uri=&quot;/64&quot;, response=&quot;c55f7f30d83d774a3d2dcacf725abaca&quot;</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">     Digest parameters are all quoted strings.  Username which is provided by</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">     the user will need double quotes and backslashes within it escaped.  For</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">     the other fields, this shouldn&#39;t be an issue.  realm, nonce, and opaque</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">     are copied as is from the server, escapes and all.  cnonce is generated</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">     with web-safe characters.  uri is already percent encoded.  nc is 8 hex</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">     characters.  algorithm and qop with standard values only contain web-safe</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">     characters.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  userp_quoted = auth_digest_string_quoted(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash ? userh : userp);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span>(!userp_quoted)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop) {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    response = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;username=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                       <span class="stringliteral">&quot;realm=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                       <span class="stringliteral">&quot;nonce=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                       <span class="stringliteral">&quot;uri=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                       <span class="stringliteral">&quot;cnonce=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                       <span class="stringliteral">&quot;nc=%08x, &quot;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                       <span class="stringliteral">&quot;qop=%s, &quot;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                       <span class="stringliteral">&quot;response=\&quot;%s\&quot;&quot;</span>,</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                       userp_quoted,</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm,</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                       uripath,</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce,</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                       request_digest);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop, <span class="stringliteral">&quot;auth&quot;</span>))</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc++; <span class="comment">/* The nc (from RFC) has to be a 8 hex digit number 0</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">                       padded which tells to the server how many times you are</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">                       using the same nonce in the qop=auth mode */</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  }</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    response = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;username=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                       <span class="stringliteral">&quot;realm=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                       <span class="stringliteral">&quot;nonce=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                       <span class="stringliteral">&quot;uri=\&quot;%s\&quot;, &quot;</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                       <span class="stringliteral">&quot;response=\&quot;%s\&quot;&quot;</span>,</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                       userp_quoted,</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm,</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                       <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce,</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                       uripath,</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                       request_digest);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(userp_quoted);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">if</span>(!response)</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">/* Add the optional fields */</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">/* Append the opaque */</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    tmp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s, opaque=\&quot;%s\&quot;&quot;</span>, response, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(response);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    response = tmp;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm) {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">/* Append the algorithm */</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    tmp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s, algorithm=\&quot;%s\&quot;&quot;</span>, response, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(response);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    response = tmp;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash) {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">/* Append the userhash */</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    tmp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s, userhash=true&quot;</span>, response);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(response);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span>(!tmp)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    response = tmp;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">/* Return the output */</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  *outptr = response;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  *outlen = strlen(response);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"> * Curl_auth_create_digest_http_message()</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment"> * This is used to generate a HTTP DIGEST response message ready for sending</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"> * to the recipient.</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"> * data    [in]     - The session handle.</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"> * userp   [in]     - The user name.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"> * passwdp [in]     - The user&#39;s password.</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"> * request [in]     - The HTTP request.</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment"> * uripath [in]     - The path of the HTTP uri.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment"> * digest  [in/out] - The digest data struct being used and modified.</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment"> * outptr  [in/out] - The address where a pointer to newly allocated memory</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"> *                    holding the result will be stored upon completion.</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"> * outlen  [out]    - The length of the output message.</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment"> * Returns CURLE_OK on success.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00947"></a><span class="lineno"><a class="line" href="vauth_8h.html#a6077ccec26c4ac7f5b2702da38ae88cb">  947</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="digest_8c.html#aae44ae9b10072a5e5e03ab880c6166a4">Curl_auth_create_digest_http_message</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">char</span> *userp,</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">char</span> *passwdp,</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *request,</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *uripath,</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                              <span class="keyword">struct</span> <a class="code" href="structdigestdata.html">digestdata</a> *<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>,</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                              <span class="keywordtype">char</span> **outptr, <span class="keywordtype">size_t</span> *outlen)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;{</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo) {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3add821c06d3087e8b217cebe85bb6d156">CURLDIGESTALGO_MD5</a>:</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4e7dce0111f47cfd0d9177b0f92f23a2">CURLDIGESTALGO_MD5SESS</a>:</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">return</span> _Curl_auth_create_digest_http_message(<a class="code" href="structdata.html">data</a>, userp, passwdp,</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                                 request, uripath, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>,</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                                 outptr, outlen,</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                                 auth_digest_md5_to_ascii,</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                                 <a class="code" href="curl__md5_8h.html#ab65717da96161b7b74f56f1539de8211">Curl_md5it</a>);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3ab6cc07af0974fa505dc76e7e2e8091b9">CURLDIGESTALGO_SHA256</a>:</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a731181d516baf3a0e00959e10f8c8a34">CURLDIGESTALGO_SHA256SESS</a>:</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3aea201eb7ad6e38eb4eb070c526062f3c">CURLDIGESTALGO_SHA512_256</a>:</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4739d334091d63bd794112c57fa6a237">CURLDIGESTALGO_SHA512_256SESS</a>:</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">return</span> _Curl_auth_create_digest_http_message(<a class="code" href="structdata.html">data</a>, userp, passwdp,</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                                 request, uripath, <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>,</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                                 outptr, outlen,</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                                 auth_digest_sha256_to_ascii,</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                                 <a class="code" href="curl__sha256_8h.html#a296f29d09e6ca469b494db984301335e">Curl_sha256it</a>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;}</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"> * Curl_auth_digest_cleanup()</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment"> * This is used to clean up the digest specific data.</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"> * Parameters:</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"> * digest    [in/out] - The digest data struct being cleaned up.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="vauth_8h.html#ab946e5ba03560d08796ff44bb2cc332f">  989</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="digest_8c.html#ab946e5ba03560d08796ff44bb2cc332f">Curl_auth_digest_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="structdigestdata.html">digestdata</a> *<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;{</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nonce);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;cnonce);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;realm);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;opaque);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;qop);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algorithm);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;nc = 0;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;algo = <a class="code" href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3add821c06d3087e8b217cebe85bb6d156">CURLDIGESTALGO_MD5</a>; <span class="comment">/* default algorithm */</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;stale = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* default means normal, not stale */</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <a class="code" href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a>-&gt;userhash = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;}</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">/* !USE_WINDOWS_SSPI */</span><span class="preprocessor"></span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">/* CURL_DISABLE_CRYPTO_AUTH */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="anyauth_8d_html_a7eb9744e157c215b8e0de36856880ebf"><div class="ttname"><a href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response thus possibly inducing an extra network round trip.This is used instead of setting a specific authentication method</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3a4739d334091d63bd794112c57fa6a237"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4739d334091d63bd794112c57fa6a237">CURLDIGESTALGO_SHA512_256SESS</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00038">digest.h:38</a></div></div>
<div class="ttc" id="digest_8c_html_a8fc384d80f3ed86d4443b47b774d1aa6"><div class="ttname"><a href="digest_8c.html#a8fc384d80f3ed86d4443b47b774d1aa6">DIGEST_QOP_VALUE_AUTH_INT</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_AUTH_INT</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00053">digest.c:53</a></div></div>
<div class="ttc" id="digest_8c_html_a7e5aa38f5e63656db921e79e48dcb8d3"><div class="ttname"><a href="digest_8c.html#a7e5aa38f5e63656db921e79e48dcb8d3">CURL_OUTPUT_DIGEST_CONV</a></div><div class="ttdeci">#define CURL_OUTPUT_DIGEST_CONV(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00064">digest.c:64</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="digest_8c_html_a79dcad530582256beb6018259b0cebda"><div class="ttname"><a href="digest_8c.html#a79dcad530582256beb6018259b0cebda">DIGEST_QOP_VALUE_AUTH_CONF</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_AUTH_CONF</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00054">digest.c:54</a></div></div>
<div class="ttc" id="digest_8c_html_a2365b3e378c16273762865b31da09fe1"><div class="ttname"><a href="digest_8c.html#a2365b3e378c16273762865b31da09fe1">DIGEST_QOP_VALUE_AUTH</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00052">digest.c:52</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="curl__md5_8h_html_ab33a834fa1c1d7252ef0b956327256bd"><div class="ttname"><a href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a></div><div class="ttdeci">const MD5_params Curl_DIGEST_MD5[1]</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00497">md5.c:497</a></div></div>
<div class="ttc" id="base64_8c_html_a3b1d7d4873cc224ffb2ce6ff201bc2e6"><div class="ttname"><a href="base64_8c.html#a3b1d7d4873cc224ffb2ce6ff201bc2e6">Curl_base64_decode</a></div><div class="ttdeci">CURLcode Curl_base64_decode(const char *src, unsigned char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00099">base64.c:99</a></div></div>
<div class="ttc" id="strtok_8h_html"><div class="ttname"><a href="strtok_8h.html">strtok.h</a></div></div>
<div class="ttc" id="curl__md5_8h_html_aabf808dd50615b76e263194b075cfcf1"><div class="ttname"><a href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a></div><div class="ttdeci">int Curl_MD5_update(MD5_context *context, const unsigned char *data, unsigned int len)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00548">md5.c:548</a></div></div>
<div class="ttc" id="curl__hmac_8h_html"><div class="ttname"><a href="curl__hmac_8h.html">curl_hmac.h</a></div></div>
<div class="ttc" id="curl__md5_8h_html_a503e57db509e2231c8289f74e55ab597"><div class="ttname"><a href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a></div><div class="ttdeci">MD5_context * Curl_MD5_init(const MD5_params *md5params)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00524">md5.c:524</a></div></div>
<div class="ttc" id="digest_8h_html_a5283c45d571e13b34462343e4767bf43"><div class="ttname"><a href="digest_8h.html#a5283c45d571e13b34462343e4767bf43">DIGEST_MAX_CONTENT_LENGTH</a></div><div class="ttdeci">#define DIGEST_MAX_CONTENT_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00030">digest.h:30</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00459">curl.h:459</a></div></div>
<div class="ttc" id="base64_8c_html_a1208ff63d0b4ca9cead4a3cdefc033c2"><div class="ttname"><a href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a></div><div class="ttdeci">CURLcode Curl_base64_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00290">base64.c:290</a></div></div>
<div class="ttc" id="digest_8h_html"><div class="ttname"><a href="digest_8h.html">digest.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="struct_m_d5__context_html"><div class="ttname"><a href="struct_m_d5__context.html">MD5_context</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__md5_8h_source.html#l00044">curl_md5.h:44</a></div></div>
<div class="ttc" id="digest_8c_html_aaa9c66d82561cc995c2e3542898e19f9"><div class="ttname"><a href="digest_8c.html#aaa9c66d82561cc995c2e3542898e19f9">DIGEST_QOP_VALUE_STRING_AUTH</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_STRING_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00056">digest.c:56</a></div></div>
<div class="ttc" id="curl__sha256_8h_html_a296f29d09e6ca469b494db984301335e"><div class="ttname"><a href="curl__sha256_8h.html#a296f29d09e6ca469b494db984301335e">Curl_sha256it</a></div><div class="ttdeci">void Curl_sha256it(unsigned char *outbuffer, const unsigned char *input)</div><div class="ttdef"><b>Definition:</b> <a href="sha256_8c_source.html#l00258">sha256.c:258</a></div></div>
<div class="ttc" id="digest_8c_html_ac027f2b51154f12f020fb7f8efd14f91"><div class="ttname"><a href="digest_8c.html#ac027f2b51154f12f020fb7f8efd14f91">DIGEST_QOP_VALUE_STRING_AUTH_INT</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_STRING_AUTH_INT</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00057">digest.c:57</a></div></div>
<div class="ttc" id="anyauth_8d_html_abb47597ee2bb7666bbf0cd3a66e5e0f2"><div class="ttname"><a href="anyauth_8d.html#abb47597ee2bb7666bbf0cd3a66e5e0f2">digest</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response thus possibly inducing an extra network round trip.This is used instead of setting a specific authentication which you can do with digest</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="digest_8h_html_aadb8a3cab2395de348149b8a7811f5bb"><div class="ttname"><a href="digest_8h.html#aadb8a3cab2395de348149b8a7811f5bb">DIGEST_MAX_VALUE_LENGTH</a></div><div class="ttdeci">#define DIGEST_MAX_VALUE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00029">digest.h:29</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00533">curl.h:533</a></div></div>
<div class="ttc" id="rand_8h_html"><div class="ttname"><a href="rand_8h.html">rand.h</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="structdigestdata_html"><div class="ttname"><a href="structdigestdata.html">digestdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00273">urldata.h:273</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="digest_8c_html_aae44ae9b10072a5e5e03ab880c6166a4"><div class="ttname"><a href="digest_8c.html#aae44ae9b10072a5e5e03ab880c6166a4">Curl_auth_create_digest_http_message</a></div><div class="ttdeci">CURLcode Curl_auth_create_digest_http_message(struct Curl_easy *data, const char *userp, const char *passwdp, const unsigned char *request, const unsigned char *uripath, struct digestdata *digest, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00947">digest.c:947</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="vtls_8h_html"><div class="ttname"><a href="vtls_8h.html">vtls.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="digest_8c_html_a67dd964e58c6eb44e08b1d91d66c41ec"><div class="ttname"><a href="digest_8c.html#a67dd964e58c6eb44e08b1d91d66c41ec">Curl_auth_create_digest_md5_message</a></div><div class="ttdeci">CURLcode Curl_auth_create_digest_md5_message(struct Curl_easy *data, const char *chlg64, const char *userp, const char *passwdp, const char *service, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00353">digest.c:353</a></div></div>
<div class="ttc" id="unit1398_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00033">unit1398.c:33</a></div></div>
<div class="ttc" id="curl__sha256_8h_html"><div class="ttname"><a href="curl__sha256_8h.html">curl_sha256.h</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="curl__md5_8h_html"><div class="ttname"><a href="curl__md5_8h.html">curl_md5.h</a></div></div>
<div class="ttc" id="config_8d_html_a9fb4830d0cbef7d3cf48425ce59f580a"><div class="ttname"><a href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are n</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="rand_8c_html_ae4bd86089b91201bafb73ad067d81f79"><div class="ttname"><a href="rand_8c.html#ae4bd86089b91201bafb73ad067d81f79">Curl_rand_hex</a></div><div class="ttdeci">CURLcode Curl_rand_hex(struct Curl_easy *data, unsigned char *rnd, size_t num)</div><div class="ttdef"><b>Definition:</b> <a href="rand_8c_source.html#l00151">rand.c:151</a></div></div>
<div class="ttc" id="curl__md5_8h_html_ab65717da96161b7b74f56f1539de8211"><div class="ttname"><a href="curl__md5_8h.html#ab65717da96161b7b74f56f1539de8211">Curl_md5it</a></div><div class="ttdeci">void Curl_md5it(unsigned char *output, const unsigned char *input)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00515">md5.c:515</a></div></div>
<div class="ttc" id="digest_8c_html_afcaf5c8f5a42ea5832a4f344e5318a5d"><div class="ttname"><a href="digest_8c.html#afcaf5c8f5a42ea5832a4f344e5318a5d">Curl_auth_decode_digest_http_message</a></div><div class="ttdeci">CURLcode Curl_auth_decode_digest_http_message(const char *chlg, struct digestdata *digest)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00521">digest.c:521</a></div></div>
<div class="ttc" id="digest_8c_html_a75bcfc858ec12ca28e8b59a1ebc76c44"><div class="ttname"><a href="digest_8c.html#a75bcfc858ec12ca28e8b59a1ebc76c44">Curl_auth_is_digest_supported</a></div><div class="ttdeci">bool Curl_auth_is_digest_supported(void)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00329">digest.c:329</a></div></div>
<div class="ttc" id="curl__md5_8h_html_a23ad6a1d54ca2af94acfbf3ca2dac046"><div class="ttname"><a href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a></div><div class="ttdeci">int Curl_MD5_final(MD5_context *context, unsigned char *result)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00557">md5.c:557</a></div></div>
<div class="ttc" id="digest_8c_html_ab946e5ba03560d08796ff44bb2cc332f"><div class="ttname"><a href="digest_8c.html#ab946e5ba03560d08796ff44bb2cc332f">Curl_auth_digest_cleanup</a></div><div class="ttdeci">void Curl_auth_digest_cleanup(struct digestdata *digest)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00989">digest.c:989</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3aea201eb7ad6e38eb4eb070c526062f3c"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3aea201eb7ad6e38eb4eb070c526062f3c">CURLDIGESTALGO_SHA512_256</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00037">digest.h:37</a></div></div>
<div class="ttc" id="warnless_8c_html_a20955df32ae739bf660266410d9e6526"><div class="ttname"><a href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a></div><div class="ttdeci">unsigned int curlx_uztoui(size_t uznum)</div><div class="ttdef"><b>Definition:</b> <a href="warnless_8c_source.html#l00243">warnless.c:243</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="digest_8c_html_ab70ce97dda687dac30f1254909b76c40"><div class="ttname"><a href="digest_8c.html#ab70ce97dda687dac30f1254909b76c40">DIGEST_QOP_VALUE_STRING_AUTH_CONF</a></div><div class="ttdeci">#define DIGEST_QOP_VALUE_STRING_AUTH_CONF</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00058">digest.c:58</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3a4e7dce0111f47cfd0d9177b0f92f23a2"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a4e7dce0111f47cfd0d9177b0f92f23a2">CURLDIGESTALGO_MD5SESS</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00034">digest.h:34</a></div></div>
<div class="ttc" id="vauth_8c_html_a161d48bc8137a3699d548bc1aa9237a0"><div class="ttname"><a href="vauth_8c.html#a161d48bc8137a3699d548bc1aa9237a0">Curl_auth_build_spn</a></div><div class="ttdeci">char * Curl_auth_build_spn(const char *service, const char *host, const char *realm)</div><div class="ttdef"><b>Definition:</b> <a href="vauth_8c_source.html#l00053">vauth.c:53</a></div></div>
<div class="ttc" id="non-ascii_8h_html"><div class="ttname"><a href="non-ascii_8h.html">non-ascii.h</a></div></div>
<div class="ttc" id="strtok_8h_html_abff4e21c5a2026f9982e88f1e686e63a"><div class="ttname"><a href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a></div><div class="ttdeci">#define strtok_r</div><div class="ttdef"><b>Definition:</b> <a href="strtok_8h_source.html#l00029">strtok.h:29</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3a731181d516baf3a0e00959e10f8c8a34"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3a731181d516baf3a0e00959e10f8c8a34">CURLDIGESTALGO_SHA256SESS</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00036">digest.h:36</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="header_8d_html_aa3b968e072109a68f98fd988ad6639af"><div class="ttname"><a href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header content</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="curl__md5_8h_html_ae1ccf1a4af3f69b0f73113109de28a90"><div class="ttname"><a href="curl__md5_8h.html#ae1ccf1a4af3f69b0f73113109de28a90">MD5_DIGEST_LEN</a></div><div class="ttdeci">#define MD5_DIGEST_LEN</div><div class="ttdef"><b>Definition:</b> <a href="curl__md5_8h_source.html#l00028">curl_md5.h:28</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3add821c06d3087e8b217cebe85bb6d156"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3add821c06d3087e8b217cebe85bb6d156">CURLDIGESTALGO_MD5</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00033">digest.h:33</a></div></div>
<div class="ttc" id="warnless_8h_html"><div class="ttname"><a href="warnless_8h.html">warnless.h</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="digest_8c_html_a25aacde6b8871bae274a6b54552a6a89"><div class="ttname"><a href="digest_8c.html#a25aacde6b8871bae274a6b54552a6a89">Curl_auth_digest_get_pair</a></div><div class="ttdeci">bool Curl_auth_digest_get_pair(const char *str, char *value, char *content, const char **endptr)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00072">digest.c:72</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="vauth_8h_html"><div class="ttname"><a href="vauth_8h.html">vauth.h</a></div></div>
<div class="ttc" id="unit1602_8c_html_a35af0be900467fedbb610bd6ea65ed78"><div class="ttname"><a href="unit1602_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a></div><div class="ttdeci">int key</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00056">unit1602.c:56</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="fail-early_8d_html_a188ba6f263db5df5a64e1cc11fb0c098"><div class="ttname"><a href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply which causes transfers to fail due to the server s HTTP status code.You can combine the two options</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="digest_8h_html_af3520ff6d43011872bab77edd27d4de3ab6cc07af0974fa505dc76e7e2e8091b9"><div class="ttname"><a href="digest_8h.html#af3520ff6d43011872bab77edd27d4de3ab6cc07af0974fa505dc76e7e2e8091b9">CURLDIGESTALGO_SHA256</a></div><div class="ttdef"><b>Definition:</b> <a href="digest_8h_source.html#l00035">digest.h:35</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="dir_5c799d76fd776f79457fc0be955adce4.html">vauth</a></li><li class="navelem"><a class="el" href="digest_8c.html">digest.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
