<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/cookie.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cookie_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">cookie.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cookie_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/***</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">RECEIVING COOKIE INFORMATION</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">============================</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">struct CookieInfo *Curl_cookie_init(struct Curl_easy *data,</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">                    const char *file, struct CookieInfo *inc, bool newsession);</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">        Inits a cookie struct to store data in a local file. This is always</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">        called before any cookies are set.</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">struct Cookie *Curl_cookie_add(struct Curl_easy *data,</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">                 struct CookieInfo *c, bool httpheader, char *lineptr,</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">                 const char *domain, const char *path);</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">        The &#39;lineptr&#39; parameter is a full &quot;Set-cookie:&quot; line as</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">        received from a server.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">        The function need to replace previously stored lines that this new</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">        line supersedes.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">        It may remove lines that are expired.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">        It should return an indication of success/error.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">SENDING COOKIE INFORMATION</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">==========================</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">struct Cookies *Curl_cookie_getlist(struct CookieInfo *cookie,</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">                                    char *host, char *path, bool secure);</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">        For a given host and path, return a linked list of cookies that</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">        the client should send to the server if used now. The secure</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">        boolean informs the cookie if a secure connection is achieved or</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">        not.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">        It shall only return cookies that haven&#39;t expired.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">Example set of cookies:</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    Set-cookie: PRODUCTINFO=webxpress; domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    Set-cookie: PERSONALIZE=none;expires=Monday, 13-Jun-1988 03:04:55 GMT;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    domain=.fidelity.com; path=/ftgw; secure</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    Set-cookie: FidHist=none;expires=Monday, 13-Jun-1988 03:04:55 GMT;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">    domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    Set-cookie: FidOrder=none;expires=Monday, 13-Jun-1988 03:04:55 GMT;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">    domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">    Set-cookie: DisPend=none;expires=Monday, 13-Jun-1988 03:04:55 GMT;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    Set-cookie: FidDis=none;expires=Monday, 13-Jun-1988 03:04:55 GMT;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">    domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">    Set-cookie:</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">    Session_Key@6791a9e0-901a-11d0-a1c8-9b012c88aa77=none;expires=Monday,</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">    13-Jun-1988 03:04:55 GMT; domain=.fidelity.com; path=/; secure</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">****/</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_HTTP) &amp;&amp; !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cookie_8h.html">cookie.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psl_8h.html">psl.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtok_8h.html">strtok.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slist_8h.html">slist.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="share_8h.html">share.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtoofft_8h.html">strtoofft.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memrchr_8h.html">curl_memrchr.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="inet__pton_8h.html">inet_pton.h</a>&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> freecookie(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *co)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a5aefd47068aac7d89411375831d7fda3">version</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> tailmatch(<span class="keyword">const</span> <span class="keywordtype">char</span> *cooke_domain, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structhostname.html">hostname</a>)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">size_t</span> cookie_domain_len = strlen(cooke_domain);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">size_t</span> hostname_len = strlen(<a class="code" href="structhostname.html">hostname</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span>(hostname_len &lt; cookie_domain_len)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(cooke_domain, <a class="code" href="structhostname.html">hostname</a> + hostname_len-cookie_domain_len))</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">/* A lead char of cookie_domain is not &#39;.&#39;.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">     RFC6265 4.1.2.3. The Domain Attribute says:</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">       For example, if the value of the Domain attribute is</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">       &quot;example.com&quot;, the user agent will include the cookie in the Cookie</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">       header when making HTTP requests to example.com, www.example.com, and</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">       www.corp.example.com.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">if</span>(hostname_len == cookie_domain_len)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span>(<span class="charliteral">&#39;.&#39;</span> == *(<a class="code" href="structhostname.html">hostname</a> + hostname_len - cookie_domain_len - 1))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * Return true if the given string is an IP(v4|v6) address.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> isip(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">struct </span>in_addr addr;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#ifdef ENABLE_IPV6</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">struct </span>in6_addr addr6;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="inet__pton_8c.html#a8d1e996e3cc6d70e844c787b1a8614cc">Curl_inet_pton</a>(AF_INET, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, &amp;addr)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;#ifdef <a class="code" href="config-os400_8h.html#a7a1524cf833450776ffc81c38a78c370">ENABLE_IPV6</a></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     || <a class="code" href="inet__pton_8c.html#a8d1e996e3cc6d70e844c787b1a8614cc">Curl_inet_pton</a>(AF_INET6, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, &amp;addr6)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;#endif</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    ) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">/* domain name given as IP address */</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * matching cookie path and url path</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * RFC6265 5.1.4 Paths and Path-Match</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> pathmatch(<span class="keyword">const</span> <span class="keywordtype">char</span> *cookie_path, <span class="keyword">const</span> <span class="keywordtype">char</span> *request_uri)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">size_t</span> cookie_path_len;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">size_t</span> uri_path_len;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">char</span> *uri_path = NULL;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">char</span> *pos;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">bool</span> ret = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">/* cookie_path must not have last &#39;/&#39; separator. ex: /sample */</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  cookie_path_len = strlen(cookie_path);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span>(1 == cookie_path_len) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">/* cookie_path must be &#39;/&#39; */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  uri_path = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(request_uri);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span>(!uri_path)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  pos = strchr(uri_path, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span>(pos)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    *pos = 0x0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">/* #-fragments are already cut off! */</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span>(0 == strlen(uri_path) || uri_path[0] != <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(uri_path);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    uri_path = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span>(!uri_path)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* here, RFC6265 5.1.4 says</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">     4. Output the characters of the uri-path from the first character up</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">        to, but not including, the right-most %x2F (&quot;/&quot;).</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">     but URL path /hoge?fuga=xxx means /hoge/index.cgi?fuga=xxx in some site</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">     without redirect.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">     Ignore this algorithm because /hoge is uri path for this case</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">     (uri path is not /).</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  uri_path_len = strlen(uri_path);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span>(uri_path_len &lt; cookie_path_len) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    ret = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">goto</span> pathmatched;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">/* not using checkprefix() because matching should be case-sensitive */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span>(strncmp(cookie_path, uri_path, cookie_path_len)) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    ret = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">goto</span> pathmatched;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">/* The cookie-path and the uri-path are identical. */</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span>(cookie_path_len == uri_path_len) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    ret = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">goto</span> pathmatched;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">/* here, cookie_path_len &lt; url_path_len */</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(uri_path[cookie_path_len] == <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    ret = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">goto</span> pathmatched;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  ret = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;pathmatched:</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(uri_path);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"> * Return the top-level domain, for optimal hashing.</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *get_top_domain(<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="keywordtype">size_t</span> *outlen)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *first = NULL, *<a class="code" href="unit1308_8c.html#a2f29226077aaea62db6864d9b291eadc">last</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="unit1308_8c.html#a2f29226077aaea62db6864d9b291eadc">last</a> = <a class="code" href="curl__memrchr_8h.html#a06109590a27d5e674ba630320d5a9d0b">memrchr</a>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="charliteral">&#39;.&#39;</span>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1308_8c.html#a2f29226077aaea62db6864d9b291eadc">last</a>) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    first = <a class="code" href="curl__memrchr_8h.html#a06109590a27d5e674ba630320d5a9d0b">memrchr</a>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="charliteral">&#39;.&#39;</span>, (<a class="code" href="unit1308_8c.html#a2f29226077aaea62db6864d9b291eadc">last</a> - <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>));</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span>(first)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> -= (++first - <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span>(outlen)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    *outlen = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">return</span> first? first: <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> * A case-insensitive hash for the cookie domains.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> cookie_hash_domain(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;{</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *end = <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> + <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">size_t</span> h = 5381;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">while</span>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> &lt; end) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    h += h &lt;&lt; 5;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    h ^= <a class="code" href="strcase_8c.html#a555bbf5fd8dc146336474a2bb7959524">Curl_raw_toupper</a>(*<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>++);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">return</span> (h % <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> * Hash this domain.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> cookiehash(<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *top;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> || isip(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>))</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  top = get_top_domain(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> cookie_hash_domain(top, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> * cookie path sanitize</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *sanitize_cookie_path(<span class="keyword">const</span> <span class="keywordtype">char</span> *cookie_path)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordtype">char</span> *new_path = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(cookie_path);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span>(!new_path)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">/* some stupid site sends path attribute with &#39;&quot;&#39;. */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen(new_path);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">if</span>(new_path[0] == <span class="charliteral">&#39;\&quot;&#39;</span>) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    memmove((<span class="keywordtype">void</span> *)new_path, (<span class="keyword">const</span> <span class="keywordtype">void</span> *)(new_path + 1), <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>--;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &amp;&amp; (new_path[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 1] == <span class="charliteral">&#39;\&quot;&#39;</span>)) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    new_path[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 1] = 0x0;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>--;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">/* RFC6265 5.2.4 The Path Attribute */</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span>(new_path[0] != <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">/* Let cookie-path be the default-path. */</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(new_path);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    new_path = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> new_path;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">/* convert /hoge/ to /hoge */</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &amp;&amp; new_path[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 1] == <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    new_path[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 1] = 0x0;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">return</span> new_path;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> * Load cookies from all given cookie files (CURLOPT_COOKIEFILE).</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * NOTE: OOM or cookie parsing failures are ignored.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="cookie_8h.html#ae44350d9d4dd49e91e604b70c3573809">  337</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#ae44350d9d4dd49e91e604b70c3573809">Curl_cookie_loadfiles</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *list = <a class="code" href="structdata.html">data</a>-&gt;change.cookielist;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span>(list) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">while</span>(list) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keyword">struct </span><a class="code" href="struct_cookie_info.html">CookieInfo</a> *newcookies = <a class="code" href="cookie_8c.html#a04615fb8c8bc6f00530d43104cdd2ff1">Curl_cookie_init</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                        list-&gt;<a class="code" href="structcurl__slist.html#a5fe4d926491a1c9b8b9a73c40505f601">data</a>,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                        <a class="code" href="structdata.html">data</a>-&gt;cookies,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                        <a class="code" href="structdata.html">data</a>-&gt;set.cookiesession);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span>(!newcookies)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">/* Failure may be due to OOM or a bad cookie; both are ignored</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">         * but only the first should be</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;ignoring failed cookie_init for %s\n&quot;</span>, list-&gt;<a class="code" href="structcurl__slist.html#a5fe4d926491a1c9b8b9a73c40505f601">data</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;cookies = newcookies;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      list = list-&gt;<a class="code" href="structcurl__slist.html#a56fcfc41d89a47865933c310d316a108">next</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(<a class="code" href="structdata.html">data</a>-&gt;change.cookielist); <span class="comment">/* clean up list */</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;change.cookielist = NULL; <span class="comment">/* don&#39;t do this again! */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> * strstore() makes a strdup() on the &#39;newstr&#39; and if &#39;*str&#39; is non-NULL</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> * that will be freed before the allocated string is stored there.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> * It is meant to easily replace strdup()</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> strstore(<span class="keywordtype">char</span> **<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *newstr)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(newstr);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> * remove_expired() removes expired cookies.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> remove_expired(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *co, *nx;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> <a class="code" href="unit1399_8c.html#acf1e931ffa73126ce876102dc2186895">now</a> = (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)<a class="code" href="retry-max-time_8d.html#a612021c6b1f447b49053406818ef4ee6">time</a>(NULL);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *pv = NULL;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    co = <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">while</span>(co) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      nx = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> &lt; <a class="code" href="unit1399_8c.html#acf1e931ffa73126ce876102dc2186895">now</a>) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">if</span>(!pv) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          pv-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;numcookies--;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        freecookie(co);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        pv = co;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      co = nx;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/* Make sure domain contains a dot or is localhost. */</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> bad_domain(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">return</span> !strchr(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="charliteral">&#39;.&#39;</span>) &amp;&amp; !<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="stringliteral">&quot;localhost&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">/****************************************************************************</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> * Curl_cookie_add()</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> * Add a single cookie line to the cookie keeping object.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> * Be aware that sometimes we get an IP-only host name, and that might also be</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * a numerical IPv6 address.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * Returns NULL on out of memory or invalid cookie. This is suboptimal,</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> * as they should be treated separately.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *</div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="cookie_8h.html#acd39c8d467a315d8bb2f689c5bdc5e74">  426</a></span>&#160;<a class="code" href="cookie_8c.html#a6e800bf3fd9b6cea2a826408bcdf235c">Curl_cookie_add</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="comment">/* The &#39;data&#39; pointer here may be NULL at times, and thus</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">                   must only be used very carefully for things that can deal</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">                   with data being NULL. Such as infof() and similar */</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *c,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordtype">bool</span> httpheader, <span class="comment">/* TRUE if HTTP header-style line */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordtype">bool</span> noexpire, <span class="comment">/* if TRUE, skip remove_expired() */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keywordtype">char</span> *lineptr,   <span class="comment">/* first character of the line */</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, <span class="comment">/* default domain */</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>)   <span class="comment">/* full path used when this cookie is set,</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">                                       used to get default path for the cookie</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">                                       unless set */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *clist;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *co;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *lastc = NULL;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  time_t <a class="code" href="unit1399_8c.html#acf1e931ffa73126ce876102dc2186895">now</a> = <a class="code" href="retry-max-time_8d.html#a612021c6b1f447b49053406818ef4ee6">time</a>(NULL);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">bool</span> replace_old = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">bool</span> badcookie = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* cookies are good by default. mmmmm yummy */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">size_t</span> myhash;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#ifdef CURL_DISABLE_VERBOSE_STRINGS</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">/* First, alloc and init a new struct for it */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  co = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a>));</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">if</span>(!co)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> NULL; <span class="comment">/* bail out if we&#39;re this low on memory */</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span>(httpheader) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">/* This line was read off a HTTP-header */</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>[<a class="code" href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a>];</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">char</span> what[<a class="code" href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a>];</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *semiptr;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">size_t</span> linelength = strlen(lineptr);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span>(linelength &gt; <a class="code" href="cookie_8h.html#aaf3dd2898e41fffcacc10853c75e7886">MAX_COOKIE_LINE</a>) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">/* discard overly long lines at once */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    semiptr = strchr(lineptr, <span class="charliteral">&#39;;&#39;</span>); <span class="comment">/* first, find a semicolon */</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">while</span>(*lineptr &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*lineptr))</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      lineptr++;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = lineptr;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">/* we have a &lt;what&gt;=&lt;this&gt; pair or a stand-alone word here */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>[0] = what[0] = 0; <span class="comment">/* init the buffers */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">if</span>(1 &lt;= sscanf(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;%&quot;</span> <a class="code" href="cookie_8h.html#a6bde8ad7da0c7288674ed63fd764ed92">MAX_NAME_TXT</a> <span class="stringliteral">&quot;[^;\r\n=] =%&quot;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                     <a class="code" href="cookie_8h.html#a6bde8ad7da0c7288674ed63fd764ed92">MAX_NAME_TXT</a> <span class="stringliteral">&quot;[^;\r\n]&quot;</span>,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                     <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, what)) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">/* Use strstore() below to properly deal with received cookie</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">           headers that have the same string property set more than once,</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">           and then we use the last one. */</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *whatptr;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordtype">bool</span> done = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordtype">bool</span> sep;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen(what);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordtype">size_t</span> nlen = strlen(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *endofn = &amp;<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>[ nlen ];</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span>(nlen &gt;= (<a class="code" href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a>-1) || <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt;= (<a class="code" href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a>-1) ||</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;           ((nlen + <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) &gt; <a class="code" href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a>)) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="comment">/* too long individual name or contents, or too long combination of</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">             name + contents. Chrome and Firefox support 4095 or 4096 bytes</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">             combo. */</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          freecookie(co);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;oversized cookie dropped, name/val %zu + %zu bytes\n&quot;</span>,</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                nlen, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">/* name ends with a &#39;=&#39; ? */</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        sep = (*endofn == <span class="charliteral">&#39;=&#39;</span>)?<a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span>(nlen) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          endofn--; <span class="comment">/* move to the last character */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*endofn)) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="comment">/* skip trailing spaces in name */</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">while</span>(*endofn &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*endofn) &amp;&amp; nlen) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              endofn--;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              nlen--;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>[nlen] = 0; <span class="comment">/* new end of name */</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">/* Strip off trailing whitespace from the &#39;what&#39; */</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">while</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(what[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>-1])) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          what[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>-1] = 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>--;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">/* Skip leading whitespace from the &#39;what&#39; */</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        whatptr = what;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">while</span>(*whatptr &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*whatptr))</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          whatptr++;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          <span class="comment">/* The very first name/value pair is the actual cookie name */</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <span class="keywordflow">if</span>(!sep) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">/* Bad name/value pair. */</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(whatptr);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a> || !co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>) {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="comment">/* this was a &quot;&lt;name&gt;=&quot; with no content, and we must allow</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">             &#39;secure&#39; and &#39;httponly&#39; specified this weirdly */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;secure&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>))</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            co-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;httponly&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>))</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            co-&gt;<a class="code" href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">httponly</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(sep)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="comment">/* there was a &#39;=&#39; so we&#39;re not done parsing this field */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            done = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">if</span>(done)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          ;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;path&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>)) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          strstore(&amp;co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>, whatptr);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* out of memory bad */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>); <span class="comment">/* if this is set again */</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> = sanitize_cookie_path(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* out of memory bad */</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;domain&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>)) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          <span class="keywordtype">bool</span> is_ip;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <span class="comment">/* Now, we make sure that our host is within the given domain,</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">             or the given domain is not valid and thus cannot be set. */</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="keywordflow">if</span>(<span class="charliteral">&#39;.&#39;</span> == whatptr[0])</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            whatptr++; <span class="comment">/* ignore preceding dot */</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#ifndef USE_LIBPSL</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          <span class="comment">/*</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">           * Without PSL we don&#39;t know when the incoming cookie is set on a</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">           * TLD or otherwise &quot;protected&quot; suffix. To reduce risk, we require a</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">           * dot OR the exact host name being &quot;localhost&quot;.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          <span class="keywordflow">if</span>(bad_domain(whatptr))</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> = <span class="stringliteral">&quot;:&quot;</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          is_ip = isip(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> ? <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> : whatptr);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;             || (is_ip &amp;&amp; !strcmp(whatptr, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>))</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;             || (!is_ip &amp;&amp; <a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a>(whatptr, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>))) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            strstore(&amp;co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>, whatptr);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;              badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span>(!is_ip)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;              co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* we always do that if the domain name was</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">                                       given */</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">/* we did not get a tailmatch and then the attempted set domain</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">               is not a domain to which the current host belongs. Mark as</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">               bad. */</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;skipped cookie with bad tailmatch domain: %s\n&quot;</span>,</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                  whatptr);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;version&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>)) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          strstore(&amp;co-&gt;<a class="code" href="struct_cookie.html#a5aefd47068aac7d89411375831d7fda3">version</a>, whatptr);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a5aefd47068aac7d89411375831d7fda3">version</a>) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;max-age&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>)) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          <span class="comment">/* Defined in RFC2109:</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">             Optional.  The Max-Age attribute defines the lifetime of the</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">             cookie, in seconds.  The delta-seconds value is a decimal non-</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">             negative integer.  After delta-seconds seconds elapse, the</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">             client should discard the cookie.  A value of zero means the</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">             cookie should be discarded immediately.</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          strstore(&amp;co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>, whatptr);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;expires&quot;</span>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>)) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;          strstore(&amp;co-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>, whatptr);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">          else this is the second (or more) name we don&#39;t know</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">          about! */</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">/* this is an &quot;illegal&quot; &lt;what&gt;=&lt;this&gt; pair */</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">if</span>(!semiptr || !*semiptr) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">/* we already know there are no more cookies */</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        semiptr = NULL;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = semiptr + 1;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">while</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>))</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      semiptr = strchr(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="charliteral">&#39;;&#39;</span>); <span class="comment">/* now, find the next semicolon */</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span>(!semiptr &amp;&amp; *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">/* There are no more semicolons, but there&#39;s a final name=value pair</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">           coming up */</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        semiptr = strchr(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="charliteral">&#39;\0&#39;</span>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    } <span class="keywordflow">while</span>(semiptr);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437f">CURLofft</a> offt;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      offt = <a class="code" href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a>((*co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a> == <span class="charliteral">&#39;\&quot;&#39;</span>)?</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                             &amp;co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>[1]:&amp;co-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>[0], NULL, 10,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                             &amp;co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">if</span>(offt == <a class="code" href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121">CURL_OFFT_FLOW</a>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">/* overflow, used max value */</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = <a class="code" href="curl__setup_8h.html#a2e2dfd85567685413b23d71f2e545299">CURL_OFF_T_MAX</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!offt) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="comment">/* already expired */</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = 1;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="curl__setup_8h.html#a2e2dfd85567685413b23d71f2e545299">CURL_OFF_T_MAX</a> - now &lt; co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="comment">/* would overflow */</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = <a class="code" href="curl__setup_8h.html#a2e2dfd85567685413b23d71f2e545299">CURL_OFF_T_MAX</a>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> += <a class="code" href="unit1399_8c.html#acf1e931ffa73126ce876102dc2186895">now</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">/* Note that if the date couldn&#39;t get parsed for whatever reason,</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">         the cookie will be treated as a session cookie */</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = <a class="code" href="curl_8h.html#ad4dd80e15a6f20cdd628a7f222fcb8eb">curl_getdate</a>(co-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>, NULL);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="comment">/* Session cookies have expires set to 0 so if we get that back</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">         from the date parser let&#39;s add a second to make it a</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">         non-session cookie */</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> == 0)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = 1;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> &lt; 0)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = 0;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span>(!badcookie &amp;&amp; !co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">/* no domain was given in the header line, set the default */</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span>(!badcookie &amp;&amp; !co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> &amp;&amp; <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">/* No path was given in the header line, set the default.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">         Note that the passed-in path to this function MAY have a &#39;?&#39; and</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">         following part that MUST not be stored as part of the path. */</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordtype">char</span> *queryp = strchr(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="comment">/* queryp is where the interesting part of the path ends, so now we</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">         want to the find the last */</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordtype">char</span> *endslash;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">if</span>(!queryp)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        endslash = strrchr(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        endslash = <a class="code" href="curl__memrchr_8h.html#a06109590a27d5e674ba630320d5a9d0b">memrchr</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="charliteral">&#39;/&#39;</span>, (queryp - <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>));</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span>(endslash) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordtype">size_t</span> pathlen = (endslash-<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> + 1); <span class="comment">/* include end slash */</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(pathlen + 1); <span class="comment">/* one extra for the zero byte */</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, pathlen);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>[pathlen] = 0; <span class="comment">/* zero terminate */</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> = sanitize_cookie_path(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* out of memory bad */</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span>(badcookie || !co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="comment">/* we didn&#39;t get a cookie name or a bad one,</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">         this is an illegal line, bail out */</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      freecookie(co);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">/* This line is NOT a HTTP header style line, we do offer support for</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">       reading the odd netscape cookies-file format here */</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordtype">char</span> *firstptr;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">char</span> *tok_buf = NULL;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">/* IE introduced HTTP-only cookies to prevent XSS attacks. Cookies</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">       marked with httpOnly after the domain name are not accessible</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">       from javascripts, but since curl does not operate at javascript</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">       level, we include them anyway. In Firefox&#39;s cookie files, these</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">       lines are preceded with #HttpOnly_ and then everything is</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">       as usual, so we skip 10 characters of the line..</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span>(strncmp(lineptr, <span class="stringliteral">&quot;#HttpOnly_&quot;</span>, 10) == 0) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      lineptr += 10;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      co-&gt;<a class="code" href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">httponly</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span>(lineptr[0]==<span class="charliteral">&#39;#&#39;</span>) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">/* don&#39;t even try the comments */</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">/* strip off the possible end-of-line characters */</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = strchr(lineptr, <span class="charliteral">&#39;\r&#39;</span>);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = 0; <span class="comment">/* clear it */</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = strchr(lineptr, <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = 0; <span class="comment">/* clear it */</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    firstptr = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(lineptr, <span class="stringliteral">&quot;\t&quot;</span>, &amp;tok_buf); <span class="comment">/* tokenize it on the TAB */</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">/* Now loop through the fields and init the struct we already have</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">       allocated */</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = firstptr, <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a> = 0; <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; !badcookie;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(NULL, <span class="stringliteral">&quot;\t&quot;</span>, &amp;tok_buf), <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>++) {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>[0]==<span class="charliteral">&#39;.&#39;</span>) <span class="comment">/* skip preceding dots */</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">/* This field got its explanation on the 23rd of May 2001 by</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">           Andrs Garca:</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">           flag: A TRUE/FALSE value indicating if all machines within a given</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">           domain can access the variable. This value is set automatically by</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">           the browser, depending on the value you set for the domain.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">           As far as I can see, it is set to true when the cookie says</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">           .domain.com and to false when the domain is complete www.domain.com</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> = <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;TRUE&quot;</span>)?<a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">/* It turns out, that sometimes the file format allows the path</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">           field to remain not filled in, we try to detect this and work</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">           around it! Andrs Garca made us aware of this... */</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">if</span>(strcmp(<span class="stringliteral">&quot;TRUE&quot;</span>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) &amp;&amp; strcmp(<span class="stringliteral">&quot;FALSE&quot;</span>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          <span class="comment">/* only if the path doesn&#39;t look like a boolean option! */</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> = sanitize_cookie_path(co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;              badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* out of memory bad */</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">/* this doesn&#39;t look like a path, make one up! */</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>++; <span class="comment">/* add a field and fall down to secure */</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a> = <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;TRUE&quot;</span>)?<a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, NULL, 10, &amp;co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>))</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span>(6 == <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="comment">/* we got a cookie with blank contents, fix it */</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>++;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">if</span>(!badcookie &amp;&amp; (7 != <a class="code" href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">fields</a>))</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="comment">/* we did not find the sufficient number of fields */</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      badcookie = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span>(badcookie) {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      freecookie(co);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span>(!c-&gt;<a class="code" href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">running</a> &amp;&amp;    <span class="comment">/* read from a file */</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;     c-&gt;<a class="code" href="struct_cookie_info.html#ab9b49390f78086409b461d8f450f1c3f">newsession</a> &amp;&amp;  <span class="comment">/* clean session cookies */</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;     !co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>) {   <span class="comment">/* this is a session cookie since it doesn&#39;t expire! */</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    freecookie(co);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  co-&gt;<a class="code" href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">livecookie</a> = c-&gt;<a class="code" href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">running</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  co-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a> = ++c-&gt;<a class="code" href="struct_cookie_info.html#ac63339e524ca07309db2efca735d28ee">lastct</a>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">/* now, we have parsed the incoming line, we must now check if this</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">     supersedes an already existing cookie, which it may if the previous have</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">     the same domain and path as this */</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">/* at first, remove expired cookies */</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span>(!noexpire)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    remove_expired(c);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#ifdef USE_LIBPSL</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">/* Check if the domain is a Public Suffix and if yes, ignore the cookie. */</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> &amp;&amp; !isip(co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keyword">const</span> psl_ctx_t *psl = <a class="code" href="psl_8h.html#a829f724809cd062e49e38c1f138c7bc1">Curl_psl_use</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">int</span> acceptable;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span>(psl) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      acceptable = psl_is_cookie_domain_acceptable(psl, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <a class="code" href="psl_8h.html#af771f7c26f84a57fff4fe3851532293a">Curl_psl_release</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      acceptable = !bad_domain(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span>(!acceptable) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;cookie &#39;%s&#39; dropped, domain &#39;%s&#39; must not &quot;</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                  <span class="stringliteral">&quot;set cookies for &#39;%s&#39;\n&quot;</span>, co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>, <a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>, co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      freecookie(co);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  myhash = cookiehash(co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  clist = c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[myhash];</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  replace_old = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">while</span>(clist) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(clist-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>, co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>)) {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="comment">/* the names are identical */</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">if</span>(clist-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(clist-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>, co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) &amp;&amp;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          (clist-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> == co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a>))</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="comment">/* The domains are identical */</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          replace_old = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!clist-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> &amp;&amp; !co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        replace_old = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">if</span>(replace_old) {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">/* the domains were identical */</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span>(clist-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(clist-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>, co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>)) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            replace_old = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            replace_old = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!clist-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> &amp;&amp; !co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          replace_old = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          replace_old = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordflow">if</span>(replace_old &amp;&amp; !co-&gt;<a class="code" href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">livecookie</a> &amp;&amp; clist-&gt;<a class="code" href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">livecookie</a>) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">/* Both cookies matched fine, except that the already present</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">           cookie is &quot;live&quot;, which means it was set from a header, while</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">           the new one isn&#39;t &quot;live&quot; and thus only read from a file. We let</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">           live cookies stay alive */</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="comment">/* Free the newcomer and get out of here! */</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        freecookie(co);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keywordflow">if</span>(replace_old) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = clist-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>; <span class="comment">/* get the next-pointer first */</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="comment">/* when replacing, creationtime is kept from old */</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        co-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a> = clist-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a>;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment">/* then free all the old pointers */</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#a5aefd47068aac7d89411375831d7fda3">version</a>);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clist-&gt;<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        *clist = *co;  <span class="comment">/* then store all the new data */</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(co);   <span class="comment">/* free the newly alloced memory */</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        co = clist; <span class="comment">/* point to the previous struct instead */</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="comment">/* We have replaced a cookie, now skip the rest of the list but</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">           make sure the &#39;lastc&#39; pointer is properly set */</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          lastc = clist;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          clist = clist-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        } <span class="keywordflow">while</span>(clist);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    lastc = clist;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    clist = clist-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">if</span>(c-&gt;<a class="code" href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">running</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">/* Only show this when NOT reading the cookies from a file */</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;%s cookie %s=\&quot;%s\&quot; for domain %s, path %s, &quot;</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          <span class="stringliteral">&quot;expire %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;          replace_old?<span class="stringliteral">&quot;Replaced&quot;</span>:<span class="stringliteral">&quot;Added&quot;</span>, co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>, co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>,</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>, co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>, co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">if</span>(!replace_old) {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">/* then make the last item point on this new one */</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">if</span>(lastc)</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      lastc-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = co;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[myhash] = co;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    c-&gt;<a class="code" href="struct_cookie_info.html#af52d829cc8a1b073deca781e453a07df">numcookies</a>++; <span class="comment">/* one more cookie in the jar */</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">return</span> co;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;}</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"> * get_line() makes sure to only return complete whole lines that fit in &#39;len&#39;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment"> * bytes and end with a newline.</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *get_line(<span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">FILE</a> *<a class="code" href="structinput.html">input</a>)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;{</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordtype">bool</span> partial = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordflow">while</span>(1) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordtype">char</span> *b = fgets(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="structinput.html">input</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">if</span>(b) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordtype">size_t</span> rlen = strlen(b);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">if</span>(rlen &amp;&amp; (b[rlen-1] == <span class="charliteral">&#39;\n&#39;</span>)) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">if</span>(partial) {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          partial = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">return</span> b;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="comment">/* read a partial, discard the next piece that ends with newline */</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      partial = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"> * Curl_cookie_init()</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"> * Inits a cookie struct to read data from a local file. This is always</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"> * called before any cookies are set. File may be NULL.</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"> * If &#39;newsession&#39; is TRUE, discard all &quot;session cookies&quot; on read from file.</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"> * Returns NULL on out of memory. Invalid cookies are ignored.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01048"></a><span class="lineno"><a class="line" href="cookie_8h.html#a285afd30d6b16b23cea74752e6fec96a"> 1048</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_cookie_info.html">CookieInfo</a> *<a class="code" href="cookie_8c.html#a04615fb8c8bc6f00530d43104cdd2ff1">Curl_cookie_init</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>,</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                    <span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *inc,</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                    <span class="keywordtype">bool</span> <a class="code" href="struct_cookie_info.html#ab9b49390f78086409b461d8f450f1c3f">newsession</a>)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie_info.html">CookieInfo</a> *c;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <a class="code" href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">FILE</a> *fp = NULL;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">bool</span> fromfile = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a> = NULL;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordflow">if</span>(NULL == inc) {</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">/* we didn&#39;t get a struct, create one */</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    c = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a>));</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span>(!c)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">return</span> NULL; <span class="comment">/* failed to get memory */</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    c-&gt;<a class="code" href="struct_cookie_info.html#a9c7a72fbc10df79eb550870df245e2f1">filename</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>?<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>:<span class="stringliteral">&quot;none&quot;</span>); <span class="comment">/* copy the name just in case */</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span>(!c-&gt;<a class="code" href="struct_cookie_info.html#a9c7a72fbc10df79eb550870df245e2f1">filename</a>)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>; <span class="comment">/* failed to get memory */</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">/* we got an already existing one, use that */</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    c = inc;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  }</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  c-&gt;<a class="code" href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">running</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* this is not running, this is init */</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> &amp;&amp; !strcmp(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>, <span class="stringliteral">&quot;-&quot;</span>)) {</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    fp = <a class="code" href="anyauth_8d.html#a1d461998550d329666033ab94bf67c6a">stdin</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    fromfile = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> &amp;&amp; !*<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>) {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">/* points to a &quot;&quot; string */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    fp = NULL;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    fp = <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>?fopen(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>, <a class="code" href="curl__setup_8h.html#ac5301ec6857f338762bb9334473131ce">FOPEN_READTEXT</a>):NULL;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  c-&gt;<a class="code" href="struct_cookie_info.html#ab9b49390f78086409b461d8f450f1c3f">newsession</a> = <a class="code" href="struct_cookie_info.html#ab9b49390f78086409b461d8f450f1c3f">newsession</a>; <span class="comment">/* new session? */</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordflow">if</span>(fp) {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordtype">char</span> *lineptr;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordtype">bool</span> headerline;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="cookie_8h.html#aaf3dd2898e41fffcacc10853c75e7886">MAX_COOKIE_LINE</a>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">while</span>(get_line(<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>, <a class="code" href="cookie_8h.html#aaf3dd2898e41fffcacc10853c75e7886">MAX_COOKIE_LINE</a>, fp)) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Set-Cookie:&quot;</span>, <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>)) {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="comment">/* This is a cookie line, get it! */</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        lineptr = &amp;<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>[11];</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        headerline = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        lineptr = <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        headerline = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keywordflow">while</span>(*lineptr &amp;&amp; <a class="code" href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a>(*lineptr))</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        lineptr++;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="cookie_8c.html#a6e800bf3fd9b6cea2a826408bcdf235c">Curl_cookie_add</a>(<a class="code" href="structdata.html">data</a>, c, headerline, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, lineptr, NULL, NULL);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>); <span class="comment">/* free the line buffer */</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    remove_expired(c); <span class="comment">/* run this once, not on every cookie */</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span>(fromfile)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      fclose(fp);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  c-&gt;<a class="code" href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">running</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;          <span class="comment">/* now, we&#39;re running */</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">return</span> c;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordflow">if</span>(!inc)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">/* Only clean up if we allocated it here, as the original could still be in</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">     * use by a share handle */</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="cookie_8c.html#a94ef82292380794dc327fb84f45fd228">Curl_cookie_cleanup</a>(c);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">if</span>(fromfile &amp;&amp; fp)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    fclose(fp);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">return</span> NULL; <span class="comment">/* out of memory */</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">/* sort this so that the longest path gets before the shorter path */</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> cookie_sort(<span class="keyword">const</span> <span class="keywordtype">void</span> *p1, <span class="keyword">const</span> <span class="keywordtype">void</span> *p2)</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;{</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *c1 = *(<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **)p1;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *c2 = *(<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **)p2;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="keywordtype">size_t</span> l1, l2;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="comment">/* 1 - compare cookie path lengths */</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  l1 = c1-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> ? strlen(c1-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>) : 0;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  l2 = c2-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a> ? strlen(c2-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>) : 0;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">if</span>(l1 != l2)</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">return</span> (l2 &gt; l1) ? 1 : -1 ; <span class="comment">/* avoid size_t &lt;=&gt; int conversions */</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">/* 2 - compare cookie domain lengths */</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  l1 = c1-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> ? strlen(c1-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) : 0;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  l2 = c2-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> ? strlen(c2-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>) : 0;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span>(l1 != l2)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">return</span> (l2 &gt; l1) ? 1 : -1 ;  <span class="comment">/* avoid size_t &lt;=&gt; int conversions */</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">/* 3 - compare cookie name lengths */</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  l1 = c1-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a> ? strlen(c1-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>) : 0;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  l2 = c2-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a> ? strlen(c2-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>) : 0;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span>(l1 != l2)</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> (l2 &gt; l1) ? 1 : -1;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">/* 4 - compare cookie creation time */</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">return</span> (c2-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a> &gt; c1-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a>) ? 1 : -1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;}</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">/* sort cookies only according to creation time */</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> cookie_sort_ct(<span class="keyword">const</span> <span class="keywordtype">void</span> *p1, <span class="keyword">const</span> <span class="keywordtype">void</span> *p2)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;{</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *c1 = *(<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **)p1;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *c2 = *(<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **)p2;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">return</span> (c2-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a> &gt; c1-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a>) ? 1 : -1;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"><a class="line" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3"> 1171</a></span>&#160;<span class="preprocessor">#define CLONE(field)                     \</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor">  do {                                   \</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor">    if(src-&gt;field) {                     \</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="preprocessor">      d-&gt;field = strdup(src-&gt;field);     \</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="preprocessor">      if(!d-&gt;field)                      \</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="preprocessor">        goto fail;                       \</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">    }                                    \</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor">  } while(0)</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *dup_cookie(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *src)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;{</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *d = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a>), 1);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">if</span>(d) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">expirestr</a>);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a>);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">maxage</a>);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#ab22abc2906422da61885ac6c8e6a1a59">version</a>);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a> = src-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> = src-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a>;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a> = src-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">livecookie</a> = src-&gt;<a class="code" href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">livecookie</a>;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">httponly</a> = src-&gt;<a class="code" href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">httponly</a>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    d-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a> = src-&gt;<a class="code" href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">creationtime</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">return</span> d;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  freecookie(d);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;}</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment"> * Curl_cookie_getlist()</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment"> * For a given host and path, return a linked list of cookies that the</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment"> * client should send to the server if used now. The secure boolean informs</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment"> * the cookie if a secure connection is achieved or not.</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment"> * It shall only return cookies that haven&#39;t expired.</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"><a class="line" href="cookie_8h.html#a363986de62cca0b000c43d60e157d7ce"> 1218</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *<a class="code" href="cookie_8c.html#a14f67e6a0c8364b8d4990de8150f32c0">Curl_cookie_getlist</a>(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *c,</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>,</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                   <span class="keywordtype">bool</span> <a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a>)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;{</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *newco;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *co;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *mainco = NULL;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordtype">size_t</span> matches = 0;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordtype">bool</span> is_ip;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> myhash = cookiehash(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="keywordflow">if</span>(!c || !c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[myhash])</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">return</span> NULL; <span class="comment">/* no cookie struct or no cookies in the struct */</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">/* at first, remove expired cookies */</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  remove_expired(c);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">/* check if host is an IP(v4|v6) address */</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  is_ip = isip(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  co = c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[myhash];</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">while</span>(co) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">/* if the cookie requires we&#39;re secure we must only continue if we are! */</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a>?<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a>:<a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="comment">/* now check if the domain is correct */</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> ||</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         (co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> &amp;&amp; !is_ip &amp;&amp; <a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a>(co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>, <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>)) ||</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         ((!co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> || is_ip) &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)) ) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">/* the right part of the host matches the domain stuff in the</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">           cookie data */</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="comment">/* now check the left part of the path with the cookies path</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">           requirement */</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a> || pathmatch(co-&gt;<a class="code" href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">spath</a>, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>) ) {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          <span class="comment">/* and now, we know this is a match and we should create an</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">             entry for the return-linked-list */</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;          newco = dup_cookie(co);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="keywordflow">if</span>(newco) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="comment">/* then modify our next */</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            newco-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = mainco;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="comment">/* point the main to us */</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            mainco = newco;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            matches++;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    co = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  }</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">if</span>(matches) {</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">/* Now we need to make sure that if there is a name appearing more than</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">       once, the longest specified path version comes first. To make this</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">       the swiftest way, we just sort them all based on path length. */</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **array;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">/* alloc an array and store all cookie pointers */</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    array = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *) * matches);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">if</span>(!array)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    co = mainco;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; co; co = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>)</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      array[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++] = co;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">/* now sort the cookie pointers in path length order */</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    qsort(array, matches, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *), cookie_sort);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">/* remake the linked list order according to the new order */</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    mainco = array[0]; <span class="comment">/* start here */</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>&lt;matches-1; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      array[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = array[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> + 1];</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    array[matches-1]-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = NULL; <span class="comment">/* terminate the list */</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(array); <span class="comment">/* remove the temporary data again */</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">return</span> mainco; <span class="comment">/* return the new list */</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">/* failure, clear up the allocated chain and return NULL */</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <a class="code" href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a>(mainco);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment"> * Curl_cookie_clearall()</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment"> * Clear all existing cookies and reset the counter.</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="cookie_8h.html#a51d3e29b5943c67abae422363f78a633"> 1321</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#a51d3e29b5943c67abae422363f78a633">Curl_cookie_clearall</a>(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>) {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <a class="code" href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a>(<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = NULL;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;numcookies = 0;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;}</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment"> * Curl_cookie_freelist()</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"> * Free a list of cookies previously returned by Curl_cookie_getlist();</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"><a class="line" href="cookie_8h.html#aa6f1c0d10f384069018743790cc06909"> 1341</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *co)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;{</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">while</span>(co) {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    freecookie(co);</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    co = <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;}</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment"> * Curl_cookie_clearsess()</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment"> * Free all session cookies in the cookies list.</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01359"></a><span class="lineno"><a class="line" href="cookie_8h.html#aff89dc409a08660714ffa16a8e1dd503"> 1359</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#aff89dc409a08660714ffa16a8e1dd503">Curl_cookie_clearsess</a>(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;{</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *first, *curr, *<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>, *prev = NULL;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>)</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>])</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    first = curr = prev = <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">for</span>(; curr; curr = <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>) {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = curr-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">if</span>(!curr-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>) {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">if</span>(first == curr)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;          first = <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">if</span>(prev == curr)</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;          prev = <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          prev-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a> = <a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        freecookie(curr);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;numcookies--;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        prev = curr;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a>-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = first;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;}</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment"> * Curl_cookie_cleanup()</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment"> * Free a &quot;cookie object&quot; previous created with Curl_cookie_init().</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment"> ****************************************************************************/</span></div><div class="line"><a name="l01403"></a><span class="lineno"><a class="line" href="cookie_8h.html#a6f81ff75e378ea40690eb073c72eb5ef"> 1403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#a94ef82292380794dc327fb84f45fd228">Curl_cookie_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *c)</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;{</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">if</span>(c) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(c-&gt;<a class="code" href="struct_cookie_info.html#a9c7a72fbc10df79eb550870df245e2f1">filename</a>);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <a class="code" href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a>(c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(c); <span class="comment">/* free the base struct as well */</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;}</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">/* get_netscape_format()</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment"> * Formats a string for Netscape output file, w/o a newline at the end.</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment"> * Function returns a char * to a formatted line. Has to be free()d</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *get_netscape_format(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *co)</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;{</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="stringliteral">&quot;%s&quot;</span>     <span class="comment">/* httponly preamble */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="stringliteral">&quot;%s%s\t&quot;</span> <span class="comment">/* domain */</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="stringliteral">&quot;%s\t&quot;</span>   <span class="comment">/* tailmatch */</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="stringliteral">&quot;%s\t&quot;</span>   <span class="comment">/* path */</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="stringliteral">&quot;%s\t&quot;</span>   <span class="comment">/* secure */</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="stringliteral">&quot;%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\t&quot;</span>   <span class="comment">/* expires */</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="stringliteral">&quot;%s\t&quot;</span>   <span class="comment">/* name */</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="stringliteral">&quot;%s&quot;</span>,    <span class="comment">/* value */</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">httponly</a>?<span class="stringliteral">&quot;#HttpOnly_&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">/* Make sure all domains are prefixed with a dot if they allow</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">       tailmatching. This is Mozilla-style. */</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    (co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a> &amp;&amp; co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>[0] != <span class="charliteral">&#39;.&#39;</span>)? <span class="stringliteral">&quot;.&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>?co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>:<span class="stringliteral">&quot;unknown&quot;</span>,</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">tailmatch</a>?<span class="stringliteral">&quot;TRUE&quot;</span>:<span class="stringliteral">&quot;FALSE&quot;</span>,</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>?co-&gt;<a class="code" href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">path</a>:<span class="stringliteral">&quot;/&quot;</span>,</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">secure</a>?<span class="stringliteral">&quot;TRUE&quot;</span>:<span class="stringliteral">&quot;FALSE&quot;</span>,</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">expires</a>,</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>,</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>?co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>:<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;}</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment"> * cookie_output()</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment"> * Writes all internally known cookies to the specified file. Specify</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment"> * &quot;-&quot; as file name to write to stdout.</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment"> * The function returns non-zero on write failure.</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> cookie_output(<span class="keyword">struct</span> <a class="code" href="struct_cookie_info.html">CookieInfo</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *dumphere)</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;{</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *co;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <a class="code" href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">FILE</a> *out;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordtype">bool</span> use_stdout = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordtype">char</span> *format_ptr;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> **array;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="comment">/* at first, remove expired cookies */</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  remove_expired(c);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="keywordflow">if</span>(!strcmp(<span class="stringliteral">&quot;-&quot;</span>, dumphere)) {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">/* use stdout */</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    out = stdout;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    use_stdout = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  }</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    out = fopen(dumphere, <a class="code" href="curl__setup_8h.html#af512fc3a3d43889eab9cfd3f6df3c952">FOPEN_WRITETEXT</a>);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span>(!out) {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordflow">return</span> 1; <span class="comment">/* failure */</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    }</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  fputs(<span class="stringliteral">&quot;# Netscape HTTP Cookie File\n&quot;</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="stringliteral">&quot;# https://curl.haxx.se/docs/http-cookies.html\n&quot;</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="stringliteral">&quot;# This file was generated by libcurl! Edit at your own risk.\n\n&quot;</span>,</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        out);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordflow">if</span>(c-&gt;<a class="code" href="struct_cookie_info.html#af52d829cc8a1b073deca781e453a07df">numcookies</a>) {</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    array = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *) * c-&gt;<a class="code" href="struct_cookie_info.html#af52d829cc8a1b073deca781e453a07df">numcookies</a>);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span>(!array) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keywordflow">if</span>(!use_stdout)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        fclose(out);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">for</span>(co = c-&gt;<a class="code" href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">cookies</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; co; co = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>) {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">if</span>(!co-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        array[<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>++] = co;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    }</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    qsort(array, c-&gt;<a class="code" href="struct_cookie_info.html#af52d829cc8a1b073deca781e453a07df">numcookies</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_cookie.html">Cookie</a> *), cookie_sort_ct);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      format_ptr = get_netscape_format(array[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">if</span>(format_ptr == NULL) {</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <a class="code" href="curl__printf_8h.html#aab6e63106cf29e5160e5c2d63db86d27">fprintf</a>(out, <span class="stringliteral">&quot;#\n# Fatal libcurl error\n&quot;</span>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(array);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">if</span>(!use_stdout)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          fclose(out);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      }</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <a class="code" href="curl__printf_8h.html#aab6e63106cf29e5160e5c2d63db86d27">fprintf</a>(out, <span class="stringliteral">&quot;%s\n&quot;</span>, format_ptr);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(format_ptr);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    }</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(array);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">if</span>(!use_stdout)</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    fclose(out);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;}</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *cookie_list(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;{</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *list = NULL;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *beg;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *c;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;cookies == NULL) ||</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      (<a class="code" href="structdata.html">data</a>-&gt;cookies-&gt;numcookies == 0))</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">for</span>(c = <a class="code" href="structdata.html">data</a>-&gt;cookies-&gt;cookies[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; c; c = c-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>) {</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordflow">if</span>(!c-&gt;<a class="code" href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">domain</a>)</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a> = get_netscape_format(c);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>) {</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(list);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      beg = <a class="code" href="slist_8c.html#a7982a92d1abe5dcce03e879a402c809b">Curl_slist_append_nodup</a>(list, <a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="keywordflow">if</span>(!beg) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a>);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(list);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      }</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      list = beg;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  }</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">return</span> list;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;}</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="cookie_8h.html#ac8a0ddced2d6af3d081a962118b5d64a"> 1556</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="cookie_8c.html#ac8a0ddced2d6af3d081a962118b5d64a">Curl_cookie_list</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;{</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *list;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  list = cookie_list(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">return</span> list;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;}</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"><a class="line" href="cookie_8h.html#a04f46d0897660b9b3daf67c163f8927b"> 1565</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cookie_8c.html#a04f46d0897660b9b3daf67c163f8927b">Curl_flush_cookies</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keywordtype">int</span> cleanup)</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;{</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fae0c2f1f95c420755faeb06fc7656842f">STRING_COOKIEJAR</a>]) {</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;change.cookielist) {</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">/* If there is a list of cookie files to read, do it first so that</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">         we have all the told files read before we write the new jar.</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">         Curl_cookie_loadfiles() LOCKS and UNLOCKS the share itself! */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <a class="code" href="cookie_8c.html#ae44350d9d4dd49e91e604b70c3573809">Curl_cookie_loadfiles</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    }</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">/* if we have a destination file for all the cookies to get dumped to */</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">if</span>(cookie_output(<a class="code" href="structdata.html">data</a>-&gt;cookies, <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fae0c2f1f95c420755faeb06fc7656842f">STRING_COOKIEJAR</a>]))</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;WARNING: failed to save cookies in %s\n&quot;</span>,</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fae0c2f1f95c420755faeb06fc7656842f">STRING_COOKIEJAR</a>]);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">if</span>(cleanup &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;change.cookielist) {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="comment">/* since nothing is written, we can just free the list of cookie file</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">         names */</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(<a class="code" href="structdata.html">data</a>-&gt;change.cookielist); <span class="comment">/* clean up list */</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;change.cookielist = NULL;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    }</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  }</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">if</span>(cleanup &amp;&amp; (!<a class="code" href="structdata.html">data</a>-&gt;share || (<a class="code" href="structdata.html">data</a>-&gt;cookies != <a class="code" href="structdata.html">data</a>-&gt;share-&gt;cookies))) {</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <a class="code" href="cookie_8c.html#a94ef82292380794dc327fb84f45fd228">Curl_cookie_cleanup</a>(<a class="code" href="structdata.html">data</a>-&gt;cookies);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;}</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_HTTP || CURL_DISABLE_COOKIES */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="cookie_8c_html_a04615fb8c8bc6f00530d43104cdd2ff1"><div class="ttname"><a href="cookie_8c.html#a04615fb8c8bc6f00530d43104cdd2ff1">Curl_cookie_init</a></div><div class="ttdeci">struct CookieInfo * Curl_cookie_init(struct Curl_easy *data, const char *file, struct CookieInfo *inc, bool newsession)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01048">cookie.c:1048</a></div></div>
<div class="ttc" id="share_8h_html"><div class="ttname"><a href="share_8h.html">share.h</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a2e2dfd85567685413b23d71f2e545299"><div class="ttname"><a href="curl__setup_8h.html#a2e2dfd85567685413b23d71f2e545299">CURL_OFF_T_MAX</a></div><div class="ttdeci">#define CURL_OFF_T_MAX</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00432">curl_setup.h:432</a></div></div>
<div class="ttc" id="strtoofft_8h_html_a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121"><div class="ttname"><a href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121">CURL_OFFT_FLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8h_source.html#l00045">strtoofft.h:45</a></div></div>
<div class="ttc" id="struct_cookie_html_a2d9e794ef1e543d4cedab22acf50717b"><div class="ttname"><a href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">Cookie::next</a></div><div class="ttdeci">struct Cookie * next</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00029">cookie.h:29</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="struct_cookie_info_html_a460ddfe82071934e9219491a69b715b8"><div class="ttname"><a href="struct_cookie_info.html#a460ddfe82071934e9219491a69b715b8">CookieInfo::cookies</a></div><div class="ttdeci">struct Cookie * cookies[COOKIE_HASH_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00053">cookie.h:53</a></div></div>
<div class="ttc" id="psl_8h_html_a829f724809cd062e49e38c1f138c7bc1"><div class="ttname"><a href="psl_8h.html#a829f724809cd062e49e38c1f138c7bc1">Curl_psl_use</a></div><div class="ttdeci">#define Curl_psl_use(easy)</div><div class="ttdef"><b>Definition:</b> <a href="psl_8h_source.html#l00042">psl.h:42</a></div></div>
<div class="ttc" id="structcurl__slist_html"><div class="ttname"><a href="structcurl__slist.html">curl_slist</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02394">curl.h:2394</a></div></div>
<div class="ttc" id="struct_cookie_info_html_ae252f7ca7fe16bd8a080210f5e072544"><div class="ttname"><a href="struct_cookie_info.html#ae252f7ca7fe16bd8a080210f5e072544">CookieInfo::running</a></div><div class="ttdeci">bool running</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00056">cookie.h:56</a></div></div>
<div class="ttc" id="curl_8h_html_a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95"><div class="ttname"><a href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02619">curl.h:2619</a></div></div>
<div class="ttc" id="strtok_8h_html"><div class="ttname"><a href="strtok_8h.html">strtok.h</a></div></div>
<div class="ttc" id="slist_8c_html_a7982a92d1abe5dcce03e879a402c809b"><div class="ttname"><a href="slist_8c.html#a7982a92d1abe5dcce03e879a402c809b">Curl_slist_append_nodup</a></div><div class="ttdeci">struct curl_slist * Curl_slist_append_nodup(struct curl_slist *list, char *data)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00059">slist.c:59</a></div></div>
<div class="ttc" id="retry-max-time_8d_html_a612021c6b1f447b49053406818ef4ee6"><div class="ttname"><a href="retry-max-time_8d.html#a612021c6b1f447b49053406818ef4ee6">time</a></div><div class="ttdeci">Long the request will be made and while it may take longer than this given time period.To limit a single request s maximum time</div><div class="ttdef"><b>Definition:</b> <a href="retry-max-time_8d_source.html#l00008">retry-max-time.d:8</a></div></div>
<div class="ttc" id="structcurl__slist_html_a5fe4d926491a1c9b8b9a73c40505f601"><div class="ttname"><a href="structcurl__slist.html#a5fe4d926491a1c9b8b9a73c40505f601">curl_slist::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02395">curl.h:2395</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="structinput_html"><div class="ttname"><a href="structinput.html">input</a></div><div class="ttdef"><b>Definition:</b> <a href="http2-upload_8c_source.html#l00169">http2-upload.c:169</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="cookie_8h_html"><div class="ttname"><a href="cookie_8h.html">cookie.h</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="struct_cookie_html_a9d0857e4a82ca14e639e7ee1136f9c6f"><div class="ttname"><a href="struct_cookie.html#a9d0857e4a82ca14e639e7ee1136f9c6f">Cookie::livecookie</a></div><div class="ttdeci">bool livecookie</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00044">cookie.h:44</a></div></div>
<div class="ttc" id="unit1399_8c_html_acf1e931ffa73126ce876102dc2186895"><div class="ttname"><a href="unit1399_8c.html#acf1e931ffa73126ce876102dc2186895">now</a></div><div class="ttdeci">struct curltime now</div><div class="ttdef"><b>Definition:</b> <a href="unit1399_8c_source.html#l00083">unit1399.c:83</a></div></div>
<div class="ttc" id="cookie_8h_html_aaf3dd2898e41fffcacc10853c75e7886"><div class="ttname"><a href="cookie_8h.html#aaf3dd2898e41fffcacc10853c75e7886">MAX_COOKIE_LINE</a></div><div class="ttdeci">#define MAX_COOKIE_LINE</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00073">cookie.h:73</a></div></div>
<div class="ttc" id="cookie_8h_html_ac7c0207aa5a0e10d378be03b68041350"><div class="ttname"><a href="cookie_8h.html#ac7c0207aa5a0e10d378be03b68041350">MAX_NAME</a></div><div class="ttdeci">#define MAX_NAME</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00076">cookie.h:76</a></div></div>
<div class="ttc" id="struct_cookie_html_a7c5ae1aec00ae68e702c9653b591f1d9"><div class="ttname"><a href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">Cookie::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00030">cookie.h:30</a></div></div>
<div class="ttc" id="config-os400_8h_html_a7a1524cf833450776ffc81c38a78c370"><div class="ttname"><a href="config-os400_8h.html#a7a1524cf833450776ffc81c38a78c370">ENABLE_IPV6</a></div><div class="ttdeci">#define ENABLE_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="config-os400_8h_source.html#l00071">config-os400.h:71</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="cookie_8h_html_a477e5603f56a862d95e310f58a5161a5"><div class="ttname"><a href="cookie_8h.html#a477e5603f56a862d95e310f58a5161a5">COOKIE_HASH_SIZE</a></div><div class="ttdeci">#define COOKIE_HASH_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00049">cookie.h:49</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="structhostname_html"><div class="ttname"><a href="structhostname.html">hostname</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00446">urldata.h:446</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a3dca40ce1e998420175eabe37246e05b"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="ttdeci">#define CURL_FORMAT_CURL_OFF_T</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00395">system.h:395</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fae0c2f1f95c420755faeb06fc7656842f"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fae0c2f1f95c420755faeb06fc7656842f">STRING_COOKIEJAR</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01403">urldata.h:1403</a></div></div>
<div class="ttc" id="cookie_8c_html_ae44350d9d4dd49e91e604b70c3573809"><div class="ttname"><a href="cookie_8c.html#ae44350d9d4dd49e91e604b70c3573809">Curl_cookie_loadfiles</a></div><div class="ttdeci">void Curl_cookie_loadfiles(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l00337">cookie.c:337</a></div></div>
<div class="ttc" id="smooth-gtk-thread_8c_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="smooth-gtk-thread_8c_source.html#l00047">smooth-gtk-thread.c:47</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a494e2b4279dc064f7ed1d0abd602b28d"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_OFF_T curl_off_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00442">system.h:442</a></div></div>
<div class="ttc" id="cookie_8c_html_aff89dc409a08660714ffa16a8e1dd503"><div class="ttname"><a href="cookie_8c.html#aff89dc409a08660714ffa16a8e1dd503">Curl_cookie_clearsess</a></div><div class="ttdeci">void Curl_cookie_clearsess(struct CookieInfo *cookies)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01359">cookie.c:1359</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="curl__setup_8h_html_ac5301ec6857f338762bb9334473131ce"><div class="ttname"><a href="curl__setup_8h.html#ac5301ec6857f338762bb9334473131ce">FOPEN_READTEXT</a></div><div class="ttdeci">#define FOPEN_READTEXT</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00771">curl_setup.h:771</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="inet__pton_8h_html"><div class="ttname"><a href="inet__pton_8h.html">inet_pton.h</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="curl__setup_8h_html_af512fc3a3d43889eab9cfd3f6df3c952"><div class="ttname"><a href="curl__setup_8h.html#af512fc3a3d43889eab9cfd3f6df3c952">FOPEN_WRITETEXT</a></div><div class="ttdeci">#define FOPEN_WRITETEXT</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00772">curl_setup.h:772</a></div></div>
<div class="ttc" id="unit1308_8c_html_a2f29226077aaea62db6864d9b291eadc"><div class="ttname"><a href="unit1308_8c.html#a2f29226077aaea62db6864d9b291eadc">last</a></div><div class="ttdeci">struct curl_httppost * last</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00046">unit1308.c:46</a></div></div>
<div class="ttc" id="struct_cookie_info_html_a9c7a72fbc10df79eb550870df245e2f1"><div class="ttname"><a href="struct_cookie_info.html#a9c7a72fbc10df79eb550870df245e2f1">CookieInfo::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00055">cookie.h:55</a></div></div>
<div class="ttc" id="share_8c_html_a85cdae024464c8d7e96a232797028d72"><div class="ttname"><a href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a></div><div class="ttdeci">CURLSHcode Curl_share_unlock(struct Curl_easy *data, curl_lock_data type)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00244">share.c:244</a></div></div>
<div class="ttc" id="output_8d_html_a7bcb6a773be04cbd4890bfe10fa42696"><div class="ttname"><a href="output_8d.html#a7bcb6a773be04cbd4890bfe10fa42696">line</a></div><div class="ttdeci">Long you can use specifier.That variable will be replaced with the current string for the URL being fetched.Like if you specify two URLs on the same command line</div><div class="ttdef"><b>Definition:</b> <a href="output_8d_source.html#l00008">output.d:8</a></div></div>
<div class="ttc" id="unit1398_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00033">unit1398.c:33</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="cookie_8c_html_a6e800bf3fd9b6cea2a826408bcdf235c"><div class="ttname"><a href="cookie_8c.html#a6e800bf3fd9b6cea2a826408bcdf235c">Curl_cookie_add</a></div><div class="ttdeci">struct Cookie * Curl_cookie_add(struct Curl_easy *data, struct CookieInfo *c, bool httpheader, bool noexpire, char *lineptr, const char *domain, const char *path)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l00426">cookie.c:426</a></div></div>
<div class="ttc" id="config_8d_html_aea53e62b3bb322f5a6bf4ceb58066a37"><div class="ttname"><a href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are r and v.A backslash preceding any other letter is ignored.If the first column of a config line is a the rest of the line will be treated as a comment.Only write one option per physical line in the config file.Specify the filename to config as to make curl read the file from stdin.Note that to be able to specify a URL in the config file</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="struct_cookie_html_a4b8594c4588aad20e0c5b3b9a0a71504"><div class="ttname"><a href="struct_cookie.html#a4b8594c4588aad20e0c5b3b9a0a71504">Cookie::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00032">cookie.h:32</a></div></div>
<div class="ttc" id="structcurl__slist_html_a56fcfc41d89a47865933c310d316a108"><div class="ttname"><a href="structcurl__slist.html#a56fcfc41d89a47865933c310d316a108">curl_slist::next</a></div><div class="ttdeci">struct curl_slist * next</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02396">curl.h:2396</a></div></div>
<div class="ttc" id="struct_cookie_html_a75a5d620ca0ea4b778e9ce800cf7aeb9"><div class="ttname"><a href="struct_cookie.html#a75a5d620ca0ea4b778e9ce800cf7aeb9">Cookie::domain</a></div><div class="ttdeci">char * domain</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00034">cookie.h:34</a></div></div>
<div class="ttc" id="cookie_8c_html_ac8a0ddced2d6af3d081a962118b5d64a"><div class="ttname"><a href="cookie_8c.html#ac8a0ddced2d6af3d081a962118b5d64a">Curl_cookie_list</a></div><div class="ttdeci">struct curl_slist * Curl_cookie_list(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01556">cookie.c:1556</a></div></div>
<div class="ttc" id="cookie_8c_html_a04f46d0897660b9b3daf67c163f8927b"><div class="ttname"><a href="cookie_8c.html#a04f46d0897660b9b3daf67c163f8927b">Curl_flush_cookies</a></div><div class="ttdeci">void Curl_flush_cookies(struct Curl_easy *data, int cleanup)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01565">cookie.c:1565</a></div></div>
<div class="ttc" id="strtoofft_8c_html_a3c9f5c063165fc15454feac4def889d7"><div class="ttname"><a href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a></div><div class="ttdeci">CURLofft curlx_strtoofft(const char *str, char **endp, int base, curl_off_t *num)</div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8c_source.html#l00215">strtoofft.c:215</a></div></div>
<div class="ttc" id="struct_cookie_html_a6db50d84be2536a3cbe68964e471128f"><div class="ttname"><a href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">Cookie::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00031">cookie.h:31</a></div></div>
<div class="ttc" id="remote-name_8d_html_aa335f8bb20424b03700f57b150bf0aa6"><div class="ttname"><a href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a></div><div class="ttdeci">Long the path is cut off.The file will be saved in the current working directory.If you want the file saved in a different make sure you change the current working directory before invoking curl with this option.The remote file name to use for saving is extracted from the given nothing and if it already exists it will be overwritten.If you want the server to be able to choose the file name refer to remote header name which can be used in addition to this option.If the server chooses a file name and that name already exists it will not be overwritten.There is no URL decoding done on the file name.If it has or other URL encoded parts of the name</div><div class="ttdef"><b>Definition:</b> <a href="remote-name_8d_source.html#l00006">remote-name.d:6</a></div></div>
<div class="ttc" id="struct_cookie_info_html_af52d829cc8a1b073deca781e453a07df"><div class="ttname"><a href="struct_cookie_info.html#af52d829cc8a1b073deca781e453a07df">CookieInfo::numcookies</a></div><div class="ttdeci">long numcookies</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00057">cookie.h:57</a></div></div>
<div class="ttc" id="struct_cookie_info_html_ab9b49390f78086409b461d8f450f1c3f"><div class="ttname"><a href="struct_cookie_info.html#ab9b49390f78086409b461d8f450f1c3f">CookieInfo::newsession</a></div><div class="ttdeci">bool newsession</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00058">cookie.h:58</a></div></div>
<div class="ttc" id="strtoofft_8h_html"><div class="ttname"><a href="strtoofft_8h.html">strtoofft.h</a></div></div>
<div class="ttc" id="struct_cookie_html_ab4f8f41b5e3ef4f6fd7bd0b371bc619d"><div class="ttname"><a href="struct_cookie.html#ab4f8f41b5e3ef4f6fd7bd0b371bc619d">Cookie::secure</a></div><div class="ttdeci">bool secure</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00043">cookie.h:43</a></div></div>
<div class="ttc" id="struct_cookie_info_html_ac63339e524ca07309db2efca735d28ee"><div class="ttname"><a href="struct_cookie_info.html#ac63339e524ca07309db2efca735d28ee">CookieInfo::lastct</a></div><div class="ttdeci">int lastct</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00059">cookie.h:59</a></div></div>
<div class="ttc" id="fail-early_8d_html_a2b978ebca1e6cb7fcbcb9a6b51701ce3"><div class="ttname"><a href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply fail</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="struct_cookie_html_a71d9f6f212522feba3491bbd33d182d3"><div class="ttname"><a href="struct_cookie.html#a71d9f6f212522feba3491bbd33d182d3">Cookie::tailmatch</a></div><div class="ttdeci">bool tailmatch</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00037">cookie.h:37</a></div></div>
<div class="ttc" id="struct_cookie_html_abc4bf2864ea9bed00cc6070f8f8ebf80"><div class="ttname"><a href="struct_cookie.html#abc4bf2864ea9bed00cc6070f8f8ebf80">Cookie::httponly</a></div><div class="ttdeci">bool httponly</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00045">cookie.h:45</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="inet__pton_8c_html_a8d1e996e3cc6d70e844c787b1a8614cc"><div class="ttname"><a href="inet__pton_8c.html#a8d1e996e3cc6d70e844c787b1a8614cc">Curl_inet_pton</a></div><div class="ttdeci">int Curl_inet_pton(int af, const char *src, void *dst)</div><div class="ttdef"><b>Definition:</b> <a href="inet__pton_8c_source.html#l00066">inet_pton.c:66</a></div></div>
<div class="ttc" id="mail-rcpt_8d_html_a2bf47710f7123dd01376c838ea4c5eb4"><div class="ttname"><a href="mail-rcpt_8d.html#a2bf47710f7123dd01376c838ea4c5eb4">domain</a></div><div class="ttdeci">Long user name or mailing list name.Repeat this option several times to send to multiple recipients.When performing a mail the recipient should specify a valid email address to send the mail to.When performing an address the recipient should be specified as the user name or user name and domain(as per Section 3.5 of RFC5321).(Added in 7.34.0) When performing a mailing list expand(EXPN command)</div></div>
<div class="ttc" id="strtoofft_8h_html_a515bb1ee04e33ae6fdb4d80dd897437f"><div class="ttname"><a href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437f">CURLofft</a></div><div class="ttdeci">CURLofft</div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8h_source.html#l00043">strtoofft.h:43</a></div></div>
<div class="ttc" id="curl__memrchr_8h_html"><div class="ttname"><a href="curl__memrchr_8h.html">curl_memrchr.h</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="psl_8h_html"><div class="ttname"><a href="psl_8h.html">psl.h</a></div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="struct_cookie_html_a42b3ad92d5eefecf66154fc623c37e6c"><div class="ttname"><a href="struct_cookie.html#a42b3ad92d5eefecf66154fc623c37e6c">Cookie::creationtime</a></div><div class="ttdeci">int creationtime</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00046">cookie.h:46</a></div></div>
<div class="ttc" id="strtok_8h_html_abff4e21c5a2026f9982e88f1e686e63a"><div class="ttname"><a href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a></div><div class="ttdeci">#define strtok_r</div><div class="ttdef"><b>Definition:</b> <a href="strtok_8h_source.html#l00029">strtok.h:29</a></div></div>
<div class="ttc" id="struct_cookie_html_adc5fdb706f52660d418fe5af1250d848"><div class="ttname"><a href="struct_cookie.html#adc5fdb706f52660d418fe5af1250d848">Cookie::expirestr</a></div><div class="ttdeci">char * expirestr</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00036">cookie.h:36</a></div></div>
<div class="ttc" id="curl_8h_html_af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1"><div class="ttname"><a href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02607">curl.h:2607</a></div></div>
<div class="ttc" id="_console_8h_html_ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719"><div class="ttname"><a href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">ArgType_t::FILE</a></div></div>
<div class="ttc" id="curl_8h_html_ad4dd80e15a6f20cdd628a7f222fcb8eb"><div class="ttname"><a href="curl_8h.html#ad4dd80e15a6f20cdd628a7f222fcb8eb">curl_getdate</a></div><div class="ttdeci">CURL_EXTERN time_t curl_getdate(const char *p, const time_t *unused)</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00559">parsedate.c:559</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_t_l_m_8h_html_ab22abc2906422da61885ac6c8e6a1a59"><div class="ttname"><a href="_b_l_e_eddystone_t_l_m_8h.html#ab22abc2906422da61885ac6c8e6a1a59">version</a></div><div class="ttdeci">uint8_t version</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_t_l_m_8h_source.html#l00041">BLEEddystoneTLM.h:41</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_a7b9356145fc9f69e003fbd3c352acc28"><div class="ttname"><a href="curl__ctype_8h.html#a7b9356145fc9f69e003fbd3c352acc28">ISBLANK</a></div><div class="ttdeci">#define ISBLANK(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00078">curl_ctype.h:78</a></div></div>
<div class="ttc" id="cookie_8h_html_a6bde8ad7da0c7288674ed63fd764ed92"><div class="ttname"><a href="cookie_8h.html#a6bde8ad7da0c7288674ed63fd764ed92">MAX_NAME_TXT</a></div><div class="ttdeci">#define MAX_NAME_TXT</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00077">cookie.h:77</a></div></div>
<div class="ttc" id="slist_8h_html"><div class="ttname"><a href="slist_8h.html">slist.h</a></div></div>
<div class="ttc" id="namespaceimpacket_1_1spnego_html_a0a02d11a9f2c4b3dc0831313547049de"><div class="ttname"><a href="namespaceimpacket_1_1spnego.html#a0a02d11a9f2c4b3dc0831313547049de">impacket.spnego.fields</a></div><div class="ttdeci">fields</div><div class="ttdef"><b>Definition:</b> <a href="spnego_8py_source.html#l00085">spnego.py:85</a></div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="struct_cookie_html_ac9de1e0d0d05e1a1297f4651e8609b83"><div class="ttname"><a href="struct_cookie.html#ac9de1e0d0d05e1a1297f4651e8609b83">Cookie::maxage</a></div><div class="ttdeci">char * maxage</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00041">cookie.h:41</a></div></div>
<div class="ttc" id="cookie_8c_html_a14f67e6a0c8364b8d4990de8150f32c0"><div class="ttname"><a href="cookie_8c.html#a14f67e6a0c8364b8d4990de8150f32c0">Curl_cookie_getlist</a></div><div class="ttdeci">struct Cookie * Curl_cookie_getlist(struct CookieInfo *c, const char *host, const char *path, bool secure)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01218">cookie.c:1218</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="include_8d_html_a1b5ad20ebd9adc54d22897bd8b7cd3c8"><div class="ttname"><a href="include_8d.html#a1b5ad20ebd9adc54d22897bd8b7cd3c8">cookies</a></div><div class="ttdeci">Long cookies</div><div class="ttdef"><b>Definition:</b> <a href="include_8d_source.html#l00007">include.d:7</a></div></div>
<div class="ttc" id="anyauth_8d_html_a1d461998550d329666033ab94bf67c6a"><div class="ttname"><a href="anyauth_8d.html#a1d461998550d329666033ab94bf67c6a">stdin</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response thus possibly inducing an extra network round trip.This is used instead of setting a specific authentication which you can do with and negotiate.Using anyauth is not recommended if you do uploads from stdin</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="share_8c_html_a5dcfa53b653176b92395464a33b509cb"><div class="ttname"><a href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a></div><div class="ttdeci">CURLSHcode Curl_share_lock(struct Curl_easy *data, curl_lock_data type, curl_lock_access accesstype)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00226">share.c:226</a></div></div>
<div class="ttc" id="strcase_8h_html_a23b67e200b6f4c3ead633c94b3edcdb3"><div class="ttname"><a href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a></div><div class="ttdeci">#define checkprefix(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00046">strcase.h:46</a></div></div>
<div class="ttc" id="cookie_8c_html_a94ef82292380794dc327fb84f45fd228"><div class="ttname"><a href="cookie_8c.html#a94ef82292380794dc327fb84f45fd228">Curl_cookie_cleanup</a></div><div class="ttdeci">void Curl_cookie_cleanup(struct CookieInfo *c)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01403">cookie.c:1403</a></div></div>
<div class="ttc" id="cookie_8c_html_a4e0b732b5a4ce674481a17c5c0b1ade6"><div class="ttname"><a href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a></div><div class="ttdeci">void Curl_cookie_freelist(struct Cookie *co)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01341">cookie.c:1341</a></div></div>
<div class="ttc" id="curl__printf_8h_html_aab6e63106cf29e5160e5c2d63db86d27"><div class="ttname"><a href="curl__printf_8h.html#aab6e63106cf29e5160e5c2d63db86d27">fprintf</a></div><div class="ttdeci">#define fprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00041">curl_printf.h:41</a></div></div>
<div class="ttc" id="psl_8h_html_af771f7c26f84a57fff4fe3851532293a"><div class="ttname"><a href="psl_8h.html#af771f7c26f84a57fff4fe3851532293a">Curl_psl_release</a></div><div class="ttdeci">#define Curl_psl_release(easy)</div><div class="ttdef"><b>Definition:</b> <a href="psl_8h_source.html#l00043">psl.h:43</a></div></div>
<div class="ttc" id="cookie_8c_html_ab8f0766a397683771883ecc142c374b3"><div class="ttname"><a href="cookie_8c.html#ab8f0766a397683771883ecc142c374b3">CLONE</a></div><div class="ttdeci">#define CLONE(field)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01171">cookie.c:1171</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="struct_cookie_html_a6b02686127ac197724ad72ca7ebf3193"><div class="ttname"><a href="struct_cookie.html#a6b02686127ac197724ad72ca7ebf3193">Cookie::spath</a></div><div class="ttdeci">char * spath</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00033">cookie.h:33</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="struct_cookie_html_a4868c2f6f603000c96c0b050cb304c5e"><div class="ttname"><a href="struct_cookie.html#a4868c2f6f603000c96c0b050cb304c5e">Cookie::expires</a></div><div class="ttdeci">curl_off_t expires</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00035">cookie.h:35</a></div></div>
<div class="ttc" id="struct_cookie_info_html"><div class="ttname"><a href="struct_cookie_info.html">CookieInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00051">cookie.h:51</a></div></div>
<div class="ttc" id="curl_8h_html_a3a28c84e40db0ef30859b680281c9d36"><div class="ttname"><a href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a></div><div class="ttdeci">CURL_EXTERN void curl_slist_free_all(struct curl_slist *)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00129">slist.c:129</a></div></div>
<div class="ttc" id="strcase_8c_html_a555bbf5fd8dc146336474a2bb7959524"><div class="ttname"><a href="strcase_8c.html#a555bbf5fd8dc146336474a2bb7959524">Curl_raw_toupper</a></div><div class="ttdeci">char Curl_raw_toupper(char in)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8c_source.html#l00031">strcase.c:31</a></div></div>
<div class="ttc" id="curl__memrchr_8h_html_a06109590a27d5e674ba630320d5a9d0b"><div class="ttname"><a href="curl__memrchr_8h.html#a06109590a27d5e674ba630320d5a9d0b">memrchr</a></div><div class="ttdeci">#define memrchr(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memrchr_8h_source.html#l00040">curl_memrchr.h:40</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="struct_cookie_html_a5aefd47068aac7d89411375831d7fda3"><div class="ttname"><a href="struct_cookie.html#a5aefd47068aac7d89411375831d7fda3">Cookie::version</a></div><div class="ttdeci">char * version</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00040">cookie.h:40</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="struct_cookie_html"><div class="ttname"><a href="struct_cookie.html">Cookie</a></div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00028">cookie.h:28</a></div></div>
<div class="ttc" id="cookie_8c_html_a51d3e29b5943c67abae422363f78a633"><div class="ttname"><a href="cookie_8c.html#a51d3e29b5943c67abae422363f78a633">Curl_cookie_clearall</a></div><div class="ttdeci">void Curl_cookie_clearall(struct CookieInfo *cookies)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01321">cookie.c:1321</a></div></div>
<div class="ttc" id="util_8c_html_a3b02c6de5c049804444a246f7fdf46b4"><div class="ttname"><a href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a></div><div class="ttdeci">const char * path</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00194">util.c:194</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="cookie_8c.html">cookie.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
