<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/doh.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('doh_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">doh.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="doh_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__addrinfo_8h.html">curl_addrinfo.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="doh_8h.html">doh.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="multiif_8h.html">multiif.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="url_8h.html">url.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="share_8h.html">share.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connect_8h.html">connect.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strdup_8h.html">strdup.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="doh_8c.html#a9cc84b120d830f184e7249db81ed1736">   41</a></span>&#160;<span class="preprocessor">#define DNS_CLASS_IN 0x01</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="doh_8c.html#a26cebb1bf5906797cfd22c935ba74a36">   42</a></span>&#160;<span class="preprocessor">#define DOH_MAX_RESPONSE_SIZE 3000 </span><span class="comment">/* bytes */</span><span class="preprocessor"></span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_VERBOSE_STRINGS</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971">errors</a>[]={</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="stringliteral">&quot;Bad label&quot;</span>,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="stringliteral">&quot;Out of range&quot;</span>,</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="stringliteral">&quot;Label loop&quot;</span>,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="stringliteral">&quot;Too small&quot;</span>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="stringliteral">&quot;Out of memory&quot;</span>,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="stringliteral">&quot;RDATA length&quot;</span>,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="stringliteral">&quot;Malformat&quot;</span>,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="stringliteral">&quot;Bad RCODE&quot;</span>,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="stringliteral">&quot;Unexpected TYPE&quot;</span>,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="stringliteral">&quot;Unexpected CLASS&quot;</span>,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="stringliteral">&quot;No content&quot;</span>,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="stringliteral">&quot;Bad ID&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *doh_strerror(<a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> &gt;= <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>) &amp;&amp; (<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> &lt;= <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a604d41c416646499acf73eaa82a997c2">DOH_DNS_BAD_ID</a>))</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971">errors</a>[<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>];</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;bad error code&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#ifdef DEBUGBUILD</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define UNITTEST</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="doh_8c.html#aa7cd0f8f04816a88879b7e5a8594db57">   72</a></span>&#160;<span class="preprocessor">#define UNITTEST static</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="doh_8c.html#aee2307e228bb2326a2aee64735937198">   75</a></span>&#160;<a class="code" href="doh_8c.html#aa7cd0f8f04816a88879b7e5a8594db57">UNITTEST</a> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="doh_8c.html#aee2307e228bb2326a2aee64735937198">doh_encode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                            <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76">DNStype</a> dnstype,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *dnsp, <span class="comment">/* buffer */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                            <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,  <span class="comment">/* buffer size */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                            <span class="keywordtype">size_t</span> *olen) <span class="comment">/* output length */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">size_t</span> hostlen = strlen(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *orig = dnsp;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *hostp = <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt; (12 + hostlen + 4))</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ab1aead6268f590c14597e7533a483531">DOH_TOO_SMALL_BUFFER</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  *dnsp++ = 0; <span class="comment">/* 16 bit id */</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  *dnsp++ = 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  *dnsp++ = 0x01; <span class="comment">/* |QR|   Opcode  |AA|TC|RD| Set the RD bit */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* |RA|   Z    |   RCODE   |                */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  *dnsp++ = 1;    <span class="comment">/* QDCOUNT (number of entries in the question section) */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* ANCOUNT */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* NSCOUNT */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* ARCOUNT */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/* store a QNAME */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">char</span> *dot = strchr(hostp, <span class="charliteral">&#39;.&#39;</span>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">size_t</span> labellen;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span>(dot) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      found = <span class="keyword">true</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      labellen = dot - hostp;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      labellen = strlen(hostp);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span>(labellen &gt; 63) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">/* too long label, error out */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      *olen = 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd">DOH_DNS_BAD_LABEL</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    *dnsp++ = (<span class="keywordtype">unsigned</span> char)labellen;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(dnsp, hostp, labellen);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    dnsp += labellen;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    hostp += labellen + 1;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span>(!found) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      *dnsp++ = 0; <span class="comment">/* terminating zero */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  } <span class="keywordflow">while</span>(1);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* upper 8 bit TYPE */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  *dnsp++ = (<span class="keywordtype">unsigned</span> char)dnstype;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  *dnsp++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* upper 8 bit CLASS */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  *dnsp++ = <a class="code" href="doh_8c.html#a9cc84b120d830f184e7249db81ed1736">DNS_CLASS_IN</a>; <span class="comment">/* IN - &quot;the Internet&quot; */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  *olen = dnsp - orig;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;doh_write_cb(<span class="keywordtype">void</span> *contents, <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, <span class="keywordtype">size_t</span> nmemb, <span class="keywordtype">void</span> *userp)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">size_t</span> realsize = <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> * nmemb;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">struct </span><a class="code" href="structdohresponse.html">dohresponse</a> *mem = (<span class="keyword">struct </span><a class="code" href="structdohresponse.html">dohresponse</a> *)userp;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">if</span>((mem-&gt;<a class="code" href="structdohresponse.html#a909b871f0cebbfd08ee722438ed50eb8">size</a> + realsize) &gt; <a class="code" href="doh_8c.html#a26cebb1bf5906797cfd22c935ba74a36">DOH_MAX_RESPONSE_SIZE</a>)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">/* suspiciously much for us */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  mem-&gt;<a class="code" href="structdohresponse.html#ab24567df24087819da62dfccf3934516">memory</a> = <a class="code" href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a>(mem-&gt;<a class="code" href="structdohresponse.html#ab24567df24087819da62dfccf3934516">memory</a>, mem-&gt;<a class="code" href="structdohresponse.html#a909b871f0cebbfd08ee722438ed50eb8">size</a> + realsize);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span>(!mem-&gt;<a class="code" href="structdohresponse.html#ab24567df24087819da62dfccf3934516">memory</a>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* out of memory! */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;(mem-&gt;<a class="code" href="structdohresponse.html#ab24567df24087819da62dfccf3934516">memory</a>[mem-&gt;<a class="code" href="structdohresponse.html#a909b871f0cebbfd08ee722438ed50eb8">size</a>]), contents, realsize);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  mem-&gt;<a class="code" href="structdohresponse.html#a909b871f0cebbfd08ee722438ed50eb8">size</a> += realsize;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> realsize;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/* called from multi.c when this DOH transfer is complete */</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Curl_doh_done(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *doh, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = doh-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a78dbbecb7d0e8f0ea66e971608a301f8">dohfor</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">/* so one of the DOH request done for the &#39;data&#39; transfer is now complete! */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.pending--;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;a DOH request is completed, %d to go\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;req.doh.pending);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;DOH request %s\n&quot;</span>, <a class="code" href="curl_8h.html#a1feaa896e865ad01f32cc46f6f8c72f5">curl_easy_strerror</a>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.doh.pending) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">/* DOH completed */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.headers);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.doh.headers = NULL;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="multi_8c.html#a759a3f675165554a5f5d6e784afa7fe0">Curl_expire</a>(<a class="code" href="structdata.html">data</a>, 0, <a class="code" href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da325bcbe2ebf7e3de886d9af307372ca4">EXPIRE_RUN_NOW</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">  176</a></span>&#160;<span class="preprocessor">#define ERROR_CHECK_SETOPT(x,y) result = curl_easy_setopt(doh, x, y);   \</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">  if(result) goto error</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> dohprobe(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="structdnsprobe.html">dnsprobe</a> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76">DNStype</a> dnstype,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <a class="code" href="multi_8h.html#a5ad3a82c3de54ee92ce4ddb052d18036">CURLM</a> *<a class="code" href="struct_curl__easy.html#ae50ee3c1668aaed84ae0338046f4f737">multi</a>,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *doh = NULL;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">char</span> *nurl = NULL;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="timeval_8h.html#aeb19832fd3e7f11c8d047d6824300e87">timediff_t</a> timeout_ms;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> d = <a class="code" href="doh_8c.html#aee2307e228bb2326a2aee64735937198">doh_encode</a>(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, dnstype, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohbuffer, <span class="keyword">sizeof</span>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohbuffer),</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                         &amp;<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohlen);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span>(d) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed to encode DOH packet [%d]\n&quot;</span>, d);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dnstype = dnstype;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;serverdoh.memory = NULL;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* the memory will be grown as needed by realloc in the doh_write_cb</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">     function */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;serverdoh.size = 0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">/* Note: this is code for sending the DoH request with GET but there&#39;s still</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">     no logic that actually enables this. We should either add that ability or</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">     yank out the GET code. Discuss! */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.doh_get) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">char</span> *b64;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">size_t</span> b64len;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#ac297f79b5b4e0198d361139720027dc8">Curl_base64url_encode</a>(<a class="code" href="structdata.html">data</a>, (<span class="keywordtype">char</span> *)<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohbuffer, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohlen,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                   &amp;b64, &amp;b64len);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    nurl = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s?dns=%s&quot;</span>, <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, b64);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(b64);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span>(!nurl) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> = nurl;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  timeout_ms = <a class="code" href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a>(<a class="code" href="structdata.html">data</a>, NULL, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">/* Curl_open() is the internal version of curl_easy_init() */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="url_8c.html#aa4332af3100a3a9ce3a2ba11e4bfddab">Curl_open</a>(&amp;doh);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">/* pass in the struct pointer via a local variable to please coverity and</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">       the gcc typecheck helpers */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdohresponse.html">dohresponse</a> *resp = &amp;<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;serverdoh;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_URL, <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_WRITEFUNCTION, doh_write_cb);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_WRITEDATA, resp);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;set.doh_get) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_POSTFIELDS, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohbuffer);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_POSTFIELDSIZE, (<span class="keywordtype">long</span>)<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;dohlen);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_HTTPHEADER, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#ifdef USE_NGHTTP2</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_HTTP_VERSION, <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da153a446054f34c6bcbca7a690209f284">CURL_HTTP_VERSION_2TLS</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#ifndef CURLDEBUG</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">/* enforce HTTPS if not debug */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_PROTOCOLS, <a class="code" href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_TIMEOUT_MS, (<span class="keywordtype">long</span>)timeout_ms);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a>(CURLOPT_VERBOSE, 1L);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    doh-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a00e1b9073bd998d304d2da328625ad4e">fmultidone</a> = Curl_doh_done;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    doh-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a78dbbecb7d0e8f0ea66e971608a301f8">dohfor</a> = <a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>; <span class="comment">/* identify for which transfer this is done */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;easy = doh;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">/* add this transfer to the multi handle */</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="multi_8h.html#a85754cc6a7c820735e0fac1ebac7493d">curl_multi_add_handle</a>(multi, doh))</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(nurl);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  error:</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(nurl);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="url_8c.html#a557d55610156477514fe6dc5a178789e">Curl_close</a>(doh);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * Curl_doh() resolves a name using DOH. It resolves a name and returns a</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> * &#39;Curl_addrinfo *&#39; with the address information.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="doh_8h.html#ad8f1d42272f3e981eb0f6a3cb71e1aa8">  270</a></span>&#160;<a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *<a class="code" href="doh_8c.html#ad8f1d42272f3e981eb0f6a3cb71e1aa8">Curl_doh</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structhostname.html">hostname</a>,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        <span class="keywordtype">int</span> port,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        <span class="keywordtype">int</span> *waitp)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  *waitp = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* this never returns synchronously */</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  (void)conn;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  (void)<a class="code" href="structhostname.html">hostname</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  (void)port;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">/* start clean, consider allocating this struct on demand */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(&amp;<a class="code" href="structdata.html">data</a>-&gt;req.doh, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdohdata.html">dohdata</a>));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.host = <a class="code" href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.port = port;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.headers =</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="curl_8h.html#a7ea20d9a213c806f82446bed893f423f">curl_slist_append</a>(NULL,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                      <span class="stringliteral">&quot;Content-Type: application/dns-message&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.doh.headers)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ad0fdd504366b349123252aa698625fd9">ip_version</a> != <a class="code" href="curl_8h.html#aacb5df097bc05c47daa985deb2425e67">CURL_IPRESOLVE_V6</a>) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">/* create IPv4 DOH request */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = dohprobe(<a class="code" href="structdata.html">data</a>, &amp;<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0], <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a>,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                      <a class="code" href="structhostname.html">hostname</a>, <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa265acd4437d583d7e1cc4cadc30e6ee4">STRING_DOH</a>],</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                      <a class="code" href="structdata.html">data</a>-&gt;multi, <a class="code" href="structdata.html">data</a>-&gt;req.doh.headers);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.doh.pending++;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ad0fdd504366b349123252aa698625fd9">ip_version</a> != <a class="code" href="curl_8h.html#a10f1fdedc5753fb92ccfb7cb08bdf9d7">CURL_IPRESOLVE_V4</a>) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">/* create IPv6 DOH request */</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = dohprobe(<a class="code" href="structdata.html">data</a>, &amp;<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1], <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a>,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                      <a class="code" href="structhostname.html">hostname</a>, <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa265acd4437d583d7e1cc4cadc30e6ee4">STRING_DOH</a>],</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                      <a class="code" href="structdata.html">data</a>-&gt;multi, <a class="code" href="structdata.html">data</a>-&gt;req.doh.headers);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.doh.pending++;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  error:</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.headers);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.headers = NULL;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="easy_8h.html#a7acd7812b672df9e378050fab7c732aa">curl_easy_cleanup</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].easy);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].easy = NULL;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="easy_8h.html#a7acd7812b672df9e378050fab7c732aa">curl_easy_cleanup</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].easy);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].easy = NULL;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> skipqname(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh, <span class="keywordtype">size_t</span> dohlen,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *indexp)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> length;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (*indexp + 1))</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    length = doh[*indexp];</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span>((length &amp; 0xc0) == 0xc0) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">/* name pointer, advance over it and be done */</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span>(dohlen &lt; (*indexp + 2))</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      *indexp += 2;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span>(length &amp; 0xc0)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd">DOH_DNS_BAD_LABEL</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (*indexp + 1 + length))</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    *indexp += 1 + length;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  } <span class="keywordflow">while</span>(length);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> get16bit(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh, <span class="keywordtype">int</span> index)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)((doh[index] &lt;&lt; 8) | doh[index + 1]);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> get32bit(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh, <span class="keywordtype">int</span> index)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">return</span> (doh[index] &lt;&lt; 24) | (doh[index + 1] &lt;&lt; 16) |</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    (doh[index + 2] &lt;&lt; 8) | doh[index + 3];</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> store_a(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh, <span class="keywordtype">int</span> index, <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">/* silently ignore addresses over the limit */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span>(d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a> &lt; <a class="code" href="doh_8h.html#a272ac0e1ff303e2ee8e10e5149dc96d1">DOH_MAX_ADDR</a>) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdohaddr.html">dohaddr</a> *<a class="code" href="structa.html">a</a> = &amp;d-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>];</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="structa.html">a</a>-&gt;type = <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;<a class="code" href="structa.html">a</a>-&gt;ip.v4, &amp;doh[index], 4);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>++;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> store_aaaa(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh, <span class="keywordtype">int</span> index, <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">/* silently ignore addresses over the limit */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span>(d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a> &lt; <a class="code" href="doh_8h.html#a272ac0e1ff303e2ee8e10e5149dc96d1">DOH_MAX_ADDR</a>) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdohaddr.html">dohaddr</a> *<a class="code" href="structa.html">a</a> = &amp;d-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>];</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="structa.html">a</a>-&gt;type = <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;<a class="code" href="structa.html">a</a>-&gt;ip.v6, &amp;doh[index], 16);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>++;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> cnameappend(<span class="keyword">struct</span> <a class="code" href="structcnamestore.html">cnamestore</a> *c,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *src,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                           <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span>(!c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a> = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 1;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span>(!c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a575217c636dcceef11f3b811e172f862">DOH_OUT_OF_MEM</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a> &lt; (c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a> + <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 1)) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a> += <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 1;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="curl__memory_8h.html#aa568500a9ca507b5a53de5372c81f26a">realloc</a>(c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>, c-&gt;<a class="code" href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">allocsize</a>);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a575217c636dcceef11f3b811e172f862">DOH_OUT_OF_MEM</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a> = <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>[c-&gt;<a class="code" href="structcnamestore.html#a7be7a1969f9ad4bf300243543623467f">len</a>], src, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  c-&gt;<a class="code" href="structcnamestore.html#a7be7a1969f9ad4bf300243543623467f">len</a> += <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  c-&gt;<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>[c-&gt;<a class="code" href="structcnamestore.html#a7be7a1969f9ad4bf300243543623467f">len</a>] = 0; <span class="comment">/* keep it zero terminated */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> store_cname(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                           <span class="keywordtype">size_t</span> dohlen,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                           <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcnamestore.html">cnamestore</a> *c;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="multi-uv_8c.html#add769cb3887f840e6e7be962492de960">loop</a> = 128; <span class="comment">/* a valid DNS name can never loop this much */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> length;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span>(d-&gt;<a class="code" href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">numcname</a> == <a class="code" href="doh_8h.html#a641dafdadc7102f7031b9ebec58340f3">DOH_MAX_CNAME</a>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>; <span class="comment">/* skip! */</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  c = &amp;d-&gt;<a class="code" href="structdohentry.html#a544482775819dec08b7ad1f3989484b4">cname</a>[d-&gt;<a class="code" href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">numcname</a>++];</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span>(index &gt;= dohlen)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    length = doh[index];</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span>((length &amp; 0xc0) == 0xc0) {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordtype">int</span> newpos;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="comment">/* name pointer, get the new offset (14 bits) */</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span>((index + 1) &gt;= dohlen)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">/* move to the the new index */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      newpos = (length &amp; 0x3f) &lt;&lt; 8 | doh[index + 1];</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      index = newpos;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(length &amp; 0xc0)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd">DOH_DNS_BAD_LABEL</a>; <span class="comment">/* bad input */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      index++;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span>(length) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span>(c-&gt;<a class="code" href="structcnamestore.html#a7be7a1969f9ad4bf300243543623467f">len</a>) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = cnameappend(c, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="stringliteral">&quot;.&quot;</span>, 1);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">if</span>((index + length) &gt; dohlen)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd">DOH_DNS_BAD_LABEL</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = cnameappend(c, &amp;doh[index], length);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      index += length;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  } <span class="keywordflow">while</span>(length &amp;&amp; --<a class="code" href="multi-uv_8c.html#add769cb3887f840e6e7be962492de960">loop</a>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="multi-uv_8c.html#add769cb3887f840e6e7be962492de960">loop</a>)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ae60ff2b80321443ae41a44c4196aff83">DOH_DNS_LABEL_LOOP</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">static</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> rdata(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                     <span class="keywordtype">size_t</span> dohlen,</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rdlength,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                     <span class="keywordtype">int</span> index,</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">/* RDATA</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">     - A (TYPE 1):  4 bytes</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">     - AAAA (TYPE 28): 16 bytes</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">     - NS (TYPE 2): N bytes */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a>:</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span>(rdlength != 4)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8d1cc35200409830f3455b1161dd83de">DOH_DNS_RDATA_LEN</a>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = store_a(doh, index, d);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a>:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span>(rdlength != 16)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8d1cc35200409830f3455b1161dd83de">DOH_DNS_RDATA_LEN</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = store_aaaa(doh, index, d);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad412bbe358a397a2512f9c395fd5c37e">DNS_TYPE_CNAME</a>:</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = store_cname(doh, dohlen, index, d);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">/* unsupported type, just skip it */</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> init_dohentry(<span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *de)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(de, 0, <span class="keyword">sizeof</span>(*de));</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  de-&gt;<a class="code" href="structdohentry.html#a0296bc0b0d8cbf477e73cfd5b3dbace2">ttl</a> = INT_MAX;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="doh_8c.html#ac4016369230e8bc1788095a09c53689b">  511</a></span>&#160;<a class="code" href="doh_8c.html#aa7cd0f8f04816a88879b7e5a8594db57">UNITTEST</a> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="doh_8c.html#ac4016369230e8bc1788095a09c53689b">doh_decode</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *doh,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                            <span class="keywordtype">size_t</span> dohlen,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                            <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76">DNStype</a> dnstype,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                            <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> rcode;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> qdcount;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ancount;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> = 0;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keyword">class</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rdlength;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nscount;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> arcount;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 12;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">if</span>(dohlen &lt; 12)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ab1aead6268f590c14597e7533a483531">DOH_TOO_SMALL_BUFFER</a>; <span class="comment">/* too small */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span>(!doh || doh[0] || doh[1])</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a604d41c416646499acf73eaa82a997c2">DOH_DNS_BAD_ID</a>; <span class="comment">/* bad ID */</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  rcode = doh[3] &amp; 0x0f;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span>(rcode)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32afe120f642e615e1aba801b7e69fd80df">DOH_DNS_BAD_RCODE</a>; <span class="comment">/* bad rcode */</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  qdcount = get16bit(doh, 4);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">while</span>(qdcount) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = skipqname(doh, dohlen, &amp;index);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>; <span class="comment">/* bad qname */</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 4))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    index += 4; <span class="comment">/* skip question&#39;s type and class */</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    qdcount--;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  ancount = get16bit(doh, 6);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">while</span>(ancount) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ttl;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = skipqname(doh, dohlen, &amp;index);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>; <span class="comment">/* bad qname */</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 2))</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> = get16bit(doh, index);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> != <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad412bbe358a397a2512f9c395fd5c37e">DNS_TYPE_CNAME</a>) &amp;&amp; (<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> != dnstype))</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">/* Not the same type as was asked for nor CNAME */</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a32e0220d3d6b0195d01383166077e9ce">DOH_DNS_UNEXPECTED_TYPE</a>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    index += 2;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 2))</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">class </span>= get16bit(doh, index);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="doh_8c.html#a9cc84b120d830f184e7249db81ed1736">DNS_CLASS_IN</a> != <span class="keyword">class</span>)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a5d0cb303395b40249e83516b961a3545">DOH_DNS_UNEXPECTED_CLASS</a>; <span class="comment">/* unsupported */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    index += 2;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 4))</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    ttl = get32bit(doh, index);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">if</span>(ttl &lt; d-&gt;ttl)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      d-&gt;<a class="code" href="structdohentry.html#a0296bc0b0d8cbf477e73cfd5b3dbace2">ttl</a> = ttl;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    index += 4;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 2))</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    rdlength = get16bit(doh, index);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    index += 2;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + rdlength))</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = rdata(doh, dohlen, rdlength, <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>, index, d);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>; <span class="comment">/* bad rdata */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    index += rdlength;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    ancount--;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  nscount = get16bit(doh, 8);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">while</span>(nscount) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = skipqname(doh, dohlen, &amp;index);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>; <span class="comment">/* bad qname */</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 8))</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    index += 2 + 2 + 4; <span class="comment">/* type, class and ttl */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 2))</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    rdlength = get16bit(doh, index);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    index += 2;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + rdlength))</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    index += rdlength;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    nscount--;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  arcount = get16bit(doh, 10);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">while</span>(arcount) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = skipqname(doh, dohlen, &amp;index);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>; <span class="comment">/* bad qname */</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 8))</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    index += 2 + 2 + 4; <span class="comment">/* type, class and ttl */</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + 2))</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    rdlength = get16bit(doh, index);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    index += 2;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span>(dohlen &lt; (index + rdlength))</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    index += rdlength;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    arcount--;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span>(index != dohlen)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ae362e8571a74c5faba9fb04cd6adcadb">DOH_DNS_MALFORMAT</a>; <span class="comment">/* something is wrong */</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> != <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a4c089094c4e291f9b3e6a7fe1faf864c">DNS_TYPE_NS</a>) &amp;&amp; !d-&gt;<a class="code" href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">numcname</a> &amp;&amp; !d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">/* nothing stored! */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a46c757652941bc2847a41c3e45fd79d6">DOH_NO_CONTENT</a>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a>; <span class="comment">/* ok */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_VERBOSE_STRINGS</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> showdoh(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;TTL: %u seconds\n&quot;</span>, d-&gt;<a class="code" href="structdohentry.html#a0296bc0b0d8cbf477e73cfd5b3dbace2">ttl</a>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; d-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdohaddr.html">dohaddr</a> *<a class="code" href="structa.html">a</a> = &amp;d-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structa.html">a</a>-&gt;type == <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a>) {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;DOH A: %u.%u.%u.%u\n&quot;</span>,</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="structa.html">a</a>-&gt;ip.v4[0], <a class="code" href="structa.html">a</a>-&gt;ip.v4[1],</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <a class="code" href="structa.html">a</a>-&gt;ip.v4[2], <a class="code" href="structa.html">a</a>-&gt;ip.v4[3]);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structa.html">a</a>-&gt;type == <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a>) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>[128];</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, 128, <span class="stringliteral">&quot;DOH AAAA: &quot;</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = &amp;<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>[10];</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 118;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; 16; <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> += 2) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordtype">size_t</span> l;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <span class="stringliteral">&quot;%s%02x%02x&quot;</span>, <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>?<span class="stringliteral">&quot;:&quot;</span>:<span class="stringliteral">&quot;&quot;</span>, d-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ae6b3cc97655a4ef5f30abe5b8e762af8">v6</a>[<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>],</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                  d-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ae6b3cc97655a4ef5f30abe5b8e762af8">v6</a>[<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> + 1]);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        l = strlen(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> -= l;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> += l;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; d-&gt;<a class="code" href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">numcname</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;CNAME: %s\n&quot;</span>, d-&gt;<a class="code" href="structdohentry.html#a544482775819dec08b7ad1f3989484b4">cname</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="preprocessor">#define showdoh(x,y)</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> * doh2ai()</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"> * This function returns a pointer to the first element of a newly allocated</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"> * Curl_addrinfo struct linked list filled with the data from a set of DOH</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> * lookups.  Curl_addrinfo is meant to work like the addrinfo struct does for</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"> * a IPv6 stack, but usable also for IPv4, all hosts and environments.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"> * The memory allocated by this function *MUST* be free&#39;d later on calling</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"> * Curl_freeaddrinfo().  For each successful call to this function there</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"> * must be an associated call later to Curl_freeaddrinfo().</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;doh2ai(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *de, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structhostname.html">hostname</a>, <span class="keywordtype">int</span> port)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *ai;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *prevai = NULL;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *firstai = NULL;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keyword">struct </span>sockaddr_in *addr;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor">#ifdef ENABLE_IPV6</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keyword">struct </span>sockaddr_in6 *addr6;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordflow">if</span>(!de)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">/* no input == no output! */</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; de-&gt;<a class="code" href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">numaddr</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">size_t</span> ss_size;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    CURL_SA_FAMILY_T addrtype;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">if</span>(de-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#aa08307119b424410ce83c70876eede24">type</a> == <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a>) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor">#ifndef ENABLE_IPV6</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="comment">/* we can&#39;t handle IPv6 addresses */</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      ss_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sockaddr_in6);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      addrtype = AF_INET6;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      ss_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sockaddr_in);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      addrtype = AF_INET;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    ai = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a>));</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span>(!ai) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    ai-&gt;<a class="code" href="struct_curl__addrinfo.html#a55a07e701e9f89b3835712afbd382906">ai_canonname</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structhostname.html">hostname</a>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span>(!ai-&gt;<a class="code" href="struct_curl__addrinfo.html#a55a07e701e9f89b3835712afbd382906">ai_canonname</a>) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ai);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    ai-&gt;<a class="code" href="struct_curl__addrinfo.html#ab72a36e22c2c7cb539df0351f59359ca">ai_addr</a> = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, ss_size);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span>(!ai-&gt;<a class="code" href="struct_curl__addrinfo.html#ab72a36e22c2c7cb539df0351f59359ca">ai_addr</a>) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ai-&gt;<a class="code" href="struct_curl__addrinfo.html#a55a07e701e9f89b3835712afbd382906">ai_canonname</a>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ai);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span>(!firstai)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">/* store the pointer we want to return from this function */</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      firstai = ai;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">if</span>(prevai)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">/* make the previous entry point to this */</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      prevai-&gt;<a class="code" href="struct_curl__addrinfo.html#a871199ad1750edcfa4c642c74cb8ccd8">ai_next</a> = ai;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    ai-&gt;<a class="code" href="struct_curl__addrinfo.html#abadfae881af6425a56ff823ef0bb1a70">ai_family</a> = addrtype;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">/* we return all names as STREAM, so when using this address for TFTP</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">       the type must be ignored and conn-&gt;socktype be used instead! */</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    ai-&gt;<a class="code" href="struct_curl__addrinfo.html#a5cc95970e9ca4cebf88338c7f0ddd0a5">ai_socktype</a> = SOCK_STREAM;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    ai-&gt;<a class="code" href="struct_curl__addrinfo.html#a0f3cc69725de08bee11e911e0cd52eb2">ai_addrlen</a> = (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#af89f74b4f46628d93e3cc829fcd69801">curl_socklen_t</a>)ss_size;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">/* leave the rest of the struct filled with zero */</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">switch</span>(ai-&gt;<a class="code" href="struct_curl__addrinfo.html#abadfae881af6425a56ff823ef0bb1a70">ai_family</a>) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">case</span> AF_INET:</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      addr = (<span class="keywordtype">void</span> *)ai-&gt;<a class="code" href="struct_curl__addrinfo.html#ab72a36e22c2c7cb539df0351f59359ca">ai_addr</a>; <span class="comment">/* storage area for this info */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr) == <span class="keyword">sizeof</span>(de-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ac7b66a4b139db5e3f94d29c5887f128b">v4</a>));</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;addr-&gt;sin_addr, &amp;de-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ac7b66a4b139db5e3f94d29c5887f128b">v4</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr));</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      addr-&gt;sin_family = (CURL_SA_FAMILY_T)addrtype;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      addr-&gt;sin_port = htons((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)port);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">#ifdef ENABLE_IPV6</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">case</span> AF_INET6:</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      addr6 = (<span class="keywordtype">void</span> *)ai-&gt;<a class="code" href="struct_curl__addrinfo.html#ab72a36e22c2c7cb539df0351f59359ca">ai_addr</a>; <span class="comment">/* storage area for this info */</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr) == <span class="keyword">sizeof</span>(de-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ae6b3cc97655a4ef5f30abe5b8e762af8">v6</a>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;addr6-&gt;sin6_addr, &amp;de-&gt;<a class="code" href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">addr</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">ip</a>.<a class="code" href="structdohaddr.html#ae6b3cc97655a4ef5f30abe5b8e762af8">v6</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      addr6-&gt;sin6_family = (CURL_SA_FAMILY_T)addrtype;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      addr6-&gt;sin6_port = htons((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)port);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    prevai = ai;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="curl__addrinfo_8c.html#adfda8bf59056f5007ee5af04f3e411ac">Curl_freeaddrinfo</a>(firstai);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    firstai = NULL;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">return</span> firstai;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_VERBOSE_STRINGS</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *type2name(<a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76">DNStype</a> dnstype)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;{</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">return</span> (dnstype == <a class="code" href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a>)?<span class="stringliteral">&quot;A&quot;</span>:<span class="stringliteral">&quot;AAAA&quot;</span>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;}</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">  809</a></span>&#160;<a class="code" href="doh_8c.html#aa7cd0f8f04816a88879b7e5a8594db57">UNITTEST</a> <span class="keywordtype">void</span> <a class="code" href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">de_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="structdohentry.html">dohentry</a> *d)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; d-&gt;<a class="code" href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">numcname</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(d-&gt;<a class="code" href="structdohentry.html#a544482775819dec08b7ad1f3989484b4">cname</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">alloc</a>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="doh_8h.html#a12b4bd4f97c05697ea2949671b6771c6">  817</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="doh_8c.html#ae7b7f8e58ab02795c6e4286dd1a00467">Curl_doh_is_resolved</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="struct_curl__dns__entry.html">Curl_dns_entry</a> **dnsp)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;{</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  *dnsp = NULL; <span class="comment">/* defaults to no response */</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].easy &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].easy) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Could not DOH-resolve: %s&quot;</span>, conn-&gt;<a class="code" href="structconnectdata.html#a81b59f48e7176a865c7459ce844c45dd">async</a>.<a class="code" href="struct_curl__async.html#a0550efdecd5238b2be25262b37c88b7e">hostname</a>);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span> conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ad6024fcc7a2aefd8d8d1359f9ae7955d">proxy</a>?<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9492950b668aee96f09e54a328d762fd">CURLE_COULDNT_RESOLVE_PROXY</a>:</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ad09d0102a75633a97e1f58be1abaf630">CURLE_COULDNT_RESOLVE_HOST</a>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.doh.pending) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a> rc2;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdohentry.html">dohentry</a> de;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_curl__dns__entry.html">Curl_dns_entry</a> *dns;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_curl__addrinfo.html">Curl_addrinfo</a> *ai;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">/* remove DOH handles from multi handle and close them */</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="multi_8h.html#abd5c8bf83688f15099b512846f6efc5a">curl_multi_remove_handle</a>(<a class="code" href="structdata.html">data</a>-&gt;multi, <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].easy);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="url_8c.html#a557d55610156477514fe6dc5a178789e">Curl_close</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].easy);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="multi_8h.html#abd5c8bf83688f15099b512846f6efc5a">curl_multi_remove_handle</a>(<a class="code" href="structdata.html">data</a>-&gt;multi, <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].easy);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="url_8c.html#a557d55610156477514fe6dc5a178789e">Curl_close</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].easy);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">/* parse the responses, create the struct and return it! */</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    init_dohentry(&amp;de);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="doh_8c.html#ac4016369230e8bc1788095a09c53689b">doh_decode</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].serverdoh.memory,</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].serverdoh.size,</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].dnstype,</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    &amp;de);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].serverdoh.memory);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;DOH: %s type %s for %s\n&quot;</span>, doh_strerror(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>),</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            type2name(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[0].dnstype),</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;req.doh.host);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    rc2 = <a class="code" href="doh_8c.html#ac4016369230e8bc1788095a09c53689b">doh_decode</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].serverdoh.memory,</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                     <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].serverdoh.size,</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                     <a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].dnstype,</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                     &amp;de);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].serverdoh.memory);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">if</span>(rc2) {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;DOH: %s type %s for %s\n&quot;</span>, doh_strerror(rc2),</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            type2name(<a class="code" href="structdata.html">data</a>-&gt;req.doh.probe[1].dnstype),</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;req.doh.host);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> || !rc2) {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;DOH Host name: %s\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;req.doh.host);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      showdoh(<a class="code" href="structdata.html">data</a>, &amp;de);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      ai = doh2ai(&amp;de, <a class="code" href="structdata.html">data</a>-&gt;req.doh.host, <a class="code" href="structdata.html">data</a>-&gt;req.doh.port);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span>(!ai) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">de_cleanup</a>(&amp;de);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;share)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cacccfc548470f64bb4c100d13d4cc9c9a">CURL_LOCK_DATA_DNS</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="comment">/* we got a response, store it in the cache */</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      dns = <a class="code" href="hostip_8c.html#afab64c7c46db37643d596002f4a0c825">Curl_cache_addr</a>(<a class="code" href="structdata.html">data</a>, ai, <a class="code" href="structdata.html">data</a>-&gt;req.doh.host, <a class="code" href="structdata.html">data</a>-&gt;req.doh.port);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;share)</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cacccfc548470f64bb4c100d13d4cc9c9a">CURL_LOCK_DATA_DNS</a>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <a class="code" href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">de_cleanup</a>(&amp;de);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">if</span>(!dns)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="comment">/* returned failure, bail out nicely */</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="curl__addrinfo_8c.html#adfda8bf59056f5007ee5af04f3e411ac">Curl_freeaddrinfo</a>(ai);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        conn-&gt;<a class="code" href="structconnectdata.html#a81b59f48e7176a865c7459ce844c45dd">async</a>.<a class="code" href="struct_curl__async.html#ad332b101ad0d9229113ca378e7909f29">dns</a> = dns;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        *dnsp = dns;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">de_cleanup</a>(&amp;de);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ad09d0102a75633a97e1f58be1abaf630">CURLE_COULDNT_RESOLVE_HOST</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="struct_connect_bits_html_ad6024fcc7a2aefd8d8d1359f9ae7955d"><div class="ttname"><a href="struct_connect_bits.html#ad6024fcc7a2aefd8d8d1359f9ae7955d">ConnectBits::proxy</a></div><div class="ttdeci">bool proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00387">urldata.h:387</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ad09d0102a75633a97e1f58be1abaf630"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ad09d0102a75633a97e1f58be1abaf630">CURLE_COULDNT_RESOLVE_HOST</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00465">curl.h:465</a></div></div>
<div class="ttc" id="curl_8h_html_aacb5df097bc05c47daa985deb2425e67"><div class="ttname"><a href="curl_8h.html#aacb5df097bc05c47daa985deb2425e67">CURL_IPRESOLVE_V6</a></div><div class="ttdeci">#define CURL_IPRESOLVE_V6</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01915">curl.h:1915</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a5d0cb303395b40249e83516b961a3545"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a5d0cb303395b40249e83516b961a3545">DOH_DNS_UNEXPECTED_CLASS</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00055">doh.h:55</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32ab1aead6268f590c14597e7533a483531"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ab1aead6268f590c14597e7533a483531">DOH_TOO_SMALL_BUFFER</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00049">doh.h:49</a></div></div>
<div class="ttc" id="share_8h_html"><div class="ttname"><a href="share_8h.html">share.h</a></div></div>
<div class="ttc" id="struct_curl__async_html_ad332b101ad0d9229113ca378e7909f29"><div class="ttname"><a href="struct_curl__async.html#ad332b101ad0d9229113ca378e7909f29">Curl_async::dns</a></div><div class="ttdeci">struct Curl_dns_entry * dns</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00474">urldata.h:474</a></div></div>
<div class="ttc" id="url_8c_html_aa4332af3100a3a9ce3a2ba11e4bfddab"><div class="ttname"><a href="url_8c.html#aa4332af3100a3a9ce3a2ba11e4bfddab">Curl_open</a></div><div class="ttdeci">CURLcode Curl_open(struct Curl_easy **curl)</div><div class="ttdef"><b>Definition:</b> <a href="url_8c_source.html#l00558">url.c:558</a></div></div>
<div class="ttc" id="structconnectdata_html_a9312f162d29fe7f59bc2b5dbeda85d9d"><div class="ttname"><a href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">connectdata::bits</a></div><div class="ttdeci">struct ConnectBits bits</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00894">urldata.h:894</a></div></div>
<div class="ttc" id="structdohentry_html_ab73e505732537d2d3b0389fb0a04d0f0"><div class="ttname"><a href="structdohentry.html#ab73e505732537d2d3b0389fb0a04d0f0">dohentry::addr</a></div><div class="ttdeci">struct dohaddr addr[DOH_MAX_ADDR]</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00087">doh.h:87</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32ae60ff2b80321443ae41a44c4196aff83"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ae60ff2b80321443ae41a44c4196aff83">DOH_DNS_LABEL_LOOP</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00048">doh.h:48</a></div></div>
<div class="ttc" id="structcnamestore_html_aceeb485348019462ec9b08c59e38d318"><div class="ttname"><a href="structcnamestore.html#aceeb485348019462ec9b08c59e38d318">cnamestore::allocsize</a></div><div class="ttdeci">size_t allocsize</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00073">doh.h:73</a></div></div>
<div class="ttc" id="doh_8c_html_ac4016369230e8bc1788095a09c53689b"><div class="ttname"><a href="doh_8c.html#ac4016369230e8bc1788095a09c53689b">doh_decode</a></div><div class="ttdeci">UNITTEST DOHcode doh_decode(unsigned char *doh, size_t dohlen, DNStype dnstype, struct dohentry *d)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00511">doh.c:511</a></div></div>
<div class="ttc" id="urldata_8h_html_aabb7db968656c3ee0555ea3d8784310da325bcbe2ebf7e3de886d9af307372ca4"><div class="ttname"><a href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da325bcbe2ebf7e3de886d9af307372ca4">EXPIRE_RUN_NOW</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01212">urldata.h:1212</a></div></div>
<div class="ttc" id="multi_8h_html_a85754cc6a7c820735e0fac1ebac7493d"><div class="ttname"><a href="multi_8h.html#a85754cc6a7c820735e0fac1ebac7493d">curl_multi_add_handle</a></div><div class="ttdeci">CURL_EXTERN CURLMcode curl_multi_add_handle(CURLM *multi_handle, CURL *curl_handle)</div></div>
<div class="ttc" id="structdohaddr_html_ae6b3cc97655a4ef5f30abe5b8e762af8"><div class="ttname"><a href="structdohaddr.html#ae6b3cc97655a4ef5f30abe5b8e762af8">dohaddr::v6</a></div><div class="ttdeci">unsigned char v6[16]</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00080">doh.h:80</a></div></div>
<div class="ttc" id="structcurl__slist_html"><div class="ttname"><a href="structcurl__slist.html">curl_slist</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02394">curl.h:2394</a></div></div>
<div class="ttc" id="doh_8h_html_afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29"><div class="ttname"><a href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a265b27cca3b7baa93c46988f68ddeb29">DNS_TYPE_A</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00061">doh.h:61</a></div></div>
<div class="ttc" id="curl_8h_html_a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95"><div class="ttname"><a href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02619">curl.h:2619</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_a0f3cc69725de08bee11e911e0cd52eb2"><div class="ttname"><a href="struct_curl__addrinfo.html#a0f3cc69725de08bee11e911e0cd52eb2">Curl_addrinfo::ai_addrlen</a></div><div class="ttdeci">curl_socklen_t ai_addrlen</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00056">curl_addrinfo.h:56</a></div></div>
<div class="ttc" id="structdohentry_html"><div class="ttname"><a href="structdohentry.html">dohentry</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00084">doh.h:84</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32afe120f642e615e1aba801b7e69fd80df"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32afe120f642e615e1aba801b7e69fd80df">DOH_DNS_BAD_RCODE</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00053">doh.h:53</a></div></div>
<div class="ttc" id="doh_8c_html_a5b3a7f6ee8bc155560713174b3cf010c"><div class="ttname"><a href="doh_8c.html#a5b3a7f6ee8bc155560713174b3cf010c">de_cleanup</a></div><div class="ttdeci">UNITTEST void de_cleanup(struct dohentry *d)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00809">doh.c:809</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32">DOHcode</a></div><div class="ttdeci">DOHcode</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00044">doh.h:44</a></div></div>
<div class="ttc" id="curl_8h_html_af898dd6eb71573ccb1668c3d2380549cacccfc548470f64bb4c100d13d4cc9c9a"><div class="ttname"><a href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cacccfc548470f64bb4c100d13d4cc9c9a">CURL_LOCK_DATA_DNS</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02608">curl.h:2608</a></div></div>
<div class="ttc" id="connect_8h_html"><div class="ttname"><a href="connect_8h.html">connect.h</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a32e0220d3d6b0195d01383166077e9ce"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a32e0220d3d6b0195d01383166077e9ce">DOH_DNS_UNEXPECTED_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00054">doh.h:54</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="unit1608_8c_html_afb9ed1b8a27eb20854efe6e23e297683"><div class="ttname"><a href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a></div><div class="ttdeci">CURLcode code</div><div class="ttdef"><b>Definition:</b> <a href="unit1608_8c_source.html#l00047">unit1608.c:47</a></div></div>
<div class="ttc" id="doh_8c_html_aee2307e228bb2326a2aee64735937198"><div class="ttname"><a href="doh_8c.html#aee2307e228bb2326a2aee64735937198">doh_encode</a></div><div class="ttdeci">UNITTEST DOHcode doh_encode(const char *host, DNStype dnstype, unsigned char *dnsp, size_t len, size_t *olen)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00075">doh.c:75</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="curl_8h_html_a10f1fdedc5753fb92ccfb7cb08bdf9d7"><div class="ttname"><a href="curl_8h.html#a10f1fdedc5753fb92ccfb7cb08bdf9d7">CURL_IPRESOLVE_V4</a></div><div class="ttdeci">#define CURL_IPRESOLVE_V4</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01914">curl.h:1914</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a23d7b88872d6ead46c978b567908d587"><div class="ttname"><a href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a></div><div class="ttdeci">#define DEBUGASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00401">curl_setup_once.h:401</a></div></div>
<div class="ttc" id="doh_8c_html_a26cebb1bf5906797cfd22c935ba74a36"><div class="ttname"><a href="doh_8c.html#a26cebb1bf5906797cfd22c935ba74a36">DOH_MAX_RESPONSE_SIZE</a></div><div class="ttdeci">#define DOH_MAX_RESPONSE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00042">doh.c:42</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a046783ae41bdfd57074f4a062f9a88fd">DOH_DNS_BAD_LABEL</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00046">doh.h:46</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa265acd4437d583d7e1cc4cadc30e6ee4"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa265acd4437d583d7e1cc4cadc30e6ee4">STRING_DOH</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01475">urldata.h:1475</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="structcnamestore_html_a95fe421774ae66d7a359138e0a2773d6"><div class="ttname"><a href="structcnamestore.html#a95fe421774ae66d7a359138e0a2773d6">cnamestore::alloc</a></div><div class="ttdeci">char * alloc</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00072">doh.h:72</a></div></div>
<div class="ttc" id="curl__addrinfo_8c_html_adfda8bf59056f5007ee5af04f3e411ac"><div class="ttname"><a href="curl__addrinfo_8c.html#adfda8bf59056f5007ee5af04f3e411ac">Curl_freeaddrinfo</a></div><div class="ttdeci">void Curl_freeaddrinfo(Curl_addrinfo *cahead)</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8c_source.html#l00085">curl_addrinfo.c:85</a></div></div>
<div class="ttc" id="structdohaddr_html"><div class="ttname"><a href="structdohaddr.html">dohaddr</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00076">doh.h:76</a></div></div>
<div class="ttc" id="structcnamestore_html"><div class="ttname"><a href="structcnamestore.html">cnamestore</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00070">doh.h:70</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa568500a9ca507b5a53de5372c81f26a"><div class="ttname"><a href="curl__memory_8h.html#aa568500a9ca507b5a53de5372c81f26a">realloc</a></div><div class="ttdeci">#define realloc(ptr, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00128">curl_memory.h:128</a></div></div>
<div class="ttc" id="doh_8h_html_afd3ed70ffb4bc5ddf0eeedb30370bc76a4c089094c4e291f9b3e6a7fe1faf864c"><div class="ttname"><a href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76a4c089094c4e291f9b3e6a7fe1faf864c">DNS_TYPE_NS</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00062">doh.h:62</a></div></div>
<div class="ttc" id="structdohentry_html_a5a3b7c343f9e0ce61f998067cce5b907"><div class="ttname"><a href="structdohentry.html#a5a3b7c343f9e0ce61f998067cce5b907">dohentry::numcname</a></div><div class="ttdeci">int numcname</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00088">doh.h:88</a></div></div>
<div class="ttc" id="doh_8h_html_afd3ed70ffb4bc5ddf0eeedb30370bc76"><div class="ttname"><a href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76">DNStype</a></div><div class="ttdeci">DNStype</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00060">doh.h:60</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="multi-uv_8c_html_add769cb3887f840e6e7be962492de960"><div class="ttname"><a href="multi-uv_8c.html#add769cb3887f840e6e7be962492de960">loop</a></div><div class="ttdeci">uv_loop_t * loop</div><div class="ttdef"><b>Definition:</b> <a href="multi-uv_8c_source.html#l00040">multi-uv.c:40</a></div></div>
<div class="ttc" id="structhostname_html"><div class="ttname"><a href="structhostname.html">hostname</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00446">urldata.h:446</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="smooth-gtk-thread_8c_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="smooth-gtk-thread_8c_source.html#l00047">smooth-gtk-thread.c:47</a></div></div>
<div class="ttc" id="unit1308_8c_html_a70a830d3039f37216dde9bcf2460aec2"><div class="ttname"><a href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a></div><div class="ttdeci">char buffer[]</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00048">unit1308.c:48</a></div></div>
<div class="ttc" id="struct_curl__easy_html_ae50ee3c1668aaed84ae0338046f4f737"><div class="ttname"><a href="struct_curl__easy.html#ae50ee3c1668aaed84ae0338046f4f737">Curl_easy::multi</a></div><div class="ttdeci">struct Curl_multi * multi</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01777">urldata.h:1777</a></div></div>
<div class="ttc" id="curl__addrinfo_8h_html"><div class="ttname"><a href="curl__addrinfo_8h.html">curl_addrinfo.h</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_a871199ad1750edcfa4c642c74cb8ccd8"><div class="ttname"><a href="struct_curl__addrinfo.html#a871199ad1750edcfa4c642c74cb8ccd8">Curl_addrinfo::ai_next</a></div><div class="ttdeci">struct Curl_addrinfo * ai_next</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00059">curl_addrinfo.h:59</a></div></div>
<div class="ttc" id="structdohresponse_html_ab24567df24087819da62dfccf3934516"><div class="ttname"><a href="structdohresponse.html#ab24567df24087819da62dfccf3934516">dohresponse::memory</a></div><div class="ttdeci">unsigned char * memory</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00505">urldata.h:505</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_a55a07e701e9f89b3835712afbd382906"><div class="ttname"><a href="struct_curl__addrinfo.html#a55a07e701e9f89b3835712afbd382906">Curl_addrinfo::ai_canonname</a></div><div class="ttdeci">char * ai_canonname</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00057">curl_addrinfo.h:57</a></div></div>
<div class="ttc" id="doh_8c_html_aa7cd0f8f04816a88879b7e5a8594db57"><div class="ttname"><a href="doh_8c.html#aa7cd0f8f04816a88879b7e5a8594db57">UNITTEST</a></div><div class="ttdeci">#define UNITTEST</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00072">doh.c:72</a></div></div>
<div class="ttc" id="doh_8c_html_a298435a11902d3223880ee5a63799fb0"><div class="ttname"><a href="doh_8c.html#a298435a11902d3223880ee5a63799fb0">ERROR_CHECK_SETOPT</a></div><div class="ttdeci">#define ERROR_CHECK_SETOPT(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00176">doh.c:176</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9492950b668aee96f09e54a328d762fd"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9492950b668aee96f09e54a328d762fd">CURLE_COULDNT_RESOLVE_PROXY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00464">curl.h:464</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="base64_8c_html_ac297f79b5b4e0198d361139720027dc8"><div class="ttname"><a href="base64_8c.html#ac297f79b5b4e0198d361139720027dc8">Curl_base64url_encode</a></div><div class="ttdeci">CURLcode Curl_base64url_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00314">base64.c:314</a></div></div>
<div class="ttc" id="structdohaddr_html_aa08307119b424410ce83c70876eede24"><div class="ttname"><a href="structdohaddr.html#aa08307119b424410ce83c70876eede24">dohaddr::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00077">doh.h:77</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="anyauth_8d_html_a076c285cdc160cc073b20f7cf28ef85f"><div class="ttname"><a href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response headers</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="form_8d_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00048">form.d:48</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="share_8c_html_a85cdae024464c8d7e96a232797028d72"><div class="ttname"><a href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a></div><div class="ttdeci">CURLSHcode Curl_share_unlock(struct Curl_easy *data, curl_lock_data type)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00244">share.c:244</a></div></div>
<div class="ttc" id="structdohentry_html_a544482775819dec08b7ad1f3989484b4"><div class="ttname"><a href="structdohentry.html#a544482775819dec08b7ad1f3989484b4">dohentry::cname</a></div><div class="ttdeci">struct cnamestore cname[DOH_MAX_CNAME]</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00089">doh.h:89</a></div></div>
<div class="ttc" id="curl_8h_html_a83d34123b66749720352af4bcb17a8e4"><div class="ttname"><a href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a></div><div class="ttdeci">#define CURLPROTO_HTTPS</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00866">curl.h:866</a></div></div>
<div class="ttc" id="doh_8c_html_a9cc84b120d830f184e7249db81ed1736"><div class="ttname"><a href="doh_8c.html#a9cc84b120d830f184e7249db81ed1736">DNS_CLASS_IN</a></div><div class="ttdeci">#define DNS_CLASS_IN</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00041">doh.c:41</a></div></div>
<div class="ttc" id="struct_user_defined_html_a78dbbecb7d0e8f0ea66e971608a301f8"><div class="ttname"><a href="struct_user_defined.html#a78dbbecb7d0e8f0ea66e971608a301f8">UserDefined::dohfor</a></div><div class="ttdeci">struct Curl_easy * dohfor</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01731">urldata.h:1731</a></div></div>
<div class="ttc" id="doh_8c_html_ad8f1d42272f3e981eb0f6a3cb71e1aa8"><div class="ttname"><a href="doh_8c.html#ad8f1d42272f3e981eb0f6a3cb71e1aa8">Curl_doh</a></div><div class="ttdeci">Curl_addrinfo * Curl_doh(struct connectdata *conn, const char *hostname, int port, int *waitp)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00270">doh.c:270</a></div></div>
<div class="ttc" id="struct_user_defined_html_a00e1b9073bd998d304d2da328625ad4e"><div class="ttname"><a href="struct_user_defined.html#a00e1b9073bd998d304d2da328625ad4e">UserDefined::fmultidone</a></div><div class="ttdeci">multidone_func fmultidone</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01730">urldata.h:1730</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_ab72a36e22c2c7cb539df0351f59359ca"><div class="ttname"><a href="struct_curl__addrinfo.html#ab72a36e22c2c7cb539df0351f59359ca">Curl_addrinfo::ai_addr</a></div><div class="ttdeci">struct sockaddr * ai_addr</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00058">curl_addrinfo.h:58</a></div></div>
<div class="ttc" id="struct_curl__dns__entry_html"><div class="ttname"><a href="struct_curl__dns__entry.html">Curl_dns_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="hostip_8h_source.html#l00066">hostip.h:66</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a8d1cc35200409830f3455b1161dd83de"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8d1cc35200409830f3455b1161dd83de">DOH_DNS_RDATA_LEN</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00051">doh.h:51</a></div></div>
<div class="ttc" id="connect_8c_html_aed32c0fb99c80a40c097c98a3eb03c74"><div class="ttname"><a href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a></div><div class="ttdeci">timediff_t Curl_timeleft(struct Curl_easy *data, struct curltime *nowp, bool duringconnect)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8c_source.html#l00184">connect.c:184</a></div></div>
<div class="ttc" id="curl_8h_html_a7ea20d9a213c806f82446bed893f423f"><div class="ttname"><a href="curl_8h.html#a7ea20d9a213c806f82446bed893f423f">curl_slist_append</a></div><div class="ttdeci">CURL_EXTERN struct curl_slist * curl_slist_append(struct curl_slist *, const char *)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00089">slist.c:89</a></div></div>
<div class="ttc" id="structa_html"><div class="ttname"><a href="structa.html">a</a></div><div class="ttdef"><b>Definition:</b> <a href="unit1323_8c_source.html#l00036">unit1323.c:36</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_abadfae881af6425a56ff823ef0bb1a70"><div class="ttname"><a href="struct_curl__addrinfo.html#abadfae881af6425a56ff823ef0bb1a70">Curl_addrinfo::ai_family</a></div><div class="ttdeci">int ai_family</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00053">curl_addrinfo.h:53</a></div></div>
<div class="ttc" id="strdup_8c_html_a3a3f98ad97deebcb223f165b377f3879"><div class="ttname"><a href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a></div><div class="ttdeci">void * Curl_saferealloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="strdup_8c_source.html#l00093">strdup.c:93</a></div></div>
<div class="ttc" id="easy_8h_html_a7acd7812b672df9e378050fab7c732aa"><div class="ttname"><a href="easy_8h.html#a7acd7812b672df9e378050fab7c732aa">curl_easy_cleanup</a></div><div class="ttdeci">CURL_EXTERN void curl_easy_cleanup(CURL *curl)</div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a604d41c416646499acf73eaa82a997c2"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a604d41c416646499acf73eaa82a997c2">DOH_DNS_BAD_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00057">doh.h:57</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="structcnamestore_html_a7be7a1969f9ad4bf300243543623467f"><div class="ttname"><a href="structcnamestore.html#a7be7a1969f9ad4bf300243543623467f">cnamestore::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00071">doh.h:71</a></div></div>
<div class="ttc" id="doh_8c_html_ae7b7f8e58ab02795c6e4286dd1a00467"><div class="ttname"><a href="doh_8c.html#ae7b7f8e58ab02795c6e4286dd1a00467">Curl_doh_is_resolved</a></div><div class="ttdeci">CURLcode Curl_doh_is_resolved(struct connectdata *conn, struct Curl_dns_entry **dnsp)</div><div class="ttdef"><b>Definition:</b> <a href="doh_8c_source.html#l00817">doh.c:817</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8h_html_acc42076253600be964e110149b458971"><div class="ttname"><a href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971">errors</a></div><div class="ttdeci">errors</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00036">MQTTPacket.h:36</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="strdup_8h_html"><div class="ttname"><a href="strdup_8h.html">strdup.h</a></div></div>
<div class="ttc" id="struct_curl__easy_html_abcc5aa61af150adc1388b1a3492c2599"><div class="ttname"><a href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">Curl_easy::set</a></div><div class="ttdeci">struct UserDefined set</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01788">urldata.h:1788</a></div></div>
<div class="ttc" id="multiif_8h_html"><div class="ttname"><a href="multiif_8h.html">multiif.h</a></div></div>
<div class="ttc" id="structdnsprobe_html"><div class="ttname"><a href="structdnsprobe.html">dnsprobe</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00510">urldata.h:510</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_u_r_l_8h_html_ad62c324cbfcc92532598792c6d0f6494"><div class="ttname"><a href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a></div><div class="ttdeci">uint8_t url[16]</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_u_r_l_8h_source.html#l00037">BLEEddystoneURL.h:37</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a575217c636dcceef11f3b811e172f862"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a575217c636dcceef11f3b811e172f862">DOH_OUT_OF_MEM</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00050">doh.h:50</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="unit1652_8c_html_a1d19b0eef3b3acd31be88886a0277c2e"><div class="ttname"><a href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a></div><div class="ttdeci">memset(input, '\0', sizeof(input))</div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="multi_8h_html_abd5c8bf83688f15099b512846f6efc5a"><div class="ttname"><a href="multi_8h.html#abd5c8bf83688f15099b512846f6efc5a">curl_multi_remove_handle</a></div><div class="ttdeci">CURL_EXTERN CURLMcode curl_multi_remove_handle(CURLM *multi_handle, CURL *curl_handle)</div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="doh_8h_html_a272ac0e1ff303e2ee8e10e5149dc96d1"><div class="ttname"><a href="doh_8h.html#a272ac0e1ff303e2ee8e10e5149dc96d1">DOH_MAX_ADDR</a></div><div class="ttdeci">#define DOH_MAX_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00067">doh.h:67</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a46c757652941bc2847a41c3e45fd79d6"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a46c757652941bc2847a41c3e45fd79d6">DOH_NO_CONTENT</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00056">doh.h:56</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a1b38a50d7c5a22552a12393996e5910d">DOH_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00045">doh.h:45</a></div></div>
<div class="ttc" id="structdohdata_html"><div class="ttname"><a href="structdohdata.html">dohdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00518">urldata.h:518</a></div></div>
<div class="ttc" id="structconnectdata_html_ad0fdd504366b349123252aa698625fd9"><div class="ttname"><a href="structconnectdata.html#ad0fdd504366b349123252aa698625fd9">connectdata::ip_version</a></div><div class="ttdeci">long ip_version</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00908">urldata.h:908</a></div></div>
<div class="ttc" id="hostip_8c_html_afab64c7c46db37643d596002f4a0c825"><div class="ttname"><a href="hostip_8c.html#afab64c7c46db37643d596002f4a0c825">Curl_cache_addr</a></div><div class="ttdeci">struct Curl_dns_entry * Curl_cache_addr(struct Curl_easy *data, Curl_addrinfo *addr, const char *hostname, int port)</div><div class="ttdef"><b>Definition:</b> <a href="hostip_8c_source.html#l00445">hostip.c:445</a></div></div>
<div class="ttc" id="multi_8h_html_a5ad3a82c3de54ee92ce4ddb052d18036"><div class="ttname"><a href="multi_8h.html#a5ad3a82c3de54ee92ce4ddb052d18036">CURLM</a></div><div class="ttdeci">void CURLM</div><div class="ttdef"><b>Definition:</b> <a href="multi_8h_source.html#l00058">multi.h:58</a></div></div>
<div class="ttc" id="structconnectdata_html_a81b59f48e7176a865c7459ce844c45dd"><div class="ttname"><a href="structconnectdata.html#a81b59f48e7176a865c7459ce844c45dd">connectdata::async</a></div><div class="ttdeci">struct Curl_async async</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00995">urldata.h:995</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html_a5cc95970e9ca4cebf88338c7f0ddd0a5"><div class="ttname"><a href="struct_curl__addrinfo.html#a5cc95970e9ca4cebf88338c7f0ddd0a5">Curl_addrinfo::ai_socktype</a></div><div class="ttdeci">int ai_socktype</div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00054">curl_addrinfo.h:54</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="doh_8h_html_afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653"><div class="ttname"><a href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad6f2a7e9311cfa3f2b9f4af3a0f19653">DNS_TYPE_AAAA</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00064">doh.h:64</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="structdohresponse_html_a909b871f0cebbfd08ee722438ed50eb8"><div class="ttname"><a href="structdohresponse.html#a909b871f0cebbfd08ee722438ed50eb8">dohresponse::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00506">urldata.h:506</a></div></div>
<div class="ttc" id="structdohresponse_html"><div class="ttname"><a href="structdohresponse.html">dohresponse</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00504">urldata.h:504</a></div></div>
<div class="ttc" id="share_8c_html_a5dcfa53b653176b92395464a33b509cb"><div class="ttname"><a href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a></div><div class="ttdeci">CURLSHcode Curl_share_lock(struct Curl_easy *data, curl_lock_data type, curl_lock_access accesstype)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00226">share.c:226</a></div></div>
<div class="ttc" id="struct_curl__addrinfo_html"><div class="ttname"><a href="struct_curl__addrinfo.html">Curl_addrinfo</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__addrinfo_8h_source.html#l00051">curl_addrinfo.h:51</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32a8f885272fb16762effeb24cb6b1529bd">DOH_DNS_OUT_OF_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00047">doh.h:47</a></div></div>
<div class="ttc" id="structdohaddr_html_ac0c941745e1b8f8274bd77c11370260e"><div class="ttname"><a href="structdohaddr.html#ac0c941745e1b8f8274bd77c11370260e">dohaddr::ip</a></div><div class="ttdeci">union dohaddr::@20 ip</div></div>
<div class="ttc" id="struct_curl__async_html_a0550efdecd5238b2be25262b37c88b7e"><div class="ttname"><a href="struct_curl__async.html#a0550efdecd5238b2be25262b37c88b7e">Curl_async::hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00472">urldata.h:472</a></div></div>
<div class="ttc" id="multi_8c_html_a759a3f675165554a5f5d6e784afa7fe0"><div class="ttname"><a href="multi_8c.html#a759a3f675165554a5f5d6e784afa7fe0">Curl_expire</a></div><div class="ttdeci">void Curl_expire(struct Curl_easy *data, time_t milli, expire_id id)</div><div class="ttdef"><b>Definition:</b> <a href="multi_8c_source.html#l02994">multi.c:2994</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="url_8c_html_a557d55610156477514fe6dc5a178789e"><div class="ttname"><a href="url_8c.html#a557d55610156477514fe6dc5a178789e">Curl_close</a></div><div class="ttdeci">CURLcode Curl_close(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="url_8c_source.html#l00319">url.c:319</a></div></div>
<div class="ttc" id="doh_8h_html_afd3ed70ffb4bc5ddf0eeedb30370bc76ad412bbe358a397a2512f9c395fd5c37e"><div class="ttname"><a href="doh_8h.html#afd3ed70ffb4bc5ddf0eeedb30370bc76ad412bbe358a397a2512f9c395fd5c37e">DNS_TYPE_CNAME</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00063">doh.h:63</a></div></div>
<div class="ttc" id="structdohaddr_html_ac7b66a4b139db5e3f94d29c5887f128b"><div class="ttname"><a href="structdohaddr.html#ac7b66a4b139db5e3f94d29c5887f128b">dohaddr::v4</a></div><div class="ttdeci">unsigned char v4[4]</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00079">doh.h:79</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="doh_8h_html_a972158dd2d2c43e4b68faf1dc2a71b32ae362e8571a74c5faba9fb04cd6adcadb"><div class="ttname"><a href="doh_8h.html#a972158dd2d2c43e4b68faf1dc2a71b32ae362e8571a74c5faba9fb04cd6adcadb">DOH_DNS_MALFORMAT</a></div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00052">doh.h:52</a></div></div>
<div class="ttc" id="doh_8h_html_a641dafdadc7102f7031b9ebec58340f3"><div class="ttname"><a href="doh_8h.html#a641dafdadc7102f7031b9ebec58340f3">DOH_MAX_CNAME</a></div><div class="ttdeci">#define DOH_MAX_CNAME</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00068">doh.h:68</a></div></div>
<div class="ttc" id="curl_8h_html_a1feaa896e865ad01f32cc46f6f8c72f5"><div class="ttname"><a href="curl_8h.html#a1feaa896e865ad01f32cc46f6f8c72f5">curl_easy_strerror</a></div><div class="ttdeci">CURL_EXTERN const char * curl_easy_strerror(CURLcode)</div><div class="ttdef"><b>Definition:</b> <a href="strerror_8c_source.html#l00057">strerror.c:57</a></div></div>
<div class="ttc" id="curl_8h_html_a3a28c84e40db0ef30859b680281c9d36"><div class="ttname"><a href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a></div><div class="ttdeci">CURL_EXTERN void curl_slist_free_all(struct curl_slist *)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00129">slist.c:129</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_af89f74b4f46628d93e3cc829fcd69801"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#af89f74b4f46628d93e3cc829fcd69801">curl_socklen_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_SOCKLEN_T curl_socklen_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00436">system.h:436</a></div></div>
<div class="ttc" id="url_8h_html"><div class="ttname"><a href="url_8h.html">url.h</a></div></div>
<div class="ttc" id="get_8d_html_a38b0ef81b65f2aee282c8c217a123176"><div class="ttname"><a href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a></div><div class="ttdeci">Long this option will make all data specified with data</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="noproxy_8d_html_a76bbcca5c6576b1086f83570943ed989"><div class="ttname"><a href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a></div><div class="ttdeci">Long if one is specified.The only wildcard is a single which matches all and effectively disables the proxy.Each name in this list is matched as either a domain which contains the hostname</div><div class="ttdef"><b>Definition:</b> <a href="noproxy_8d_source.html#l00006">noproxy.d:6</a></div></div>
<div class="ttc" id="structdohentry_html_a0296bc0b0d8cbf477e73cfd5b3dbace2"><div class="ttname"><a href="structdohentry.html#a0296bc0b0d8cbf477e73cfd5b3dbace2">dohentry::ttl</a></div><div class="ttdeci">unsigned int ttl</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00085">doh.h:85</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
<div class="ttc" id="timeval_8h_html_aeb19832fd3e7f11c8d047d6824300e87"><div class="ttname"><a href="timeval_8h.html#aeb19832fd3e7f11c8d047d6824300e87">timediff_t</a></div><div class="ttdeci">int timediff_t</div><div class="ttdef"><b>Definition:</b> <a href="timeval_8h_source.html#l00028">timeval.h:28</a></div></div>
<div class="ttc" id="doh_8h_html"><div class="ttname"><a href="doh_8h.html">doh.h</a></div></div>
<div class="ttc" id="structdohentry_html_a3cac8ba2181e7227beeee462cc0bc32d"><div class="ttname"><a href="structdohentry.html#a3cac8ba2181e7227beeee462cc0bc32d">dohentry::numaddr</a></div><div class="ttdeci">int numaddr</div><div class="ttdef"><b>Definition:</b> <a href="doh_8h_source.html#l00086">doh.h:86</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
<div class="ttc" id="curl_8h_html_abc5c98fcc1211af2b80116dd6e0a035da153a446054f34c6bcbca7a690209f284"><div class="ttname"><a href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da153a446054f34c6bcbca7a690209f284">CURL_HTTP_VERSION_2TLS</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01928">curl.h:1928</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="doh_8c.html">doh.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
