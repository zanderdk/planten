<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/vtls/gskit.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('gskit_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">gskit.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gskit_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef USE_GSKIT</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;gskssl.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;qsoasync.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* Some symbols are undefined/unsupported on OS400 versions &lt; V7R1. */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifndef GSK_SSL_EXTN_SERVERNAME_REQUEST</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#define GSK_SSL_EXTN_SERVERNAME_REQUEST         230</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#ifndef GSK_TLSV10_CIPHER_SPECS</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#define GSK_TLSV10_CIPHER_SPECS                 236</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifndef GSK_TLSV11_CIPHER_SPECS</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#define GSK_TLSV11_CIPHER_SPECS                 237</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#ifndef GSK_TLSV12_CIPHER_SPECS</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define GSK_TLSV12_CIPHER_SPECS                 238</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifndef GSK_PROTOCOL_TLSV11</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#define GSK_PROTOCOL_TLSV11                     437</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifndef GSK_PROTOCOL_TLSV12</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#define GSK_PROTOCOL_TLSV12                     438</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#ifndef GSK_FALSE</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#define GSK_FALSE                               0</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifndef GSK_TRUE</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#define GSK_TRUE                                1</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gskit_8h.html">gskit.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtls_8h.html">vtls.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connect_8h.html">connect.h</a>&quot;</span> <span class="comment">/* for the connect timeout */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="select_8h.html">select.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x509asn1_8h.html">x509asn1.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/* The last #include file should be: */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/* Directions. */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#define SOS_READ        0x01</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#define SOS_WRITE       0x02</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/* SSL version flags. */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_SSLV2     0</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_SSLV2_MASK        (1 &lt;&lt; CURL_GSKPROTO_SSLV2)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_SSLV3     1</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_SSLV3_MASK        (1 &lt;&lt; CURL_GSKPROTO_SSLV3)</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV10    2</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV10_MASK        (1 &lt;&lt; CURL_GSKPROTO_TLSV10)</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV11    3</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV11_MASK        (1 &lt;&lt; CURL_GSKPROTO_TLSV11)</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV12    4</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_TLSV12_MASK        (1 &lt;&lt; CURL_GSKPROTO_TLSV12)</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#define CURL_GSKPROTO_LAST      5</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">struct </span>ssl_backend_data {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  gsk_handle handle;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> iocport;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> localfd;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> remotefd;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;};</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#define BACKEND connssl-&gt;backend</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">/* Supported ciphers. */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>;            <span class="comment">/* Cipher name. */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *gsktoken;        <span class="comment">/* Corresponding token for GSKit String. */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> versions;       <span class="comment">/* SSL version flags. */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}  gskit_cipher;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> gskit_cipher  ciphertable[] = {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  { <span class="stringliteral">&quot;null-md5&quot;</span>,         <span class="stringliteral">&quot;01&quot;</span>,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  { <span class="stringliteral">&quot;null-sha&quot;</span>,         <span class="stringliteral">&quot;02&quot;</span>,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  { <span class="stringliteral">&quot;exp-rc4-md5&quot;</span>,      <span class="stringliteral">&quot;03&quot;</span>,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK },</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  { <span class="stringliteral">&quot;rc4-md5&quot;</span>,          <span class="stringliteral">&quot;04&quot;</span>,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  { <span class="stringliteral">&quot;rc4-sha&quot;</span>,          <span class="stringliteral">&quot;05&quot;</span>,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  { <span class="stringliteral">&quot;exp-rc2-cbc-md5&quot;</span>,  <span class="stringliteral">&quot;06&quot;</span>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK },</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  { <span class="stringliteral">&quot;exp-des-cbc-sha&quot;</span>,  <span class="stringliteral">&quot;09&quot;</span>,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      CURL_GSKPROTO_TLSV11_MASK },</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  { <span class="stringliteral">&quot;des-cbc3-sha&quot;</span>,     <span class="stringliteral">&quot;0A&quot;</span>,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  { <span class="stringliteral">&quot;aes128-sha&quot;</span>,       <span class="stringliteral">&quot;2F&quot;</span>,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      CURL_GSKPROTO_TLSV10_MASK | CURL_GSKPROTO_TLSV11_MASK |</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  { <span class="stringliteral">&quot;aes256-sha&quot;</span>,       <span class="stringliteral">&quot;35&quot;</span>,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      CURL_GSKPROTO_TLSV10_MASK | CURL_GSKPROTO_TLSV11_MASK |</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  { <span class="stringliteral">&quot;null-sha256&quot;</span>,      <span class="stringliteral">&quot;3B&quot;</span>,   CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  { <span class="stringliteral">&quot;aes128-sha256&quot;</span>,    <span class="stringliteral">&quot;3C&quot;</span>,   CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  { <span class="stringliteral">&quot;aes256-sha256&quot;</span>,    <span class="stringliteral">&quot;3D&quot;</span>,   CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  { <span class="stringliteral">&quot;aes128-gcm-sha256&quot;</span>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="stringliteral">&quot;9C&quot;</span>,   CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  { <span class="stringliteral">&quot;aes256-gcm-sha384&quot;</span>,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        <span class="stringliteral">&quot;9D&quot;</span>,   CURL_GSKPROTO_TLSV12_MASK },</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  { <span class="stringliteral">&quot;rc4-md5&quot;</span>,          <span class="stringliteral">&quot;1&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  { <span class="stringliteral">&quot;exp-rc4-md5&quot;</span>,      <span class="stringliteral">&quot;2&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  { <span class="stringliteral">&quot;rc2-md5&quot;</span>,          <span class="stringliteral">&quot;3&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  { <span class="stringliteral">&quot;exp-rc2-md5&quot;</span>,      <span class="stringliteral">&quot;4&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  { <span class="stringliteral">&quot;des-cbc-md5&quot;</span>,      <span class="stringliteral">&quot;6&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  { <span class="stringliteral">&quot;des-cbc3-md5&quot;</span>,     <span class="stringliteral">&quot;7&quot;</span>,    CURL_GSKPROTO_SSLV2_MASK },</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  { (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL, 0       }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;};</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> is_separator(<span class="keywordtype">char</span> c)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">/* Return whether character is a cipher list separator. */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">switch</span>(c) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>:</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;\t&#39;</span>:</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;:&#39;</span>:</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;,&#39;</span>:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;;&#39;</span>:</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gskit_status(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *procname, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> defcode)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">/* Process GSKit status and map it to a CURLcode. */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">case</span> GSK_OS400_ASYNCHRONOUS_SOC_INIT:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">case</span> GSK_KEYRING_OPEN_ERROR:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">case</span> GSK_OS400_ERROR_NO_ACCESS:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8e6bdaad09a5404d9b01acaa93e1a797">CURLE_SSL_CACERT_BADFILE</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">case</span> GSK_INSUFFICIENT_STORAGE:</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_BAD_V2_CIPHER:</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_BAD_V3_CIPHER:</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_NO_CIPHERS:</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">case</span> GSK_OS400_ERROR_NOT_TRUSTED_ROOT:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_CERT_VALIDATION:</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a746b63c8123f5bdc10a916f720f2c9e5">CURLE_PEER_FAILED_VERIFICATION</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">case</span> GSK_OS400_ERROR_TIMED_OUT:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">case</span> GSK_WOULD_BLOCK:</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">case</span> GSK_OS400_ERROR_NOT_REGISTERED:</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_IO:</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">switch</span>(errno) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="config-win32ce_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>:</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;%s I/O error: %s&quot;</span>, procname, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;%s: %s&quot;</span>, procname, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">return</span> defcode;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> set_enum(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, gsk_handle h,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                GSK_ENUM_ID <span class="keywordtype">id</span>, GSK_ENUM_VALUE <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="keywordtype">bool</span> unsupported_ok)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a0ee195fc513184d659250d3148c1753d">gsk_attribute_set_enum</a>(h, <span class="keywordtype">id</span>, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_IO:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_enum() I/O error: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">case</span> GSK_ATTRIBUTE_INVALID_ID:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span>(unsupported_ok)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_enum(): %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> set_buffer(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, gsk_handle h,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        GSK_BUF_ID <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">bool</span> unsupported_ok)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#abd09be3337affa882c103238974af8b6">gsk_attribute_set_buffer</a>(h, <span class="keywordtype">id</span>, <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, 0);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_IO:</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_buffer() I/O error: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">case</span> GSK_ATTRIBUTE_INVALID_ID:</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span>(unsupported_ok)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_buffer(): %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> set_numeric(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                            gsk_handle h, GSK_NUM_ID <span class="keywordtype">id</span>, <span class="keywordtype">int</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#ad1b8bf93dc82e064d13549441789860c">gsk_attribute_set_numeric_value</a>(h, <span class="keywordtype">id</span>, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_IO:</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_numeric_value() I/O error: %s&quot;</span>,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_numeric_value(): %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> set_callback(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                             gsk_handle h, GSK_CALLBACK_ID <span class="keywordtype">id</span>, <span class="keywordtype">void</span> *info)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#adb961dfa39eafca6052016a9173e4ae8">gsk_attribute_set_callback</a>(h, <span class="keywordtype">id</span>, info);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">case</span> GSK_ERROR_IO:</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_callback() I/O error: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_attribute_set_callback(): %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> set_ciphers(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                        gsk_handle h, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *protoflags)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *cipherlist = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(cipher_list);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *clp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keyword">const</span> gskit_cipher *ctp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">int</span> l;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">bool</span> unsupported;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">struct </span>{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  } ciphers[CURL_GSKPROTO_LAST];</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">/* Compile cipher list into GSKit-compatible cipher lists. */</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span>(!cipherlist)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">while</span>(is_separator(*cipherlist))     <span class="comment">/* Skip initial separators. */</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    cipherlist++;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span>(!*cipherlist)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">/* We allocate GSKit buffers of the same size as the input string: since</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">     GSKit tokens are always shorter than their cipher names, allocated buffers</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">     will always be large enough to accommodate the result. */</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  l = strlen(cipherlist) + 1;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>((<span class="keywordtype">char</span> *) ciphers, 0, <span class="keyword">sizeof</span>(ciphers));</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; CURL_GSKPROTO_LAST; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].buf = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(l);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span>(!ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">while</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>--)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].ptr = ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].buf;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    *ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].ptr = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">/* Process each cipher in input string. */</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  unsupported = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span>(clp = cipherlist; *cipherlist &amp;&amp; !is_separator(*cipherlist);)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      cipherlist++;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    l = cipherlist - clp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span>(!l)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* Search the cipher in our table. */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span>(ctp = ciphertable; ctp-&gt;name; ctp++)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(ctp-&gt;name, clp, l) &amp;&amp; !ctp-&gt;name[l])</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span>(!ctp-&gt;name) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Unknown cipher %.*s&quot;</span>, l, clp);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      unsupported |= !(ctp-&gt;versions &amp; (CURL_GSKPROTO_SSLV2_MASK |</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        CURL_GSKPROTO_SSLV3_MASK | CURL_GSKPROTO_TLSV10_MASK));</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; CURL_GSKPROTO_LAST; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span>(ctp-&gt;versions &amp; (1 &lt;&lt; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          strcpy(ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, ctp-&gt;gsktoken);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].ptr += strlen(ctp-&gt;gsktoken);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="comment">/* Advance to next cipher name or end of string. */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">while</span>(is_separator(*cipherlist))</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      cipherlist++;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">/* Disable protocols with empty cipher lists. */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; CURL_GSKPROTO_LAST; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>(!(*protoflags &amp; (1 &lt;&lt; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)) || !ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[0]) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      *protoflags &amp;= ~(1 &lt;&lt; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">/* Try to set-up TLSv1.1 and TLSv2.1 ciphers. */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span>(*protoflags &amp; CURL_GSKPROTO_TLSV11_MASK) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_TLSV11_CIPHER_SPECS,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        ciphers[CURL_GSKPROTO_TLSV11].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">if</span>(unsupported) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;TLSv1.1-only ciphers are not yet supported&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; (*protoflags &amp; CURL_GSKPROTO_TLSV12_MASK)) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_TLSV12_CIPHER_SPECS,</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        ciphers[CURL_GSKPROTO_TLSV12].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span>(unsupported) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;TLSv1.2-only ciphers are not yet supported&quot;</span>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">/* Try to set-up TLSv1.0 ciphers. If not successful, concatenate them to</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">     the SSLv3 ciphers. OS/400 prior to version 7.1 will understand it. */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; (*protoflags &amp; CURL_GSKPROTO_TLSV10_MASK)) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_TLSV10_CIPHER_SPECS,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        ciphers[CURL_GSKPROTO_TLSV10].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      strcpy(ciphers[CURL_GSKPROTO_SSLV3].<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>,</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;             ciphers[CURL_GSKPROTO_TLSV10].<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">/* Set-up other ciphers. */</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; (*protoflags &amp; CURL_GSKPROTO_SSLV3_MASK))</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_V3_CIPHER_SPECS,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        ciphers[CURL_GSKPROTO_SSLV3].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; (*protoflags &amp; CURL_GSKPROTO_SSLV2_MASK))</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_V2_CIPHER_SPECS,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                        ciphers[CURL_GSKPROTO_SSLV2].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">/* Clean-up. */</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; CURL_GSKPROTO_LAST; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ciphers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Curl_gskit_init(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">/* No initialisation needed. */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Curl_gskit_cleanup(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;{</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">/* Nothing to do. */</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> init_environment(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                 gsk_handle *envir, <span class="keyword">const</span> <span class="keywordtype">char</span> *appid,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *label,</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *password)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  gsk_handle h;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">/* Creates the GSKit environment. */</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a6f372f1f5069417ad131c8975b96546e">gsk_environment_open</a>(&amp;h);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">case</span> GSK_INSUFFICIENT_STORAGE:</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;gsk_environment_open(): %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, h, GSK_SESSION_TYPE, GSK_CLIENT_SESSION, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; appid)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_OS400_APPLICATION_ID, appid, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_KEYRING_FILE, <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; label)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_KEYRING_LABEL, label, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; password)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, h, GSK_KEYRING_PW, password, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">/* Locate CAs, Client certificate and key according to our settings.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">       Note: this call may be blocking for some tenths of seconds. */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>, <a class="code" href="setup-os400_8h.html#a33e1497e4a96eef1f196bc3469214e21">gsk_environment_init</a>(h),</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                          <span class="stringliteral">&quot;gsk_environment_init()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      *envir = h;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">/* Error: rollback. */</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="setup-os400_8h.html#a25583bcffb803a4e26a377c8848c5503">gsk_environment_close</a>(&amp;h);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> cancel_async_handshake(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  Qso_OverlappedIO_t cstat;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span>(QsoCancelOperation(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex], 0) &gt; 0)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    QsoWaitForIOCompletion(BACKEND-&gt;iocport, &amp;cstat, (<span class="keyword">struct</span> <a class="code" href="structtimeval.html">timeval</a> *) NULL);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> close_async_handshake(<span class="keyword">struct</span> <a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  QsoDestroyIOCompletionPort(BACKEND-&gt;iocport);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  BACKEND-&gt;iocport = -1;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">/* SSL over SSL</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> * Problems:</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"> * 1) GSKit can only perform SSL on an AF_INET or AF_INET6 stream socket. To</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> *    pipe an SSL stream into another, it is therefore needed to have a pair</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> *    of such communicating sockets and handle the pipelining explicitly.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> * 2) OS/400 socketpair() is only implemented for domain AF_UNIX, thus cannot</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"> *    be used to produce the pipeline.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"> * The solution is to simulate socketpair() for AF_INET with low-level API</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"> *    listen(), bind() and connect().</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;inetsocketpair(<span class="keywordtype">int</span> sv[2])</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">int</span> lfd;      <span class="comment">/* Listening socket. */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">int</span> sfd;      <span class="comment">/* Server socket. */</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">int</span> cfd;      <span class="comment">/* Client socket. */</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keyword">struct </span>sockaddr_in addr1;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">struct </span>sockaddr_in addr2;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">/* Create listening socket on a local dynamic port. */</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  lfd = socket(AF_INET, SOCK_STREAM, 0);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">if</span>(lfd &lt; 0)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>((<span class="keywordtype">char</span> *) &amp;addr1, 0, <span class="keyword">sizeof</span>(addr1));</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  addr1.sin_family = AF_INET;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  addr1.sin_addr.s_addr = htonl(INADDR_LOOPBACK);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  addr1.sin_port = 0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="setup-os400_8h.html#af65cc88d9ccb2274b94e0025d25d965f">bind</a>(lfd, (<span class="keyword">struct</span> sockaddr *) &amp;addr1, <span class="keyword">sizeof</span>(addr1)) ||</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;     listen(lfd, 2) &lt; 0) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    close(lfd);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">/* Get the allocated port. */</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <span class="keyword">sizeof</span>(addr1);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">if</span>(getsockname(lfd, (<span class="keyword">struct</span> sockaddr *) &amp;addr1, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) &lt; 0) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    close(lfd);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">/* Create the client socket. */</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  cfd = socket(AF_INET, SOCK_STREAM, 0);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span>(cfd &lt; 0) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    close(lfd);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">/* Request unblocking connection to the listening socket. */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a>(cfd, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a>(cfd, (<span class="keyword">struct</span> sockaddr *) &amp;addr1, <span class="keyword">sizeof</span>(addr1)) &lt; 0 &amp;&amp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;     errno != EINPROGRESS) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    close(lfd);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    close(cfd);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">/* Get the client dynamic port for intrusion check below. */</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <span class="keyword">sizeof</span>(addr2);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span>(getsockname(cfd, (<span class="keyword">struct</span> sockaddr *) &amp;addr2, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) &lt; 0) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    close(lfd);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    close(cfd);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">/* Accept the incoming connection and get the server socket. */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a>(lfd, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <span class="keyword">sizeof</span>(addr1);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    sfd = accept(lfd, (<span class="keyword">struct</span> sockaddr *) &amp;addr1, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span>(sfd &lt; 0) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      close(lfd);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      close(cfd);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">/* Check for possible intrusion from an external process. */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span>(addr1.sin_addr.s_addr == addr2.sin_addr.s_addr &amp;&amp;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       addr1.sin_port == addr2.sin_port)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">/* Intrusion: reject incoming connection. */</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    close(sfd);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">/* Done, return sockets and succeed. */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  close(lfd);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a>(cfd, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  sv[0] = cfd;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  sv[1] = sfd;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> pipe_ssloverssl(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex,</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                           <span class="keywordtype">int</span> directions)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;{</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connproxyssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex];</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  fd_set fds_read;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  fd_set fds_write;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">int</span> m;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtimeval.html">timeval</a> tv = {0, 0};</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[<a class="code" href="curl_8h.html#a0417440dcb84270d40959fa70aec6f86">CURL_MAX_WRITE_SIZE</a>];</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span>(!connssl-&gt;<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a> || !connproxyssl-&gt;<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a>)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">return</span> 0;   <span class="comment">/* No SSL over SSL: OK. */</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  FD_ZERO(&amp;fds_read);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  FD_ZERO(&amp;fds_write);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = -1;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span>(directions &amp; SOS_READ) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    FD_SET(BACKEND-&gt;remotefd, &amp;fds_write);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = BACKEND-&gt;remotefd;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span>(directions &amp; SOS_WRITE) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    FD_SET(BACKEND-&gt;remotefd, &amp;fds_read);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = BACKEND-&gt;remotefd;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    FD_SET(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex], &amp;fds_write);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span>(n &lt; conn-&gt;sock[sockindex])</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = select(<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> + 1, &amp;fds_read, &amp;fds_write, NULL, &amp;tv);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 0)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">return</span> -1;  <span class="comment">/* Select error. */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span>(FD_ISSET(BACKEND-&gt;remotefd, &amp;fds_write)) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">/* Try getting data from HTTPS proxy and pipe it upstream. */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = 0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = <a class="code" href="setup-os400_8h.html#a87bcee10709404af37dedbbc932f48f2">gsk_secure_soc_read</a>(connproxyssl-&gt;backend-&gt;handle,</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                            <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keyword">sizeof</span>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>), &amp;<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">case</span> GSK_OK:</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = write(BACKEND-&gt;remotefd, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 0)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        ret = 1;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">case</span> GSK_OS400_ERROR_TIMED_OUT:</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">case</span> GSK_WOULD_BLOCK:</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span>(FD_ISSET(BACKEND-&gt;remotefd, &amp;fds_read) &amp;&amp;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     FD_ISSET(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex], &amp;fds_write)) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">/* Pipe data to HTTPS proxy. */</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = read(BACKEND-&gt;remotefd, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keyword">sizeof</span>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>));</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> &lt; 0)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>) {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = <a class="code" href="setup-os400_8h.html#a54f0cfd0013cabd4828f0c6be9b19de3">gsk_secure_soc_write</a>(connproxyssl-&gt;backend-&gt;handle, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>, &amp;m);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> != GSK_OK || <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> != m)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      ret = 1;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">return</span> ret;  <span class="comment">/* OK */</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> close_one(<span class="keyword">struct</span> <a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                      <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">if</span>(BACKEND-&gt;handle) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    gskit_status(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <a class="code" href="setup-os400_8h.html#a8bbabcbcbfd5723279a43f8c53ff3e78">gsk_secure_soc_close</a>(&amp;BACKEND-&gt;handle),</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;              <span class="stringliteral">&quot;gsk_secure_soc_close()&quot;</span>, 0);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">/* Last chance to drain output. */</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">while</span>(pipe_ssloverssl(conn, sockindex, SOS_WRITE) &gt; 0)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      ;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    BACKEND-&gt;handle = (gsk_handle) NULL;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span>(BACKEND-&gt;localfd &gt;= 0) {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      close(BACKEND-&gt;localfd);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      BACKEND-&gt;localfd = -1;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">if</span>(BACKEND-&gt;remotefd &gt;= 0) {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      close(BACKEND-&gt;remotefd);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      BACKEND-&gt;remotefd = -1;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">if</span>(BACKEND-&gt;iocport &gt;= 0)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    close_async_handshake(connssl);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keyword">static</span> <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> gskit_send(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">void</span> *mem, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> *curlcode)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;{</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> cc = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="url_8d.html#a1bc9666de113dffcfaf5d5c84eac6469">written</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span>(pipe_ssloverssl(conn, sockindex, SOS_WRITE) &gt;= 0) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    cc = gskit_status(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                      <a class="code" href="setup-os400_8h.html#a54f0cfd0013cabd4828f0c6be9b19de3">gsk_secure_soc_write</a>(BACKEND-&gt;handle,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                           (<span class="keywordtype">char</span> *) mem, (<span class="keywordtype">int</span>) <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, &amp;<a class="code" href="url_8d.html#a1bc9666de113dffcfaf5d5c84eac6469">written</a>),</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                      <span class="stringliteral">&quot;gsk_secure_soc_write()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">if</span>(cc == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span>(pipe_ssloverssl(conn, sockindex, SOS_WRITE) &lt; 0)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        cc = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">if</span>(cc != <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    *curlcode = cc;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="url_8d.html#a1bc9666de113dffcfaf5d5c84eac6469">written</a> = -1;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a>) <a class="code" href="url_8d.html#a1bc9666de113dffcfaf5d5c84eac6469">written</a>; <span class="comment">/* number of bytes */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keyword">static</span> <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> gskit_recv(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> num, <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>,</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                           <span class="keywordtype">size_t</span> buffersize, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> *curlcode)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;{</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[num];</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">int</span> buffsize;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">int</span> nread;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> cc = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span>(pipe_ssloverssl(conn, num, SOS_READ) &gt;= 0) {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    buffsize = buffersize &gt; (size_t) INT_MAX? INT_MAX: (<span class="keywordtype">int</span>) buffersize;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    cc = gskit_status(<a class="code" href="structdata.html">data</a>, <a class="code" href="setup-os400_8h.html#a87bcee10709404af37dedbbc932f48f2">gsk_secure_soc_read</a>(BACKEND-&gt;handle,</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                                <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, buffsize, &amp;nread),</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                      <span class="stringliteral">&quot;gsk_secure_soc_read()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">switch</span>(cc) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>:</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>:</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    cc = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a>;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    *curlcode = cc;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    nread = -1;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a>) nread;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;set_ssl_version_min_max(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *protoflags, <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;{</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordtype">long</span> ssl_version = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#ab22abc2906422da61885ac6c8e6a1a59">version</a>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordtype">long</span> ssl_version_max = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(version_max);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordtype">long</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = ssl_version;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">switch</span>(ssl_version_max) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df">CURL_SSLVERSION_MAX_NONE</a>:</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0">CURL_SSLVERSION_MAX_DEFAULT</a>:</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      ssl_version_max = <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eae9b72f6323430c824c44182b7649d0d8">CURL_SSLVERSION_TLSv1_2</a>;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">for</span>(; i &lt;= (ssl_version_max &gt;&gt; 16); ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea769044d53450fd19575f12b2838f54d0">CURL_SSLVERSION_TLSv1_0</a>:</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        *protoflags |= CURL_GSKPROTO_TLSV10_MASK;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3659f18972112848e04fec39daf19985">CURL_SSLVERSION_TLSv1_1</a>:</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        *protoflags |= CURL_GSKPROTO_TLSV11_MASK;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eae9b72f6323430c824c44182b7649d0d8">CURL_SSLVERSION_TLSv1_2</a>:</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        *protoflags |= CURL_GSKPROTO_TLSV11_MASK;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3a20a62139a18a0577154835dc642c0d">CURL_SSLVERSION_TLSv1_3</a>:</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;GSKit: TLS 1.3 is not yet supported&quot;</span>);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gskit_connect_step1(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;{</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  gsk_handle envir;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> keyringfile = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(CAfile);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> keyringpwd = <a class="code" href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a>(key_passwd);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> keyringlabel = <a class="code" href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a>(cert);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ssl_version = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#ab22abc2906422da61885ac6c8e6a1a59">version</a>);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> verifypeer = <a class="code" href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a>(verifypeer);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="structhostname.html">hostname</a> = <a class="code" href="vtls_8h.html#ad333981ba88648c413730d21d5418405">SSL_IS_PROXY</a>()? conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>:</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *sni;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> protoflags = 0;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">long</span> <a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  Qso_OverlappedIO_t commarea;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">int</span> sockpair[2];</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> sobufsize = <a class="code" href="curl_8h.html#a0417440dcb84270d40959fa70aec6f86">CURL_MAX_WRITE_SIZE</a>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">/* Create SSL environment, start (preferably asynchronous) handshake. */</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  BACKEND-&gt;handle = (gsk_handle) NULL;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  BACKEND-&gt;iocport = -1;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  BACKEND-&gt;localfd = -1;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  BACKEND-&gt;remotefd = -1;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">/* GSKit supports two ways of specifying an SSL context: either by</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">   *  application identifier (that should have been defined at the system</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">   *  level) or by keyring file, password and certificate label.</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">   * Local certificate name (CURLOPT_SSLCERT) is used to hold either the</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">   *  application identifier of the certificate label.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">   * Key password (CURLOPT_KEYPASSWD) holds the keyring password.</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">   * It is not possible to have different keyrings for the CAs and the</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">   *  local certificate. We thus use the CA file (CURLOPT_CAINFO) to identify</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">   *  the keyring file.</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">   * If no key password is given and the keyring is the system keyring,</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">   *  application identifier mode is tried first, as recommended in IBM doc.</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  envir = (gsk_handle) NULL;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">if</span>(keyringlabel &amp;&amp; *keyringlabel &amp;&amp; !keyringpwd &amp;&amp;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      !strcmp(keyringfile, <a class="code" href="config-dos_8h.html#ae5eea99d1a0e2512a7854acb71038197">CURL_CA_BUNDLE</a>)) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">/* Try application identifier mode. */</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    init_environment(<a class="code" href="structdata.html">data</a>, &amp;envir, keyringlabel, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL,</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                     (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">if</span>(!envir) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">/* Use keyring mode. */</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = init_environment(<a class="code" href="structdata.html">data</a>, &amp;envir, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL,</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                              keyringfile, keyringlabel, keyringpwd);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">/* Create secure session. */</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>, <a class="code" href="setup-os400_8h.html#a8519a91e4fd8a1fa5dd7afe168069ca4">gsk_secure_soc_open</a>(envir, &amp;BACKEND-&gt;handle),</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        <span class="stringliteral">&quot;gsk_secure_soc_open()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="setup-os400_8h.html#a25583bcffb803a4e26a377c8848c5503">gsk_environment_close</a>(&amp;envir);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">/* Establish a pipelining socket pair for SSL over SSL. */</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a>) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span>(inetsocketpair(sockpair))</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    BACKEND-&gt;localfd = sockpair[0];</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    BACKEND-&gt;remotefd = sockpair[1];</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    setsockopt(BACKEND-&gt;localfd, SOL_SOCKET, SO_RCVBUF,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;               (<span class="keywordtype">void</span> *) sobufsize, <span class="keyword">sizeof</span>(sobufsize));</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    setsockopt(BACKEND-&gt;remotefd, SOL_SOCKET, SO_RCVBUF,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               (<span class="keywordtype">void</span> *) sobufsize, <span class="keyword">sizeof</span>(sobufsize));</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    setsockopt(BACKEND-&gt;localfd, SOL_SOCKET, SO_SNDBUF,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;               (<span class="keywordtype">void</span> *) sobufsize, <span class="keyword">sizeof</span>(sobufsize));</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    setsockopt(BACKEND-&gt;remotefd, SOL_SOCKET, SO_SNDBUF,</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;               (<span class="keywordtype">void</span> *) sobufsize, <span class="keyword">sizeof</span>(sobufsize));</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a>(BACKEND-&gt;localfd, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a>(BACKEND-&gt;remotefd, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">/* Determine which SSL/TLS version should be enabled. */</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  sni = <a class="code" href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">switch</span>(ssl_version) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea0f8174e66c2e7084ab2aa414509110ce">CURL_SSLVERSION_SSLv2</a>:</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    protoflags = CURL_GSKPROTO_SSLV2_MASK;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    sni = NULL;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea196e49e6628c0360cbe00852964fa906">CURL_SSLVERSION_SSLv3</a>:</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    protoflags = CURL_GSKPROTO_SSLV3_MASK;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    sni = NULL;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea0227d3edc8c1ee5f0bb41831912ce756">CURL_SSLVERSION_DEFAULT</a>:</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eaf516898239e1f4a335ab3c0d019de40e">CURL_SSLVERSION_TLSv1</a>:</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    protoflags = CURL_GSKPROTO_TLSV10_MASK |</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                 CURL_GSKPROTO_TLSV11_MASK | CURL_GSKPROTO_TLSV12_MASK;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea769044d53450fd19575f12b2838f54d0">CURL_SSLVERSION_TLSv1_0</a>:</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3659f18972112848e04fec39daf19985">CURL_SSLVERSION_TLSv1_1</a>:</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eae9b72f6323430c824c44182b7649d0d8">CURL_SSLVERSION_TLSv1_2</a>:</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3a20a62139a18a0577154835dc642c0d">CURL_SSLVERSION_TLSv1_3</a>:</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_ssl_version_min_max(&amp;protoflags, conn);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> != <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Unrecognized parameter passed via CURLOPT_SSLVERSION&quot;</span>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment">/* Process SNI. Ignore if not supported (on OS400 &lt; V7R1). */</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordflow">if</span>(sni) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_buffer(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        GSK_SSL_EXTN_SERVERNAME_REQUEST, sni, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">/* Set session parameters. */</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">/* Compute the handshake timeout. Since GSKit granularity is 1 second,</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">       we round up the required value. */</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a> = <a class="code" href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a>(<a class="code" href="structdata.html">data</a>, NULL, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a> &lt; 0)</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_numeric(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_HANDSHAKE_TIMEOUT,</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                           (<a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a> + 999) / 1000);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_numeric(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_OS400_READ_TIMEOUT, 1);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_numeric(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_FD, BACKEND-&gt;localfd &gt;= 0?</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                         BACKEND-&gt;localfd: conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex]);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_ciphers(conn, BACKEND-&gt;handle, &amp;protoflags);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">if</span>(!protoflags) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;No SSL protocol/cipher combination enabled&quot;</span>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_PROTOCOL_SSLV2,</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                      (protoflags &amp; CURL_GSKPROTO_SSLV2_MASK)?</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                      GSK_PROTOCOL_SSLV2_ON: GSK_PROTOCOL_SSLV2_OFF, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_PROTOCOL_SSLV3,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                      (protoflags &amp; CURL_GSKPROTO_SSLV3_MASK)?</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                      GSK_PROTOCOL_SSLV3_ON: GSK_PROTOCOL_SSLV3_OFF, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_PROTOCOL_TLSV1,</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                      (protoflags &amp; CURL_GSKPROTO_TLSV10_MASK)?</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                      GSK_PROTOCOL_TLSV1_ON: GSK_PROTOCOL_TLSV1_OFF, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_PROTOCOL_TLSV11,</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                      (protoflags &amp; CURL_GSKPROTO_TLSV11_MASK)?</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                      GSK_TRUE: GSK_FALSE, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">if</span>(protoflags == CURL_GSKPROTO_TLSV11_MASK) {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;TLS 1.1 not yet supported&quot;</span>);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_PROTOCOL_TLSV12,</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                      (protoflags &amp; CURL_GSKPROTO_TLSV12_MASK)?</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                      GSK_TRUE: GSK_FALSE, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>) {</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">if</span>(protoflags == CURL_GSKPROTO_TLSV12_MASK) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;TLS 1.2 not yet supported&quot;</span>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = set_enum(<a class="code" href="structdata.html">data</a>, BACKEND-&gt;handle, GSK_SERVER_AUTH_TYPE,</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                      verifypeer? GSK_SERVER_AUTH_FULL:</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                      GSK_SERVER_AUTH_PASSTHRU, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">/* Start handshake. Try asynchronous first. */</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(&amp;commarea, 0, <span class="keyword">sizeof</span>(commarea));</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    BACKEND-&gt;iocport = QsoCreateIOCompletionPort();</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span>(BACKEND-&gt;iocport != -1) {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                            <a class="code" href="setup-os400_8h.html#a4de924504c8f470c76fdc71ea6951e18">gsk_secure_soc_startInit</a>(BACKEND-&gt;handle,</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                                     BACKEND-&gt;iocport,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                                     &amp;commarea),</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                            <span class="stringliteral">&quot;gsk_secure_soc_startInit()&quot;</span>,</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                            <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a02630bc60f6cd9c202c67e33784ee7a5">ssl_connect_2</a>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        close_async_handshake(connssl);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(errno != ENOBUFS)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>, GSK_ERROR_IO,</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                            <span class="stringliteral">&quot;QsoCreateIOCompletionPort()&quot;</span>, 0);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a>) {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="comment">/* Cannot pipeline while handshaking synchronously. */</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="comment">/* No more completion port available. Use synchronous IO. */</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>, <a class="code" href="setup-os400_8h.html#a3388c3394737c686933031ee38a5cb7b">gsk_secure_soc_init</a>(BACKEND-&gt;handle),</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                            <span class="stringliteral">&quot;gsk_secure_soc_init()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a7934d517b40671313c488ba54c1bf09e">ssl_connect_3</a>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="comment">/* Error: rollback. */</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  close_one(connssl, conn, sockindex);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gskit_connect_step2(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                    <span class="keywordtype">bool</span> nonblocking)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;{</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  Qso_OverlappedIO_t cstat;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordtype">long</span> timeout_ms;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtimeval.html">timeval</a> stmv;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">/* Poll or wait for end of SSL asynchronous handshake. */</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    timeout_ms = nonblocking? 0: <a class="code" href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a>(<a class="code" href="structdata.html">data</a>, NULL, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">if</span>(timeout_ms &lt; 0)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      timeout_ms = 0;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    stmv.tv_sec = timeout_ms / 1000;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    stmv.tv_usec = (timeout_ms - stmv.tv_sec * 1000) * 1000;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">switch</span>(QsoWaitForIOCompletion(BACKEND-&gt;iocport, &amp;cstat, &amp;stmv)) {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">case</span> 1:             <span class="comment">/* Operation complete. */</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">case</span> -1:            <span class="comment">/* An error occurred: handshake still in progress. */</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">if</span>(errno == EINTR) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span>(nonblocking)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">continue</span>;       <span class="comment">/* Retry. */</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="keywordflow">if</span>(errno != ETIME) {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;QsoWaitForIOCompletion() I/O error: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        cancel_async_handshake(conn, sockindex);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        close_async_handshake(connssl);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="comment">/* FALL INTO... */</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">case</span> 0:             <span class="comment">/* Handshake in progress, timeout occurred. */</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">if</span>(nonblocking)</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      cancel_async_handshake(conn, sockindex);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      close_async_handshake(connssl);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_status(<a class="code" href="structdata.html">data</a>, cstat.returnValue, <span class="stringliteral">&quot;SSL handshake&quot;</span>,</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a7934d517b40671313c488ba54c1bf09e">ssl_connect_3</a>;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  close_async_handshake(connssl);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;}</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gskit_connect_step3(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;{</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keyword">const</span> gsk_cert_data_elem *cdev;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordtype">int</span> cdec;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keyword">const</span> gsk_cert_data_elem *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *cert = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) NULL;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *certend;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">/* SSL handshake done: gather certificate info and verify host. */</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">if</span>(gskit_status(<a class="code" href="structdata.html">data</a>, <a class="code" href="setup-os400_8h.html#a39f0ba38062ad5ab17d7311709da0ec9">gsk_attribute_get_cert_info</a>(BACKEND-&gt;handle,</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                                    GSK_PARTNER_CERT_INFO,</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                                    &amp;cdev, &amp;cdec),</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                  <span class="stringliteral">&quot;gsk_attribute_get_cert_info()&quot;</span>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>) ==</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;     <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>) {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Server certificate:\n&quot;</span>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = cdev;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++ &lt; cdec; <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_id) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">case</span> CERT_BODY_DER:</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        cert = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_p;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        certend = cert + cdev-&gt;cert_data_l;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">case</span> CERT_DN_PRINTABLE:</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;\t subject: %.*s\n&quot;</span>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_l, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_p);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">case</span> CERT_ISSUER_DN_PRINTABLE:</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;\t issuer: %.*s\n&quot;</span>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_l, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_p);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <span class="keywordflow">case</span> CERT_VALID_FROM:</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;\t start date: %.*s\n&quot;</span>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_l, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_p);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">case</span> CERT_VALID_TO:</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;\t expire date: %.*s\n&quot;</span>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_l, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;cert_data_p);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">/* Verify host. */</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_verifyhost(conn, cert, certend);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="comment">/* The only place GSKit can get the whole CA chain is a validation</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">     callback where no user data pointer is available. Therefore it&#39;s not</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">     possible to copy this chain into our structures for CAINFO.</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">     However the server certificate may be available, thus we can return</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">     info about it. */</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.ssl.certinfo) {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_ssl_init_certinfo(<a class="code" href="structdata.html">data</a>, 1);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span>(cert) {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_extract_certinfo(conn, 0, cert, certend);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">/* Check pinned public key. */</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="vtls_8h.html#ad333981ba88648c413730d21d5418405">SSL_IS_PROXY</a>() ? <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa85af043a41434c1b4f439fb89d5c9047">STRING_SSL_PINNEDPUBLICKEY_PROXY</a>] :</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                         <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa83729aeebf5f0a20b00829bc3a6a1e9f">STRING_SSL_PINNEDPUBLICKEY_ORIG</a>];</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    curl_X509certificate x509;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    curl_asn1Element *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">if</span>(Curl_parseX509(&amp;x509, cert, certend))</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f">CURLE_SSL_PINNEDPUBKEYNOTMATCH</a>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = &amp;x509.subjectPublicKeyInfo;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_pin_peer_pubkey(<a class="code" href="structdata.html">data</a>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;header, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;end - <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>-&gt;header);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;SSL: public key does not match pinned public key!&quot;</span>);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a8c789d7e6cfccfe4cb46894d5e2102f1">ssl_connect_done</a>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;}</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gskit_connect_common(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex,</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                     <span class="keywordtype">bool</span> nonblocking, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;{</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordtype">long</span> timeout_ms;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  Qso_OverlappedIO_t cstat;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  *done = connssl-&gt;<a class="code" href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">state</a> == <a class="code" href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c">ssl_connection_complete</a>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">if</span>(*done)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">/* Step 1: create session, start handshake. */</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="keywordflow">if</span>(connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508">ssl_connect_1</a>) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">/* check allowed time left */</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    timeout_ms = <a class="code" href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a>(<a class="code" href="structdata.html">data</a>, NULL, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span>(timeout_ms &lt; 0) {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">/* no need to continue if time already is up */</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;SSL connection timeout&quot;</span>);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_connect_step1(conn, sockindex);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">/* Handle handshake pipelining. */</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span>(pipe_ssloverssl(conn, sockindex, SOS_READ | SOS_WRITE) &lt; 0)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">/* Step 2: check if handshake is over. */</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a02630bc60f6cd9c202c67e33784ee7a5">ssl_connect_2</a>) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">/* check allowed time left */</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    timeout_ms = <a class="code" href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a>(<a class="code" href="structdata.html">data</a>, NULL, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span>(timeout_ms &lt; 0) {</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="comment">/* no need to continue if time already is up */</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;SSL connection timeout&quot;</span>);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_connect_step2(conn, sockindex, nonblocking);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  }</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">/* Handle handshake pipelining. */</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">if</span>(pipe_ssloverssl(conn, sockindex, SOS_READ | SOS_WRITE) &lt; 0)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="comment">/* Step 3: gather certificate info, verify host. */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a7934d517b40671313c488ba54c1bf09e">ssl_connect_3</a>)</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_connect_step3(conn, sockindex);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    close_one(connssl, conn, sockindex);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a8c789d7e6cfccfe4cb46894d5e2102f1">ssl_connect_done</a>) {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    connssl-&gt;<a class="code" href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">state</a> = <a class="code" href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c">ssl_connection_complete</a>;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508">ssl_connect_1</a>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">recv</a>[sockindex] = gskit_recv;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">send</a>[sockindex] = gskit_send;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;}</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_gskit_connect_nonblocking(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                               <span class="keywordtype">int</span> sockindex, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;{</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_connect_common(conn, sockindex, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, done);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">if</span>(*done || <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508">ssl_connect_1</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;}</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_gskit_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;{</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keywordtype">bool</span> done;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> = <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508">ssl_connect_1</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = gskit_connect_common(conn, sockindex, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, &amp;done);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(done);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;}</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Curl_gskit_close(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;{</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  close_one(&amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex], conn, sockindex);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  close_one(&amp;conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex], conn, sockindex);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Curl_gskit_shutdown(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;{</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> nread;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordtype">int</span> what;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[120];</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="keywordflow">if</span>(!BACKEND-&gt;handle)</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.ftp_ccc != <a class="code" href="curl_8h.html#a48086b496b9853f6b9507af1c7a50acaa9159611119fe5f4912d5875f41dd5f0a">CURLFTPSSL_CCC_ACTIVE</a>)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  close_one(connssl, conn, sockindex);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = 0;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  what = <a class="code" href="select_8h.html#a7e89e8a851eb27402914a0d5beb58d99">SOCKET_READABLE</a>(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex],</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                         SSL_SHUTDOWN_TIMEOUT);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">if</span>(what &lt; 0) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="comment">/* anything that gets here is fatally bad */</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;select/poll on SSL socket, errno: %d&quot;</span>, <a class="code" href="curl__setup__once_8h.html#af9cf1bc5edbe4eec056fe773c09d234e">SOCKERRNO</a>);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = -1;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span>(!what) {                                <span class="comment">/* timeout */</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;SSL shutdown timeout&quot;</span>);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">/* Something to read, let&#39;s do it and hope that it is the close</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">       notify alert from the server. No way to gsk_secure_soc_read() now, so</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">       use read(). */</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    nread = read(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex], <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keyword">sizeof</span>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>));</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">if</span>(nread &lt; 0) {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;read: %s&quot;</span>, <a class="code" href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">strerror</a>(errno));</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = -1;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span>(nread &lt;= 0)</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    what = <a class="code" href="select_8h.html#a7e89e8a851eb27402914a0d5beb58d99">SOCKET_READABLE</a>(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[sockindex], 0);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> Curl_gskit_version(<span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;{</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, <span class="stringliteral">&quot;GSKit&quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;}</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Curl_gskit_check_cxn(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *cxn)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;cxn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordtype">int</span> err;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordtype">int</span> errlen;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">/* The only thing that can be tested here is at the socket level. */</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">if</span>(!BACKEND-&gt;handle)</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">/* connection has been closed */</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  err = 0;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  errlen = <span class="keyword">sizeof</span>(err);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">if</span>(getsockopt(cxn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>], SOL_SOCKET, SO_ERROR,</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) &amp;err, &amp;errlen) ||</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;     errlen != <span class="keyword">sizeof</span>(err) || err)</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">/* connection has been closed */</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">return</span> -1;  <span class="comment">/* connection status unknown */</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *Curl_gskit_get_internals(<span class="keyword">struct</span> <a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl,</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                      <a class="code" href="curl_8h.html#aabc03ec968a2fdccde5c6709f712dd7b">CURLINFO</a> info <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;{</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  (void)info;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">return</span> BACKEND-&gt;handle;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> Curl_ssl_gskit = {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  { <a class="code" href="curl_8h.html#a908c5b707ac681212b8f8688cf76689da5e4415f292e2dec3482c586dd35efa4f">CURLSSLBACKEND_GSKIT</a>, <span class="stringliteral">&quot;gskit&quot;</span> }, <span class="comment">/* info */</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <a class="code" href="vtls_8h.html#af964d3e85b565ae20b4f85444b9b1619">SSLSUPP_CERTINFO</a> |</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <a class="code" href="vtls_8h.html#a932726d4856765a766c86e3a3ed29a8f">SSLSUPP_PINNEDPUBKEY</a>,</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ssl_backend_data),</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  Curl_gskit_init,                <span class="comment">/* init */</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  Curl_gskit_cleanup,             <span class="comment">/* cleanup */</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  Curl_gskit_version,             <span class="comment">/* version */</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  Curl_gskit_check_cxn,           <span class="comment">/* check_cxn */</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  Curl_gskit_shutdown,            <span class="comment">/* shutdown */</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <a class="code" href="vtls_8h.html#aba5f776941608a9d5c44fd0b422b1862">Curl_none_data_pending</a>,         <span class="comment">/* data_pending */</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <a class="code" href="vtls_8h.html#a04e21d561123bc29f2e018c260ede891">Curl_none_random</a>,               <span class="comment">/* random */</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <a class="code" href="vtls_8h.html#afd63787510a375221ab2aba491ef2073">Curl_none_cert_status_request</a>,  <span class="comment">/* cert_status_request */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  Curl_gskit_connect,             <span class="comment">/* connect */</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  Curl_gskit_connect_nonblocking, <span class="comment">/* connect_nonblocking */</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  Curl_gskit_get_internals,       <span class="comment">/* get_internals */</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  Curl_gskit_close,               <span class="comment">/* close_one */</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <a class="code" href="vtls_8h.html#a054a6a646a0108d8f91a503d31a21671">Curl_none_close_all</a>,            <span class="comment">/* close_all */</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">/* No session handling for GSKit */</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <a class="code" href="vtls_8h.html#abd2be2ec8895660c6eb7e124cfac438e">Curl_none_session_free</a>,         <span class="comment">/* session_free */</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <a class="code" href="vtls_8h.html#a7ccc438dc80065afa61534a12f49716b">Curl_none_set_engine</a>,           <span class="comment">/* set_engine */</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <a class="code" href="vtls_8h.html#a06f0fb1d7887e2395f579c430c55e9da">Curl_none_set_engine_default</a>,   <span class="comment">/* set_engine_default */</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <a class="code" href="vtls_8h.html#a93de8d8215f8110779b3e2ab9d77dbd3">Curl_none_engines_list</a>,         <span class="comment">/* engines_list */</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <a class="code" href="vtls_8h.html#a0a1d6e1d64672ae38b75216a44d08641">Curl_none_false_start</a>,          <span class="comment">/* false_start */</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <a class="code" href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a>,               <span class="comment">/* md5sum */</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  NULL                            <span class="comment">/* sha256sum */</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;};</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_GSKIT */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aaa7a948caaac0addf8754794663f48b1">CURLE_OPERATION_TIMEDOUT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00498">curl.h:498</a></div></div>
<div class="ttc" id="structconnectdata_html_ab6f11cf5c5bc549e9f9af12fc65e2e23"><div class="ttname"><a href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">connectdata::ssl</a></div><div class="ttdeci">struct ssl_connect_data ssl[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00885">urldata.h:885</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a32dce3380228f1a23cdc1f784263762b"><div class="ttname"><a href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a></div><div class="ttdeci">#define UNUSED_PARAM</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00699">curl_setup.h:699</a></div></div>
<div class="ttc" id="url_8d_html_a1bc9666de113dffcfaf5d5c84eac6469"><div class="ttname"><a href="url_8d.html#a1bc9666de113dffcfaf5d5c84eac6469">written</a></div><div class="ttdeci">Long POP3 or SMTP then that protocol will be otherwise HTTP will be used.Since..guessing can be disabled by setting a default see proto default for details.This option may be used any number of times.To control where this URL is written</div><div class="ttdef"><b>Definition:</b> <a href="url_8d_source.html#l00010">url.d:10</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00527">curl.h:527</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a3d136f81a9d7bf281f4a050099438683">CURLE_SSL_CIPHER</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00530">curl.h:530</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="setup-os400_8h_html_af65cc88d9ccb2274b94e0025d25d965f"><div class="ttname"><a href="setup-os400_8h.html#af65cc88d9ccb2274b94e0025d25d965f">bind</a></div><div class="ttdeci">#define bind</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00211">setup-os400.h:211</a></div></div>
<div class="ttc" id="curl_8h_html_a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df"><div class="ttname"><a href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df">CURL_SSLVERSION_MAX_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01985">curl.h:1985</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="structconnectdata_html_aec2de2220c36ec447f6101e85bf0a52b"><div class="ttname"><a href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">connectdata::recv</a></div><div class="ttdeci">Curl_recv * recv[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00879">urldata.h:879</a></div></div>
<div class="ttc" id="vtls_8h_html_a594e132ba0c0e860b62140083ead1c0d"><div class="ttname"><a href="vtls_8h.html#a594e132ba0c0e860b62140083ead1c0d">SSL_CONN_CONFIG</a></div><div class="ttdeci">#define SSL_CONN_CONFIG(var)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00138">vtls.h:138</a></div></div>
<div class="ttc" id="struct_curl__ssl_html"><div class="ttname"><a href="struct_curl__ssl.html">Curl_ssl</a></div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00036">vtls.h:36</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a6f372f1f5069417ad131c8975b96546e"><div class="ttname"><a href="setup-os400_8h.html#a6f372f1f5069417ad131c8975b96546e">gsk_environment_open</a></div><div class="ttdeci">#define gsk_environment_open</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00062">setup-os400.h:62</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a33e1497e4a96eef1f196bc3469214e21"><div class="ttname"><a href="setup-os400_8h.html#a33e1497e4a96eef1f196bc3469214e21">gsk_environment_init</a></div><div class="ttdeci">#define gsk_environment_init</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00075">setup-os400.h:75</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a0ee195fc513184d659250d3148c1753d"><div class="ttname"><a href="setup-os400_8h.html#a0ee195fc513184d659250d3148c1753d">gsk_attribute_set_enum</a></div><div class="ttdeci">#define gsk_attribute_set_enum</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00089">setup-os400.h:89</a></div></div>
<div class="ttc" id="structproxy__info_html_ae2cc9c2eb5c4ea0c4b92bf067e391bdc"><div class="ttname"><a href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">proxy_info::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00752">urldata.h:752</a></div></div>
<div class="ttc" id="urldata_8h_html_a56b23efdd8d04b0179b52224a251bcb7"><div class="ttname"><a href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a></div><div class="ttdeci">#define FIRSTSOCKET</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00480">urldata.h:480</a></div></div>
<div class="ttc" id="setup-os400_8h_html_ad1b8bf93dc82e064d13549441789860c"><div class="ttname"><a href="setup-os400_8h.html#ad1b8bf93dc82e064d13549441789860c">gsk_attribute_set_numeric_value</a></div><div class="ttdeci">#define gsk_attribute_set_numeric_value</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00094">setup-os400.h:94</a></div></div>
<div class="ttc" id="vtls_8h_html_abd2be2ec8895660c6eb7e124cfac438e"><div class="ttname"><a href="vtls_8h.html#abd2be2ec8895660c6eb7e124cfac438e">Curl_none_session_free</a></div><div class="ttdeci">void Curl_none_session_free(void *ptr)</div></div>
<div class="ttc" id="connect_8h_html"><div class="ttname"><a href="connect_8h.html">connect.h</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="vtls_8h_html_a6d4d2d806ff1ab1428629b690f02e964"><div class="ttname"><a href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a></div><div class="ttdeci">#define SSL_SET_OPTION(var)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00136">vtls.h:136</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9eae9b72f6323430c824c44182b7649d0d8"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eae9b72f6323430c824c44182b7649d0d8">CURL_SSLVERSION_TLSv1_2</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01978">curl.h:1978</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="structssl__connect__data_html_a2de0f5a8b43b4e4550e22b1b8f3870e1"><div class="ttname"><a href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">ssl_connect_data::connecting_state</a></div><div class="ttdeci">ssl_connect_state connecting_state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00203">urldata.h:203</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_af9cf1bc5edbe4eec056fe773c09d234e"><div class="ttname"><a href="curl__setup__once_8h.html#af9cf1bc5edbe4eec056fe773c09d234e">SOCKERRNO</a></div><div class="ttdeci">#define SOCKERRNO</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00414">curl_setup_once.h:414</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00459">curl.h:459</a></div></div>
<div class="ttc" id="curl_8h_html_a0417440dcb84270d40959fa70aec6f86"><div class="ttname"><a href="curl_8h.html#a0417440dcb84270d40959fa70aec6f86">CURL_MAX_WRITE_SIZE</a></div><div class="ttdeci">#define CURL_MAX_WRITE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00230">curl.h:230</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea0f8174e66c2e7084ab2aa414509110ce"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea0f8174e66c2e7084ab2aa414509110ce">CURL_SSLVERSION_SSLv2</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01974">curl.h:1974</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a23d7b88872d6ead46c978b567908d587"><div class="ttname"><a href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a></div><div class="ttdeci">#define DEBUGASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00401">curl_setup_once.h:401</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa83729aeebf5f0a20b00829bc3a6a1e9f"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa83729aeebf5f0a20b00829bc3a6a1e9f">STRING_SSL_PINNEDPUBLICKEY_ORIG</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01429">urldata.h:1429</a></div></div>
<div class="ttc" id="multi-uv_8c_html_afb43b78d9a22f95e721353db4408304c"><div class="ttname"><a href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a></div><div class="ttdeci">uv_timer_t timeout</div><div class="ttdef"><b>Definition:</b> <a href="multi-uv_8c_source.html#l00042">multi-uv.c:42</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="curl_8h_html_aabc03ec968a2fdccde5c6709f712dd7b"><div class="ttname"><a href="curl_8h.html#aabc03ec968a2fdccde5c6709f712dd7b">CURLINFO</a></div><div class="ttdeci">CURLINFO</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02498">curl.h:2498</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00526">curl.h:526</a></div></div>
<div class="ttc" id="config-dos_8h_html_ae5eea99d1a0e2512a7854acb71038197"><div class="ttname"><a href="config-dos_8h.html#ae5eea99d1a0e2512a7854acb71038197">CURL_CA_BUNDLE</a></div><div class="ttdeci">#define CURL_CA_BUNDLE</div><div class="ttdef"><b>Definition:</b> <a href="config-dos_8h_source.html#l00155">config-dos.h:155</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a8519a91e4fd8a1fa5dd7afe168069ca4"><div class="ttname"><a href="setup-os400_8h.html#a8519a91e4fd8a1fa5dd7afe168069ca4">gsk_secure_soc_open</a></div><div class="ttdeci">#define gsk_secure_soc_open</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00066">setup-os400.h:66</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="vtls_8h_html_aba5f776941608a9d5c44fd0b422b1862"><div class="ttname"><a href="vtls_8h.html#aba5f776941608a9d5c44fd0b422b1862">Curl_none_data_pending</a></div><div class="ttdeci">bool Curl_none_data_pending(const struct connectdata *conn, int connindex)</div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f">CURLE_SSL_PINNEDPUBKEYNOTMATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00578">curl.h:578</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00564">curl.h:564</a></div></div>
<div class="ttc" id="vtls_8h_html_af964d3e85b565ae20b4f85444b9b1619"><div class="ttname"><a href="vtls_8h.html#af964d3e85b565ae20b4f85444b9b1619">SSLSUPP_CERTINFO</a></div><div class="ttdeci">#define SSLSUPP_CERTINFO</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00030">vtls.h:30</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a54f0cfd0013cabd4828f0c6be9b19de3"><div class="ttname"><a href="setup-os400_8h.html#a54f0cfd0013cabd4828f0c6be9b19de3">gsk_secure_soc_write</a></div><div class="ttdeci">#define gsk_secure_soc_write</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00135">setup-os400.h:135</a></div></div>
<div class="ttc" id="gskit_8h_html"><div class="ttname"><a href="gskit_8h.html">gskit.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c"><div class="ttname"><a href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c">ssl_connection_complete</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00190">urldata.h:190</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="structhostname_html"><div class="ttname"><a href="structhostname.html">hostname</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00446">urldata.h:446</a></div></div>
<div class="ttc" id="setup-os400_8h_html_adb961dfa39eafca6052016a9173e4ae8"><div class="ttname"><a href="setup-os400_8h.html#adb961dfa39eafca6052016a9173e4ae8">gsk_attribute_set_callback</a></div><div class="ttdeci">#define gsk_attribute_set_callback</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00099">setup-os400.h:99</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1a7934d517b40671313c488ba54c1bf09e"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a7934d517b40671313c488ba54c1bf09e">ssl_connect_3</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00183">urldata.h:183</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="namespaceimpacket_1_1nmb_html_ae08ba7342be906ac4e49aa4746c2242d"><div class="ttname"><a href="namespaceimpacket_1_1nmb.html#ae08ba7342be906ac4e49aa4746c2242d">impacket.nmb.strerror</a></div><div class="ttdeci">def strerror(errclass, errcode)</div><div class="ttdef"><b>Definition:</b> <a href="nmb_8py_source.html#l00140">nmb.py:140</a></div></div>
<div class="ttc" id="unit1308_8c_html_a70a830d3039f37216dde9bcf2460aec2"><div class="ttname"><a href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a></div><div class="ttdeci">char buffer[]</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00048">unit1308.c:48</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea196e49e6628c0360cbe00852964fa906"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea196e49e6628c0360cbe00852964fa906">CURL_SSLVERSION_SSLv3</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01975">curl.h:1975</a></div></div>
<div class="ttc" id="setup-os400_8h_html_abd09be3337affa882c103238974af8b6"><div class="ttname"><a href="setup-os400_8h.html#abd09be3337affa882c103238974af8b6">gsk_attribute_set_buffer</a></div><div class="ttdeci">#define gsk_attribute_set_buffer</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00084">setup-os400.h:84</a></div></div>
<div class="ttc" id="nonblock_8c_html_a0b0747a29eed9acae52471c25a66e042"><div class="ttname"><a href="nonblock_8c.html#a0b0747a29eed9acae52471c25a66e042">curlx_nonblock</a></div><div class="ttdeci">int curlx_nonblock(curl_socket_t sockfd, int nonblock)</div><div class="ttdef"><b>Definition:</b> <a href="nonblock_8c_source.html#l00047">nonblock.c:47</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="structconnectdata_html_a4df63a4042ad767671bb3bfd74aa68fc"><div class="ttname"><a href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">connectdata::http_proxy</a></div><div class="ttdeci">struct proxy_info http_proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00837">urldata.h:837</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="structssl__connect__data_html_a46d3839ea70923be1efa7f85aba7f6a8"><div class="ttname"><a href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">ssl_connect_data::state</a></div><div class="ttdeci">ssl_connection_state state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00202">urldata.h:202</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9eaf516898239e1f4a335ab3c0d019de40e"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9eaf516898239e1f4a335ab3c0d019de40e">CURL_SSLVERSION_TLSv1</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01973">curl.h:1973</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a8e6bdaad09a5404d9b01acaa93e1a797"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a8e6bdaad09a5404d9b01acaa93e1a797">CURLE_SSL_CACERT_BADFILE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00555">curl.h:555</a></div></div>
<div class="ttc" id="vtls_8h_html"><div class="ttname"><a href="vtls_8h.html">vtls.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00529">curl.h:529</a></div></div>
<div class="ttc" id="vtls_8h_html_a04e21d561123bc29f2e018c260ede891"><div class="ttname"><a href="vtls_8h.html#a04e21d561123bc29f2e018c260ede891">Curl_none_random</a></div><div class="ttdeci">CURLcode Curl_none_random(struct Curl_easy *data, unsigned char *entropy, size_t length)</div></div>
<div class="ttc" id="structssl__connect__data_html_ad63d8e461921062845bbf07dfc0007c5"><div class="ttname"><a href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">ssl_connect_data::use</a></div><div class="ttdeci">bool use</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00201">urldata.h:201</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a25583bcffb803a4e26a377c8848c5503"><div class="ttname"><a href="setup-os400_8h.html#a25583bcffb803a4e26a377c8848c5503">gsk_environment_close</a></div><div class="ttdeci">#define gsk_environment_close</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00069">setup-os400.h:69</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a87bcee10709404af37dedbbc932f48f2"><div class="ttname"><a href="setup-os400_8h.html#a87bcee10709404af37dedbbc932f48f2">gsk_secure_soc_read</a></div><div class="ttdeci">#define gsk_secure_soc_read</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00130">setup-os400.h:130</a></div></div>
<div class="ttc" id="config_8d_html_aea53e62b3bb322f5a6bf4ceb58066a37"><div class="ttname"><a href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are r and v.A backslash preceding any other letter is ignored.If the first column of a config line is a the rest of the line will be treated as a comment.Only write one option per physical line in the config file.Specify the filename to config as to make curl read the file from stdin.Note that to be able to specify a URL in the config file</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a4e3426d85e0c3f200031c8df367f8cdb"><div class="ttname"><a href="setup-os400_8h.html#a4e3426d85e0c3f200031c8df367f8cdb">gsk_strerror</a></div><div class="ttdeci">#define gsk_strerror</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00138">setup-os400.h:138</a></div></div>
<div class="ttc" id="vtls_8h_html_a0a1d6e1d64672ae38b75216a44d08641"><div class="ttname"><a href="vtls_8h.html#a0a1d6e1d64672ae38b75216a44d08641">Curl_none_false_start</a></div><div class="ttdeci">bool Curl_none_false_start(void)</div></div>
<div class="ttc" id="config_8d_html_a9fb4830d0cbef7d3cf48425ce59f580a"><div class="ttname"><a href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are n</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="vtls_8h_html_a932726d4856765a766c86e3a3ed29a8f"><div class="ttname"><a href="vtls_8h.html#a932726d4856765a766c86e3a3ed29a8f">SSLSUPP_PINNEDPUBKEY</a></div><div class="ttdeci">#define SSLSUPP_PINNEDPUBKEY</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00031">vtls.h:31</a></div></div>
<div class="ttc" id="connect_8c_html_aed32c0fb99c80a40c097c98a3eb03c74"><div class="ttname"><a href="connect_8c.html#aed32c0fb99c80a40c097c98a3eb03c74">Curl_timeleft</a></div><div class="ttdeci">timediff_t Curl_timeleft(struct Curl_easy *data, struct curltime *nowp, bool duringconnect)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8c_source.html#l00184">connect.c:184</a></div></div>
<div class="ttc" id="select_8h_html_a7e89e8a851eb27402914a0d5beb58d99"><div class="ttname"><a href="select_8h.html#a7e89e8a851eb27402914a0d5beb58d99">SOCKET_READABLE</a></div><div class="ttdeci">#define SOCKET_READABLE(x, z)</div><div class="ttdef"><b>Definition:</b> <a href="select_8h_source.html#l00079">select.h:79</a></div></div>
<div class="ttc" id="vtls_8h_html_afd63787510a375221ab2aba491ef2073"><div class="ttname"><a href="vtls_8h.html#afd63787510a375221ab2aba491ef2073">Curl_none_cert_status_request</a></div><div class="ttdeci">bool Curl_none_cert_status_request(void)</div></div>
<div class="ttc" id="strcase_8h_html_a48c605aaef9b3681c41d91096b6baad0"><div class="ttname"><a href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a></div><div class="ttdeci">#define strncasecompare(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00036">strcase.h:36</a></div></div>
<div class="ttc" id="select_8h_html"><div class="ttname"><a href="select_8h.html">select.h</a></div></div>
<div class="ttc" id="remote-name_8d_html_aa335f8bb20424b03700f57b150bf0aa6"><div class="ttname"><a href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a></div><div class="ttdeci">Long the path is cut off.The file will be saved in the current working directory.If you want the file saved in a different make sure you change the current working directory before invoking curl with this option.The remote file name to use for saving is extracted from the given nothing and if it already exists it will be overwritten.If you want the server to be able to choose the file name refer to remote header name which can be used in addition to this option.If the server chooses a file name and that name already exists it will not be overwritten.There is no URL decoding done on the file name.If it has or other URL encoded parts of the name</div><div class="ttdef"><b>Definition:</b> <a href="remote-name_8d_source.html#l00006">remote-name.d:6</a></div></div>
<div class="ttc" id="structtimeval_html"><div class="ttname"><a href="structtimeval.html">timeval</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00109">curl_setup_once.h:109</a></div></div>
<div class="ttc" id="structssl__connect__data_html"><div class="ttname"><a href="structssl__connect__data.html">ssl_connect_data</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00197">urldata.h:197</a></div></div>
<div class="ttc" id="setup-os400_8h_html_adfd4ee688142ebda1142c1b0c7577e91"><div class="ttname"><a href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a></div><div class="ttdeci">#define connect</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00210">setup-os400.h:210</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a3388c3394737c686933031ee38a5cb7b"><div class="ttname"><a href="setup-os400_8h.html#a3388c3394737c686933031ee38a5cb7b">gsk_secure_soc_init</a></div><div class="ttdeci">#define gsk_secure_soc_init</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00078">setup-os400.h:78</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea0227d3edc8c1ee5f0bb41831912ce756"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea0227d3edc8c1ee5f0bb41831912ce756">CURL_SSLVERSION_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01972">curl.h:1972</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00505">curl.h:505</a></div></div>
<div class="ttc" id="structconnectdata_html_ada83cbd7d295b87033b7ea635c0a5dd5"><div class="ttname"><a href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">connectdata::send</a></div><div class="ttdeci">Curl_send * send[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00880">urldata.h:880</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a8bbabcbcbfd5723279a43f8c53ff3e78"><div class="ttname"><a href="setup-os400_8h.html#a8bbabcbcbfd5723279a43f8c53ff3e78">gsk_secure_soc_close</a></div><div class="ttdeci">#define gsk_secure_soc_close</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00072">setup-os400.h:72</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="vtls_8h_html_a77767d6781edb481cfa95437ab11f64a"><div class="ttname"><a href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a></div><div class="ttdeci">CURLcode Curl_none_md5sum(unsigned char *input, size_t inputlen, unsigned char *md5sum, size_t md5len)</div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="unit1652_8c_html_a1d19b0eef3b3acd31be88886a0277c2e"><div class="ttname"><a href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a></div><div class="ttdeci">memset(input, '\0', sizeof(input))</div></div>
<div class="ttc" id="vtls_8h_html_a7ccc438dc80065afa61534a12f49716b"><div class="ttname"><a href="vtls_8h.html#a7ccc438dc80065afa61534a12f49716b">Curl_none_set_engine</a></div><div class="ttdeci">CURLcode Curl_none_set_engine(struct Curl_easy *data, const char *engine)</div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="config-win32ce_8h_html_a6a05c923dad0c1208043e9c20a58c8e5"><div class="ttname"><a href="config-win32ce_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a></div><div class="ttdeci">#define ENOMEM</div><div class="ttdef"><b>Definition:</b> <a href="config-win32ce_8h_source.html#l00443">config-win32ce.h:443</a></div></div>
<div class="ttc" id="config-win32_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="config-win32_8h_source.html#l00379">config-win32.h:379</a></div></div>
<div class="ttc" id="structconnectdata_html_a13cc2123ad38902e8ad44e67f10ed7aa"><div class="ttname"><a href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">connectdata::sock</a></div><div class="ttdeci">curl_socket_t sock[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00874">urldata.h:874</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_t_l_m_8h_html_ab22abc2906422da61885ac6c8e6a1a59"><div class="ttname"><a href="_b_l_e_eddystone_t_l_m_8h.html#ab22abc2906422da61885ac6c8e6a1a59">version</a></div><div class="ttdeci">uint8_t version</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_t_l_m_8h_source.html#l00041">BLEEddystoneTLM.h:41</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea769044d53450fd19575f12b2838f54d0"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea769044d53450fd19575f12b2838f54d0">CURL_SSLVERSION_TLSv1_0</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01976">curl.h:1976</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a746b63c8123f5bdc10a916f720f2c9e5"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a746b63c8123f5bdc10a916f720f2c9e5">CURLE_PEER_FAILED_VERIFICATION</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00531">curl.h:531</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a4de924504c8f470c76fdc71ea6951e18"><div class="ttname"><a href="setup-os400_8h.html#a4de924504c8f470c76fdc71ea6951e18">gsk_secure_soc_startInit</a></div><div class="ttdeci">#define gsk_secure_soc_startInit</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00143">setup-os400.h:143</a></div></div>
<div class="ttc" id="vtls_8h_html_a93de8d8215f8110779b3e2ab9d77dbd3"><div class="ttname"><a href="vtls_8h.html#a93de8d8215f8110779b3e2ab9d77dbd3">Curl_none_engines_list</a></div><div class="ttdeci">struct curl_slist * Curl_none_engines_list(struct Curl_easy *data)</div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa85af043a41434c1b4f439fb89d5c9047"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa85af043a41434c1b4f439fb89d5c9047">STRING_SSL_PINNEDPUBLICKEY_PROXY</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01430">urldata.h:1430</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1a02630bc60f6cd9c202c67e33784ee7a5"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a02630bc60f6cd9c202c67e33784ee7a5">ssl_connect_2</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00180">urldata.h:180</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea3659f18972112848e04fec39daf19985"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3659f18972112848e04fec39daf19985">CURL_SSLVERSION_TLSv1_1</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01977">curl.h:1977</a></div></div>
<div class="ttc" id="curl_8h_html_a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0"><div class="ttname"><a href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0">CURL_SSLVERSION_MAX_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01986">curl.h:1986</a></div></div>
<div class="ttc" id="structconnectdata_html_a57fed5d378439f0b8cbad7cc9e916604"><div class="ttname"><a href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">connectdata::proxy_ssl</a></div><div class="ttdeci">struct ssl_connect_data proxy_ssl[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00886">urldata.h:886</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1a8c789d7e6cfccfe4cb46894d5e2102f1"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a8c789d7e6cfccfe4cb46894d5e2102f1">ssl_connect_done</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00184">urldata.h:184</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea3a20a62139a18a0577154835dc642c0d"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea3a20a62139a18a0577154835dc642c0d">CURL_SSLVERSION_TLSv1_3</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01979">curl.h:1979</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="curl_8h_html_a908c5b707ac681212b8f8688cf76689da5e4415f292e2dec3482c586dd35efa4f"><div class="ttname"><a href="curl_8h.html#a908c5b707ac681212b8f8688cf76689da5e4415f292e2dec3482c586dd35efa4f">CURLSSLBACKEND_GSKIT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00143">curl.h:143</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a39f0ba38062ad5ab17d7311709da0ec9"><div class="ttname"><a href="setup-os400_8h.html#a39f0ba38062ad5ab17d7311709da0ec9">gsk_attribute_get_cert_info</a></div><div class="ttdeci">#define gsk_attribute_get_cert_info</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00121">setup-os400.h:121</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="noproxy_8d_html_a76bbcca5c6576b1086f83570943ed989"><div class="ttname"><a href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a></div><div class="ttdeci">Long if one is specified.The only wildcard is a single which matches all and effectively disables the proxy.Each name in this list is matched as either a domain which contains the hostname</div><div class="ttdef"><b>Definition:</b> <a href="noproxy_8d_source.html#l00006">noproxy.d:6</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1aff18b454b42fb95d95e3fd93130a5508">ssl_connect_1</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00179">urldata.h:179</a></div></div>
<div class="ttc" id="x509asn1_8h_html"><div class="ttname"><a href="x509asn1_8h.html">x509asn1.h</a></div></div>
<div class="ttc" id="vtls_8h_html_a06f0fb1d7887e2395f579c430c55e9da"><div class="ttname"><a href="vtls_8h.html#a06f0fb1d7887e2395f579c430c55e9da">Curl_none_set_engine_default</a></div><div class="ttdeci">CURLcode Curl_none_set_engine_default(struct Curl_easy *data)</div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="vtls_8h_html_a054a6a646a0108d8f91a503d31a21671"><div class="ttname"><a href="vtls_8h.html#a054a6a646a0108d8f91a503d31a21671">Curl_none_close_all</a></div><div class="ttdeci">void Curl_none_close_all(struct Curl_easy *data)</div></div>
<div class="ttc" id="curl_8h_html_a48086b496b9853f6b9507af1c7a50acaa9159611119fe5f4912d5875f41dd5f0a"><div class="ttname"><a href="curl_8h.html#a48086b496b9853f6b9507af1c7a50acaa9159611119fe5f4912d5875f41dd5f0a">CURLFTPSSL_CCC_ACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00828">curl.h:828</a></div></div>
<div class="ttc" id="vtls_8h_html_ad333981ba88648c413730d21d5418405"><div class="ttname"><a href="vtls_8h.html#ad333981ba88648c413730d21d5418405">SSL_IS_PROXY</a></div><div class="ttdeci">#define SSL_IS_PROXY()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00133">vtls.h:133</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="dir_c8d0f45061db60a99b5caea59b58f693.html">vtls</a></li><li class="navelem"><a class="el" href="gskit_8c.html">gskit.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
