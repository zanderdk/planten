<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/networking/mqtt/paho_mqtt_embedded_c/MQTTClient/src/MQTTClient.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('src_2_m_q_t_t_client_8h_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MQTTClient.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="src_2_m_q_t_t_client_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2014, 2015 IBM Corp.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * All rights reserved. This program and the accompanying materials</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * and Eclipse Distribution License v1.0 which accompany this distribution.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * The Eclipse Public License is available at</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *    http://www.eclipse.org/legal/epl-v10.html</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * and the Eclipse Distribution License is available at</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   http://www.eclipse.org/org/documents/edl-v10.php.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * Contributors:</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *    Ian Craggs - initial API and implementation and/or initial documentation</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *    Ian Craggs - fix for bug 458512 - QoS 2 messages</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *    Ian Craggs - fix for bug 460389 - send loop uses wrong length</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *    Ian Craggs - fix for bug 464169 - clearing subscriptions</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *    Ian Craggs - fix for bug 464551 - enums and ints can be different size</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *    Mark Sonnentag - fix for bug 475204 - inefficient instantiation of Timer</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *    Ian Craggs - fix for bug 475749 - packetid modified twice</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *******************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#if !defined(MQTTCLIENT_H)</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#define MQTTCLIENT_H</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_f_p_8h.html">FP.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_m_q_t_t_packet_8h.html">MQTTPacket.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;stdio.h&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_m_q_t_t_logging_8h.html">MQTTLogging.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#if !defined(MQTTCLIENT_QOS1)</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="src_2_m_q_t_t_client_8h.html#a73afe4f60381315585f7e9bbd8b68999">   32</a></span>&#160;<span class="preprocessor">    #define MQTTCLIENT_QOS1 1</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if !defined(MQTTCLIENT_QOS2)</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="src_2_m_q_t_t_client_8h.html#a9a9b4371a3a4f049f9f2cb2624f0c5ac">   35</a></span>&#160;<span class="preprocessor">    #define MQTTCLIENT_QOS2 0</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespace_m_q_t_t.html">   38</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_m_q_t_t.html">MQTT</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">   42</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> { <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a14dc14f3d6013dcbfb6a2d88f9245b81">QOS0</a>, <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">QOS1</a>, <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a> };</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// all failure return codes must be negative</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">   45</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76ae">returnCode</a> { <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa1b956048909aa613f9172983994380c">BUFFER_OVERFLOW</a> = -2, <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a> = -1, <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a> = 0 };</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html">   48</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">   50</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> <a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a>;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#a7388592f2fa96f57a9e65c794d0c993c">   51</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="struct_m_q_t_t_1_1_message.html#a7388592f2fa96f57a9e65c794d0c993c">retained</a>;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#ac9da6ada101085aa9ba129f70b95f248">   52</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="struct_m_q_t_t_1_1_message.html#ac9da6ada101085aa9ba129f70b95f248">dup</a>;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">   53</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#aac97ac3db89ef94c772fb57ae81e6576">   54</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="struct_m_q_t_t_1_1_message.html#aac97ac3db89ef94c772fb57ae81e6576">payload</a>;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message.html#ad1a880e68f68c218f19c602996bb61ee">   55</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_m_q_t_t_1_1_message.html#ad1a880e68f68c218f19c602996bb61ee">payloadlen</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;};</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message_data.html">   59</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_m_q_t_t_1_1_message_data.html">MessageData</a></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message_data.html#a51773f08310352751f5dd773a1df045d">   61</a></span>&#160;    <a class="code" href="struct_m_q_t_t_1_1_message_data.html#a51773f08310352751f5dd773a1df045d">MessageData</a>(<a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> &amp;aTopicName, <span class="keyword">struct</span> <a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a> &amp;aMessage)  : <a class="code" href="struct_m_q_t_t_1_1_message_data.html#af8309d8efbfdfa091a0ee14321e3e141">message</a>(aMessage), <a class="code" href="struct_m_q_t_t_1_1_message_data.html#a4f659e4cf961134230faea3f21852e4a">topicName</a>(aTopicName)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    { }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message_data.html#af8309d8efbfdfa091a0ee14321e3e141">   64</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a> &amp;<a class="code" href="struct_m_q_t_t_1_1_message_data.html#af8309d8efbfdfa091a0ee14321e3e141">message</a>;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="struct_m_q_t_t_1_1_message_data.html#a4f659e4cf961134230faea3f21852e4a">   65</a></span>&#160;    <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> &amp;<a class="code" href="struct_m_q_t_t_1_1_message_data.html#a4f659e4cf961134230faea3f21852e4a">topicName</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;};</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_packet_id.html">   69</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_m_q_t_t_1_1_packet_id.html">PacketId</a></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_packet_id.html#a93b9fc49bdf5c400091046d2c4d3d3e9">   72</a></span>&#160;    <a class="code" href="class_m_q_t_t_1_1_packet_id.html#a93b9fc49bdf5c400091046d2c4d3d3e9">PacketId</a>()</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        next = 0;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_packet_id.html#a4cca89af7a52518ea77d43491ca9059b">   77</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_packet_id.html#a4cca89af7a52518ea77d43491ca9059b">getNext</a>()</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">return</span> next = (next == MAX_PACKET_ID) ? 1 : next + 1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_PACKET_ID = 65535;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">int</span> next;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;};</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE = 100, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS = 5&gt;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html">   98</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_m_q_t_t_1_1_client.html">Client</a></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a42412d6c64b1c703f3abb3b10cbd233e">  103</a></span>&#160;    <span class="keyword">typedef</span> void (*<a class="code" href="class_m_q_t_t_1_1_client.html#a42412d6c64b1c703f3abb3b10cbd233e">messageHandler</a>)(<a class="code" href="struct_m_q_t_t_1_1_message_data.html">MessageData</a>&amp;);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="class_m_q_t_t_1_1_client.html#ace4f0a238535ff38fa2a1eb1fadff1be">Client</a>(<a class="code" href="struct_network.html">Network</a>&amp; <a class="code" href="mqtt__paho_8c.html#a2d9a64328e83ad37af17cbeb5e73b5df">network</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> command_timeout_ms = 30000);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#afde257d236c56680a5b132633c3a44ed">  115</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_m_q_t_t_1_1_client.html#afde257d236c56680a5b132633c3a44ed">setDefaultMessageHandler</a>(<a class="code" href="class_m_q_t_t_1_1_client.html#a42412d6c64b1c703f3abb3b10cbd233e">messageHandler</a> mh)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        defaultMessageHandler.attach(mh);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">connect</a>();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">connect</a>(<a class="code" href="struct_m_q_t_t_packet__connect_data.html">MQTTPacket_connectData</a>&amp; <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a>&amp; message);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <span class="keywordtype">void</span>* payload, <span class="keywordtype">size_t</span> payloadlen, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos = <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a14dc14f3d6013dcbfb6a2d88f9245b81">QOS0</a>, <span class="keywordtype">bool</span> retained = <span class="keyword">false</span>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <span class="keywordtype">void</span>* payload, <span class="keywordtype">size_t</span> payloadlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&amp; <span class="keywordtype">id</span>, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos = <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">QOS1</a>, <span class="keywordtype">bool</span> retained = <span class="keyword">false</span>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#af14fc1a824e33c0a7cda6784aa95dace">subscribe</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicFilter, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos, <a class="code" href="class_m_q_t_t_1_1_client.html#a42412d6c64b1c703f3abb3b10cbd233e">messageHandler</a> mh);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a8e9e9c6510e7e819360462500564ccd1">unsubscribe</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicFilter);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ac1e8a91bcfcd5f518849b46152211991">disconnect</a>();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3676580238ca03ec60810b8ed2baf2e9">yield</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timeout_ms = 1000L);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a8b21e4c3a200b749b9821a342d9f0b26">  192</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a8b21e4c3a200b749b9821a342d9f0b26">isConnected</a>()</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">return</span> isconnected;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">void</span> cleanSession();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">int</span> cycle(<a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">int</span> waitfor(<span class="keywordtype">int</span> packet_type, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> keepalive();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">publish</a>(<span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">int</span> decodePacket(<span class="keywordtype">int</span>* <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="keywordtype">int</span> <a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">int</span> readPacket(<a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> sendPacket(<span class="keywordtype">int</span> length, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">int</span> deliverMessage(<a class="code" href="struct_m_q_t_t_string.html">MQTTString</a>&amp; topicName, <a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a>&amp; message);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">bool</span> isTopicMatched(<span class="keywordtype">char</span>* topicFilter, <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a>&amp; topicName);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="struct_network.html">Network</a>&amp; ipstack;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> command_timeout_ms;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sendbuf[MAX_MQTT_PACKET_SIZE];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> readbuf[MAX_MQTT_PACKET_SIZE];</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> last_sent, last_received;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> keepAliveInterval;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">bool</span> ping_outstanding;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">bool</span> cleansession;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="class_m_q_t_t_1_1_packet_id.html">PacketId</a> packetid;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">struct </span>MessageHandlers</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* topicFilter;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="class_f_p.html">FP&lt;void, MessageData&amp;&gt;</a> fp;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    } messageHandlers[<a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a>];      <span class="comment">// Message handlers are indexed by subscription topic</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="class_f_p.html">FP&lt;void, MessageData&amp;&gt;</a> defaultMessageHandler;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">bool</span> isconnected;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pubbuf[MAX_MQTT_PACKET_SIZE];  <span class="comment">// store the last publish for sending on reconnect</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">int</span> inflightLen;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> inflightMsgid;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">enum</span> <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a2a5744b0ca3f049979e6777b75d7a634">QoS</a> inflightQoS;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">bool</span> pubrel;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">    #if !defined(MAX_INCOMING_QOS2_MESSAGES)</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">        #define MAX_INCOMING_QOS2_MESSAGES 10</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> incomingQoS2messages[MAX_INCOMING_QOS2_MESSAGES];</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">bool</span> isQoS2msgidFree(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">bool</span> useQoS2msgid(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">void</span> freeQoS2msgid(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;};</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS&gt;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, MAX_MESSAGE_HANDLERS&gt;::cleanSession</a>() </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    ping_outstanding = <span class="keyword">false</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a>; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter = 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    isconnected = <span class="keyword">false</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    inflightMsgid = 0;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    inflightQoS = <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a2a5744b0ca3f049979e6777b75d7a634a7d2552996d8248e57b28f5328fc1e003">QOS0</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    pubrel = <span class="keyword">false</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; MAX_INCOMING_QOS2_MESSAGES; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = 0;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS&gt;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#ace4f0a238535ff38fa2a1eb1fadff1be">  279</a></span>&#160;<a class="code" href="class_m_q_t_t_1_1_client.html#ace4f0a238535ff38fa2a1eb1fadff1be">MQTT::Client&lt;Network, Timer, a, MAX_MESSAGE_HANDLERS&gt;::Client</a>(<a class="code" href="struct_network.html">Network</a>&amp; <a class="code" href="mqtt__paho_8c.html#a2d9a64328e83ad37af17cbeb5e73b5df">network</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> command_timeout_ms)  : ipstack(<a class="code" href="mqtt__paho_8c.html#a2d9a64328e83ad37af17cbeb5e73b5df">network</a>), packetid()</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    this-&gt;command_timeout_ms = command_timeout_ms;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    cleanSession();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::isQoS2msgidFree</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; MAX_INCOMING_QOS2_MESSAGES; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] == <span class="keywordtype">id</span>)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::useQoS2msgid</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; MAX_INCOMING_QOS2_MESSAGES; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] == 0)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = id;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::freeQoS2msgid</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; MAX_INCOMING_QOS2_MESSAGES; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span> (incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] == <span class="keywordtype">id</span>)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            incomingQoS2messages[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = 0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::sendPacket</a>(<span class="keywordtype">int</span> length, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        sent = 0;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">while</span> (sent &lt; length &amp;&amp; !<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.expired())</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ipstack.write(&amp;sendbuf[sent], length - sent, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.left_ms());</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt; 0)  <span class="comment">// there was an error writing the data</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        sent += <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (sent == length)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (this-&gt;keepAliveInterval &gt; 0)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            last_sent.countdown(this-&gt;keepAliveInterval); <span class="comment">// record the fact that we have successfully sent the packet</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#if defined(MQTT_DEBUG)</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">char</span> printbuf[150];</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="_m_q_t_t_logging_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;Rc %d from sending packet %s\n&quot;</span>, <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, <a class="code" href="_m_q_t_t_format_8c.html#a29f425be3d4f6facad4359f7e2b9d334">MQTTFormat_toServerString</a>(printbuf, <span class="keyword">sizeof</span>(printbuf), sendbuf, length));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::decodePacket</a>(<span class="keywordtype">int</span>* <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, <span class="keywordtype">int</span> <a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a>)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">int</span> multiplier = 1;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="_m_q_t_t_packet_8c.html#a166c9117b1ef3db3292d475f300ca560">MAX_NO_OF_REMAINING_LENGTH_BYTES</a> = 4;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = 0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971a5cbe32551f8036958703f757c0d1a857">MQTTPACKET_READ_ERROR</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (++<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt; <a class="code" href="_m_q_t_t_packet_8c.html#a166c9117b1ef3db3292d475f300ca560">MAX_NO_OF_REMAINING_LENGTH_BYTES</a>)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971a5cbe32551f8036958703f757c0d1a857">MQTTPACKET_READ_ERROR</a>; <span class="comment">/* bad data */</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ipstack.read(&amp;c, 1, <a class="code" href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 1)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> += (c &amp; 127) * multiplier;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        multiplier *= 128;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    } <span class="keywordflow">while</span> ((c &amp; 128) != 0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;exit:</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::readPacket</a>(<a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="union_m_q_t_t_header.html">MQTTHeader</a> header = {0};</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">int</span> rem_len = 0;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/* 1. read the header byte.  This has the packet type in it */</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (ipstack.read(readbuf, 1, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.left_ms()) != 1)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 1;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">/* 2. read the remaining length.  This is variable in itself */</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    decodePacket(&amp;rem_len, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.left_ms());</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <a class="code" href="_m_q_t_t_packet_8c.html#a5464b2e101bc4dc199e58486c4ffaa9f">MQTTPacket_encode</a>(readbuf + 1, rem_len); <span class="comment">/* put the original remaining length into the buffer */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (rem_len &gt; (MAX_MQTT_PACKET_SIZE - <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>))</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa1b956048909aa613f9172983994380c">BUFFER_OVERFLOW</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* 3. read the rest of the buffer using a callback to supply the rest of the data */</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (rem_len &gt; 0 &amp;&amp; (ipstack.read(readbuf + <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, rem_len, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.left_ms()) != rem_len))</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    header.<a class="code" href="union_m_q_t_t_header.html#a9b2c40029ba354713e46b76ca74b2420">byte</a> = readbuf[0];</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = header.<a class="code" href="union_m_q_t_t_header.html#af366887430d3f755e398cea31022c1a3">bits</a>.<a class="code" href="union_m_q_t_t_header.html#aab9204aefddf8f4f6c6d6f58f4c1ab1c">type</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (this-&gt;keepAliveInterval &gt; 0)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        last_received.countdown(this-&gt;keepAliveInterval); <span class="comment">// record the fact that we have successfully received a packet</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;exit:</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        </div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#if defined(MQTT_DEBUG)</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &gt;= 0)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordtype">char</span> printbuf[50];</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="_m_q_t_t_logging_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;Rc %d from receiving packet %s\n&quot;</span>, <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, <a class="code" href="_m_q_t_t_format_8c.html#a081fe12d147970958623d53fd4e61735">MQTTFormat_toClientString</a>(printbuf, <span class="keyword">sizeof</span>(printbuf), readbuf, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>));</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">// assume topic filter and name is in correct format</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">// # can only be at end</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">// + and # can only be next to separator</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::isTopicMatched</a>(<span class="keywordtype">char</span>* topicFilter, <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a>&amp; topicName)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">char</span>* curf = topicFilter;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">char</span>* curn = topicName.<a class="code" href="struct_m_q_t_t_string.html#a78847a9d8950eeefa8e270a5c67c9a35">lenstring</a>.<a class="code" href="struct_m_q_t_t_len_string.html#ac875ffa1e0af752d17a10be055c33377">data</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">char</span>* curn_end = curn + topicName.<a class="code" href="struct_m_q_t_t_string.html#a78847a9d8950eeefa8e270a5c67c9a35">lenstring</a>.<a class="code" href="struct_m_q_t_t_len_string.html#a7eb20db2b77f5e224e12d94c78573fa3">len</a>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">while</span> (*curf &amp;&amp; curn &lt; curn_end)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (*curn == <span class="charliteral">&#39;/&#39;</span> &amp;&amp; *curf != <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (*curf != <span class="charliteral">&#39;+&#39;</span> &amp;&amp; *curf != <span class="charliteral">&#39;#&#39;</span> &amp;&amp; *curf != *curn)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (*curf == <span class="charliteral">&#39;+&#39;</span>)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        {   <span class="comment">// skip until we meet the next separator, or end of string</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordtype">char</span>* nextpos = curn + 1;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">while</span> (nextpos &lt; curn_end &amp;&amp; *nextpos != <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                nextpos = ++curn + 1;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*curf == <span class="charliteral">&#39;#&#39;</span>)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            curn = curn_end - 1;    <span class="comment">// skip until end of string</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        curf++;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        curn++;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    };</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> (curn == curn_end) &amp;&amp; (*curf == <span class="charliteral">&#39;\0&#39;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS&gt;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, MAX_MESSAGE_HANDLERS&gt;::deliverMessage</a>(<a class="code" href="struct_m_q_t_t_string.html">MQTTString</a>&amp; topicName, Message&amp; message)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// we have to find the right message handler - indexed by topic</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a>; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter != 0 &amp;&amp; (<a class="code" href="_m_q_t_t_packet_8c.html#a37bbf8101236ecfae4b6bb2e63c10075">MQTTPacket_equals</a>(&amp;topicName, (<span class="keywordtype">char</span>*)messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter) ||</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                isTopicMatched((<span class="keywordtype">char</span>*)messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter, topicName)))</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">if</span> (messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].fp.attached())</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <a class="code" href="struct_message_data.html">MessageData</a> md(topicName, message);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].fp(md);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a> &amp;&amp; defaultMessageHandler.attached())</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="struct_message_data.html">MessageData</a> md(topicName, message);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        defaultMessageHandler(md);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a3676580238ca03ec60810b8ed2baf2e9">  504</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3676580238ca03ec60810b8ed2baf2e9">MQTT::Client&lt;Network, Timer, a, b&gt;::yield</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timeout_ms)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.countdown_ms(timeout_ms);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.expired())</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a2bcf85f488f98b6d8e539f37c37eab78">cycle</a>(<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>) &lt; 0)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::cycle</a>(<a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">/* get one piece of work off the wire and one pass through */</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// read the socket, see what work is due</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">int</span> packet_type = readPacket(<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">switch</span> (packet_type)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>:</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa1b956048909aa613f9172983994380c">BUFFER_OVERFLOW</a>:</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = packet_type;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1aa636430e8d9563704f7328824d6bc0a5">CONNACK</a>:</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2">PUBACK</a>:</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abe48cb8225101545fd55752f2534348d">SUBACK</a>:</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abd1a204dcfa4933760cd12e779f36fc5">PUBLISH</a>:</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> topicName = <a class="code" href="_m_q_t_t_packet_8h.html#a34afa3fe58c14803eec9957875c70342">MQTTString_initializer</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a> msg;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordtype">int</span> intQoS;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_deserialize_publish_8c.html#a72900aeb8c3a63ea49a61020fd7dd45a">MQTTDeserialize_publish</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)&amp;msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#ac9da6ada101085aa9ba129f70b95f248">dup</a>, &amp;intQoS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)&amp;msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a7388592f2fa96f57a9e65c794d0c993c">retained</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>*)&amp;msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>, &amp;topicName,</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>**)&amp;msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#aac97ac3db89ef94c772fb57ae81e6576">payload</a>, (<span class="keywordtype">int</span>*)&amp;msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#ad1a880e68f68c218f19c602996bb61ee">payloadlen</a>, readbuf, MAX_MQTT_PACKET_SIZE) != 1)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a> = (<span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a>)intQoS;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">if</span> (msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a> != <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a>)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <a class="code" href="_m_q_t_t_client_8c.html#a9ee5e1a3021798303d1efab7996dbd36">deliverMessage</a>(topicName, msg);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isQoS2msgidFree(msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>))</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="keywordflow">if</span> (useQoS2msgid(msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>))</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    <a class="code" href="_m_q_t_t_client_8c.html#a9ee5e1a3021798303d1efab7996dbd36">deliverMessage</a>(topicName, msg);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    <a class="code" href="_m_q_t_t_logging_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Maximum number of incoming QoS2 messages exceeded&quot;</span>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">if</span> (msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a> != <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a14dc14f3d6013dcbfb6a2d88f9245b81">QOS0</a>)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="keywordflow">if</span> (msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a> == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">QOS1</a>)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc606fd1a635e8603c1418c81bca4ecf">MQTTSerialize_ack</a>(sendbuf, MAX_MQTT_PACKET_SIZE, <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2">PUBACK</a>, 0, msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a> == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a>)</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc606fd1a635e8603c1418c81bca4ecf">MQTTSerialize_ack</a>(sendbuf, MAX_MQTT_PACKET_SIZE, <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1e2c2a84e88263f41d3b9bed26bf4e89">PUBREC</a>, 0, msg.<a class="code" href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">id</a>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt;= 0)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    <span class="keywordflow">goto</span> exit; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1e2c2a84e88263f41d3b9bed26bf4e89">PUBREC</a>:</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85">PUBREL</a>:</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mypacketid;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dup, <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_deserialize_publish_8c.html#aef7f705e677e0467230a24a1134ec1f2">MQTTDeserialize_ack</a>(&amp;<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>, &amp;dup, &amp;mypacketid, readbuf, MAX_MQTT_PACKET_SIZE) != 1)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc606fd1a635e8603c1418c81bca4ecf">MQTTSerialize_ack</a>(sendbuf, MAX_MQTT_PACKET_SIZE, </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        (packet_type == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1e2c2a84e88263f41d3b9bed26bf4e89">PUBREC</a>) ? <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85">PUBREL</a> : <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c">PUBCOMP</a>, 0, mypacketid)) &lt;= 0)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>) <span class="comment">// send the PUBREL packet</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <span class="keywordflow">goto</span> exit; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">if</span> (packet_type == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85">PUBREL</a>)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                freeQoS2msgid(mypacketid);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c">PUBCOMP</a>:</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1a3a12a071fc8874e9518b1c94aaef30">PINGRESP</a>:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            ping_outstanding = <span class="keyword">false</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="_m_q_t_t_client_8c.html#aec16090cf96b12cdfc44acda8908e6a2">keepalive</a>();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;exit:</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = packet_type;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::keepalive</a>()</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (keepAliveInterval == 0)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (last_sent.expired() || last_received.expired())</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span> (!ping_outstanding)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>(1000);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_connect_8h.html#abd5c098c9e4a5cf2f5607e4a9db6c43b">MQTTSerialize_pingreq</a>(sendbuf, MAX_MQTT_PACKET_SIZE);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt; 0 &amp;&amp; (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>) <span class="comment">// send the ping packet</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                ping_outstanding = <span class="keyword">true</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;exit:</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;}</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">// only used in single-threaded mode where one command at a time is in process</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html">MQTT::Client&lt;Network, Timer, a, b&gt;::waitfor</a>(<span class="keywordtype">int</span> packet_type, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>.expired())</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// we timed out</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">while</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="_m_q_t_t_client_8c.html#a2bcf85f488f98b6d8e539f37c37eab78">cycle</a>(<a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) != packet_type);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a8ca4c1a15acd2ec0710aabbe49d59c49">  661</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::connect</a>(<a class="code" href="struct_m_q_t_t_packet__connect_data.html">MQTTPacket_connectData</a>&amp; <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> connect_timer(command_timeout_ms);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (isconnected) <span class="comment">// don&#39;t send connect packet again if we are already connected</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    this-&gt;keepAliveInterval = <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>.keepAliveInterval;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    this-&gt;cleansession = <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>.cleansession;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_connect_8h.html#a612f9e23a665b10198fc59e676dc94f9">MQTTSerialize_connect</a>(sendbuf, MAX_MQTT_PACKET_SIZE, &amp;<a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>)) &lt;= 0)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, connect_timer)) != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)  <span class="comment">// send the connect packet</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">goto</span> exit; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (this-&gt;keepAliveInterval &gt; 0)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        last_received.countdown(this-&gt;keepAliveInterval);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// this will be a blocking call, wait for the connack</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a>(<a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1aa636430e8d9563704f7328824d6bc0a5">CONNACK</a>, connect_timer) == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1aa636430e8d9563704f7328824d6bc0a5">CONNACK</a>)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> connack_rc = 255;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordtype">bool</span> sessionPresent = <span class="keyword">false</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_connect_8h.html#a356cb5639f3d0d6d002b4a144a58f11a">MQTTDeserialize_connack</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)&amp;sessionPresent, &amp;connack_rc, readbuf, MAX_MQTT_PACKET_SIZE) == 1)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = connack_rc;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// resend any inflight publish</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (inflightMsgid &gt; 0 &amp;&amp; inflightQoS == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a> &amp;&amp; pubrel)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_packet_8h.html#acc606fd1a635e8603c1418c81bca4ecf">MQTTSerialize_ack</a>(sendbuf, MAX_MQTT_PACKET_SIZE, <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85">PUBREL</a>, 0, inflightMsgid)) &lt;= 0)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = publish(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, connect_timer, inflightQoS);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (inflightMsgid &gt; 0)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(sendbuf, pubbuf, MAX_MQTT_PACKET_SIZE);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = publish(inflightLen, connect_timer, inflightQoS);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;exit:</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        isconnected = <span class="keyword">true</span>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00719"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">  719</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::connect</a>()</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="struct_m_q_t_t_packet__connect_data.html">MQTTPacket_connectData</a> default_options = <a class="code" href="_m_q_t_t_connect_8h.html#a3e475310d0fdc12dfb3ae2d4e802bb7b">MQTTPacket_connectData_initializer</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a>(default_options);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS&gt;</div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#af14fc1a824e33c0a7cda6784aa95dace">  727</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#af14fc1a824e33c0a7cda6784aa95dace">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, MAX_MESSAGE_HANDLERS&gt;::subscribe</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicFilter, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos, <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a57263a23e77cb842104b9a1d39dba53e">messageHandler</a> <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a57263a23e77cb842104b9a1d39dba53e">messageHandler</a>)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;{</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>(command_timeout_ms);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> topic = {(<span class="keywordtype">char</span>*)topicFilter, {0, 0}};</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (!isconnected)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_subscribe_8h.html#aa88712c28d8b9ad842d4d9c7453c8528">MQTTSerialize_subscribe</a>(sendbuf, MAX_MQTT_PACKET_SIZE, 0, packetid.getNext(), 1, &amp;topic, (<span class="keywordtype">int</span>*)&amp;qos);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt;= 0)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>) <span class="comment">// send the subscribe packet</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">goto</span> exit;             <span class="comment">// there was a problem</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a>(<a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abe48cb8225101545fd55752f2534348d">SUBACK</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>) == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abe48cb8225101545fd55752f2534348d">SUBACK</a>)      <span class="comment">// wait for suback</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordtype">int</span> count = 0, grantedQoS = -1;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mypacketid;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_subscribe_8h.html#a67a03482ca40e354dec5abc8561004e4">MQTTDeserialize_suback</a>(&amp;mypacketid, 1, &amp;count, &amp;grantedQoS, readbuf, MAX_MQTT_PACKET_SIZE) == 1)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = grantedQoS; <span class="comment">// 0, 1, 2 or 0x80</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 0x80)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a>; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keywordflow">if</span> (messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter == 0)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter = topicFilter;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].fp.attach(<a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a57263a23e77cb842104b9a1d39dba53e">messageHandler</a>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = 0;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;exit:</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        cleanSession();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> MAX_MESSAGE_HANDLERS&gt;</div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a8e9e9c6510e7e819360462500564ccd1">  774</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#a8e9e9c6510e7e819360462500564ccd1">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, MAX_MESSAGE_HANDLERS&gt;::unsubscribe</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicFilter)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;{</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>(command_timeout_ms);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> topic = {(<span class="keywordtype">char</span>*)topicFilter, {0, 0}};</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (!isconnected)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_unsubscribe_8h.html#a9f16e69d4c62e3a9ef1d2734510bc016">MQTTSerialize_unsubscribe</a>(sendbuf, MAX_MQTT_PACKET_SIZE, 0, packetid.getNext(), 1, &amp;topic)) &lt;= 0)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>) <span class="comment">// send the unsubscribe packet</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">goto</span> exit; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a>(<a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a722b573f419f3cdb3b2263f7dd00a3ae">UNSUBACK</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>) == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a722b573f419f3cdb3b2263f7dd00a3ae">UNSUBACK</a>)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mypacketid;  <span class="comment">// should be the same as the packetid above</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_unsubscribe_8h.html#a959e05d42b06a5c6a7cecbaa61bee68d">MQTTDeserialize_unsuback</a>(&amp;mypacketid, readbuf, MAX_MQTT_PACKET_SIZE) == 1)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = 0;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="comment">// remove the subscription message handler associated with this topic, if there is one</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a>; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="keywordflow">if</span> (messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter != 0 &amp;&amp; strcmp(messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter, topicFilter) == 0)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    messageHandlers[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].topicFilter = 0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;exit:</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        cleanSession();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::publish</a>(<span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="struct_timer.html">Timer</a>&amp; <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;{</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>)) != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>) <span class="comment">// send the publish packet</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">goto</span> exit; <span class="comment">// there was a problem</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">if</span> (qos == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">QOS1</a>)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a>(<a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2">PUBACK</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>) == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2">PUBACK</a>)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mypacketid;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dup, <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_deserialize_publish_8c.html#aef7f705e677e0467230a24a1134ec1f2">MQTTDeserialize_ack</a>(&amp;<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>, &amp;dup, &amp;mypacketid, readbuf, MAX_MQTT_PACKET_SIZE) != 1)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflightMsgid == mypacketid)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                inflightMsgid = 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#elif MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qos == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a>(<a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c">PUBCOMP</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>) == <a class="code" href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c">PUBCOMP</a>)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> mypacketid;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dup, <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_m_q_t_t_deserialize_publish_8c.html#aef7f705e677e0467230a24a1134ec1f2">MQTTDeserialize_ack</a>(&amp;<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>, &amp;dup, &amp;mypacketid, readbuf, MAX_MQTT_PACKET_SIZE) != 1)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflightMsgid == mypacketid)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                inflightMsgid = 0;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;exit:</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">SUCCESS</a>)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        cleanSession();</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#aa6b65ee396bf6f71e2ad3390d862112a">  866</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <span class="keywordtype">void</span>* payload, <span class="keywordtype">size_t</span> payloadlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>&amp; <span class="keywordtype">id</span>, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos, <span class="keywordtype">bool</span> retained)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>(command_timeout_ms);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="struct_m_q_t_t_string.html">MQTTString</a> topicString = <a class="code" href="_m_q_t_t_packet_8h.html#a34afa3fe58c14803eec9957875c70342">MQTTString_initializer</a>;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">if</span> (!isconnected)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    topicString.<a class="code" href="struct_m_q_t_t_string.html#a00126e87a6bbc0ddd66918920fd4a425">cstring</a> = (<span class="keywordtype">char</span>*)topicName;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (qos == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">QOS1</a> || qos == <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">QOS2</a>)</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordtype">id</span> = packetid.getNext();</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_publish_8h.html#a65f4a3f8efdd0c3c67d980adbaa9adb5">MQTTSerialize_publish</a>(sendbuf, MAX_MQTT_PACKET_SIZE, 0, qos, retained, <span class="keywordtype">id</span>,</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;              topicString, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)payload, payloadlen);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt;= 0)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS1 || MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">if</span> (!cleansession)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(pubbuf, sendbuf, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        inflightMsgid = id;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        inflightLen = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        inflightQoS = qos;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">#if MQTTCLIENT_QOS2</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        pubrel = <span class="keyword">false</span>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = publish(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>, qos);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;exit:</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00908"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#a9d1b46dc485321093ae4494266f901c4">  908</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <span class="keywordtype">void</span>* payload, <span class="keywordtype">size_t</span> payloadlen, <span class="keyword">enum</span> <a class="code" href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">QoS</a> qos, <span class="keywordtype">bool</span> retained)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;{</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span> = 0;  <span class="comment">// dummy - not used for anything</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">return</span> publish(topicName, payload, payloadlen, <span class="keywordtype">id</span>, qos, retained);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00916"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">  916</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::publish</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* topicName, <a class="code" href="struct_m_q_t_t_1_1_message.html">Message</a>&amp; message)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">return</span> publish(topicName, message.<a class="code" href="struct_m_q_t_t_1_1_message.html#aac97ac3db89ef94c772fb57ae81e6576">payload</a>, message.<a class="code" href="struct_m_q_t_t_1_1_message.html#ad1a880e68f68c218f19c602996bb61ee">payloadlen</a>, message.<a class="code" href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">qos</a>, message.<a class="code" href="struct_m_q_t_t_1_1_message.html#a7388592f2fa96f57a9e65c794d0c993c">retained</a>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;}</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> Network, <span class="keyword">class</span> Timer, <span class="keywordtype">int</span> MAX_MQTT_PACKET_SIZE, <span class="keywordtype">int</span> b&gt;</div><div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="class_m_q_t_t_1_1_client.html#ac1e8a91bcfcd5f518849b46152211991">  923</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_q_t_t_1_1_client.html#ac1e8a91bcfcd5f518849b46152211991">MQTT::Client&lt;Network, Timer, MAX_MQTT_PACKET_SIZE, b&gt;::disconnect</a>()</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;{</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">FAILURE</a>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="struct_timer.html">Timer</a> <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>(command_timeout_ms);     <span class="comment">// we might wait for incomplete incoming publishes to complete</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="_m_q_t_t_connect_8h.html#aa30ad14dad5094716ec3de426d20ca37">MQTTSerialize_disconnect</a>(sendbuf, MAX_MQTT_PACKET_SIZE);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt; 0)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = sendPacket(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a>);            <span class="comment">// send the disconnect packet</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (cleansession)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        cleanSession();</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        isconnected = <span class="keyword">false</span>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="struct_m_q_t_t_1_1_message_data_html_af8309d8efbfdfa091a0ee14321e3e141"><div class="ttname"><a href="struct_m_q_t_t_1_1_message_data.html#af8309d8efbfdfa091a0ee14321e3e141">MQTT::MessageData::message</a></div><div class="ttdeci">struct Message &amp; message</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00064">MQTTClient.h:64</a></div></div>
<div class="ttc" id="struct_message_data_html"><div class="ttname"><a href="struct_message_data.html">MessageData</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_2src_2_m_q_t_t_client_8h_source.html#l00086">MQTTClient.h:86</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_ac9da6ada101085aa9ba129f70b95f248"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#ac9da6ada101085aa9ba129f70b95f248">MQTT::Message::dup</a></div><div class="ttdeci">bool dup</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00052">MQTTClient.h:52</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a549111dc3c0a49dd2ba3ac10561c2173a14dc14f3d6013dcbfb6a2d88f9245b81"><div class="ttname"><a href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a14dc14f3d6013dcbfb6a2d88f9245b81">MQTT::QOS0</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00042">MQTTClient.h:42</a></div></div>
<div class="ttc" id="_m_q_t_t_client_8c_html_a418e2bc4b929202f5ea4008beddc14d0"><div class="ttname"><a href="_m_q_t_t_client_8c.html#a418e2bc4b929202f5ea4008beddc14d0">waitfor</a></div><div class="ttdeci">int waitfor(MQTTClient *c, int packet_type, Timer *timer)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_client_8c_source.html#l00345">MQTTClient.c:345</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_a42412d6c64b1c703f3abb3b10cbd233e"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#a42412d6c64b1c703f3abb3b10cbd233e">MQTT::Client::messageHandler</a></div><div class="ttdeci">void(* messageHandler)(MessageData &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00103">MQTTClient.h:103</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_af14fc1a824e33c0a7cda6784aa95dace"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#af14fc1a824e33c0a7cda6784aa95dace">MQTT::Client::subscribe</a></div><div class="ttdeci">int subscribe(const char *topicFilter, enum QoS qos, messageHandler mh)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00727">MQTTClient.h:727</a></div></div>
<div class="ttc" id="union_m_q_t_t_header_html_a9b2c40029ba354713e46b76ca74b2420"><div class="ttname"><a href="union_m_q_t_t_header.html#a9b2c40029ba354713e46b76ca74b2420">MQTTHeader::byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00055">MQTTPacket.h:55</a></div></div>
<div class="ttc" id="class_f_p_html"><div class="ttname"><a href="class_f_p.html">FP</a></div><div class="ttdoc">API for managing Function Pointers. </div><div class="ttdef"><b>Definition:</b> <a href="_f_p_8h_source.html#l00131">FP.h:131</a></div></div>
<div class="ttc" id="_m_q_t_t_connect_8h_html_abd5c098c9e4a5cf2f5607e4a9db6c43b"><div class="ttname"><a href="_m_q_t_t_connect_8h.html#abd5c098c9e4a5cf2f5607e4a9db6c43b">MQTTSerialize_pingreq</a></div><div class="ttdeci">DLLExport int MQTTSerialize_pingreq(unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_client_8c_source.html#l00213">MQTTConnectClient.c:213</a></div></div>
<div class="ttc" id="_m_q_t_t_format_8c_html_a081fe12d147970958623d53fd4e61735"><div class="ttname"><a href="_m_q_t_t_format_8c.html#a081fe12d147970958623d53fd4e61735">MQTTFormat_toClientString</a></div><div class="ttdeci">char * MQTTFormat_toClientString(char *strbuf, int strbuflen, unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_format_8c_source.html#l00117">MQTTFormat.c:117</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_packet_id_html_a4cca89af7a52518ea77d43491ca9059b"><div class="ttname"><a href="class_m_q_t_t_1_1_packet_id.html#a4cca89af7a52518ea77d43491ca9059b">MQTT::PacketId::getNext</a></div><div class="ttdeci">int getNext()</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00077">MQTTClient.h:77</a></div></div>
<div class="ttc" id="union_m_q_t_t_header_html_af366887430d3f755e398cea31022c1a3"><div class="ttname"><a href="union_m_q_t_t_header.html#af366887430d3f755e398cea31022c1a3">MQTTHeader::bits</a></div><div class="ttdeci">struct MQTTHeader::@64 bits</div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a6c80acf0cc016cb26a40d2ad681a76aeaa1b956048909aa613f9172983994380c"><div class="ttname"><a href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa1b956048909aa613f9172983994380c">MQTT::BUFFER_OVERFLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00045">MQTTClient.h:45</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_ad1a880e68f68c218f19c602996bb61ee"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#ad1a880e68f68c218f19c602996bb61ee">MQTT::Message::payloadlen</a></div><div class="ttdeci">size_t payloadlen</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00055">MQTTClient.h:55</a></div></div>
<div class="ttc" id="struct_m_q_t_t_string_html"><div class="ttname"><a href="struct_m_q_t_t_string.html">MQTTString</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00081">MQTTPacket.h:81</a></div></div>
<div class="ttc" id="_m_q_t_t_connect_8h_html_a612f9e23a665b10198fc59e676dc94f9"><div class="ttname"><a href="_m_q_t_t_connect_8h.html#a612f9e23a665b10198fc59e676dc94f9">MQTTSerialize_connect</a></div><div class="ttdeci">DLLExport int MQTTSerialize_connect(unsigned char *buf, int buflen, MQTTPacket_connectData *options)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_client_8c_source.html#l00058">MQTTConnectClient.c:58</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1a1a3a12a071fc8874e9518b1c94aaef30"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1a3a12a071fc8874e9518b1c94aaef30">PINGRESP</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00087">PubSubClient.h:87</a></div></div>
<div class="ttc" id="_m_q_t_t_client_8c_html_aec16090cf96b12cdfc44acda8908e6a2"><div class="ttname"><a href="_m_q_t_t_client_8c.html#aec16090cf96b12cdfc44acda8908e6a2">keepalive</a></div><div class="ttdeci">int keepalive(MQTTClient *c)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_client_8c_source.html#l00195">MQTTClient.c:195</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1ad6c983841148fc8d12e721038df5bb85">PUBREL</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00080">PubSubClient.h:80</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_data_html"><div class="ttname"><a href="struct_m_q_t_t_1_1_message_data.html">MQTT::MessageData</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00059">MQTTClient.h:59</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73"><div class="ttname"><a href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aeaa41666789546afb8df3d8a0f4f40df73">MQTT::SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00045">MQTTClient.h:45</a></div></div>
<div class="ttc" id="multi-uv_8c_html_afb43b78d9a22f95e721353db4408304c"><div class="ttname"><a href="multi-uv_8c.html#afb43b78d9a22f95e721353db4408304c">timeout</a></div><div class="ttdeci">uv_timer_t timeout</div><div class="ttdef"><b>Definition:</b> <a href="multi-uv_8c_source.html#l00042">multi-uv.c:42</a></div></div>
<div class="ttc" id="_m_q_t_t_publish_8h_html_a65f4a3f8efdd0c3c67d980adbaa9adb5"><div class="ttname"><a href="_m_q_t_t_publish_8h.html#a65f4a3f8efdd0c3c67d980adbaa9adb5">MQTTSerialize_publish</a></div><div class="ttdeci">DLLExport int MQTTSerialize_publish(unsigned char *buf, int buflen, unsigned char dup, int qos, unsigned char retained, unsigned short packetid, MQTTString topicName, unsigned char *payload, int payloadlen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_serialize_publish_8c_source.html#l00055">MQTTSerializePublish.c:55</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_afde257d236c56680a5b132633c3a44ed"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#afde257d236c56680a5b132633c3a44ed">MQTT::Client::setDefaultMessageHandler</a></div><div class="ttdeci">void setDefaultMessageHandler(messageHandler mh)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00115">MQTTClient.h:115</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_ac1e8a91bcfcd5f518849b46152211991"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#ac1e8a91bcfcd5f518849b46152211991">MQTT::Client::disconnect</a></div><div class="ttdeci">int disconnect()</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00923">MQTTClient.h:923</a></div></div>
<div class="ttc" id="_m_q_t_t_unsubscribe_8h_html_a959e05d42b06a5c6a7cecbaa61bee68d"><div class="ttname"><a href="_m_q_t_t_unsubscribe_8h.html#a959e05d42b06a5c6a7cecbaa61bee68d">MQTTDeserialize_unsuback</a></div><div class="ttdeci">DLLExport int MQTTDeserialize_unsuback(unsigned short *packetid, unsigned char *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_unsubscribe_client_8c_source.html#l00092">MQTTUnsubscribeClient.c:92</a></div></div>
<div class="ttc" id="_m_q_t_t_deserialize_publish_8c_html_a72900aeb8c3a63ea49a61020fd7dd45a"><div class="ttname"><a href="_m_q_t_t_deserialize_publish_8c.html#a72900aeb8c3a63ea49a61020fd7dd45a">MQTTDeserialize_publish</a></div><div class="ttdeci">int MQTTDeserialize_publish(unsigned char *dup, int *qos, unsigned char *retained, unsigned short *packetid, MQTTString *topicName, unsigned char **payload, int *payloadlen, unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_deserialize_publish_8c_source.html#l00036">MQTTDeserializePublish.c:36</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_a7388592f2fa96f57a9e65c794d0c993c"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#a7388592f2fa96f57a9e65c794d0c993c">MQTT::Message::retained</a></div><div class="ttdeci">bool retained</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00051">MQTTClient.h:51</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="_m_q_t_t_connect_8h_html_a356cb5639f3d0d6d002b4a144a58f11a"><div class="ttname"><a href="_m_q_t_t_connect_8h.html#a356cb5639f3d0d6d002b4a144a58f11a">MQTTDeserialize_connack</a></div><div class="ttdeci">DLLExport int MQTTDeserialize_connack(unsigned char *sessionPresent, unsigned char *connack_rc, unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_client_8c_source.html#l00132">MQTTConnectClient.c:132</a></div></div>
<div class="ttc" id="_m_q_t_t_connect_8h_html_aa30ad14dad5094716ec3de426d20ca37"><div class="ttname"><a href="_m_q_t_t_connect_8h.html#aa30ad14dad5094716ec3de426d20ca37">MQTTSerialize_disconnect</a></div><div class="ttdeci">DLLExport int MQTTSerialize_disconnect(unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_client_8c_source.html#l00201">MQTTConnectClient.c:201</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1afbeab5fd4cdcb49a725fc27099c16cc2">PUBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00078">PubSubClient.h:78</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8h_html_acc606fd1a635e8603c1418c81bca4ecf"><div class="ttname"><a href="_m_q_t_t_packet_8h.html#acc606fd1a635e8603c1418c81bca4ecf">MQTTSerialize_ack</a></div><div class="ttdeci">int MQTTSerialize_ack(unsigned char *buf, int buflen, unsigned char type, unsigned char dup, unsigned short packetid)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_serialize_publish_8c_source.html#l00104">MQTTSerializePublish.c:104</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_a8e9e9c6510e7e819360462500564ccd1"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#a8e9e9c6510e7e819360462500564ccd1">MQTT::Client::unsubscribe</a></div><div class="ttdeci">int unsubscribe(const char *topicFilter)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00774">MQTTClient.h:774</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8c_html_a37bbf8101236ecfae4b6bb2e63c10075"><div class="ttname"><a href="_m_q_t_t_packet_8c.html#a37bbf8101236ecfae4b6bb2e63c10075">MQTTPacket_equals</a></div><div class="ttdeci">int MQTTPacket_equals(MQTTString *a, char *bptr)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8c_source.html#l00260">MQTTPacket.c:260</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html">MQTT::Message</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00048">MQTTClient.h:48</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_data_html_a51773f08310352751f5dd773a1df045d"><div class="ttname"><a href="struct_m_q_t_t_1_1_message_data.html#a51773f08310352751f5dd773a1df045d">MQTT::MessageData::MessageData</a></div><div class="ttdeci">MessageData(MQTTString &amp;aTopicName, struct Message &amp;aMessage)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00061">MQTTClient.h:61</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8c_html_a5464b2e101bc4dc199e58486c4ffaa9f"><div class="ttname"><a href="_m_q_t_t_packet_8c.html#a5464b2e101bc4dc199e58486c4ffaa9f">MQTTPacket_encode</a></div><div class="ttdeci">int MQTTPacket_encode(unsigned char *buf, int length)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8c_source.html#l00029">MQTTPacket.c:29</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="struct_timer_html"><div class="ttname"><a href="struct_timer.html">Timer</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_c_c3200_8h_source.html#l00028">MQTTCC3200.h:28</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html">MQTT::Client</a></div><div class="ttdoc">blocking, non-threaded MQTT client API </div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00098">MQTTClient.h:98</a></div></div>
<div class="ttc" id="_f_p_8h_html"><div class="ttname"><a href="_f_p_8h.html">FP.h</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7"><div class="ttname"><a href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a67190ba35b18fa3bcdc3b1c34256b8f7">MQTT::QOS1</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00042">MQTTClient.h:42</a></div></div>
<div class="ttc" id="struct_m_q_t_t_string_html_a78847a9d8950eeefa8e270a5c67c9a35"><div class="ttname"><a href="struct_m_q_t_t_string.html#a78847a9d8950eeefa8e270a5c67c9a35">MQTTString::lenstring</a></div><div class="ttdeci">MQTTLenString lenstring</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00084">MQTTPacket.h:84</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="form_8d_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00048">form.d:48</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_ace4f0a238535ff38fa2a1eb1fadff1be"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#ace4f0a238535ff38fa2a1eb1fadff1be">MQTT::Client::Client</a></div><div class="ttdeci">Client(Network &amp;network, unsigned int command_timeout_ms=30000)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00279">MQTTClient.h:279</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8h_html"><div class="ttname"><a href="_m_q_t_t_packet_8h.html">MQTTPacket.h</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1acae9f9c28803a317d9302650dc7dab0c">PUBCOMP</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00081">PubSubClient.h:81</a></div></div>
<div class="ttc" id="_m_q_t_t_logging_8h_html_a96dd473db0b3d10bd43390cdacb00120"><div class="ttname"><a href="_m_q_t_t_logging_8h.html#a96dd473db0b3d10bd43390cdacb00120">DEBUG</a></div><div class="ttdeci">#define DEBUG(...)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_logging_8h_source.html#l00022">MQTTLogging.h:22</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8c_html_a166c9117b1ef3db3292d475f300ca560"><div class="ttname"><a href="_m_q_t_t_packet_8c.html#a166c9117b1ef3db3292d475f300ca560">MAX_NO_OF_REMAINING_LENGTH_BYTES</a></div><div class="ttdeci">#define MAX_NO_OF_REMAINING_LENGTH_BYTES</div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_a8b21e4c3a200b749b9821a342d9f0b26"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#a8b21e4c3a200b749b9821a342d9f0b26">MQTT::Client::isConnected</a></div><div class="ttdeci">bool isConnected()</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00192">MQTTClient.h:192</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html"><div class="ttname"><a href="namespace_m_q_t_t.html">MQTT</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00038">MQTTClient.h:38</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_ae454878601be8a182373af8c1b622401"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#ae454878601be8a182373af8c1b622401">MQTT::Client::publish</a></div><div class="ttdeci">int publish(const char *topicName, Message &amp;message)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00916">MQTTClient.h:916</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8h_html_acc42076253600be964e110149b458971a5cbe32551f8036958703f757c0d1a857"><div class="ttname"><a href="_m_q_t_t_packet_8h.html#acc42076253600be964e110149b458971a5cbe32551f8036958703f757c0d1a857">MQTTPACKET_READ_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00039">MQTTPacket.h:39</a></div></div>
<div class="ttc" id="asiohiper_8cpp_html_a6363ad0c2267201dc689dbbbc4ae4305"><div class="ttname"><a href="asiohiper_8cpp.html#a6363ad0c2267201dc689dbbbc4ae4305">timer</a></div><div class="ttdeci">boost::asio::deadline_timer timer(io_service)</div></div>
<div class="ttc" id="_m_q_t_t_subscribe_8h_html_aa88712c28d8b9ad842d4d9c7453c8528"><div class="ttname"><a href="_m_q_t_t_subscribe_8h.html#aa88712c28d8b9ad842d4d9c7453c8528">MQTTSerialize_subscribe</a></div><div class="ttdeci">DLLExport int MQTTSerialize_subscribe(unsigned char *buf, int buflen, unsigned char dup, unsigned short packetid, int count, MQTTString topicFilters[], int requestedQoSs[])</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_subscribe_client_8c_source.html#l00050">MQTTSubscribeClient.c:50</a></div></div>
<div class="ttc" id="mqtt__paho_8c_html_a2d9a64328e83ad37af17cbeb5e73b5df"><div class="ttname"><a href="mqtt__paho_8c.html#a2d9a64328e83ad37af17cbeb5e73b5df">network</a></div><div class="ttdeci">Network network</div><div class="ttdef"><b>Definition:</b> <a href="mqtt__paho_8c_source.html#l00013">mqtt_paho.c:13</a></div></div>
<div class="ttc" id="struct_m_q_t_t_string_html_a00126e87a6bbc0ddd66918920fd4a425"><div class="ttname"><a href="struct_m_q_t_t_string.html#a00126e87a6bbc0ddd66918920fd4a425">MQTTString::cstring</a></div><div class="ttdeci">char * cstring</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00083">MQTTPacket.h:83</a></div></div>
<div class="ttc" id="setup-os400_8h_html_adfd4ee688142ebda1142c1b0c7577e91"><div class="ttname"><a href="setup-os400_8h.html#adfd4ee688142ebda1142c1b0c7577e91">connect</a></div><div class="ttdeci">#define connect</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00210">setup-os400.h:210</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1abd1a204dcfa4933760cd12e779f36fc5"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abd1a204dcfa4933760cd12e779f36fc5">PUBLISH</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00077">PubSubClient.h:77</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_af9913a98a2f17c394121cc694ed9cf36"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#af9913a98a2f17c394121cc694ed9cf36">MQTT::Message::id</a></div><div class="ttdeci">unsigned short id</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00053">MQTTClient.h:53</a></div></div>
<div class="ttc" id="_m_q_t_t_client_8c_html_a9ee5e1a3021798303d1efab7996dbd36"><div class="ttname"><a href="_m_q_t_t_client_8c.html#a9ee5e1a3021798303d1efab7996dbd36">deliverMessage</a></div><div class="ttdeci">int deliverMessage(MQTTClient *c, MQTTString *topicName, MQTTMessage *message)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_client_8c_source.html#l00162">MQTTClient.c:162</a></div></div>
<div class="ttc" id="struct_m_q_t_t_len_string_html_a7eb20db2b77f5e224e12d94c78573fa3"><div class="ttname"><a href="struct_m_q_t_t_len_string.html#a7eb20db2b77f5e224e12d94c78573fa3">MQTTLenString::len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00077">MQTTPacket.h:77</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1a722b573f419f3cdb3b2263f7dd00a3ae"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a722b573f419f3cdb3b2263f7dd00a3ae">UNSUBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00085">PubSubClient.h:85</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1a1e2c2a84e88263f41d3b9bed26bf4e89"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1a1e2c2a84e88263f41d3b9bed26bf4e89">PUBREC</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00079">PubSubClient.h:79</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a6c80acf0cc016cb26a40d2ad681a76ae"><div class="ttname"><a href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76ae">MQTT::returnCode</a></div><div class="ttdeci">returnCode</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00045">MQTTClient.h:45</a></div></div>
<div class="ttc" id="_m_q_t_t_logging_8h_html"><div class="ttname"><a href="_m_q_t_t_logging_8h.html">MQTTLogging.h</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_a3676580238ca03ec60810b8ed2baf2e9"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#a3676580238ca03ec60810b8ed2baf2e9">MQTT::Client::yield</a></div><div class="ttdeci">int yield(unsigned long timeout_ms=1000L)</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00504">MQTTClient.h:504</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_aac97ac3db89ef94c772fb57ae81e6576"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#aac97ac3db89ef94c772fb57ae81e6576">MQTT::Message::payload</a></div><div class="ttdeci">void * payload</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00054">MQTTClient.h:54</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_packet_id_html_a93b9fc49bdf5c400091046d2c4d3d3e9"><div class="ttname"><a href="class_m_q_t_t_1_1_packet_id.html#a93b9fc49bdf5c400091046d2c4d3d3e9">MQTT::PacketId::PacketId</a></div><div class="ttdeci">PacketId()</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00072">MQTTClient.h:72</a></div></div>
<div class="ttc" id="_c_2src_2_m_q_t_t_client_8h_html_a2a5744b0ca3f049979e6777b75d7a634"><div class="ttname"><a href="_c_2src_2_m_q_t_t_client_8h.html#a2a5744b0ca3f049979e6777b75d7a634">QoS</a></div><div class="ttdeci">QoS</div><div class="ttdef"><b>Definition:</b> <a href="_c_2src_2_m_q_t_t_client_8h_source.html#l00054">MQTTClient.h:54</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_html_a5d62588771b8265f17ab1ae31901874b"><div class="ttname"><a href="struct_m_q_t_t_1_1_message.html#a5d62588771b8265f17ab1ae31901874b">MQTT::Message::qos</a></div><div class="ttdeci">enum QoS qos</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00050">MQTTClient.h:50</a></div></div>
<div class="ttc" id="_m_q_t_t_deserialize_publish_8c_html_aef7f705e677e0467230a24a1134ec1f2"><div class="ttname"><a href="_m_q_t_t_deserialize_publish_8c.html#aef7f705e677e0467230a24a1134ec1f2">MQTTDeserialize_ack</a></div><div class="ttdeci">int MQTTDeserialize_ack(unsigned char *packettype, unsigned char *dup, unsigned short *packetid, unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_deserialize_publish_8c_source.html#l00082">MQTTDeserializePublish.c:82</a></div></div>
<div class="ttc" id="_c_2src_2_m_q_t_t_client_8h_html_a097fe1f2aed537fea5c806f7c231535e"><div class="ttname"><a href="_c_2src_2_m_q_t_t_client_8h.html#a097fe1f2aed537fea5c806f7c231535e">MAX_MESSAGE_HANDLERS</a></div><div class="ttdeci">#define MAX_MESSAGE_HANDLERS</div><div class="ttdef"><b>Definition:</b> <a href="_c_2src_2_m_q_t_t_client_8h_source.html#l00051">MQTTClient.h:51</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200"><div class="ttname"><a href="namespace_m_q_t_t.html#a6c80acf0cc016cb26a40d2ad681a76aea0962074415cf46e561c1cf25e3607200">MQTT::FAILURE</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00045">MQTTClient.h:45</a></div></div>
<div class="ttc" id="_c_2src_2_m_q_t_t_client_8h_html_a2a5744b0ca3f049979e6777b75d7a634a7d2552996d8248e57b28f5328fc1e003"><div class="ttname"><a href="_c_2src_2_m_q_t_t_client_8h.html#a2a5744b0ca3f049979e6777b75d7a634a7d2552996d8248e57b28f5328fc1e003">QOS0</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_2src_2_m_q_t_t_client_8h_source.html#l00054">MQTTClient.h:54</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_packet_id_html"><div class="ttname"><a href="class_m_q_t_t_1_1_packet_id.html">MQTT::PacketId</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00069">MQTTClient.h:69</a></div></div>
<div class="ttc" id="_m_q_t_t_unsubscribe_8h_html_a9f16e69d4c62e3a9ef1d2734510bc016"><div class="ttname"><a href="_m_q_t_t_unsubscribe_8h.html#a9f16e69d4c62e3a9ef1d2734510bc016">MQTTSerialize_unsubscribe</a></div><div class="ttdeci">DLLExport int MQTTSerialize_unsubscribe(unsigned char *buf, int buflen, unsigned char dup, unsigned short packetid, int count, MQTTString topicFilters[])</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_unsubscribe_client_8c_source.html#l00049">MQTTUnsubscribeClient.c:49</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1abe48cb8225101545fd55752f2534348d"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1abe48cb8225101545fd55752f2534348d">SUBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00083">PubSubClient.h:83</a></div></div>
<div class="ttc" id="class_m_q_t_t_1_1_client_html_a3eabfc67e51717765203dceb1cc35bd4"><div class="ttname"><a href="class_m_q_t_t_1_1_client.html#a3eabfc67e51717765203dceb1cc35bd4">MQTT::Client::connect</a></div><div class="ttdeci">int connect()</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00719">MQTTClient.h:719</a></div></div>
<div class="ttc" id="_m_q_t_t_logging_8h_html_a8f75b971030a39ef811d3526a62b36b8"><div class="ttname"><a href="_m_q_t_t_logging_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a></div><div class="ttdeci">#define WARN(...)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_logging_8h_source.html#l00038">MQTTLogging.h:38</a></div></div>
<div class="ttc" id="struct_m_q_t_t_len_string_html_ac875ffa1e0af752d17a10be055c33377"><div class="ttname"><a href="struct_m_q_t_t_len_string.html#ac875ffa1e0af752d17a10be055c33377">MQTTLenString::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00078">MQTTPacket.h:78</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="_c_2src_2_m_q_t_t_client_8h_html_a57263a23e77cb842104b9a1d39dba53e"><div class="ttname"><a href="_c_2src_2_m_q_t_t_client_8h.html#a57263a23e77cb842104b9a1d39dba53e">messageHandler</a></div><div class="ttdeci">void(* messageHandler)(MessageData *)</div><div class="ttdef"><b>Definition:</b> <a href="_c_2src_2_m_q_t_t_client_8h_source.html#l00092">MQTTClient.h:92</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2"><div class="ttname"><a href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173a824da0ec0c31a8d2978980a4ac9f7eb2">MQTT::QOS2</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00042">MQTTClient.h:42</a></div></div>
<div class="ttc" id="_m_q_t_t_subscribe_8h_html_a67a03482ca40e354dec5abc8561004e4"><div class="ttname"><a href="_m_q_t_t_subscribe_8h.html#a67a03482ca40e354dec5abc8561004e4">MQTTDeserialize_suback</a></div><div class="ttdeci">DLLExport int MQTTDeserialize_suback(unsigned short *packetid, int maxcount, int *count, int grantedQoSs[], unsigned char *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_subscribe_client_8c_source.html#l00100">MQTTSubscribeClient.c:100</a></div></div>
<div class="ttc" id="struct_m_q_t_t_packet__connect_data_html"><div class="ttname"><a href="struct_m_q_t_t_packet__connect_data.html">MQTTPacket_connectData</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_8h_source.html#l00088">MQTTConnect.h:88</a></div></div>
<div class="ttc" id="_m_q_t_t_packet_8h_html_a34afa3fe58c14803eec9957875c70342"><div class="ttname"><a href="_m_q_t_t_packet_8h.html#a34afa3fe58c14803eec9957875c70342">MQTTString_initializer</a></div><div class="ttdeci">#define MQTTString_initializer</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00087">MQTTPacket.h:87</a></div></div>
<div class="ttc" id="namespace_m_q_t_t_html_a549111dc3c0a49dd2ba3ac10561c2173"><div class="ttname"><a href="namespace_m_q_t_t.html#a549111dc3c0a49dd2ba3ac10561c2173">MQTT::QoS</a></div><div class="ttdeci">QoS</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00042">MQTTClient.h:42</a></div></div>
<div class="ttc" id="union_m_q_t_t_header_html"><div class="ttname"><a href="union_m_q_t_t_header.html">MQTTHeader</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00053">MQTTPacket.h:53</a></div></div>
<div class="ttc" id="_m_q_t_t_client_8c_html_a2bcf85f488f98b6d8e539f37c37eab78"><div class="ttname"><a href="_m_q_t_t_client_8c.html#a2bcf85f488f98b6d8e539f37c37eab78">cycle</a></div><div class="ttdeci">int cycle(MQTTClient *c, Timer *timer)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_client_8c_source.html#l00223">MQTTClient.c:223</a></div></div>
<div class="ttc" id="struct_m_q_t_t_1_1_message_data_html_a4f659e4cf961134230faea3f21852e4a"><div class="ttname"><a href="struct_m_q_t_t_1_1_message_data.html#a4f659e4cf961134230faea3f21852e4a">MQTT::MessageData::topicName</a></div><div class="ttdeci">MQTTString &amp; topicName</div><div class="ttdef"><b>Definition:</b> <a href="src_2_m_q_t_t_client_8h_source.html#l00065">MQTTClient.h:65</a></div></div>
<div class="ttc" id="fail-early_8d_html_a188ba6f263db5df5a64e1cc11fb0c098"><div class="ttname"><a href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply which causes transfers to fail due to the server s HTTP status code.You can combine the two options</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="union_m_q_t_t_header_html_aab9204aefddf8f4f6c6d6f58f4c1ab1c"><div class="ttname"><a href="union_m_q_t_t_header.html#aab9204aefddf8f4f6c6d6f58f4c1ab1c">MQTTHeader::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_packet_8h_source.html#l00070">MQTTPacket.h:70</a></div></div>
<div class="ttc" id="_m_q_t_t_connect_8h_html_a3e475310d0fdc12dfb3ae2d4e802bb7b"><div class="ttname"><a href="_m_q_t_t_connect_8h.html#a3e475310d0fdc12dfb3ae2d4e802bb7b">MQTTPacket_connectData_initializer</a></div><div class="ttdeci">#define MQTTPacket_connectData_initializer</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_connect_8h_source.html#l00124">MQTTConnect.h:124</a></div></div>
<div class="ttc" id="struct_network_html"><div class="ttname"><a href="struct_network.html">Network</a></div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_c_c3200_8h_source.html#l00035">MQTTCC3200.h:35</a></div></div>
<div class="ttc" id="_pub_sub_client_8h_html_ac243cf15beb51b2206e36da86c2f95f1aa636430e8d9563704f7328824d6bc0a5"><div class="ttname"><a href="_pub_sub_client_8h.html#ac243cf15beb51b2206e36da86c2f95f1aa636430e8d9563704f7328824d6bc0a5">CONNACK</a></div><div class="ttdef"><b>Definition:</b> <a href="_pub_sub_client_8h_source.html#l00076">PubSubClient.h:76</a></div></div>
<div class="ttc" id="_m_q_t_t_format_8c_html_a29f425be3d4f6facad4359f7e2b9d334"><div class="ttname"><a href="_m_q_t_t_format_8c.html#a29f425be3d4f6facad4359f7e2b9d334">MQTTFormat_toServerString</a></div><div class="ttdeci">char * MQTTFormat_toServerString(char *strbuf, int strbuflen, unsigned char *buf, int buflen)</div><div class="ttdef"><b>Definition:</b> <a href="_m_q_t_t_format_8c_source.html#l00185">MQTTFormat.c:185</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e6509e8e306afd21d8371d681599573a.html">networking</a></li><li class="navelem"><a class="el" href="dir_bc0c0b9b7f6662c190af4a813f93d198.html">mqtt</a></li><li class="navelem"><a class="el" href="dir_f010d300aa4f2aca70794602db48245c.html">paho_mqtt_embedded_c</a></li><li class="navelem"><a class="el" href="dir_6a8d93c98e4489f281da583b67454e53.html">MQTTClient</a></li><li class="navelem"><a class="el" href="dir_d26eb8a9337201d4147d4b6391c76f4b.html">src</a></li><li class="navelem"><a class="el" href="src_2_m_q_t_t_client_8h.html">MQTTClient.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
