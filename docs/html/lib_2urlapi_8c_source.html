<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/urlapi.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lib_2urlapi_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">urlapi.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lib_2urlapi_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urlapi-int_8h.html">urlapi-int.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dotdot_8h.html">dotdot.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="url_8h.html">url.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="escape_8h.html">escape.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__ctype_8h.html">curl_ctype.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">/* MSDOS/Windows style drive prefix, eg c: in c:foo */</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a1d8ca5825ab9492349fd408756468b27">   39</a></span>&#160;<span class="preprocessor">#define STARTS_WITH_DRIVE_PREFIX(str) \</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">  (((&#39;a&#39; &lt;= str[0] &amp;&amp; str[0] &lt;= &#39;z&#39;) || \</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    (&#39;A&#39; &lt;= str[0] &amp;&amp; str[0] &lt;= &#39;Z&#39;)) &amp;&amp; \</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">   (str[1] == &#39;:&#39;))</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* MSDOS/Windows style drive prefix, optionally with</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   * a &#39;|&#39; instead of &#39;:&#39;, followed by a slash or NUL */</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">   46</a></span>&#160;<span class="preprocessor">#define STARTS_WITH_URL_DRIVE_PREFIX(str) \</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">  (((&#39;a&#39; &lt;= (str)[0] &amp;&amp; (str)[0] &lt;= &#39;z&#39;) || \</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">    (&#39;A&#39; &lt;= (str)[0] &amp;&amp; (str)[0] &lt;= &#39;Z&#39;)) &amp;&amp; \</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">   ((str)[1] == &#39;:&#39; || (str)[1] == &#39;|&#39;) &amp;&amp; \</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">   ((str)[2] == &#39;/&#39; || (str)[2] == &#39;\\&#39; || (str)[2] == 0))</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/* Internal representation of CURLU. Point to URL-encoded strings. */</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html">   53</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> {</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#af9b39b0fdf1de99bc781256e6dce8d6a">   54</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#af9b39b0fdf1de99bc781256e6dce8d6a">scheme</a>;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a110d8c27483dbddc6689dcaa885ebb7f">   55</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a110d8c27483dbddc6689dcaa885ebb7f">user</a>;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#afac1991683b4eb2bb3600888985f924f">   56</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#afac1991683b4eb2bb3600888985f924f">password</a>;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a308f107777e2f37d57b8d22c15f8741f">   57</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a308f107777e2f37d57b8d22c15f8741f">options</a>; <span class="comment">/* IMAP only? */</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#aaaa882d02aaad0789a5943b5b40c17b8">   58</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#aaaa882d02aaad0789a5943b5b40c17b8">host</a>;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a285f240406a220d80b38098e7a94a26c">   59</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a285f240406a220d80b38098e7a94a26c">port</a>;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a9712d2cd9e5b9008e221cd47d640bebf">   60</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a9712d2cd9e5b9008e221cd47d640bebf">path</a>;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a7daffe0df6606d6aee91f8933a050ce4">   61</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a7daffe0df6606d6aee91f8933a050ce4">query</a>;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a29fe0a21f345498978757395ed49a134">   62</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#a29fe0a21f345498978757395ed49a134">fragment</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#ab04be2ae8d4204d4b70474d9db109784">   64</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="struct_curl___u_r_l.html#ab04be2ae8d4204d4b70474d9db109784">scratch</a>; <span class="comment">/* temporary scratch area */</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="struct_curl___u_r_l.html#a62f2e16d24df9ee5f7cde35a2eaea9e5">   65</a></span>&#160;  <span class="keywordtype">long</span> <a class="code" href="struct_curl___u_r_l.html#a62f2e16d24df9ee5f7cde35a2eaea9e5">portnum</a>; <span class="comment">/* the numerical version */</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;};</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#af5442ca84b3ad9479b29da9433ad27bd">   68</a></span>&#160;<span class="preprocessor">#define DEFAULT_SCHEME &quot;https&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> free_urlhandle(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scratch);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">/* move the full contents of one handle onto another and</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">   free the original */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> mv_urlhandle(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *from,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *<a class="code" href="form_8d.html#ac776e8c2aa1a100ee6a391f59441ccf4">to</a>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  free_urlhandle(<a class="code" href="form_8d.html#ac776e8c2aa1a100ee6a391f59441ccf4">to</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  *<a class="code" href="form_8d.html#ac776e8c2aa1a100ee6a391f59441ccf4">to</a> = *from;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(from);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * Find the separator at the end of the host name, or the &#39;?&#39; in cases like</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> * http://www.url.com?id=2380</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *find_host_sep(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *sep;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *query;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* Find the start of the hostname */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  sep = strstr(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <span class="stringliteral">&quot;//&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span>(!sep)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    sep = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    sep += 2;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  query = strchr(sep, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  sep = strchr(sep, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span>(!sep)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    sep = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> + strlen(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span>(!query)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    query = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> + strlen(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">return</span> sep &lt; query ? sep : query;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> * Decide in an encoding-independent manner whether a character in an</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> * URL must be escaped. The same criterion must be used in strlen_url()</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> * and strcpy_url().</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> urlchar_needs_escaping(<span class="keywordtype">int</span> c)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> !(<a class="code" href="curl__ctype_8h.html#ae262b4651f9bbb296ca4b7725d6df9fd">ISCNTRL</a>(c) || <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(c) || <a class="code" href="curl__ctype_8h.html#aff5da85872d542fca69aa535244b2694">ISGRAPH</a>(c));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> * strlen_url() returns the length of the given URL if the spaces within the</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> * URL were properly URL encoded.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> * URL encoding should be skipped for host names, otherwise IDN resolution</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * will fail.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#adb99149ef0cf15c972298fc617457f13">  138</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="lib_2urlapi_8c.html#adb99149ef0cf15c972298fc617457f13">Curl_strlen_url</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <span class="keywordtype">bool</span> relative)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">size_t</span> newlen = 0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">bool</span> left = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* left side of the ? */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *host_sep = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span>(!relative)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    host_sep = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) find_host_sep(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>; *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>; <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &lt; host_sep) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      ++newlen;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">switch</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      left = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span>(urlchar_needs_escaping(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>))</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        newlen += 2;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      newlen++;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">if</span>(left)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        newlen += 3;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        newlen++;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> newlen;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/* strcpy_url() copies a url to a output buffer and URL-encodes the spaces in</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * the source URL accordingly.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * URL encoding should be skipped for host names, otherwise IDN resolution</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> * will fail.</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#aba93935f5c7359dd3ee0bf497178cf0f">  180</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lib_2urlapi_8c.html#aba93935f5c7359dd3ee0bf497178cf0f">Curl_strcpy_url</a>(<span class="keywordtype">char</span> *<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <span class="keywordtype">bool</span> relative)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">/* we must add this with whitespace-replacing */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">bool</span> left = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iptr;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">char</span> *optr = <a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *host_sep = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span>(!relative)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    host_sep = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) find_host_sep(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">for</span>(iptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;    <span class="comment">/* read from here */</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      *iptr;         <span class="comment">/* until zero byte */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      iptr++) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span>(iptr &lt; host_sep) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      *optr++ = *iptr;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">switch</span>(*iptr) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      left = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span>(urlchar_needs_escaping(*iptr)) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(optr, 4, <span class="stringliteral">&quot;%%%02x&quot;</span>, *iptr);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        optr += 3;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        *optr++=*iptr;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>:</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span>(left) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        *optr++=<span class="charliteral">&#39;%&#39;</span>; <span class="comment">/* add a &#39;%&#39; */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        *optr++=<span class="charliteral">&#39;2&#39;</span>; <span class="comment">/* add a &#39;2&#39; */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        *optr++=<span class="charliteral">&#39;0&#39;</span>; <span class="comment">/* add a &#39;0&#39; */</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        *optr++=<span class="charliteral">&#39;+&#39;</span>; <span class="comment">/* add a &#39;+&#39; here */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  *optr = 0; <span class="comment">/* zero terminate output buffer */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"> * Returns true if the given URL is absolute (as opposed to relative) within</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> * the buffer size. Returns the scheme in the buffer if TRUE and &#39;buf&#39; is</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> * non-NULL.</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a907290236fba856375068b6d2fa8045d">  232</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="lib_2urlapi_8c.html#a907290236fba856375068b6d2fa8045d">Curl_is_absolute_url</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> buflen)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef WIN32</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="lib_2urlapi_8c.html#a1d8ca5825ab9492349fd408756468b27">STARTS_WITH_DRIVE_PREFIX</a>(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>))</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; buflen &amp;&amp; <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">char</span> s = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span>((s == <span class="charliteral">&#39;:&#39;</span>) &amp;&amp; (<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> + 1] == <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = 0;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* RFC 3986 3.1 explains:</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      scheme      = ALPHA *( ALPHA / DIGIT / &quot;+&quot; / &quot;-&quot; / &quot;.&quot; )</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="curl__ctype_8h.html#a1cb5d5dd0c364d720854e8a250967dd1">ISALNUM</a>(s) || (s == <span class="charliteral">&#39;+&#39;</span>) || (s == <span class="charliteral">&#39;-&#39;</span>) || (s == <span class="charliteral">&#39;.&#39;</span>) ) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = (char)<a class="code" href="curl__setup__once_8h.html#a50cf1998cd442f5d41df925e184fd841">TOLOWER</a>(s);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * Concatenate a relative URL to a base URL making it absolute.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> * URL-encodes any spaces.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> * The returned pointer must be freed by the caller unless NULL</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> * (returns NULL on out of memory).</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#ab173a054c4da16c296035ec089cfcaa1">  265</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="lib_2urlapi_8c.html#ab173a054c4da16c296035ec089cfcaa1">Curl_concat_url</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *base, <span class="keyword">const</span> <span class="keywordtype">char</span> *relurl)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">/***</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">   TRY to append this new path to the old URL</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">   to the right of the host part. Oh crap, this is doomed to cause</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">   problems in the future...</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">char</span> *newest;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">char</span> *protsep;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">char</span> *pathsep;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">size_t</span> newlen;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">bool</span> host_changed = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *useurl = relurl;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">size_t</span> urllen;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">/* we must make our own copy of the URL to play with, as it may</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">     point to read-only data */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">char</span> *url_clone = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(base);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span>(!url_clone)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> NULL; <span class="comment">/* skip out of this NOW */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">/* protsep points to the start of the host name */</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  protsep = strstr(url_clone, <span class="stringliteral">&quot;//&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(!protsep)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    protsep = url_clone;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    protsep += 2; <span class="comment">/* pass the slashes */</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span>(<span class="charliteral">&#39;/&#39;</span> != relurl[0]) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span> level = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">/* First we need to find out if there&#39;s a ?-letter in the URL,</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">       and cut it and the right-side of that off */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    pathsep = strchr(protsep, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span>(pathsep)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      *pathsep = 0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">/* we have a relative path to append to the last slash if there&#39;s one</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">       available, or if the new URL is just a query string (starts with a</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">       &#39;?&#39;)  we append the new one at the end of the entire currently worked</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">       out URL */</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(useurl[0] != <span class="charliteral">&#39;?&#39;</span>) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      pathsep = strrchr(protsep, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">if</span>(pathsep)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        *pathsep = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">/* Check if there&#39;s any slash after the host name, and if so, remember</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">       that position instead */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    pathsep = strchr(protsep, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span>(pathsep)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      protsep = pathsep + 1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      protsep = NULL;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">/* now deal with one &quot;./&quot; or any amount of &quot;../&quot; in the newurl</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">       and act accordingly */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span>((useurl[0] == <span class="charliteral">&#39;.&#39;</span>) &amp;&amp; (useurl[1] == <span class="charliteral">&#39;/&#39;</span>))</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      useurl += 2; <span class="comment">/* just skip the &quot;./&quot; */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">while</span>((useurl[0] == <span class="charliteral">&#39;.&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          (useurl[1] == <span class="charliteral">&#39;.&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          (useurl[2] == <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      level++;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      useurl += 3; <span class="comment">/* pass the &quot;../&quot; */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span>(protsep) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">while</span>(level--) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">/* cut off one more level from the right of the original URL */</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        pathsep = strrchr(protsep, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span>(pathsep)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          *pathsep = 0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          *protsep = 0;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">/* We got a new absolute path for this server */</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span>((relurl[0] == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp; (relurl[1] == <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">/* the new URL starts with //, just keep the protocol part from the</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">         original one */</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      *protsep = 0;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      useurl = &amp;relurl[2]; <span class="comment">/* we keep the slashes from the original, so we</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">                              skip the new ones */</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      host_changed = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="comment">/* cut off the original URL from the first slash, or deal with URLs</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">         without slash */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      pathsep = strchr(protsep, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">if</span>(pathsep) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">/* When people use badly formatted URLs, such as</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">           &quot;http://www.url.com?dir=/home/daniel&quot; we must not use the first</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">           slash, if there&#39;s a ?-letter before it! */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">char</span> *sep = strchr(protsep, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">if</span>(sep &amp;&amp; (sep &lt; pathsep))</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          pathsep = sep;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        *pathsep = 0;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">/* There was no slash. Now, since we might be operating on a badly</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">           formatted URL, such as &quot;http://www.url.com?id=2380&quot; which doesn&#39;t</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">           use a slash separator as it is supposed to, we need to check for a</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">           ?-letter as well! */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        pathsep = strchr(protsep, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">if</span>(pathsep)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          *pathsep = 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">/* If the new part contains a space, this is a mighty stupid redirect</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">     but we still make an effort to do &quot;right&quot;. To the left of a &#39;?&#39;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">     letter we replace each space with %20 while it is replaced with &#39;+&#39;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">     on the right side of the &#39;?&#39; letter.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  newlen = <a class="code" href="lib_2urlapi_8c.html#adb99149ef0cf15c972298fc617457f13">Curl_strlen_url</a>(useurl, !host_changed);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  urllen = strlen(url_clone);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  newest = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(urllen + 1 + <span class="comment">/* possible slash */</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                  newlen + 1 <span class="comment">/* zero byte */</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span>(!newest) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(url_clone); <span class="comment">/* don&#39;t leak this */</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">/* copy over the root url part */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(newest, url_clone, urllen);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">/* check if we need to append a slash */</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span>((<span class="charliteral">&#39;/&#39;</span> == useurl[0]) || (protsep &amp;&amp; !*protsep) || (<span class="charliteral">&#39;?&#39;</span> == useurl[0]))</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    ;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    newest[urllen++]=<span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">/* then append the new piece on the right side */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="lib_2urlapi_8c.html#aba93935f5c7359dd3ee0bf497178cf0f">Curl_strcpy_url</a>(&amp;newest[urllen], useurl, !host_changed);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(url_clone);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">return</span> newest;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * parse_hostname_login()</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * Parse the login details (user name, password and options) from the URL and</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> * strip them out of the host name</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> parse_hostname_login(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_curl__handler.html">Curl_handler</a> *h,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                      <span class="keywordtype">char</span> **<a class="code" href="structhostname.html">hostname</a>,</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;{</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ccode;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">char</span> *userp = NULL;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">char</span> *passwdp = NULL;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">char</span> *optionsp = NULL;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">/* At this point, we&#39;re hoping all the other special cases have</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">   * been taken care of, so conn-&gt;host.name is at most</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">   *    [user[:password][;options]]@]hostname</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">   * We need somewhere to put the embedded details, so do that first.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = strchr(*<a class="code" href="structhostname.html">hostname</a>, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">char</span> *login = *<a class="code" href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">goto</span> out;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">/* We will now try to extract the</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">   * possible login information in a string like:</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">   * ftp://user:password@ftp.my.site:8021/README */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  *<a class="code" href="structhostname.html">hostname</a> = ++<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">/* We could use the login information in the URL so extract it. Only parse</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">     options if the handler says we should. Note that &#39;h&#39; might be NULL! */</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  ccode = <a class="code" href="url_8c.html#a13ba4d524a116c2400ef2cf5cca77c3b">Curl_parse_login_details</a>(login, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> - login - 1,</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                   &amp;userp, &amp;passwdp,</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                   (h &amp;&amp; (h-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#a7dc3bffda7491b001e405e434493b896">PROTOPT_URLOPTIONS</a>)) ?</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                   &amp;optionsp:NULL);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">if</span>(ccode) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">goto</span> out;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span>(userp) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span>(flags &amp; <a class="code" href="urlapi_8h.html#ad93f0f34e1e550dc6c45ecddccfc0efb">CURLU_DISALLOW_USER</a>) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="comment">/* Option DISALLOW_USER is set and url contains username. */</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deac2e085bf461f244975782d033af83813">CURLUE_USER_NOT_ALLOWED</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordflow">goto</span> out;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user = userp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span>(passwdp)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password = passwdp;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">if</span>(optionsp)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options = optionsp;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  out:</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(userp);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(passwdp);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(optionsp);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> parse_port(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <span class="keywordtype">char</span> *<a class="code" href="structhostname.html">hostname</a>)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">char</span> *portptr;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">char</span> endbracket;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span>((1 == sscanf(<a class="code" href="structhostname.html">hostname</a>, <span class="stringliteral">&quot;[%*45[0123456789abcdefABCDEF:.%%]%c%n&quot;</span>,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                  &amp;endbracket, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)) &amp;&amp;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;     (<span class="charliteral">&#39;]&#39;</span> == endbracket)) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/* this is a RFC2732-style specified IP-address */</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    portptr = &amp;<a class="code" href="structhostname.html">hostname</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>];</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span>(*portptr) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">if</span>(*portptr != <span class="charliteral">&#39;:&#39;</span>)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      portptr = NULL;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    portptr = strchr(<a class="code" href="structhostname.html">hostname</a>, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span>(portptr) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">char</span> *rest;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">long</span> port;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">char</span> portbuf[7];</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="curl__ctype_8h.html#acc3e9b1176bd8c62c4fe0e017007e719">ISDIGIT</a>(portptr[1]))</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0">CURLUE_BAD_PORT_NUMBER</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    port = strtol(portptr + 1, &amp;rest, 10);  <span class="comment">/* Port number must be decimal */</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span>((port &lt;= 0) || (port &gt; 0xffff))</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="comment">/* Single unix standard says port numbers are 16 bits long, but we don&#39;t</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">         treat port zero as OK. */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0">CURLUE_BAD_PORT_NUMBER</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span>(rest[0])</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0">CURLUE_BAD_PORT_NUMBER</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span>(rest != &amp;portptr[1]) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      *portptr++ = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">/* cut off the name there */</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      *rest = 0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="comment">/* generate a new to get rid of leading zeroes etc */</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(portbuf, <span class="keyword">sizeof</span>(portbuf), <span class="stringliteral">&quot;%ld&quot;</span>, port);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;portnum = port;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(portbuf);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="comment">/* Browser behavior adaptation. If there&#39;s a colon with no digits after,</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">         just cut off the name there which makes us ignore the colon and just</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">         use the default port. Firefox and Chrome both do that. */</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      *portptr = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">/* scan for byte values &lt; 31 or 127 */</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> junkscan(<span class="keywordtype">char</span> *<a class="code" href="structpart.html">part</a>)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;{</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">char</span> badbytes[]={</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">/* */</span> 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    0x7f,</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    0x00 <span class="comment">/* zero terminate */</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  };</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structpart.html">part</a>) {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a> = strlen(<a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">size_t</span> nfine = strcspn(<a class="code" href="structpart.html">part</a>, badbytes);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span>(nfine != <a class="code" href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a>)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">/* since we don&#39;t know which part is scanned, return a generic error</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">         code */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> hostname_check(<span class="keywordtype">char</span> *<a class="code" href="structhostname.html">hostname</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *l = NULL; <span class="comment">/* accepted characters */</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordtype">size_t</span> hlen = strlen(<a class="code" href="structhostname.html">hostname</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  (void)flags;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structhostname.html">hostname</a>[0] == <span class="charliteral">&#39;[&#39;</span>) {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="structhostname.html">hostname</a>++;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    l = <span class="stringliteral">&quot;0123456789abcdefABCDEF::.%&quot;</span>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    hlen -= 2;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span>(l) {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">/* only valid letters are ok */</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strspn(<a class="code" href="structhostname.html">hostname</a>, l);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span>(hlen != <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">/* hostname with bad content */</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">/* letters from the second string is not ok */</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strcspn(<a class="code" href="structhostname.html">hostname</a>, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span>(hlen != <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="comment">/* hostname with bad content */</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#af282596cc4cf6cba46b59c07e9b007ab">  603</a></span>&#160;<span class="preprocessor">#define HOSTNAME_END(x) (((x) == &#39;/&#39;) || ((x) == &#39;?&#39;) || ((x) == &#39;#&#39;))</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> seturl(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;{</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordtype">bool</span> path_alloced = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordtype">char</span> *query = NULL;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">char</span> *fragment = NULL;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordtype">bool</span> url_has_scheme = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordtype">char</span> schemebuf[<a class="code" href="urlapi-int_8h.html#ac1c52efdd487ad52d2eaebc4963c5616">MAX_SCHEME_LEN</a>];</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">char</span> *schemep = NULL;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">size_t</span> schemelen = 0;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">size_t</span> urllen;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> *h = NULL;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">/*************************************************************</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">   * Parse the URL.</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">   ************************************************************/</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">/* allocate scratch area */</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  urllen = strlen(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scratch = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(urllen * 2 + 2);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="structhostname.html">hostname</a> = &amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[urllen + 1];</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="structhostname.html">hostname</a>[0] = 0;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="lib_2urlapi_8c.html#a907290236fba856375068b6d2fa8045d">Curl_is_absolute_url</a>(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, schemebuf, <span class="keyword">sizeof</span>(schemebuf))) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    url_has_scheme = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    schemelen = strlen(schemebuf);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">/* handle the file: scheme */</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">if</span>(url_has_scheme &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(schemebuf, <span class="stringliteral">&quot;file&quot;</span>)) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">/* path has been allocated large enough to hold this */</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    strcpy(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, &amp;<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>[5]);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="structhostname.html">hostname</a> = NULL; <span class="comment">/* no host for file: URLs */</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;file&quot;</span>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">/* Extra handling URLs with an authority component (i.e. that start with</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">     * &quot;file://&quot;)</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">     * We allow omitted hostname (e.g. file:/&lt;path&gt;) -- valid according to</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">     * RFC 8089, but not the (current) WHAT-WG URL spec.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[0] == <span class="charliteral">&#39;/&#39;</span> &amp;&amp; <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[1] == <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">/* swallow the two slashes */</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = &amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[2];</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">       * According to RFC 8089, a file: URL can be reliably dereferenced if:</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">       *  o it has no/blank hostname, or</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">       *  o the hostname matches &quot;localhost&quot; (case-insensitively), or</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">       *  o the hostname is a FQDN that resolves to this machine.</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">       * For brevity, we only consider URLs with empty, &quot;localhost&quot;, or</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">       * &quot;127.0.0.1&quot; hostnames as local.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">       * Additionally, there is an exception for URLs with a Windows drive</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">       * letter in the authority (which was accidentally omitted from RFC 8089</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">       * Appendix E, but believe me, it was meant to be there. --MK)</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>[0] != <span class="charliteral">&#39;/&#39;</span> &amp;&amp; !<a class="code" href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">STARTS_WITH_URL_DRIVE_PREFIX</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">/* the URL includes a host name, it must match &quot;localhost&quot; or</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">           &quot;127.0.0.1&quot; to be valid */</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;localhost/&quot;</span>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) &amp;&amp;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;           !<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;127.0.0.1/&quot;</span>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="comment">/* Invalid file://hostname/, expected localhost or 127.0.0.1 or</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">             none */</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> += 9; <span class="comment">/* now points to the slash after the host */</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#if !defined(MSDOS) &amp;&amp; !defined(WIN32) &amp;&amp; !defined(__CYGWIN__)</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">/* Don&#39;t allow Windows drive letters when not in Windows.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">     * This catches both &quot;file:/c:&quot; and &quot;file:c:&quot; */</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span>((<span class="charliteral">&#39;/&#39;</span> == <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[0] &amp;&amp; <a class="code" href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">STARTS_WITH_URL_DRIVE_PREFIX</a>(&amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[1])) ||</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;       <a class="code" href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">STARTS_WITH_URL_DRIVE_PREFIX</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>)) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="comment">/* File drive letters are only accepted in MSDOS/Windows */</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">/* If the path starts with a slash and a drive letter, ditch the slash */</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;/&#39;</span> == <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[0] &amp;&amp; <a class="code" href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">STARTS_WITH_URL_DRIVE_PREFIX</a>(&amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[1])) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="comment">/* This cannot be done with strcpy, as the memory chunks overlap! */</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      memmove(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, &amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[1], strlen(&amp;<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[1]) + 1);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">/* clear path */</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *hostp;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[0] = 0;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span>(url_has_scheme) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = &amp;<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>[schemelen + 1];</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">while</span>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> &amp;&amp; (*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp; (<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 4)) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">if</span>((<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; 1) || (<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>&gt;3))</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="comment">/* less than one or more than three slashes */</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      schemep = schemebuf;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(schemep) &amp;&amp;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;         !(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a38354ba89f94ee9d65db974f5040f6db">CURLU_NON_SUPPORT_SCHEME</a>))</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea3cd335f8655b5ae976a00795cdde5474">CURLUE_UNSUPPORTED_SCHEME</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">if</span>(junkscan(schemep))</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">/* no scheme! */</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span>(!(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; (<a class="code" href="urlapi_8h.html#ae1ea321bd8b451610b3220c81dc4a701">CURLU_DEFAULT_SCHEME</a>|<a class="code" href="urlapi_8h.html#a1923d8f5dadb5924e5824c73282e6b64">CURLU_GUESS_SCHEME</a>)))</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#ae1ea321bd8b451610b3220c81dc4a701">CURLU_DEFAULT_SCHEME</a>)</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        schemep = (<span class="keywordtype">char</span> *) <a class="code" href="lib_2urlapi_8c.html#af5442ca84b3ad9479b29da9433ad27bd">DEFAULT_SCHEME</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">       * The URL was badly formatted, let&#39;s try without scheme specified.</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    hostp = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>; <span class="comment">/* host name starts here */</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">while</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> &amp;&amp; !<a class="code" href="lib_2urlapi_8c.html#af282596cc4cf6cba46b59c07e9b007ab">HOSTNAME_END</a>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>)) <span class="comment">/* find end of host name */</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> - hostp;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="structhostname.html">hostname</a>, hostp, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="structhostname.html">hostname</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>] = 0;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a1923d8f5dadb5924e5824c73282e6b64">CURLU_GUESS_SCHEME</a>) &amp;&amp; !schemep) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="comment">/* legacy curl-style guess based on host name */</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;ftp.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;ftp&quot;</span>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;dict.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;dict&quot;</span>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;ldap.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;ldap&quot;</span>;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;imap.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;imap&quot;</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;smtp.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;smtp&quot;</span>;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;pop3.&quot;</span>, <a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;pop3&quot;</span>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        schemep = (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;http&quot;</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>] = 0;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(schemep);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">/* if this is a known scheme, get some details */</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  h = <a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">if</span>(junkscan(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>))</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  query = strchr(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span>(query)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    *query++ = 0;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  fragment = strchr(query?query:<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">if</span>(fragment)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    *fragment++ = 0;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[0])</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">/* if there&#39;s no path set, unset */</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = NULL;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a36838c77a48b01b7b6bfd546c5aa55b5">CURLU_PATH_AS_IS</a>)) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">/* sanitise paths and remove ../ and ./ sequences according to RFC3986 */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">char</span> *newp = <a class="code" href="dotdot_8c.html#a7396c4bff669850218012a3272ce3f1a">Curl_dedotdotify</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span>(!newp)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">if</span>(strcmp(newp, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>)) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">/* if we got a new version */</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = newp;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      path_alloced = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(newp);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path = path_alloced?<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>:<a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structhostname.html">hostname</a>) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">     * Parse the login details and strip them out of the host name.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">if</span>(junkscan(<a class="code" href="structhostname.html">hostname</a>))</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = parse_hostname_login(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, h, &amp;<a class="code" href="structhostname.html">hostname</a>, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = parse_port(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="structhostname.html">hostname</a>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = hostname_check(<a class="code" href="structhostname.html">hostname</a>, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structhostname.html">hostname</a>);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span>(query &amp;&amp; query[0]) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(query);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">if</span>(fragment &amp;&amp; fragment[0]) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(fragment);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scratch);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scratch = NULL;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;}</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"> * Parse the URL and set the relevant members of the Curl_URL struct.</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keyword">static</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> parseurl(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>)</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = seturl(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    free_urlhandle(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a>));</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">  879</a></span>&#160;<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">curl_url</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;{</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a>), 1);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">  884</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a>(<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;{</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    free_urlhandle(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">  892</a></span>&#160;<span class="preprocessor">#define DUP(dest, src, name)         \</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">  if(src-&gt;name) {                    \</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor">    dest-&gt;name = strdup(src-&gt;name);  \</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">    if(!dest-&gt;name)                  \</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">      goto fail;                     \</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a4d517e62217faa7b130ea213703a1a40">  899</a></span>&#160;<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="lib_2urlapi_8c.html#a4d517e62217faa7b130ea213703a1a40">curl_url_dup</a>(<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>)</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;{</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl___u_r_l.html">Curl_URL</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a> = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_curl___u_r_l.html">Curl_URL</a>), 1);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#af9b39b0fdf1de99bc781256e6dce8d6a">scheme</a>);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#a110d8c27483dbddc6689dcaa885ebb7f">user</a>);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#afac1991683b4eb2bb3600888985f924f">password</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#a285f240406a220d80b38098e7a94a26c">port</a>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#a7daffe0df6606d6aee91f8933a050ce4">query</a>);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>, <a class="code" href="struct_curl___u_r_l.html#a29fe0a21f345498978757395ed49a134">fragment</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;portnum = <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;portnum;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <a class="code" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#a48912262854fec981577f695464990be">  920</a></span>&#160;<a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="lib_2urlapi_8c.html#a48912262854fec981577f695464990be">curl_url_get</a>(<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eb">CURLUPart</a> what,</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                       <span class="keywordtype">char</span> **<a class="code" href="structpart.html">part</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;{</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaf51060f7da011a1ef255ae71a8b16d19">CURLUE_UNKNOWN_PART</a>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">char</span> portbuf[7];</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordtype">bool</span> urldecode = (flags &amp; <a class="code" href="urlapi_8h.html#a454384246f1932a3493fa5eb9f671ffc">CURLU_URLDECODE</a>)?1:0;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordtype">bool</span> plusdecode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  (void)flags;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae8291f68426ea3dfbe38cd9dfd16ac14">CURLUE_BAD_HANDLE</a>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structpart.html">part</a>)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea091341eba174530893461cbc196adbf9">CURLUE_BAD_PARTPOINTER</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  *<a class="code" href="structpart.html">part</a> = NULL;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">switch</span>(what) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba78d43413bf7e618d74014aea871032a1">CURLUPART_SCHEME</a>:</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea61e604b67efc46cfc616571c17315cc0">CURLUE_NO_SCHEME</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    urldecode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* never for schemes */</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a>:</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaac4dd71b6c5300cd470ad231634337b3">CURLUE_NO_USER</a>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a>:</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea094bcca2e67eb06c2a1386a43b4b8c7f">CURLUE_NO_PASSWORD</a>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba46b928429eaa2b25f385a437ba6f8146">CURLUPART_OPTIONS</a>:</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dead6544c3594d9fccf22317dc96b109c75">CURLUE_NO_OPTIONS</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a>:</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae33b2ef7005707fe7c69f9ac1196233e">CURLUE_NO_HOST</a>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebabc452edee4006b5ff6a86d2a4d916dee">CURLUPART_PORT</a>:</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaecd176f6842d34eb9b49ff0f7ab27129">CURLUE_NO_PORT</a>;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    urldecode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* never for port */</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; (flags &amp; <a class="code" href="urlapi_8h.html#a263ef15af3683aaf88338dcb6f0cda83">CURLU_DEFAULT_PORT</a>) &amp;&amp; <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="comment">/* there&#39;s no stored port number, but asked to deliver</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">         a default one for the scheme */</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> *h =</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">if</span>(h) {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(portbuf, <span class="keyword">sizeof</span>(portbuf), <span class="stringliteral">&quot;%ld&quot;</span>, h-&gt;<a class="code" href="struct_curl__handler.html#a82bf8ca5a2caa4437c064c998467f768">defport</a>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = portbuf;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme) {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">/* there is a stored port number, but ask to inhibit if</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">         it matches the default one for the scheme */</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> *h =</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">if</span>(h &amp;&amp; (h-&gt;<a class="code" href="struct_curl__handler.html#a82bf8ca5a2caa4437c064c998467f768">defport</a> == <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;portnum) &amp;&amp;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;         (<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a7391c977f1051597540b2efc493faf74">CURLU_NO_DEFAULT_PORT</a>))</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = NULL;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba55cc24daefc3debfca5396c267a5d04b">CURLUPART_PATH</a>:</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebad44a6470deff9d6fc0b423aab47462e8">CURLUPART_QUERY</a>:</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea97e5b574504124bb31e46bd6cb2dfbd6">CURLUE_NO_QUERY</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    plusdecode = urldecode;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a>:</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    ifmissing = <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea7c177b1f52f0b54102e1e1ed82bcf24e">CURLUE_NO_FRAGMENT</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a>: {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordtype">char</span> *port = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;file&quot;</span>, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme)) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;file://%s%s%s&quot;</span>,</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path,</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment? <span class="stringliteral">&quot;#&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host)</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae33b2ef7005707fe7c69f9ac1196233e">CURLUE_NO_HOST</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> *h = NULL;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a> = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#ae1ea321bd8b451610b3220c81dc4a701">CURLU_DEFAULT_SCHEME</a>)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a> = (<span class="keywordtype">char</span> *) <a class="code" href="lib_2urlapi_8c.html#af5442ca84b3ad9479b29da9433ad27bd">DEFAULT_SCHEME</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea61e604b67efc46cfc616571c17315cc0">CURLUE_NO_SCHEME</a>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        h = <a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(<a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">if</span>(!port &amp;&amp; (<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a263ef15af3683aaf88338dcb6f0cda83">CURLU_DEFAULT_PORT</a>)) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          <span class="comment">/* there&#39;s no stored port number, but asked to deliver</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">             a default one for the scheme */</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="keywordflow">if</span>(h) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(portbuf, <span class="keyword">sizeof</span>(portbuf), <span class="stringliteral">&quot;%ld&quot;</span>, h-&gt;<a class="code" href="struct_curl__handler.html#a82bf8ca5a2caa4437c064c998467f768">defport</a>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            port = portbuf;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(port) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          <span class="comment">/* there is a stored port number, but asked to inhibit if it matches</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">             the default one for the scheme */</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="keywordflow">if</span>(h &amp;&amp; (h-&gt;<a class="code" href="struct_curl__handler.html#a82bf8ca5a2caa4437c064c998467f768">defport</a> == <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;portnum) &amp;&amp;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;             (<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a7391c977f1051597540b2efc493faf74">CURLU_NO_DEFAULT_PORT</a>))</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            port = NULL;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      }</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">if</span>(h &amp;&amp; !(h-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#a7dc3bffda7491b001e405e434493b896">PROTOPT_URLOPTIONS</a>))</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a> = NULL;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s://%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s&quot;</span>,</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    <a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>,</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user ? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password ? <span class="stringliteral">&quot;:&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password ? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a> ? <span class="stringliteral">&quot;;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a> ? <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    (<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user || <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password || <a class="code" href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a>) ? <span class="stringliteral">&quot;@&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host,</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    port ? <span class="stringliteral">&quot;:&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    port ? port : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                    (<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path &amp;&amp; (<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path[0] != <span class="charliteral">&#39;/&#39;</span>)) ? <span class="stringliteral">&quot;/&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path ? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path : <span class="stringliteral">&quot;/&quot;</span>,</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query? <span class="stringliteral">&quot;?&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment? <span class="stringliteral">&quot;#&quot;</span>: <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment? <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>)</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    *<a class="code" href="structpart.html">part</a> = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  }</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = NULL;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    *<a class="code" href="structpart.html">part</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span>(!*<a class="code" href="structpart.html">part</a>)</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span>(plusdecode) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="comment">/* convert + to space */</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordtype">char</span> *plus;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">for</span>(plus = *<a class="code" href="structpart.html">part</a>; *plus; ++plus) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span>(*plus == <span class="charliteral">&#39;+&#39;</span>)</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          *plus = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    }</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span>(urldecode) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="unit1302_8c.html#ab18a759c2c4c5488588580ec4cb3bef5">decoded</a>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordtype">size_t</span> dlen;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> res = <a class="code" href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a>(NULL, *<a class="code" href="structpart.html">part</a>, 0, &amp;<a class="code" href="unit1302_8c.html#ab18a759c2c4c5488588580ec4cb3bef5">decoded</a>, &amp;dlen, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*<a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">if</span>(res) {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        *<a class="code" href="structpart.html">part</a> = NULL;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea061d471905cef7476aede5eb6afafb87">CURLUE_URLDECODE</a>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      *<a class="code" href="structpart.html">part</a> = <a class="code" href="unit1302_8c.html#ab18a759c2c4c5488588580ec4cb3bef5">decoded</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> ifmissing;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"><a class="line" href="lib_2urlapi_8c.html#ac6fcd496aa8e5ed986ebc3abe5ad4d6a"> 1097</a></span>&#160;<a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="lib_2urlapi_8c.html#ac6fcd496aa8e5ed986ebc3abe5ad4d6a">curl_url_set</a>(<a class="code" href="struct_curl___u_r_l.html">CURLU</a> *<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eb">CURLUPart</a> what,</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpart.html">part</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordtype">char</span> **storep = NULL;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordtype">long</span> port = 0;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">bool</span> urlencode = (<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a9305c2e0493f32991a8981ba56f81ca2">CURLU_URLENCODE</a>)? 1 : 0;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordtype">bool</span> plusencode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordtype">bool</span> urlskipslash = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keywordtype">bool</span> appendquery = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordtype">bool</span> equalsencode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae8291f68426ea3dfbe38cd9dfd16ac14">CURLUE_BAD_HANDLE</a>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structpart.html">part</a>) {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">/* setting a part to NULL clears it */</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">switch</span>(what) {</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a>:</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba78d43413bf7e618d74014aea871032a1">CURLUPART_SCHEME</a>:</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a>:</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a>:</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba46b928429eaa2b25f385a437ba6f8146">CURLUPART_OPTIONS</a>:</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a>:</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebabc452edee4006b5ff6a86d2a4d916dee">CURLUPART_PORT</a>:</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba55cc24daefc3debfca5396c267a5d04b">CURLUPART_PATH</a>:</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebad44a6470deff9d6fc0b423aab47462e8">CURLUPART_QUERY</a>:</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a>:</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaf51060f7da011a1ef255ae71a8b16d19">CURLUE_UNKNOWN_PART</a>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span>(storep &amp;&amp; *storep) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*storep);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      *storep = NULL;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">switch</span>(what) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba78d43413bf7e618d74014aea871032a1">CURLUPART_SCHEME</a>:</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">if</span>(!(<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#a38354ba89f94ee9d65db974f5040f6db">CURLU_NON_SUPPORT_SCHEME</a>) &amp;&amp;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;       <span class="comment">/* verify that it is a fine scheme */</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;       !<a class="code" href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a>(<a class="code" href="structpart.html">part</a>))</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea3cd335f8655b5ae976a00795cdde5474">CURLUE_UNSUPPORTED_SCHEME</a>;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;scheme;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    urlencode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* never */</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a>:</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;user;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a>:</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;password;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba46b928429eaa2b25f385a437ba6f8146">CURLUPART_OPTIONS</a>:</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;options;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a>:</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;host;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebabc452edee4006b5ff6a86d2a4d916dee">CURLUPART_PORT</a>:</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    urlencode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* never */</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    port = strtol(<a class="code" href="structpart.html">part</a>, NULL, 10);  <span class="comment">/* Port number must be decimal */</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span>((port &lt;= 0) || (port &gt; 0xffff))</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0">CURLUE_BAD_PORT_NUMBER</a>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;port;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba55cc24daefc3debfca5396c267a5d04b">CURLUPART_PATH</a>:</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    urlskipslash = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;path;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebad44a6470deff9d6fc0b423aab47462e8">CURLUPART_QUERY</a>:</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    plusencode = urlencode;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    appendquery = (<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urlapi_8h.html#ac306a2611e3457b672fdba50d4459d19">CURLU_APPENDQUERY</a>)?1:0;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    equalsencode = appendquery;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a>:</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    storep = &amp;<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;fragment;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a>: {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">     * Allow a new URL to replace the existing (if any) contents.</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">     * If the existing contents is enough for a URL, allow a relative URL to</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">     * replace it.</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordtype">char</span> *oldurl;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordtype">char</span> *redired_url;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <a class="code" href="struct_curl___u_r_l.html">CURLU</a> *handle2;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="lib_2urlapi_8c.html#a907290236fba856375068b6d2fa8045d">Curl_is_absolute_url</a>(<a class="code" href="structpart.html">part</a>, NULL, <a class="code" href="urlapi-int_8h.html#ac1c52efdd487ad52d2eaebc4963c5616">MAX_SCHEME_LEN</a>)) {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      handle2 = <a class="code" href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">curl_url</a>();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordflow">if</span>(!handle2)</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = parseurl(<a class="code" href="structpart.html">part</a>, handle2, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        mv_urlhandle(handle2, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <a class="code" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a>(handle2);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">/* extract the full &quot;old&quot; URL to do the redirect on */</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="lib_2urlapi_8c.html#a48912262854fec981577f695464990be">curl_url_get</a>(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a>, &amp;oldurl, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">/* couldn&#39;t get the old URL, just use the new! */</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      handle2 = <a class="code" href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">curl_url</a>();</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="keywordflow">if</span>(!handle2)</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = parseurl(<a class="code" href="structpart.html">part</a>, handle2, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        mv_urlhandle(handle2, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <a class="code" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a>(handle2);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">/* apply the relative part to create a new URL */</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    redired_url = <a class="code" href="lib_2urlapi_8c.html#ab173a054c4da16c296035ec089cfcaa1">Curl_concat_url</a>(oldurl, <a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(oldurl);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">if</span>(!redired_url)</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">/* now parse the new URL */</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    handle2 = <a class="code" href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">curl_url</a>();</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">if</span>(!handle2) {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(redired_url);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = parseurl(redired_url, handle2, <a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(redired_url);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      mv_urlhandle(handle2, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a>(handle2);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaf51060f7da011a1ef255ae71a8b16d19">CURLUE_UNKNOWN_PART</a>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">if</span>(storep) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *newp = <a class="code" href="structpart.html">part</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordtype">size_t</span> nalloc = strlen(<a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">if</span>(urlencode) {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordtype">char</span> *o;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordtype">bool</span> free_part = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordtype">char</span> *enc = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(nalloc * 3 + 1); <span class="comment">/* for worst case! */</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">if</span>(!enc)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">if</span>(plusencode) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="comment">/* space to plus */</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = <a class="code" href="structpart.html">part</a>;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">for</span>(o = enc; *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>; ++o, ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          *o = (*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <span class="charliteral">&#39; &#39;</span>) ? <span class="charliteral">&#39;+&#39;</span> : *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        *o = 0; <span class="comment">/* zero terminate */</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <a class="code" href="structpart.html">part</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(enc);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="structpart.html">part</a>) {</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(enc);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        free_part = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      }</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = <a class="code" href="structpart.html">part</a>, o = enc; *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="escape_8c.html#a482018a2c20f2040f80e3ea608475ad0">Curl_isunreserved</a>(*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) ||</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;           ((*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp; urlskipslash) ||</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;           ((*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <span class="charliteral">&#39;=&#39;</span>) &amp;&amp; equalsencode) ||</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;           ((*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <span class="charliteral">&#39;+&#39;</span>) &amp;&amp; plusencode)) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          <span class="keywordflow">if</span>((*<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <span class="charliteral">&#39;=&#39;</span>) &amp;&amp; equalsencode)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <span class="comment">/* only skip the first equals sign */</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            equalsencode = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          *o = *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          o++;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(o, 4, <span class="stringliteral">&quot;%%%02x&quot;</span>, *<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          o += 3;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      }</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      *o = 0; <span class="comment">/* zero terminate */</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      newp = enc;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">if</span>(free_part)</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>((<span class="keywordtype">char</span> *)<a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      newp = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structpart.html">part</a>);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">if</span>(!newp)</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = (<span class="keywordtype">char</span> *)newp;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="keywordflow">while</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="comment">/* make sure percent encoded are lower case */</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">if</span>((*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> == <span class="charliteral">&#39;%&#39;</span>) &amp;&amp; <a class="code" href="curl__ctype_8h.html#ac0e84c3fd48c096e0f836d1cdbe310bb">ISXDIGIT</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[1]) &amp;&amp; <a class="code" href="curl__ctype_8h.html#ac0e84c3fd48c096e0f836d1cdbe310bb">ISXDIGIT</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[2]) &amp;&amp;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;           (<a class="code" href="curl__ctype_8h.html#a66e6e47e8d70dd61ccae33e7bff0b909">ISUPPER</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[1]) || <a class="code" href="curl__ctype_8h.html#a66e6e47e8d70dd61ccae33e7bff0b909">ISUPPER</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[2]))) {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[1] = (char)<a class="code" href="curl__setup__once_8h.html#a50cf1998cd442f5d41df925e184fd841">TOLOWER</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[1]);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[2] = (char)<a class="code" href="curl__setup__once_8h.html#a50cf1998cd442f5d41df925e184fd841">TOLOWER</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[2]);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;          <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> += 3;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        }</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">if</span>(appendquery) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="comment">/* Append the string onto the old query. Add a &#39;&amp;&#39; separator if none is</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">         present at the end of the exsting query already */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordtype">size_t</span> querylen = <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query ? strlen(<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query) : 0;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordtype">bool</span> addamperand = querylen &amp;&amp; (<a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query[querylen -1] != <span class="charliteral">&#39;&amp;&#39;</span>);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">if</span>(querylen) {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordtype">size_t</span> newplen = strlen(newp);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(querylen + addamperand + newplen + 1);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>((<span class="keywordtype">char</span> *)newp);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        strcpy(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;query); <span class="comment">/* original query */</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">if</span>(addamperand)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[querylen] = <span class="charliteral">&#39;&amp;&#39;</span>; <span class="comment">/* ampersand */</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        strcpy(&amp;<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[querylen + addamperand], newp); <span class="comment">/* new suffix */</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>((<span class="keywordtype">char</span> *)newp);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*storep);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        *storep = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      }</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*storep);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    *storep = (<span class="keywordtype">char</span> *)newp;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="comment">/* set after the string, to make it not assigned if the allocation above</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">     fails */</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordflow">if</span>(port)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a>-&gt;portnum = port;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;}</div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deaf51060f7da011a1ef255ae71a8b16d19"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaf51060f7da011a1ef255ae71a8b16d19">CURLUE_UNKNOWN_PART</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00040">urlapi.h:40</a></div></div>
<div class="ttc" id="urlapi-int_8h_html_ac1c52efdd487ad52d2eaebc4963c5616"><div class="ttname"><a href="urlapi-int_8h.html#ac1c52efdd487ad52d2eaebc4963c5616">MAX_SCHEME_LEN</a></div><div class="ttdeci">#define MAX_SCHEME_LEN</div><div class="ttdef"><b>Definition:</b> <a href="urlapi-int_8h_source.html#l00027">urlapi-int.h:27</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_adb99149ef0cf15c972298fc617457f13"><div class="ttname"><a href="lib_2urlapi_8c.html#adb99149ef0cf15c972298fc617457f13">Curl_strlen_url</a></div><div class="ttdeci">size_t Curl_strlen_url(const char *url, bool relative)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00138">urlapi.c:138</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a9712d2cd9e5b9008e221cd47d640bebf"><div class="ttname"><a href="struct_curl___u_r_l.html#a9712d2cd9e5b9008e221cd47d640bebf">Curl_URL::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00060">urlapi.c:60</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deae8291f68426ea3dfbe38cd9dfd16ac14"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae8291f68426ea3dfbe38cd9dfd16ac14">CURLUE_BAD_HANDLE</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00032">urlapi.h:32</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a50cf1998cd442f5d41df925e184fd841"><div class="ttname"><a href="curl__setup__once_8h.html#a50cf1998cd442f5d41df925e184fd841">TOLOWER</a></div><div class="ttdeci">#define TOLOWER(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00276">curl_setup_once.h:276</a></div></div>
<div class="ttc" id="escape_8c_html_a11aa4921a19102059a1d94e2be15477a"><div class="ttname"><a href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a></div><div class="ttdeci">CURLcode Curl_urldecode(struct Curl_easy *data, const char *string, size_t length, char **ostring, size_t *olen, bool reject_ctrl)</div><div class="ttdef"><b>Definition:</b> <a href="escape_8c_source.html#l00147">escape.c:147</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deaac4dd71b6c5300cd470ad231634337b3"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaac4dd71b6c5300cd470ad231634337b3">CURLUE_NO_USER</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00042">urlapi.h:42</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a4d517e62217faa7b130ea213703a1a40"><div class="ttname"><a href="lib_2urlapi_8c.html#a4d517e62217faa7b130ea213703a1a40">curl_url_dup</a></div><div class="ttdeci">CURLU * curl_url_dup(CURLU *in)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00899">urlapi.c:899</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_af282596cc4cf6cba46b59c07e9b007ab"><div class="ttname"><a href="lib_2urlapi_8c.html#af282596cc4cf6cba46b59c07e9b007ab">HOSTNAME_END</a></div><div class="ttdeci">#define HOSTNAME_END(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00603">urlapi.c:603</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a29fe0a21f345498978757395ed49a134"><div class="ttname"><a href="struct_curl___u_r_l.html#a29fe0a21f345498978757395ed49a134">Curl_URL::fragment</a></div><div class="ttdeci">char * fragment</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00062">urlapi.c:62</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea0ba90c652a34f6aa06c90cab4ea6dcb0">CURLUE_BAD_PORT_NUMBER</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00035">urlapi.h:35</a></div></div>
<div class="ttc" id="url_8c_html_a5ea73e21fa360f1bc61d59806bdc801f"><div class="ttname"><a href="url_8c.html#a5ea73e21fa360f1bc61d59806bdc801f">Curl_builtin_scheme</a></div><div class="ttdeci">const struct Curl_handler * Curl_builtin_scheme(const char *scheme)</div><div class="ttdef"><b>Definition:</b> <a href="url_8c_source.html#l01960">url.c:1960</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_aee1775135a0fca96725c93b6dac81a31"><div class="ttname"><a href="lib_2urlapi_8c.html#aee1775135a0fca96725c93b6dac81a31">curl_url_cleanup</a></div><div class="ttdeci">void curl_url_cleanup(CURLU *u)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00884">urlapi.c:884</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba46b928429eaa2b25f385a437ba6f8146"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba46b928429eaa2b25f385a437ba6f8146">CURLUPART_OPTIONS</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00056">urlapi.h:56</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_ae262b4651f9bbb296ca4b7725d6df9fd"><div class="ttname"><a href="curl__ctype_8h.html#ae262b4651f9bbb296ca4b7725d6df9fd">ISCNTRL</a></div><div class="ttdeci">#define ISCNTRL(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00073">curl_ctype.h:73</a></div></div>
<div class="ttc" id="_sample_h_i_d_keyboard_8cpp_html_a3baed8fd316b19ffc4765639221cf225"><div class="ttname"><a href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a></div><div class="ttdeci">BLECharacteristic * output</div><div class="ttdef"><b>Definition:</b> <a href="_sample_h_i_d_keyboard_8cpp_source.html#l00020">SampleHIDKeyboard.cpp:20</a></div></div>
<div class="ttc" id="struct_curl__handler_html"><div class="ttname"><a href="struct_curl__handler.html">Curl_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00628">urldata.h:628</a></div></div>
<div class="ttc" id="urlapi_8h_html_ad93f0f34e1e550dc6c45ecddccfc0efb"><div class="ttname"><a href="urlapi_8h.html#ad93f0f34e1e550dc6c45ecddccfc0efb">CURLU_DISALLOW_USER</a></div><div class="ttdeci">#define CURLU_DISALLOW_USER</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00072">urlapi.h:72</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea3cd335f8655b5ae976a00795cdde5474"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea3cd335f8655b5ae976a00795cdde5474">CURLUE_UNSUPPORTED_SCHEME</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00036">urlapi.h:36</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="unit1302_8c_html_ab18a759c2c4c5488588580ec4cb3bef5"><div class="ttname"><a href="unit1302_8c.html#ab18a759c2c4c5488588580ec4cb3bef5">decoded</a></div><div class="ttdeci">unsigned char * decoded</div><div class="ttdef"><b>Definition:</b> <a href="unit1302_8c_source.html#l00051">unit1302.c:51</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aff5da85872d542fca69aa535244b2694"><div class="ttname"><a href="curl__ctype_8h.html#aff5da85872d542fca69aa535244b2694">ISGRAPH</a></div><div class="ttdeci">#define ISGRAPH(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00068">curl_ctype.h:68</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea97e5b574504124bb31e46bd6cb2dfbd6"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea97e5b574504124bb31e46bd6cb2dfbd6">CURLUE_NO_QUERY</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00047">urlapi.h:47</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a1d8ca5825ab9492349fd408756468b27"><div class="ttname"><a href="lib_2urlapi_8c.html#a1d8ca5825ab9492349fd408756468b27">STARTS_WITH_DRIVE_PREFIX</a></div><div class="ttdeci">#define STARTS_WITH_DRIVE_PREFIX(str)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00039">urlapi.c:39</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea094bcca2e67eb06c2a1386a43b4b8c7f"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea094bcca2e67eb06c2a1386a43b4b8c7f">CURLUE_NO_PASSWORD</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00043">urlapi.h:43</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_afac1991683b4eb2bb3600888985f924f"><div class="ttname"><a href="struct_curl___u_r_l.html#afac1991683b4eb2bb3600888985f924f">Curl_URL::password</a></div><div class="ttdeci">char * password</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00056">urlapi.c:56</a></div></div>
<div class="ttc" id="urlapi_8h_html_a7391c977f1051597540b2efc493faf74"><div class="ttname"><a href="urlapi_8h.html#a7391c977f1051597540b2efc493faf74">CURLU_NO_DEFAULT_PORT</a></div><div class="ttdeci">#define CURLU_NO_DEFAULT_PORT</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00065">urlapi.h:65</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_af5442ca84b3ad9479b29da9433ad27bd"><div class="ttname"><a href="lib_2urlapi_8c.html#af5442ca84b3ad9479b29da9433ad27bd">DEFAULT_SCHEME</a></div><div class="ttdeci">#define DEFAULT_SCHEME</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00068">urlapi.c:68</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="structhostname_html"><div class="ttname"><a href="structhostname.html">hostname</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00446">urldata.h:446</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae947d8e39c047c7d45c735b736225e0b">CURLUE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00038">urlapi.h:38</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eb"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eb">CURLUPart</a></div><div class="ttdeci">CURLUPart</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00051">urlapi.h:51</a></div></div>
<div class="ttc" id="curl__ctype_8h_html"><div class="ttname"><a href="curl__ctype_8h.html">curl_ctype.h</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_af9b39b0fdf1de99bc781256e6dce8d6a"><div class="ttname"><a href="struct_curl___u_r_l.html#af9b39b0fdf1de99bc781256e6dce8d6a">Curl_URL::scheme</a></div><div class="ttdeci">char * scheme</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00054">urlapi.c:54</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a7daffe0df6606d6aee91f8933a050ce4"><div class="ttname"><a href="struct_curl___u_r_l.html#a7daffe0df6606d6aee91f8933a050ce4">Curl_URL::query</a></div><div class="ttdeci">char * query</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00061">urlapi.c:61</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea61e604b67efc46cfc616571c17315cc0"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea61e604b67efc46cfc616571c17315cc0">CURLUE_NO_SCHEME</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00041">urlapi.h:41</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a96ee760bf93e43fe45cb568b7c78b550"><div class="ttname"><a href="lib_2urlapi_8c.html#a96ee760bf93e43fe45cb568b7c78b550">STARTS_WITH_URL_DRIVE_PREFIX</a></div><div class="ttdeci">#define STARTS_WITH_URL_DRIVE_PREFIX(str)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00046">urlapi.c:46</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a907290236fba856375068b6d2fa8045d"><div class="ttname"><a href="lib_2urlapi_8c.html#a907290236fba856375068b6d2fa8045d">Curl_is_absolute_url</a></div><div class="ttdeci">bool Curl_is_absolute_url(const char *url, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00232">urlapi.c:232</a></div></div>
<div class="ttc" id="urlapi_8h_html_a38354ba89f94ee9d65db974f5040f6db"><div class="ttname"><a href="urlapi_8h.html#a38354ba89f94ee9d65db974f5040f6db">CURLU_NON_SUPPORT_SCHEME</a></div><div class="ttdeci">#define CURLU_NON_SUPPORT_SCHEME</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00070">urlapi.h:70</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="urlapi_8h_html_a263ef15af3683aaf88338dcb6f0cda83"><div class="ttname"><a href="urlapi_8h.html#a263ef15af3683aaf88338dcb6f0cda83">CURLU_DEFAULT_PORT</a></div><div class="ttdeci">#define CURLU_DEFAULT_PORT</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00064">urlapi.h:64</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2ebad44a6470deff9d6fc0b423aab47462e8"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebad44a6470deff9d6fc0b423aab47462e8">CURLUPART_QUERY</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00060">urlapi.h:60</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_ab04be2ae8d4204d4b70474d9db109784"><div class="ttname"><a href="struct_curl___u_r_l.html#ab04be2ae8d4204d4b70474d9db109784">Curl_URL::scratch</a></div><div class="ttdeci">char * scratch</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00064">urlapi.c:64</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_a66e6e47e8d70dd61ccae33e7bff0b909"><div class="ttname"><a href="curl__ctype_8h.html#a66e6e47e8d70dd61ccae33e7bff0b909">ISUPPER</a></div><div class="ttdeci">#define ISUPPER(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00071">curl_ctype.h:71</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a62f2e16d24df9ee5f7cde35a2eaea9e5"><div class="ttname"><a href="struct_curl___u_r_l.html#a62f2e16d24df9ee5f7cde35a2eaea9e5">Curl_URL::portnum</a></div><div class="ttdeci">long portnum</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00065">urlapi.c:65</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deae33b2ef7005707fe7c69f9ac1196233e"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae33b2ef7005707fe7c69f9ac1196233e">CURLUE_NO_HOST</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00045">urlapi.h:45</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="config_8d_html_a9fb4830d0cbef7d3cf48425ce59f580a"><div class="ttname"><a href="config_8d.html#a9fb4830d0cbef7d3cf48425ce59f580a">n</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are n</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_ac6fcd496aa8e5ed986ebc3abe5ad4d6a"><div class="ttname"><a href="lib_2urlapi_8c.html#ac6fcd496aa8e5ed986ebc3abe5ad4d6a">curl_url_set</a></div><div class="ttdeci">CURLUcode curl_url_set(CURLU *u, CURLUPart what, const char *part, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l01097">urlapi.c:1097</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00052">urlapi.h:52</a></div></div>
<div class="ttc" id="negotiate_8d_html_aded1f287a712c6b11eedae138b7005ca"><div class="ttname"><a href="negotiate_8d.html#aded1f287a712c6b11eedae138b7005ca">u</a></div><div class="ttdeci">Long you must also provide a fake user option to activate the authentication code properly.Sending a u</div><div class="ttdef"><b>Definition:</b> <a href="negotiate_8d_source.html#l00011">negotiate.d:11</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2ebabc452edee4006b5ff6a86d2a4d916dee"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebabc452edee4006b5ff6a86d2a4d916dee">CURLUPART_PORT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00058">urlapi.h:58</a></div></div>
<div class="ttc" id="urlapi_8h_html_ae1ea321bd8b451610b3220c81dc4a701"><div class="ttname"><a href="urlapi_8h.html#ae1ea321bd8b451610b3220c81dc4a701">CURLU_DEFAULT_SCHEME</a></div><div class="ttdeci">#define CURLU_DEFAULT_SCHEME</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00068">urlapi.h:68</a></div></div>
<div class="ttc" id="urlapi_8h_html_a36838c77a48b01b7b6bfd546c5aa55b5"><div class="ttname"><a href="urlapi_8h.html#a36838c77a48b01b7b6bfd546c5aa55b5">CURLU_PATH_AS_IS</a></div><div class="ttdeci">#define CURLU_PATH_AS_IS</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00071">urlapi.h:71</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00055">urlapi.h:55</a></div></div>
<div class="ttc" id="dotdot_8c_html_a7396c4bff669850218012a3272ce3f1a"><div class="ttname"><a href="dotdot_8c.html#a7396c4bff669850218012a3272ce3f1a">Curl_dedotdotify</a></div><div class="ttdeci">char * Curl_dedotdotify(const char *input)</div><div class="ttdef"><b>Definition:</b> <a href="dotdot_8c_source.html#l00053">dotdot.c:53</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba55cc24daefc3debfca5396c267a5d04b"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba55cc24daefc3debfca5396c267a5d04b">CURLUPART_PATH</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00059">urlapi.h:59</a></div></div>
<div class="ttc" id="urlapi_8h_html_a1923d8f5dadb5924e5824c73282e6b64"><div class="ttname"><a href="urlapi_8h.html#a1923d8f5dadb5924e5824c73282e6b64">CURLU_GUESS_SCHEME</a></div><div class="ttdeci">#define CURLU_GUESS_SCHEME</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00076">urlapi.h:76</a></div></div>
<div class="ttc" id="urlapi-int_8h_html"><div class="ttname"><a href="urlapi-int_8h.html">urlapi-int.h</a></div></div>
<div class="ttc" id="fail-early_8d_html_a2b978ebca1e6cb7fcbcb9a6b51701ce3"><div class="ttname"><a href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply fail</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a6f40ec190b29fc01606043313439328a"><div class="ttname"><a href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">Curl_handler::scheme</a></div><div class="ttdeci">const char * scheme</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00629">urldata.h:629</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a82bf8ca5a2caa4437c064c998467f768"><div class="ttname"><a href="struct_curl__handler.html#a82bf8ca5a2caa4437c064c998467f768">Curl_handler::defport</a></div><div class="ttdeci">long defport</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00699">urldata.h:699</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea6978036a5edd2be695e5ab72f86d983e">CURLUE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00031">urlapi.h:31</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a2e88ea8fe0df82943164d861abfb360d"><div class="ttname"><a href="lib_2urlapi_8c.html#a2e88ea8fe0df82943164d861abfb360d">DUP</a></div><div class="ttdeci">#define DUP(dest, src, name)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00892">urlapi.c:892</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea091341eba174530893461cbc196adbf9"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea091341eba174530893461cbc196adbf9">CURLUE_BAD_PARTPOINTER</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00033">urlapi.h:33</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1de"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a></div><div class="ttdeci">CURLUcode</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00030">urlapi.h:30</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00061">urlapi.h:61</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_u_r_l_8h_html_ad62c324cbfcc92532598792c6d0f6494"><div class="ttname"><a href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a></div><div class="ttdeci">uint8_t url[16]</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_u_r_l_8h_source.html#l00037">BLEEddystoneURL.h:37</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_aba93935f5c7359dd3ee0bf497178cf0f"><div class="ttname"><a href="lib_2urlapi_8c.html#aba93935f5c7359dd3ee0bf497178cf0f">Curl_strcpy_url</a></div><div class="ttdeci">void Curl_strcpy_url(char *output, const char *url, bool relative)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00180">urlapi.c:180</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="unit1652_8c_html_a1d19b0eef3b3acd31be88886a0277c2e"><div class="ttname"><a href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a></div><div class="ttdeci">memset(input, '\0', sizeof(input))</div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="urlapi_8h_html_a9305c2e0493f32991a8981ba56f81ca2"><div class="ttname"><a href="urlapi_8h.html#a9305c2e0493f32991a8981ba56f81ca2">CURLU_URLENCODE</a></div><div class="ttdeci">#define CURLU_URLENCODE</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00074">urlapi.h:74</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_a48912262854fec981577f695464990be"><div class="ttname"><a href="lib_2urlapi_8c.html#a48912262854fec981577f695464990be">curl_url_get</a></div><div class="ttdeci">CURLUcode curl_url_get(CURLU *u, CURLUPart what, char **part, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00920">urlapi.c:920</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea7c177b1f52f0b54102e1e1ed82bcf24e"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea7c177b1f52f0b54102e1e1ed82bcf24e">CURLUE_NO_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00048">urlapi.h:48</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dea061d471905cef7476aede5eb6afafb87"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dea061d471905cef7476aede5eb6afafb87">CURLUE_URLDECODE</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00037">urlapi.h:37</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a308f107777e2f37d57b8d22c15f8741f"><div class="ttname"><a href="struct_curl___u_r_l.html#a308f107777e2f37d57b8d22c15f8741f">Curl_URL::options</a></div><div class="ttdeci">char * options</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00057">urlapi.c:57</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00057">urlapi.h:57</a></div></div>
<div class="ttc" id="urlapi_8h_html_a454384246f1932a3493fa5eb9f671ffc"><div class="ttname"><a href="urlapi_8h.html#a454384246f1932a3493fa5eb9f671ffc">CURLU_URLDECODE</a></div><div class="ttdeci">#define CURLU_URLDECODE</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00073">urlapi.h:73</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="header_8d_html_af039c1a4bf9f7d5ffdd981d66cd3fb2d"><div class="ttname"><a href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a></div><div class="ttdeci">Long your externally set header will be used instead of the one.This allows you to make even trickier stuff than curl would normally do.You should not replace internally set headers without knowing perfectly well what you re doing.Remove an header by giving a replacement without content on the right side of the as in</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00009">header.d:9</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_acc3e9b1176bd8c62c4fe0e017007e719"><div class="ttname"><a href="curl__ctype_8h.html#acc3e9b1176bd8c62c4fe0e017007e719">ISDIGIT</a></div><div class="ttdeci">#define ISDIGIT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00065">curl_ctype.h:65</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a2fc887b2697c63980406a19108b82a24"><div class="ttname"><a href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">Curl_handler::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00702">urldata.h:702</a></div></div>
<div class="ttc" id="url_8c_html_a13ba4d524a116c2400ef2cf5cca77c3b"><div class="ttname"><a href="url_8c.html#a13ba4d524a116c2400ef2cf5cca77c3b">Curl_parse_login_details</a></div><div class="ttdeci">CURLcode Curl_parse_login_details(const char *login, const size_t len, char **userp, char **passwdp, char **optionsp)</div><div class="ttdef"><b>Definition:</b> <a href="url_8c_source.html#l02885">url.c:2885</a></div></div>
<div class="ttc" id="urlapi_8h_html_ac306a2611e3457b672fdba50d4459d19"><div class="ttname"><a href="urlapi_8h.html#ac306a2611e3457b672fdba50d4459d19">CURLU_APPENDQUERY</a></div><div class="ttdeci">#define CURLU_APPENDQUERY</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00075">urlapi.h:75</a></div></div>
<div class="ttc" id="escape_8h_html"><div class="ttname"><a href="escape_8h.html">escape.h</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deae32cb8539b7e8ec6fcfafcb7c3567638">CURLUE_MALFORMED_INPUT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00034">urlapi.h:34</a></div></div>
<div class="ttc" id="urldata_8h_html_a7dc3bffda7491b001e405e434493b896"><div class="ttname"><a href="urldata_8h.html#a7dc3bffda7491b001e405e434493b896">PROTOPT_URLOPTIONS</a></div><div class="ttdeci">#define PROTOPT_URLOPTIONS</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00723">urldata.h:723</a></div></div>
<div class="ttc" id="strcase_8h_html_a23b67e200b6f4c3ead633c94b3edcdb3"><div class="ttname"><a href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a></div><div class="ttdeci">#define checkprefix(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00046">strcase.h:46</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_aaaa882d02aaad0789a5943b5b40c17b8"><div class="ttname"><a href="struct_curl___u_r_l.html#aaaa882d02aaad0789a5943b5b40c17b8">Curl_URL::host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00058">urlapi.c:58</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deac2e085bf461f244975782d033af83813"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deac2e085bf461f244975782d033af83813">CURLUE_USER_NOT_ALLOWED</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00039">urlapi.h:39</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_ad818b36ef573962be02706e4bf54b952"><div class="ttname"><a href="lib_2urlapi_8c.html#ad818b36ef573962be02706e4bf54b952">curl_url</a></div><div class="ttdeci">CURLU * curl_url(void)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00879">urlapi.c:879</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1deaecd176f6842d34eb9b49ff0f7ab27129"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1deaecd176f6842d34eb9b49ff0f7ab27129">CURLUE_NO_PORT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00046">urlapi.h:46</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00054">urlapi.h:54</a></div></div>
<div class="ttc" id="lib_2urlapi_8c_html_ab173a054c4da16c296035ec089cfcaa1"><div class="ttname"><a href="lib_2urlapi_8c.html#ab173a054c4da16c296035ec089cfcaa1">Curl_concat_url</a></div><div class="ttdeci">char * Curl_concat_url(const char *base, const char *relurl)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00265">urlapi.c:265</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba78d43413bf7e618d74014aea871032a1"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba78d43413bf7e618d74014aea871032a1">CURLUPART_SCHEME</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00053">urlapi.h:53</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_ac0e84c3fd48c096e0f836d1cdbe310bb"><div class="ttname"><a href="curl__ctype_8h.html#ac0e84c3fd48c096e0f836d1cdbe310bb">ISXDIGIT</a></div><div class="ttdeci">#define ISXDIGIT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00067">curl_ctype.h:67</a></div></div>
<div class="ttc" id="dotdot_8h_html"><div class="ttname"><a href="dotdot_8h.html">dotdot.h</a></div></div>
<div class="ttc" id="url_8h_html"><div class="ttname"><a href="url_8h.html">url.h</a></div></div>
<div class="ttc" id="form_8d_html_ac776e8c2aa1a100ee6a391f59441ccf4"><div class="ttname"><a href="form_8d.html#ac776e8c2aa1a100ee6a391f59441ccf4">to</a></div><div class="ttdeci">since the full size is unknown before the transfer such data is sent as chunks by HTTP and rejected by IMAP.where &amp;profile is the name of the form field to which the file portrait.jpg will be the but get the contents for it from a local in a manner similar to</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00028">form.d:28</a></div></div>
<div class="ttc" id="noproxy_8d_html_a76bbcca5c6576b1086f83570943ed989"><div class="ttname"><a href="noproxy_8d.html#a76bbcca5c6576b1086f83570943ed989">hostname</a></div><div class="ttdeci">Long if one is specified.The only wildcard is a single which matches all and effectively disables the proxy.Each name in this list is matched as either a domain which contains the hostname</div><div class="ttdef"><b>Definition:</b> <a href="noproxy_8d_source.html#l00006">noproxy.d:6</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1dead6544c3594d9fccf22317dc96b109c75"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1dead6544c3594d9fccf22317dc96b109c75">CURLUE_NO_OPTIONS</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00044">urlapi.h:44</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a110d8c27483dbddc6689dcaa885ebb7f"><div class="ttname"><a href="struct_curl___u_r_l.html#a110d8c27483dbddc6689dcaa885ebb7f">Curl_URL::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00055">urlapi.c:55</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html_a285f240406a220d80b38098e7a94a26c"><div class="ttname"><a href="struct_curl___u_r_l.html#a285f240406a220d80b38098e7a94a26c">Curl_URL::port</a></div><div class="ttdeci">char * port</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00059">urlapi.c:59</a></div></div>
<div class="ttc" id="fail-early_8d_html_a188ba6f263db5df5a64e1cc11fb0c098"><div class="ttname"><a href="fail-early_8d.html#a188ba6f263db5df5a64e1cc11fb0c098">options</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply which causes transfers to fail due to the server s HTTP status code.You can combine the two options</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_a1cb5d5dd0c364d720854e8a250967dd1"><div class="ttname"><a href="curl__ctype_8h.html#a1cb5d5dd0c364d720854e8a250967dd1">ISALNUM</a></div><div class="ttdeci">#define ISALNUM(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00066">curl_ctype.h:66</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="escape_8c_html_a482018a2c20f2040f80e3ea608475ad0"><div class="ttname"><a href="escape_8c.html#a482018a2c20f2040f80e3ea608475ad0">Curl_isunreserved</a></div><div class="ttdeci">bool Curl_isunreserved(unsigned char in)</div><div class="ttdef"><b>Definition:</b> <a href="escape_8c_source.html#l00044">escape.c:44</a></div></div>
<div class="ttc" id="util_8c_html_a3b02c6de5c049804444a246f7fdf46b4"><div class="ttname"><a href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a></div><div class="ttdeci">const char * path</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00194">util.c:194</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html"><div class="ttname"><a href="struct_curl___u_r_l.html">Curl_URL</a></div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00053">urlapi.c:53</a></div></div>
<div class="ttc" id="structpart_html"><div class="ttname"><a href="structpart.html">part</a></div><div class="ttdef"><b>Definition:</b> <a href="lib1560_8c_source.html#l00037">lib1560.c:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="lib_2urlapi_8c.html">urlapi.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
