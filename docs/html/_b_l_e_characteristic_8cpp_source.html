<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/cpp_utils/BLECharacteristic.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_l_e_characteristic_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLECharacteristic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_b_l_e_characteristic_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * BLECharacteristic.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Jun 22, 2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#if defined(CONFIG_BT_ENABLED)</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;esp_log.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;esp_err.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_characteristic_8h.html">BLECharacteristic.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_service_8h.html">BLEService.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_device_8h.html">BLEDevice.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_utils_8h.html">BLEUtils.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e2902_8h.html">BLE2902.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_general_utils_8h.html">GeneralUtils.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifdef ARDUINO_ARCH_ESP32</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;esp32-hal-log.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* LOG_TAG = <span class="stringliteral">&quot;BLECharacteristic&quot;</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="_b_l_e_characteristic_8cpp.html#ae633a443f20ba142873858305e83cd88">   28</a></span>&#160;<span class="preprocessor">#define NULL_HANDLE (0xffff)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a6833d4adc67929d69a99f3a6b2620351">   36</a></span>&#160;<a class="code" href="class_b_l_e_characteristic.html#a6833d4adc67929d69a99f3a6b2620351">BLECharacteristic::BLECharacteristic</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* uuid, uint32_t properties) : <a class="code" href="class_b_l_e_characteristic.html">BLECharacteristic</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(uuid), properties) {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a778dc5dcca2ef386055445fa9447ea22">   44</a></span>&#160;<a class="code" href="class_b_l_e_characteristic.html#a6833d4adc67929d69a99f3a6b2620351">BLECharacteristic::BLECharacteristic</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> uuid, uint32_t properties) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    m_bleUUID    = uuid;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    m_handle     = <a class="code" href="_b_l_e_characteristic_8cpp.html#ae633a443f20ba142873858305e83cd88">NULL_HANDLE</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    m_properties = (esp_gatt_char_prop_t)0;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    m_pCallbacks = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a71e9605b9f97a32c3f15cc15c44260e6">setBroadcastProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#ad771643ce8f5a321ef14d8d18e9a925f">PROPERTY_BROADCAST</a>) != 0);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a7c711983f6cb7540f6ed73ab0d4a92ab">setReadProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#a54c6f36de0e85928583c2cdca0dbc453">PROPERTY_READ</a>) != 0);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a52fc80cc51aa75a5ddf2a99ed9198d4c">setWriteProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#ac55113748a66caafc031be26f97f7b76">PROPERTY_WRITE</a>) != 0);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a90515329867fee2e4a05888306df9ee4">setNotifyProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#a224cf88fbc3beecd3bff1f9e4ec9375b">PROPERTY_NOTIFY</a>) != 0);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a1f2528ba4723d8fed192aa21b3771f99">setIndicateProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#aa8cb5ac60c0e094b7615a7a19145a7ff">PROPERTY_INDICATE</a>) != 0);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ad31ff9cf3f34f5955cdfb8d68af1a1f9">setWriteNoResponseProperty</a>((properties &amp; <a class="code" href="class_b_l_e_characteristic.html#a9673274ca3ca326d6748b92fb5485cd6">PROPERTY_WRITE_NR</a>) != 0);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;} <span class="comment">// BLECharacteristic</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a4fff7e76804ad78427591ddc60088ba1">   61</a></span>&#160;<a class="code" href="class_b_l_e_characteristic.html#a4fff7e76804ad78427591ddc60088ba1">BLECharacteristic::~BLECharacteristic</a>() {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//free(m_value.attr_value); // Release the storage for the value.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;} <span class="comment">// ~BLECharacteristic</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a268245dea16728988459a4c7038dbced">   71</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a268245dea16728988459a4c7038dbced">BLECharacteristic::addDescriptor</a>(<a class="code" href="class_b_l_e_descriptor.html">BLEDescriptor</a>* pDescriptor) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; addDescriptor(): Adding %s to %s&quot;</span>, pDescriptor-&gt;<a class="code" href="class_b_l_e_descriptor.html#a767ecc1c8a3137faa99e973d9459e5e6">toString</a>().c_str(), <a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">toString</a>().c_str());</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#af160970e51454b8e3ec80d179e2e16a4">setByUUID</a>(pDescriptor-&gt;<a class="code" href="class_b_l_e_descriptor.html#a85ebb13db3538adc419f2dceb60afd68">getUUID</a>(), pDescriptor);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; addDescriptor()&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;} <span class="comment">// addDescriptor</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::executeCreate(<a class="code" href="class_b_l_e_service.html">BLEService</a>* pService) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; executeCreate()&quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (m_handle != <a class="code" href="_b_l_e_characteristic_8cpp.html#ae633a443f20ba142873858305e83cd88">NULL_HANDLE</a>) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Characteristic already has a handle.&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    m_pService = pService; <span class="comment">// Save the service to which this characteristic belongs.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;Registering characteristic (esp_ble_gatts_add_char): uuid: %s, service: %s&quot;</span>,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">getUUID</a>().<a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">toString</a>().c_str(),</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        m_pService-&gt;<a class="code" href="class_b_l_e_service.html#a389e7e6e9fb078158142ec226fe7ba45">toString</a>().c_str());</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    esp_attr_control_t control;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    control.auto_rsp = ESP_GATT_RSP_BY_APP;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    m_semaphoreCreateEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;executeCreate&quot;</span>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    esp_err_t errRc = ::esp_ble_gatts_add_char(</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        m_pService-&gt;<a class="code" href="class_b_l_e_service.html#ab4cce218daffde19e019bd0d1b6697ad">getHandle</a>(),</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">getUUID</a>().<a class="code" href="class_b_l_e_u_u_i_d.html#ad59ac075030347b7f306cdeb850e3e6e">getNative</a>(),</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">static_cast&lt;</span>esp_gatt_perm_t<span class="keyword">&gt;</span>(m_permissions),</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        getProperties(),</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        &amp;control); <span class="comment">// Whether to auto respond or not.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; esp_ble_gatts_add_char: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    m_semaphoreCreateEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;executeCreate&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="class_b_l_e_descriptor.html">BLEDescriptor</a>* pDescriptor = m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#afa5415ac42d2f4e6514602c85a7d3b99">getFirst</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">while</span> (pDescriptor != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        pDescriptor-&gt;executeCreate(<span class="keyword">this</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        pDescriptor = m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#affeb1b70f1495cd938fcdc8b61af9b06">getNext</a>();</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    } <span class="comment">// End while</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; executeCreate&quot;</span>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;} <span class="comment">// executeCreate</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a6592ef2c6ac44c113e35c4fc55b88982">  129</a></span>&#160;<a class="code" href="class_b_l_e_descriptor.html">BLEDescriptor</a>* <a class="code" href="class_b_l_e_characteristic.html#a6592ef2c6ac44c113e35c4fc55b88982">BLECharacteristic::getDescriptorByUUID</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* descriptorUUID) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#a431d72f448ea419ec77344300a91f76b">getByUUID</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(descriptorUUID));</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;} <span class="comment">// getDescriptorByUUID</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a61d53fa52c01cba0db0c1c28b0843d96">  139</a></span>&#160;<a class="code" href="class_b_l_e_descriptor.html">BLEDescriptor</a>* <a class="code" href="class_b_l_e_characteristic.html#a6592ef2c6ac44c113e35c4fc55b88982">BLECharacteristic::getDescriptorByUUID</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> descriptorUUID) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#a431d72f448ea419ec77344300a91f76b">getByUUID</a>(descriptorUUID);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;} <span class="comment">// getDescriptorByUUID</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">  148</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">BLECharacteristic::getHandle</a>() {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> m_handle;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;} <span class="comment">// getHandle</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a023f6570deed3cdd160bc857faff9cf6">  152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a023f6570deed3cdd160bc857faff9cf6">BLECharacteristic::setAccessPermissions</a>(esp_gatt_perm_t perm) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    m_permissions = perm;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;esp_gatt_char_prop_t BLECharacteristic::getProperties() {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> m_properties;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;} <span class="comment">// getProperties</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<a class="code" href="class_b_l_e_service.html">BLEService</a>* BLECharacteristic::getService() {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">return</span> m_pService;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;} <span class="comment">// getService</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">  173</a></span>&#160;<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">BLECharacteristic::getUUID</a>() {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> m_bleUUID;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;} <span class="comment">// getUUID</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a03927d537d1f09c10100f2cea29974cd">  182</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_characteristic.html#a03927d537d1f09c10100f2cea29974cd">BLECharacteristic::getValue</a>() {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;} <span class="comment">// getValue</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a30771341d9d0b1a83fd1cfcdcba53047">  190</a></span>&#160;uint8_t* <a class="code" href="class_b_l_e_characteristic.html#a30771341d9d0b1a83fd1cfcdcba53047">BLECharacteristic::getData</a>() {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> m_value.<a class="code" href="class_b_l_e_value.html#af97c9627170b1672d464b96d1664ed77">getData</a>();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;} <span class="comment">// getData</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::handleGATTServerEvent(</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        esp_gatts_cb_event_t      event,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        esp_gatt_if_t             gatts_if,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        esp_ble_gatts_cb_param_t* param) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; handleGATTServerEvent: %s&quot;</span>, <a class="code" href="class_b_l_e_utils.html#acb35970d17947515e04bd77af6a5f0f9">BLEUtils::gattServerEventTypeToString</a>(event).c_str());</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">switch</span>(event) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// Events handled:</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// ESP_GATTS_ADD_CHAR_EVT</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// ESP_GATTS_CONF_EVT</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// ESP_GATTS_CONNECT_EVT</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// ESP_GATTS_DISCONNECT_EVT</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// ESP_GATTS_READ_EVT</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// ESP_GATTS_WRITE_EVT</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// When we receive this event it is an indication that a previous write long needs to be committed.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// exec_write:</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">// - uint16_t conn_id</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// - uint32_t trans_id</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// - uint8_t exec_write_flag - Either ESP_GATT_PREP_WRITE_EXEC or ESP_GATT_PREP_WRITE_CANCEL</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_EXEC_WRITE_EVT: {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (param-&gt;exec_write.exec_write_flag == ESP_GATT_PREP_WRITE_EXEC) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                m_value.<a class="code" href="class_b_l_e_value.html#a2ec01006910676d52888baa3affa9edc">commit</a>();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">if</span> (m_pCallbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    m_pCallbacks-&gt;<a class="code" href="class_b_l_e_characteristic_callbacks.html#a4ae0d40890990c1cb408b0ebd9b89ed8">onWrite</a>(<span class="keyword">this</span>); <span class="comment">// Invoke the onWrite callback handler.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                m_value.<a class="code" href="class_b_l_e_value.html#a8107af1e3d843719ba66750dea3ec205">cancel</a>();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// ???</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            esp_err_t errRc = ::esp_ble_gatts_send_response(</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    gatts_if,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    param-&gt;write.conn_id,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    param-&gt;write.trans_id, ESP_GATT_OK, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        } <span class="comment">// ESP_GATTS_EXEC_WRITE_EVT</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">// ESP_GATTS_ADD_CHAR_EVT - Indicate that a characteristic was added to the service.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// add_char:</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">// - uint16_t attr_handle</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">// - uint16_t service_handle</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">// - esp_bt_uuid_t char_uuid</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_ADD_CHAR_EVT: {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">getHandle</a>() == param-&gt;add_char.attr_handle) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// we have created characteristic, now we can create descriptors</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="comment">// BLEDescriptor* pDescriptor = m_descriptorMap.getFirst();</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="comment">// while (pDescriptor != nullptr) {</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">//  pDescriptor-&gt;executeCreate(this);</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="comment">//  pDescriptor = m_descriptorMap.getNext();</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="comment">// } // End while</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                m_semaphoreCreateEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        } <span class="comment">// ESP_GATTS_ADD_CHAR_EVT</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">// ESP_GATTS_WRITE_EVT - A request to write the value of a characteristic has arrived.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// write:</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// - uint16_t      conn_id</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// - uint16_t      trans_id</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// - uint16_t      handle</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// - uint16_t      offset</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">// - bool          need_rsp</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// - bool          is_prep</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// - uint16_t      len</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// - uint8_t      *value</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_WRITE_EVT: {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">// We check if this write request is for us by comparing the handles in the event.  If it is for us</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">// we save the new value.  Next we look at the need_rsp flag which indicates whether or not we need</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">// to send a response.  If we do, then we formulate a response and send it.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (param-&gt;write.handle == m_handle) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">if</span> (param-&gt;write.is_prep) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    m_value.<a class="code" href="class_b_l_e_value.html#a4d93ec1f39c17d7557d711a84e0e2315">addPart</a>(param-&gt;write.value, param-&gt;write.len);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(param-&gt;write.value, param-&gt;write.len);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot; - Response to write event: New value: handle: %.2x, uuid: %s&quot;</span>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        <a class="code" href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">getHandle</a>(), <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">getUUID</a>().<a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">toString</a>().c_str());</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordtype">char</span>* pHexData = <a class="code" href="class_b_l_e_utils.html#afb88eb5c555c242966dba1b7e890af8f">BLEUtils::buildHexData</a>(<span class="keyword">nullptr</span>, param-&gt;write.value, param-&gt;write.len);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot; - Data: length: %d, data: %s&quot;</span>, param-&gt;write.len, pHexData);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(pHexData);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (param-&gt;write.need_rsp) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    esp_gatt_rsp_t rsp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    rsp.attr_value.len      = param-&gt;write.len;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    rsp.attr_value.handle   = m_handle;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    rsp.attr_value.offset   = param-&gt;write.offset;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    rsp.attr_value.auth_req = ESP_GATT_AUTH_REQ_NONE;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(rsp.attr_value.value, param-&gt;write.value, param-&gt;write.len);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    esp_err_t errRc = ::esp_ble_gatts_send_response(</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                            gatts_if,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                            param-&gt;write.conn_id,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                            param-&gt;write.trans_id, ESP_GATT_OK, &amp;rsp);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                } <span class="comment">// Response needed</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">if</span> (m_pCallbacks != <span class="keyword">nullptr</span> &amp;&amp; param-&gt;write.is_prep != <span class="keyword">true</span>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    m_pCallbacks-&gt;<a class="code" href="class_b_l_e_characteristic_callbacks.html#a4ae0d40890990c1cb408b0ebd9b89ed8">onWrite</a>(<span class="keyword">this</span>); <span class="comment">// Invoke the onWrite callback handler.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            } <span class="comment">// Match on handles.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        } <span class="comment">// ESP_GATTS_WRITE_EVT</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// ESP_GATTS_READ_EVT - A request to read the value of a characteristic has arrived.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// read:</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// - uint16_t      conn_id</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// - uint32_t      trans_id</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// - esp_bd_addr_t bda</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">// - uint16_t      handle</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// - uint16_t      offset</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">// - bool          is_long</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// - bool          need_rsp</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_READ_EVT: {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> (param-&gt;read.handle == m_handle) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">// Here&#39;s an interesting thing.  The read request has the option of saying whether we need a response</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">// or not.  What would it &quot;mean&quot; to receive a read request and NOT send a response back?  That feels like</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">// a very strange read.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">// We have to handle the case where the data we wish to send back to the client is greater than the maximum</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">// packet size of 22 bytes.  In this case, we become responsible for chunking the data into units of 22 bytes.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">// The apparent algorithm is as follows:</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">// If the is_long flag is set then this is a follow on from an original read and we will already have sent at least 22 bytes.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// If the is_long flag is not set then we need to check how much data we are going to send.  If we are sending LESS than</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">// 22 bytes, then we &quot;just&quot; send it and thats the end of the story.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">// If we are sending 22 bytes exactly, we just send it BUT we will get a follow on request.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">// If we are sending more than 22 bytes, we send the first 22 bytes and we will get a follow on request.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">// Because of follow on request processing, we need to maintain an offset of how much data we have already sent</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">// so that when a follow on request arrives, we know where to start in the data to send the next sequence.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">// Note that the indication that the client will send a follow on request is that we sent exactly 22 bytes as a response.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">// If our payload is divisible by 22 then the last response will be a response of 0 bytes in length.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">// The following code has deliberately not been factored to make it fewer statements because this would cloud the</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">// the logic flow comprehension.</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="comment">// get mtu for peer device that we are sending read request to</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                uint16_t maxOffset =  getService()-&gt;<a class="code" href="class_b_l_e_service.html#a3bfd36fe7ce35be32a373eeef2d625ef">getServer</a>()-&gt;<a class="code" href="class_b_l_e_server.html#a898e73615b3056ed3af21eb2ecdcbfa2">getPeerMTU</a>(param-&gt;read.conn_id) - 1;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;mtu value: %d&quot;</span>, maxOffset);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordflow">if</span> (param-&gt;read.need_rsp) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;Sending a response (esp_ble_gatts_send_response)&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    esp_gatt_rsp_t rsp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="keywordflow">if</span> (param-&gt;read.is_long) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() - m_value.<a class="code" href="class_b_l_e_value.html#a2bf1f68b62aeb5f3eaa0b6e83dfbdf85">getReadOffset</a>() &lt; maxOffset) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                            <span class="comment">// This is the last in the chain</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                            rsp.attr_value.len    = <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() - m_value.<a class="code" href="class_b_l_e_value.html#a2bf1f68b62aeb5f3eaa0b6e83dfbdf85">getReadOffset</a>();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                            rsp.attr_value.offset = m_value.<a class="code" href="class_b_l_e_value.html#a2bf1f68b62aeb5f3eaa0b6e83dfbdf85">getReadOffset</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                            <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(rsp.attr_value.value, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data() + rsp.attr_value.offset, rsp.attr_value.len);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                            m_value.<a class="code" href="class_b_l_e_value.html#ae8137625a5132b0d433a2dee8fba4c69">setReadOffset</a>(0);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                            <span class="comment">// There will be more to come.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                            rsp.attr_value.len    = maxOffset;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                            rsp.attr_value.offset = m_value.<a class="code" href="class_b_l_e_value.html#a2bf1f68b62aeb5f3eaa0b6e83dfbdf85">getReadOffset</a>();</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                            <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(rsp.attr_value.value, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data() + rsp.attr_value.offset, rsp.attr_value.len);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            m_value.<a class="code" href="class_b_l_e_value.html#ae8137625a5132b0d433a2dee8fba4c69">setReadOffset</a>(rsp.attr_value.offset + maxOffset);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// read.is_long == false</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() + 1 &gt; maxOffset) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                            <span class="comment">// Too big for a single shot entry.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                            m_value.<a class="code" href="class_b_l_e_value.html#ae8137625a5132b0d433a2dee8fba4c69">setReadOffset</a>(maxOffset);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                            rsp.attr_value.len    = maxOffset;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                            rsp.attr_value.offset = 0;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                            <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(rsp.attr_value.value, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data(), rsp.attr_value.len);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            <span class="comment">// Will fit in a single packet with no callbacks required.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            rsp.attr_value.len    = <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                            rsp.attr_value.offset = 0;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                            <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(rsp.attr_value.value, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data(), rsp.attr_value.len);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="keywordflow">if</span> (m_pCallbacks != <span class="keyword">nullptr</span>) {  <span class="comment">// If is.long is false then this is the first (or only) request to read data, so invoke the callback</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                            m_pCallbacks-&gt;<a class="code" href="class_b_l_e_characteristic_callbacks.html#a8dac68835a79ae6ef909515f6db4a431">onRead</a>(<span class="keyword">this</span>);   <span class="comment">// Invoke the read callback.</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    rsp.attr_value.handle   = param-&gt;read.handle;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    rsp.attr_value.auth_req = ESP_GATT_AUTH_REQ_NONE;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordtype">char</span> *pHexData = <a class="code" href="class_b_l_e_utils.html#afb88eb5c555c242966dba1b7e890af8f">BLEUtils::buildHexData</a>(<span class="keyword">nullptr</span>, rsp.attr_value.value, rsp.attr_value.len);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot; - Data: length=%d, data=%s, offset=%d&quot;</span>, rsp.attr_value.len, pHexData, rsp.attr_value.offset);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(pHexData);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    esp_err_t errRc = ::esp_ble_gatts_send_response(</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                            gatts_if, param-&gt;read.conn_id,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                            param-&gt;read.trans_id,</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                            ESP_GATT_OK,</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            &amp;rsp);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gatts_send_response: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                } <span class="comment">// Response needed</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            } <span class="comment">// Handle matches this characteristic.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        } <span class="comment">// ESP_GATTS_READ_EVT</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">// ESP_GATTS_CONF_EVT</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// conf:</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">// - esp_gatt_status_t status  – The status code.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// - uint16_t          conn_id – The connection used.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_CONF_EVT: {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">// ESP_LOGD(LOG_TAG, &quot;m_handle = %d, conf-&gt;handle = %d&quot;, m_handle, param-&gt;conf.handle);</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">if</span>(param-&gt;conf.conn_id == getService()-&gt;getServer()-&gt;getConnId()) <span class="comment">// &amp;&amp; param-&gt;conf.handle == m_handle) // bug in esp-idf and not implemented in arduino yet</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                m_semaphoreConfEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>(param-&gt;conf.status);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_CONNECT_EVT: {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">case</span> ESP_GATTS_DISCONNECT_EVT: {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            m_semaphoreConfEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        } <span class="comment">// default</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    } <span class="comment">// switch event</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// Give each of the descriptors associated with this characteristic the opportunity to handle the</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// event.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    m_descriptorMap.<a class="code" href="class_b_l_e_descriptor_map.html#ad617412614990bca1344fb9adbedb24e">handleGATTServerEvent</a>(event, gatts_if, param);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; handleGATTServerEvent&quot;</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;} <span class="comment">// handleGATTServerEvent</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#ac900bf20fd476c2c6a6b3b7c778608f3">  468</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac900bf20fd476c2c6a6b3b7c778608f3">BLECharacteristic::indicate</a>() {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; indicate: length: %d&quot;</span>, m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().length());</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#a9e716766107d22ba00d5326c16fedc6a">notify</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; indicate&quot;</span>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;} <span class="comment">// indicate</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a9e716766107d22ba00d5326c16fedc6a">  482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a9e716766107d22ba00d5326c16fedc6a">BLECharacteristic::notify</a>(<span class="keywordtype">bool</span> is_notification) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; notify: length: %d&quot;</span>, m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().length());</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="test1_8c.html#a74bb3debd3b0d3f9c3fe210442b4cacc">assert</a>(getService() != <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="test1_8c.html#a74bb3debd3b0d3f9c3fe210442b4cacc">assert</a>(getService()-&gt;getServer() != <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="class_general_utils.html#a0624d2bba035e50c4073074da675a606">GeneralUtils::hexDump</a>((uint8_t*)m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().data(), m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().length());</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (getService()-&gt;<a class="code" href="class_b_l_e_service.html#a3bfd36fe7ce35be32a373eeef2d625ef">getServer</a>()-&gt;<a class="code" href="class_b_l_e_server.html#a4e73a6a59133915aa7212d3e87f60084">getConnectedCount</a>() == 0) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; notify: No connected clients.&quot;</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// Test to see if we have a 0x2902 descriptor.  If we do, then check to see if notification is enabled</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// and, if not, prevent the notification.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="class_b_l_e2902.html">BLE2902</a> *p2902 = (<a class="code" href="class_b_l_e2902.html">BLE2902</a>*)<a class="code" href="class_b_l_e_characteristic.html#a6592ef2c6ac44c113e35c4fc55b88982">getDescriptorByUUID</a>((uint16_t)0x2902);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span>(is_notification) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span> (p2902 != <span class="keyword">nullptr</span> &amp;&amp; !p2902-&gt;<a class="code" href="class_b_l_e2902.html#a7609aeaf43a8d5b70ac30d71f940089e">getNotifications</a>()) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; notifications disabled; ignoring&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (p2902 != <span class="keyword">nullptr</span> &amp;&amp; !p2902-&gt;<a class="code" href="class_b_l_e2902.html#a83898356dba62c055e7f759eb4ddcd8c">getIndications</a>()) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; indications disabled; ignoring&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : getService()-&gt;getServer()-&gt;getPeerDevices(<span class="keyword">false</span>)) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        uint16_t _mtu = (myPair.second.mtu);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> (m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().length() &gt; _mtu - 3) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            ESP_LOGW(LOG_TAG, <span class="stringliteral">&quot;- Truncating to %d bytes (maximum notify size)&quot;</span>, _mtu - 3);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">size_t</span> length = m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().length();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span>(!is_notification)</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            m_semaphoreConfEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;indicate&quot;</span>);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        esp_err_t errRc = ::esp_ble_gatts_send_indicate(</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                getService()-&gt;getServer()-&gt;getGattsIf(),</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                myPair.first,</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <a class="code" href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">getHandle</a>(), length, (uint8_t*)m_value.<a class="code" href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">getValue</a>().data(), !is_notification); <span class="comment">// The need_confirm = false makes this a notify.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; esp_ble_gatts_send_ %s: rc=%d %s&quot;</span>,is_notification?<span class="stringliteral">&quot;notify&quot;</span>:<span class="stringliteral">&quot;indicate&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            m_semaphoreConfEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">if</span>(!is_notification)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            m_semaphoreConfEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;indicate&quot;</span>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; notify&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;} <span class="comment">// Notify</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a71e9605b9f97a32c3f15cc15c44260e6">  543</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a71e9605b9f97a32c3f15cc15c44260e6">BLECharacteristic::setBroadcastProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setBroadcastProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_BROADCAST);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_BROADCAST);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;} <span class="comment">// setBroadcastProperty</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a57431e7893554f12c34d45889475d4d2">  557</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a57431e7893554f12c34d45889475d4d2">BLECharacteristic::setCallbacks</a>(<a class="code" href="class_b_l_e_characteristic_callbacks.html">BLECharacteristicCallbacks</a>* pCallbacks) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; setCallbacks: 0x%x&quot;</span>, (uint32_t)pCallbacks);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    m_pCallbacks = pCallbacks;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; setCallbacks&quot;</span>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;} <span class="comment">// setCallbacks</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordtype">void</span> BLECharacteristic::setHandle(uint16_t handle) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; setHandle: handle=0x%.2x, characteristic uuid=%s&quot;</span>, handle, <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">getUUID</a>().<a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">toString</a>().c_str());</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    m_handle = handle;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; setHandle&quot;</span>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;} <span class="comment">// setHandle</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a1f2528ba4723d8fed192aa21b3771f99">  585</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a1f2528ba4723d8fed192aa21b3771f99">BLECharacteristic::setIndicateProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setIndicateProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_INDICATE);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_INDICATE);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;} <span class="comment">// setIndicateProperty</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a90515329867fee2e4a05888306df9ee4">  599</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a90515329867fee2e4a05888306df9ee4">BLECharacteristic::setNotifyProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setNotifyProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_NOTIFY);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_NOTIFY);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;} <span class="comment">// setNotifyProperty</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a7c711983f6cb7540f6ed73ab0d4a92ab">  613</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a7c711983f6cb7540f6ed73ab0d4a92ab">BLECharacteristic::setReadProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setReadProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_READ);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_READ);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;} <span class="comment">// setReadProperty</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">  628</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(uint8_t* <a class="code" href="structdata.html">data</a>, <span class="keywordtype">size_t</span> length) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">char</span>* pHex = <a class="code" href="class_b_l_e_utils.html#afb88eb5c555c242966dba1b7e890af8f">BLEUtils::buildHexData</a>(<span class="keyword">nullptr</span>, <a class="code" href="structdata.html">data</a>, length);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; setValue: length=%d, data=%s, characteristic UUID=%s&quot;</span>, length, pHex, <a class="code" href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">getUUID</a>().<a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">toString</a>().c_str());</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(pHex);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (length &gt; ESP_GATT_MAX_ATTR_LEN) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Size %d too large, must be no bigger than %d&quot;</span>, length, ESP_GATT_MAX_ATTR_LEN);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    m_value.<a class="code" href="class_b_l_e_value.html#aabac82a0abd852ee50c2f6bf02c7aa3e">setValue</a>(<a class="code" href="structdata.html">data</a>, length);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; setValue&quot;</span>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a5cf03a0e1559367d0e4524c05335bd11">  648</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>((uint8_t*)(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data()), <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length());</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a6932d7945c557291643ff82744ac454f">  652</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(uint16_t&amp; data16) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    uint8_t <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data16;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data16 &gt;&gt; 8;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 2);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a0a92d690209697d07217b39696451d22">  659</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(uint32_t&amp; data32) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    uint8_t <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[4];</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data32;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data32 &gt;&gt; 8;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2] = data32 &gt;&gt; 16;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[3] = data32 &gt;&gt; 24;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a552da322ca4a23663f07467bc8e222ae">  668</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(<span class="keywordtype">int</span>&amp; data32) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    uint8_t <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[4];</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[0] = data32;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[1] = data32 &gt;&gt; 8;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[2] = data32 &gt;&gt; 16;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[3] = data32 &gt;&gt; 24;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a8e6c0dac34ea3a78f7fd72d34bf0ddab">  677</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(<span class="keywordtype">float</span>&amp; data32) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    uint8_t <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[4];</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    *((<span class="keywordtype">float</span>*)<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>) = data32;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 4);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#abfbacd868dd1c3688a323633761b1d85">  683</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a>(<span class="keywordtype">double</span>&amp; data64) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    uint8_t <a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>[8];</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    *((<span class="keywordtype">double</span>*)<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>) = data64;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">setValue</a>(<a class="code" href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a>, 8);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#ad31ff9cf3f34f5955cdfb8d68af1a1f9">  694</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#ad31ff9cf3f34f5955cdfb8d68af1a1f9">BLECharacteristic::setWriteNoResponseProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setWriteNoResponseProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_WRITE_NR);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_WRITE_NR);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;} <span class="comment">// setWriteNoResponseProperty</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a52fc80cc51aa75a5ddf2a99ed9198d4c">  708</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic.html#a52fc80cc51aa75a5ddf2a99ed9198d4c">BLECharacteristic::setWriteProperty</a>(<span class="keywordtype">bool</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;setWriteProperty(%d)&quot;, value);</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties | ESP_GATT_CHAR_PROP_BIT_WRITE);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        m_properties = (esp_gatt_char_prop_t)(m_properties &amp; ~ESP_GATT_CHAR_PROP_BIT_WRITE);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;} <span class="comment">// setWriteProperty</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">  722</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">BLECharacteristic::toString</a>() {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    std::stringstream stringstream;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    stringstream &lt;&lt; std::hex &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    stringstream &lt;&lt; <span class="stringliteral">&quot;UUID: &quot;</span> &lt;&lt; m_bleUUID.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>() + <span class="stringliteral">&quot;, handle: 0x&quot;</span> &lt;&lt; std::setw(2) &lt;&lt; m_handle;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    stringstream &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_READ) ? <span class="stringliteral">&quot;Read &quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_WRITE) ? <span class="stringliteral">&quot;Write &quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_WRITE_NR) ? <span class="stringliteral">&quot;WriteNoResponse &quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_BROADCAST) ? <span class="stringliteral">&quot;Broadcast &quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_NOTIFY) ? <span class="stringliteral">&quot;Notify &quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        ((m_properties &amp; ESP_GATT_CHAR_PROP_BIT_INDICATE) ? <span class="stringliteral">&quot;Indicate &quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">return</span> stringstream.str();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;} <span class="comment">// toString</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic_callbacks.html#a7cce7901eb402d17a9277e76d0685fb6">  737</a></span>&#160;<a class="code" href="class_b_l_e_characteristic_callbacks.html#a7cce7901eb402d17a9277e76d0685fb6">BLECharacteristicCallbacks::~BLECharacteristicCallbacks</a>() {}</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic_callbacks.html#a8dac68835a79ae6ef909515f6db4a431">  744</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic_callbacks.html#a8dac68835a79ae6ef909515f6db4a431">BLECharacteristicCallbacks::onRead</a>(<a class="code" href="class_b_l_e_characteristic.html">BLECharacteristic</a>* <a class="code" href="_sample_notify_8cpp.html#a83949d215e88efee5fc4f312ea2692e7">pCharacteristic</a>) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onRead: default&quot;</span>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onRead&quot;</span>);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;} <span class="comment">// onRead</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="class_b_l_e_characteristic_callbacks.html#a4ae0d40890990c1cb408b0ebd9b89ed8">  754</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_characteristic_callbacks.html#a4ae0d40890990c1cb408b0ebd9b89ed8">BLECharacteristicCallbacks::onWrite</a>(<a class="code" href="class_b_l_e_characteristic.html">BLECharacteristic</a>* <a class="code" href="_sample_notify_8cpp.html#a83949d215e88efee5fc4f312ea2692e7">pCharacteristic</a>) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onWrite: default&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;BLECharacteristicCallbacks&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onWrite&quot;</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;} <span class="comment">// onWrite</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CONFIG_BT_ENABLED */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html">BLEUUID</a></div><div class="ttdoc">A model of a BLE UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8h_source.html#l00018">BLEUUID.h:18</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a706761c2593535beddd0311a57b54d6e"><div class="ttname"><a href="class_b_l_e_characteristic.html#a706761c2593535beddd0311a57b54d6e">BLECharacteristic::getUUID</a></div><div class="ttdeci">BLEUUID getUUID()</div><div class="ttdoc">Get the UUID of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00173">BLECharacteristic.cpp:173</a></div></div>
<div class="ttc" id="_general_utils_8h_html"><div class="ttname"><a href="_general_utils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="_b_l_e_characteristic_8h_html"><div class="ttname"><a href="_b_l_e_characteristic_8h.html">BLECharacteristic.h</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a224cf88fbc3beecd3bff1f9e4ec9375b"><div class="ttname"><a href="class_b_l_e_characteristic.html#a224cf88fbc3beecd3bff1f9e4ec9375b">BLECharacteristic::PROPERTY_NOTIFY</a></div><div class="ttdeci">static const uint32_t PROPERTY_NOTIFY</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00088">BLECharacteristic.h:88</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_ac900bf20fd476c2c6a6b3b7c778608f3"><div class="ttname"><a href="class_b_l_e_characteristic.html#ac900bf20fd476c2c6a6b3b7c778608f3">BLECharacteristic::indicate</a></div><div class="ttdeci">void indicate()</div><div class="ttdoc">Send an indication. An indication is a transmission of up to the first 20 bytes of the characteristic...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00468">BLECharacteristic.cpp:468</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_map_html_afa5415ac42d2f4e6514602c85a7d3b99"><div class="ttname"><a href="class_b_l_e_descriptor_map.html#afa5415ac42d2f4e6514602c85a7d3b99">BLEDescriptorMap::getFirst</a></div><div class="ttdeci">BLEDescriptor * getFirst()</div><div class="ttdoc">Get the first descriptor in the map. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_map_8cpp_source.html#l00128">BLEDescriptorMap.cpp:128</a></div></div>
<div class="ttc" id="_b_l_e_utils_8h_html"><div class="ttname"><a href="_b_l_e_utils_8h.html">BLEUtils.h</a></div></div>
<div class="ttc" id="_b_l_e_device_8h_html"><div class="ttname"><a href="_b_l_e_device_8h.html">BLEDevice.h</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a71e9605b9f97a32c3f15cc15c44260e6"><div class="ttname"><a href="class_b_l_e_characteristic.html#a71e9605b9f97a32c3f15cc15c44260e6">BLECharacteristic::setBroadcastProperty</a></div><div class="ttdeci">void setBroadcastProperty(bool value)</div><div class="ttdoc">Set the permission to broadcast. A characteristics has properties associated with it which define wha...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00543">BLECharacteristic.cpp:543</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_ad771643ce8f5a321ef14d8d18e9a925f"><div class="ttname"><a href="class_b_l_e_characteristic.html#ad771643ce8f5a321ef14d8d18e9a925f">BLECharacteristic::PROPERTY_BROADCAST</a></div><div class="ttdeci">static const uint32_t PROPERTY_BROADCAST</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00089">BLECharacteristic.h:89</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_callbacks_html_a7cce7901eb402d17a9277e76d0685fb6"><div class="ttname"><a href="class_b_l_e_characteristic_callbacks.html#a7cce7901eb402d17a9277e76d0685fb6">BLECharacteristicCallbacks::~BLECharacteristicCallbacks</a></div><div class="ttdeci">virtual ~BLECharacteristicCallbacks()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00737">BLECharacteristic.cpp:737</a></div></div>
<div class="ttc" id="class_b_l_e_server_html_a4e73a6a59133915aa7212d3e87f60084"><div class="ttname"><a href="class_b_l_e_server.html#a4e73a6a59133915aa7212d3e87f60084">BLEServer::getConnectedCount</a></div><div class="ttdeci">uint32_t getConnectedCount()</div><div class="ttdoc">Return the number of connected clients. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_server_8cpp_source.html#l00130">BLEServer.cpp:130</a></div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a023f6570deed3cdd160bc857faff9cf6"><div class="ttname"><a href="class_b_l_e_characteristic.html#a023f6570deed3cdd160bc857faff9cf6">BLECharacteristic::setAccessPermissions</a></div><div class="ttdeci">void setAccessPermissions(esp_gatt_perm_t perm)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00152">BLECharacteristic.cpp:152</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_html_a767ecc1c8a3137faa99e973d9459e5e6"><div class="ttname"><a href="class_b_l_e_descriptor.html#a767ecc1c8a3137faa99e973d9459e5e6">BLEDescriptor::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Return a string representation of the descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_8cpp_source.html#l00263">BLEDescriptor.cpp:263</a></div></div>
<div class="ttc" id="class_b_l_e_utils_html_afb88eb5c555c242966dba1b7e890af8f"><div class="ttname"><a href="class_b_l_e_utils.html#afb88eb5c555c242966dba1b7e890af8f">BLEUtils::buildHexData</a></div><div class="ttdeci">static char * buildHexData(uint8_t *target, uint8_t *source, uint8_t length)</div><div class="ttdoc">Create a hex representation of data. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_utils_8cpp_source.html#l00773">BLEUtils.cpp:773</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a2fbc07b24f41f2e7a4ed2b003bd5d8c7"><div class="ttname"><a href="class_b_l_e_characteristic.html#a2fbc07b24f41f2e7a4ed2b003bd5d8c7">BLECharacteristic::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Return a string representation of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00722">BLECharacteristic.cpp:722</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html_ad59ac075030347b7f306cdeb850e3e6e"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html#ad59ac075030347b7f306cdeb850e3e6e">BLEUUID::getNative</a></div><div class="ttdeci">esp_bt_uuid_t * getNative()</div><div class="ttdoc">Get the native UUID value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8cpp_source.html#l00278">BLEUUID.cpp:278</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_aabac82a0abd852ee50c2f6bf02c7aa3e"><div class="ttname"><a href="class_b_l_e_value.html#aabac82a0abd852ee50c2f6bf02c7aa3e">BLEValue::setValue</a></div><div class="ttdeci">void setValue(std::string value)</div><div class="ttdoc">Set the current value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00122">BLEValue.cpp:122</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a6592ef2c6ac44c113e35c4fc55b88982"><div class="ttname"><a href="class_b_l_e_characteristic.html#a6592ef2c6ac44c113e35c4fc55b88982">BLECharacteristic::getDescriptorByUUID</a></div><div class="ttdeci">BLEDescriptor * getDescriptorByUUID(const char *descriptorUUID)</div><div class="ttdoc">Return the BLE Descriptor for the given UUID if associated with this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00129">BLECharacteristic.cpp:129</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a30771341d9d0b1a83fd1cfcdcba53047"><div class="ttname"><a href="class_b_l_e_characteristic.html#a30771341d9d0b1a83fd1cfcdcba53047">BLECharacteristic::getData</a></div><div class="ttdeci">uint8_t * getData()</div><div class="ttdoc">Retrieve the current raw data of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00190">BLECharacteristic.cpp:190</a></div></div>
<div class="ttc" id="_b_l_e_characteristic_8cpp_html_ae633a443f20ba142873858305e83cd88"><div class="ttname"><a href="_b_l_e_characteristic_8cpp.html#ae633a443f20ba142873858305e83cd88">NULL_HANDLE</a></div><div class="ttdeci">#define NULL_HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00028">BLECharacteristic.cpp:28</a></div></div>
<div class="ttc" id="class_b_l_e_service_html"><div class="ttname"><a href="class_b_l_e_service.html">BLEService</a></div><div class="ttdoc">The model of a BLE service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_service_8h_source.html#l00049">BLEService.h:49</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_ad1aa158e37d15363b4441482fae82dd8"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">FreeRTOS::Semaphore::give</a></div><div class="ttdeci">void give()</div><div class="ttdoc">Give a semaphore. The Semaphore is given. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00114">FreeRTOS.cpp:114</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_a2ec01006910676d52888baa3affa9edc"><div class="ttname"><a href="class_b_l_e_value.html#a2ec01006910676d52888baa3affa9edc">BLEValue::commit</a></div><div class="ttdeci">void commit()</div><div class="ttdoc">Commit the current accumulation. When writing a value, we may find that we write it in &quot;parts&quot; meanin...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00065">BLEValue.cpp:65</a></div></div>
<div class="ttc" id="class_b_l_e_utils_html_acb35970d17947515e04bd77af6a5f0f9"><div class="ttname"><a href="class_b_l_e_utils.html#acb35970d17947515e04bd77af6a5f0f9">BLEUtils::gattServerEventTypeToString</a></div><div class="ttdeci">static std::string gattServerEventTypeToString(esp_gatts_cb_event_t eventType)</div><div class="ttdoc">Return a string representation of a GATT server event code. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_utils_8cpp_source.html#l00961">BLEUtils.cpp:961</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_map_html_affeb1b70f1495cd938fcdc8b61af9b06"><div class="ttname"><a href="class_b_l_e_descriptor_map.html#affeb1b70f1495cd938fcdc8b61af9b06">BLEDescriptorMap::getNext</a></div><div class="ttdeci">BLEDescriptor * getNext()</div><div class="ttdoc">Get the next descriptor in the map. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_map_8cpp_source.html#l00141">BLEDescriptorMap.cpp:141</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a268245dea16728988459a4c7038dbced"><div class="ttname"><a href="class_b_l_e_characteristic.html#a268245dea16728988459a4c7038dbced">BLECharacteristic::addDescriptor</a></div><div class="ttdeci">void addDescriptor(BLEDescriptor *pDescriptor)</div><div class="ttdoc">Associate a descriptor with this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00071">BLECharacteristic.cpp:71</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_ad31ff9cf3f34f5955cdfb8d68af1a1f9"><div class="ttname"><a href="class_b_l_e_characteristic.html#ad31ff9cf3f34f5955cdfb8d68af1a1f9">BLECharacteristic::setWriteNoResponseProperty</a></div><div class="ttdeci">void setWriteNoResponseProperty(bool value)</div><div class="ttdoc">Set the Write No Response property value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00694">BLECharacteristic.cpp:694</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_callbacks_html_a4ae0d40890990c1cb408b0ebd9b89ed8"><div class="ttname"><a href="class_b_l_e_characteristic_callbacks.html#a4ae0d40890990c1cb408b0ebd9b89ed8">BLECharacteristicCallbacks::onWrite</a></div><div class="ttdeci">virtual void onWrite(BLECharacteristic *pCharacteristic)</div><div class="ttdoc">Callback function to support a write request. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00754">BLECharacteristic.cpp:754</a></div></div>
<div class="ttc" id="class_b_l_e_service_html_ab4cce218daffde19e019bd0d1b6697ad"><div class="ttname"><a href="class_b_l_e_service.html#ab4cce218daffde19e019bd0d1b6697ad">BLEService::getHandle</a></div><div class="ttdeci">uint16_t getHandle()</div><div class="ttdoc">Get the handle associated with this service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_service_8cpp_source.html#l00213">BLEService.cpp:213</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="class_b_l_e_descriptor_html"><div class="ttname"><a href="class_b_l_e_descriptor.html">BLEDescriptor</a></div><div class="ttdoc">A model of a BLE descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_8h_source.html#l00025">BLEDescriptor.h:25</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a90515329867fee2e4a05888306df9ee4"><div class="ttname"><a href="class_b_l_e_characteristic.html#a90515329867fee2e4a05888306df9ee4">BLECharacteristic::setNotifyProperty</a></div><div class="ttdeci">void setNotifyProperty(bool value)</div><div class="ttdoc">Set the Notify property value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00599">BLECharacteristic.cpp:599</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_a8107af1e3d843719ba66750dea3ec205"><div class="ttname"><a href="class_b_l_e_value.html#a8107af1e3d843719ba66750dea3ec205">BLEValue::cancel</a></div><div class="ttdeci">void cancel()</div><div class="ttdoc">Cancel the current accumulation. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00052">BLEValue.cpp:52</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_af97c9627170b1672d464b96d1664ed77"><div class="ttname"><a href="class_b_l_e_value.html#af97c9627170b1672d464b96d1664ed77">BLEValue::getData</a></div><div class="ttdeci">uint8_t * getData()</div><div class="ttdoc">Get a pointer to the data. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00079">BLEValue.cpp:79</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_callbacks_html_a8dac68835a79ae6ef909515f6db4a431"><div class="ttname"><a href="class_b_l_e_characteristic_callbacks.html#a8dac68835a79ae6ef909515f6db4a431">BLECharacteristicCallbacks::onRead</a></div><div class="ttdeci">virtual void onRead(BLECharacteristic *pCharacteristic)</div><div class="ttdoc">Callback function to support a read request. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00744">BLECharacteristic.cpp:744</a></div></div>
<div class="ttc" id="class_b_l_e_server_html_a898e73615b3056ed3af21eb2ecdcbfa2"><div class="ttname"><a href="class_b_l_e_server.html#a898e73615b3056ed3af21eb2ecdcbfa2">BLEServer::getPeerMTU</a></div><div class="ttdeci">uint16_t getPeerMTU(uint16_t conn_id)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_server_8cpp_source.html#l00390">BLEServer.cpp:390</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a57431e7893554f12c34d45889475d4d2"><div class="ttname"><a href="class_b_l_e_characteristic.html#a57431e7893554f12c34d45889475d4d2">BLECharacteristic::setCallbacks</a></div><div class="ttdeci">void setCallbacks(BLECharacteristicCallbacks *pCallbacks)</div><div class="ttdoc">Set the callback handlers for this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00557">BLECharacteristic.cpp:557</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html"><div class="ttname"><a href="class_b_l_e_characteristic.html">BLECharacteristic</a></div><div class="ttdoc">The model of a BLE Characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00053">BLECharacteristic.h:53</a></div></div>
<div class="ttc" id="class_general_utils_html_a0624d2bba035e50c4073074da675a606"><div class="ttname"><a href="class_general_utils.html#a0624d2bba035e50c4073074da675a606">GeneralUtils::hexDump</a></div><div class="ttdeci">static void hexDump(const uint8_t *pData, uint32_t length)</div><div class="ttdoc">Dump a representation of binary data to the console. </div><div class="ttdef"><b>Definition:</b> <a href="_general_utils_8cpp_source.html#l00293">GeneralUtils.cpp:293</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_af8b0f2a86109a07ce75e6f6772b3bbdc"><div class="ttname"><a href="class_b_l_e_characteristic.html#af8b0f2a86109a07ce75e6f6772b3bbdc">BLECharacteristic::getHandle</a></div><div class="ttdeci">uint16_t getHandle()</div><div class="ttdoc">Get the handle of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00148">BLECharacteristic.cpp:148</a></div></div>
<div class="ttc" id="class_b_l_e_service_html_a389e7e6e9fb078158142ec226fe7ba45"><div class="ttname"><a href="class_b_l_e_service.html#a389e7e6e9fb078158142ec226fe7ba45">BLEService::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Return a string representation of this service. A service is defined by: </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_service_8cpp_source.html#l00388">BLEService.cpp:388</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_map_html_af160970e51454b8e3ec80d179e2e16a4"><div class="ttname"><a href="class_b_l_e_descriptor_map.html#af160970e51454b8e3ec80d179e2e16a4">BLEDescriptorMap::setByUUID</a></div><div class="ttdeci">void setByUUID(const char *uuid, BLEDescriptor *pDescriptor)</div><div class="ttdoc">Set the descriptor by UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_map_8cpp_source.html#l00060">BLEDescriptorMap.cpp:60</a></div></div>
<div class="ttc" id="class_general_utils_html_a25e466e54ff002f54bfb7e1f43bd401b"><div class="ttname"><a href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a></div><div class="ttdeci">static const char * errorToString(esp_err_t errCode)</div><div class="ttdoc">Convert an ESP error code to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_general_utils_8cpp_source.html#l00366">GeneralUtils.cpp:366</a></div></div>
<div class="ttc" id="class_b_l_e2902_html"><div class="ttname"><a href="class_b_l_e2902.html">BLE2902</a></div><div class="ttdoc">Descriptor for Client Characteristic Configuration. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e2902_8h_source.html#l00023">BLE2902.h:23</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a023cb404ff897bb39064b454732ccf21"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">FreeRTOS::Semaphore::wait</a></div><div class="ttdeci">uint32_t wait(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Wait for a semaphore to be released by trying to take it and then releasing it again. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00064">FreeRTOS.cpp:64</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a4fff7e76804ad78427591ddc60088ba1"><div class="ttname"><a href="class_b_l_e_characteristic.html#a4fff7e76804ad78427591ddc60088ba1">BLECharacteristic::~BLECharacteristic</a></div><div class="ttdeci">virtual ~BLECharacteristic()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00061">BLECharacteristic.cpp:61</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_callbacks_html"><div class="ttname"><a href="class_b_l_e_characteristic_callbacks.html">BLECharacteristicCallbacks</a></div><div class="ttdoc">Callbacks that can be associated with a BLE characteristic to inform of events. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00130">BLECharacteristic.h:130</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a9e716766107d22ba00d5326c16fedc6a"><div class="ttname"><a href="class_b_l_e_characteristic.html#a9e716766107d22ba00d5326c16fedc6a">BLECharacteristic::notify</a></div><div class="ttdeci">void notify(bool is_notification=true)</div><div class="ttdoc">Send a notify. A notification is a transmission of up to the first 20 bytes of the characteristic val...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00482">BLECharacteristic.cpp:482</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a6833d4adc67929d69a99f3a6b2620351"><div class="ttname"><a href="class_b_l_e_characteristic.html#a6833d4adc67929d69a99f3a6b2620351">BLECharacteristic::BLECharacteristic</a></div><div class="ttdeci">BLECharacteristic(const char *uuid, uint32_t properties=0)</div><div class="ttdoc">Construct a characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00036">BLECharacteristic.cpp:36</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a54c6f36de0e85928583c2cdca0dbc453"><div class="ttname"><a href="class_b_l_e_characteristic.html#a54c6f36de0e85928583c2cdca0dbc453">BLECharacteristic::PROPERTY_READ</a></div><div class="ttdeci">static const uint32_t PROPERTY_READ</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00086">BLECharacteristic.h:86</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_ac55113748a66caafc031be26f97f7b76"><div class="ttname"><a href="class_b_l_e_characteristic.html#ac55113748a66caafc031be26f97f7b76">BLECharacteristic::PROPERTY_WRITE</a></div><div class="ttdeci">static const uint32_t PROPERTY_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00087">BLECharacteristic.h:87</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_ab1cfca5ba59d772b1a9079fa7781f306"><div class="ttname"><a href="class_b_l_e_value.html#ab1cfca5ba59d772b1a9079fa7781f306">BLEValue::getValue</a></div><div class="ttdeci">std::string getValue()</div><div class="ttdoc">Get the current value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00105">BLEValue.cpp:105</a></div></div>
<div class="ttc" id="class_b_l_e2902_html_a83898356dba62c055e7f759eb4ddcd8c"><div class="ttname"><a href="class_b_l_e2902.html#a83898356dba62c055e7f759eb4ddcd8c">BLE2902::getIndications</a></div><div class="ttdeci">bool getIndications()</div><div class="ttdoc">Get the indications value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e2902_8cpp_source.html#l00036">BLE2902.cpp:36</a></div></div>
<div class="ttc" id="class_b_l_e2902_html_a7609aeaf43a8d5b70ac30d71f940089e"><div class="ttname"><a href="class_b_l_e2902.html#a7609aeaf43a8d5b70ac30d71f940089e">BLE2902::getNotifications</a></div><div class="ttdeci">bool getNotifications()</div><div class="ttdoc">Get the notifications value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e2902_8cpp_source.html#l00027">BLE2902.cpp:27</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_map_html_ad617412614990bca1344fb9adbedb24e"><div class="ttname"><a href="class_b_l_e_descriptor_map.html#ad617412614990bca1344fb9adbedb24e">BLEDescriptorMap::handleGATTServerEvent</a></div><div class="ttdeci">void handleGATTServerEvent(esp_gatts_cb_event_t event, esp_gatt_if_t gatts_if, esp_ble_gatts_cb_param_t *param)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_map_8cpp_source.html#l00113">BLEDescriptorMap.cpp:113</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_map_html_a431d72f448ea419ec77344300a91f76b"><div class="ttname"><a href="class_b_l_e_descriptor_map.html#a431d72f448ea419ec77344300a91f76b">BLEDescriptorMap::getByUUID</a></div><div class="ttdeci">BLEDescriptor * getByUUID(const char *uuid)</div><div class="ttdoc">Return the descriptor by UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_map_8cpp_source.html#l00023">BLEDescriptorMap.cpp:23</a></div></div>
<div class="ttc" id="_sample_notify_8cpp_html_a83949d215e88efee5fc4f312ea2692e7"><div class="ttname"><a href="_sample_notify_8cpp.html#a83949d215e88efee5fc4f312ea2692e7">pCharacteristic</a></div><div class="ttdeci">BLECharacteristic * pCharacteristic</div><div class="ttdef"><b>Definition:</b> <a href="_sample_notify_8cpp_source.html#l00042">SampleNotify.cpp:42</a></div></div>
<div class="ttc" id="class_b_l_e_service_html_a3bfd36fe7ce35be32a373eeef2d625ef"><div class="ttname"><a href="class_b_l_e_service.html#a3bfd36fe7ce35be32a373eeef2d625ef">BLEService::getServer</a></div><div class="ttdeci">BLEServer * getServer()</div><div class="ttdoc">Get the BLE server associated with this service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_service_8cpp_source.html#l00412">BLEService.cpp:412</a></div></div>
<div class="ttc" id="_b_l_e_service_8h_html"><div class="ttname"><a href="_b_l_e_service_8h.html">BLEService.h</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a03927d537d1f09c10100f2cea29974cd"><div class="ttname"><a href="class_b_l_e_characteristic.html#a03927d537d1f09c10100f2cea29974cd">BLECharacteristic::getValue</a></div><div class="ttdeci">std::string getValue()</div><div class="ttdoc">Retrieve the current value of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00182">BLECharacteristic.cpp:182</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_aa8cb5ac60c0e094b7615a7a19145a7ff"><div class="ttname"><a href="class_b_l_e_characteristic.html#aa8cb5ac60c0e094b7615a7a19145a7ff">BLECharacteristic::PROPERTY_INDICATE</a></div><div class="ttdeci">static const uint32_t PROPERTY_INDICATE</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00090">BLECharacteristic.h:90</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_a2bf1f68b62aeb5f3eaa0b6e83dfbdf85"><div class="ttname"><a href="class_b_l_e_value.html#a2bf1f68b62aeb5f3eaa0b6e83dfbdf85">BLEValue::getReadOffset</a></div><div class="ttdeci">uint16_t getReadOffset()</div><div class="ttdoc">Get the read offset. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00097">BLEValue.cpp:97</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_a4d93ec1f39c17d7557d711a84e0e2315"><div class="ttname"><a href="class_b_l_e_value.html#a4d93ec1f39c17d7557d711a84e0e2315">BLEValue::addPart</a></div><div class="ttdeci">void addPart(std::string part)</div><div class="ttdoc">Add a message part to the accumulation. The accumulation is a growing set of data that is added to un...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00031">BLEValue.cpp:31</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a7c711983f6cb7540f6ed73ab0d4a92ab"><div class="ttname"><a href="class_b_l_e_characteristic.html#a7c711983f6cb7540f6ed73ab0d4a92ab">BLECharacteristic::setReadProperty</a></div><div class="ttdeci">void setReadProperty(bool value)</div><div class="ttdoc">Set the Read property value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00613">BLECharacteristic.cpp:613</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="class_b_l_e_value_html_ae8137625a5132b0d433a2dee8fba4c69"><div class="ttname"><a href="class_b_l_e_value.html#ae8137625a5132b0d433a2dee8fba4c69">BLEValue::setReadOffset</a></div><div class="ttdeci">void setReadOffset(uint16_t readOffset)</div><div class="ttdoc">Set the read offset. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_value_8cpp_source.html#l00114">BLEValue.cpp:114</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_t_l_m_8h_html_a36142ddde297ed1d5577c81230997301"><div class="ttname"><a href="_b_l_e_eddystone_t_l_m_8h.html#a36142ddde297ed1d5577c81230997301">temp</a></div><div class="ttdeci">uint16_t temp</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_t_l_m_8h_source.html#l00043">BLEEddystoneTLM.h:43</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html_a52e30a254e1ff10a429c2e0a36a6131d"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">BLEUUID::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Get a string representation of the UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8cpp_source.html#l00355">BLEUUID.cpp:355</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a9673274ca3ca326d6748b92fb5485cd6"><div class="ttname"><a href="class_b_l_e_characteristic.html#a9673274ca3ca326d6748b92fb5485cd6">BLECharacteristic::PROPERTY_WRITE_NR</a></div><div class="ttdeci">static const uint32_t PROPERTY_WRITE_NR</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8h_source.html#l00091">BLECharacteristic.h:91</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a52fc80cc51aa75a5ddf2a99ed9198d4c"><div class="ttname"><a href="class_b_l_e_characteristic.html#a52fc80cc51aa75a5ddf2a99ed9198d4c">BLECharacteristic::setWriteProperty</a></div><div class="ttdeci">void setWriteProperty(bool value)</div><div class="ttdoc">Set the Write property value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00708">BLECharacteristic.cpp:708</a></div></div>
<div class="ttc" id="class_b_l_e_descriptor_html_a85ebb13db3538adc419f2dceb60afd68"><div class="ttname"><a href="class_b_l_e_descriptor.html#a85ebb13db3538adc419f2dceb60afd68">BLEDescriptor::getUUID</a></div><div class="ttdeci">BLEUUID getUUID()</div><div class="ttdoc">Get the UUID of the descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_descriptor_8cpp_source.html#l00112">BLEDescriptor.cpp:112</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_a1f2528ba4723d8fed192aa21b3771f99"><div class="ttname"><a href="class_b_l_e_characteristic.html#a1f2528ba4723d8fed192aa21b3771f99">BLECharacteristic::setIndicateProperty</a></div><div class="ttdeci">void setIndicateProperty(bool value)</div><div class="ttdoc">Set the Indicate property value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00585">BLECharacteristic.cpp:585</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a67fa9bf777be48332a30154e006827fd"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">FreeRTOS::Semaphore::take</a></div><div class="ttdeci">bool take(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Take a semaphore. Take a semaphore and wait indefinitely. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00159">FreeRTOS.cpp:159</a></div></div>
<div class="ttc" id="test1_8c_html_a74bb3debd3b0d3f9c3fe210442b4cacc"><div class="ttname"><a href="test1_8c.html#a74bb3debd3b0d3f9c3fe210442b4cacc">assert</a></div><div class="ttdeci">#define assert(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="test1_8c_source.html#l00202">test1.c:202</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="_b_l_e2902_8h_html"><div class="ttname"><a href="_b_l_e2902_8h.html">BLE2902.h</a></div></div>
<div class="ttc" id="class_b_l_e_characteristic_html_ac3f5de598746678ce93c0457e42e8ccd"><div class="ttname"><a href="class_b_l_e_characteristic.html#ac3f5de598746678ce93c0457e42e8ccd">BLECharacteristic::setValue</a></div><div class="ttdeci">void setValue(uint8_t *data, size_t size)</div><div class="ttdoc">Set the value of the characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_characteristic_8cpp_source.html#l00628">BLECharacteristic.cpp:628</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e66062f3a4d2a5b6b6746a6b0f9c85ac.html">cpp_utils</a></li><li class="navelem"><a class="el" href="_b_l_e_characteristic_8cpp.html">BLECharacteristic.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
