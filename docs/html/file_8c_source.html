<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/file.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('file_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">file.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="file_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_FILE</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef HAVE_NETINET_IN_H</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef HAVE_NETDB_H</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;netdb.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifdef HAVE_ARPA_INET_H</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef HAVE_NET_IF_H</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;net/if.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_IOCTL_H</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;sys/ioctl.h&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_PARAM_H</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;sys/param.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifdef HAVE_FCNTL_H</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtoofft_8h.html">strtoofft.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="progress_8h.html">progress.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="escape_8h.html">escape.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="components_2curl_2lib_2_file_8h.html">file.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="speedcheck_8h.html">speedcheck.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="getinfo_8h.html">getinfo.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="transfer_8h.html">transfer.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="url_8h.html">url.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="parsedate_8h.html">parsedate.h</a>&quot;</span> <span class="comment">/* for the week day and month names */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="warnless_8h.html">warnless.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__range_8h.html">curl_range.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#if defined(WIN32) || defined(MSDOS) || defined(__EMX__) || \</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">  defined(__SYMBIAN32__)</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#define DOS_FILESYSTEM 1</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#ifdef OPEN_NEEDS_ARG3</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#  define open_readonly(p,f) open((p),(f),(0))</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="file_8c.html#ad7e5de2ac3cd7dfc9ca7e5db0ae41d29">   78</a></span>&#160;<span class="preprocessor">#  define open_readonly(p,f) open((p),(f))</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * Forward declarations.</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_done(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                          <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> status, <span class="keywordtype">bool</span> premature);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_disconnect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                <span class="keywordtype">bool</span> dead_connection);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_setup_connection(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * FILE scheme handler.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="components_2curl_2lib_2_file_8h.html#ad4db8d27c2dff81749fd0015a0ad24cd">   97</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> <a class="code" href="file_8c.html#ad4db8d27c2dff81749fd0015a0ad24cd">Curl_handler_file</a> = {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="stringliteral">&quot;FILE&quot;</span>,                               <span class="comment">/* scheme */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  file_setup_connection,                <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  file_do,                              <span class="comment">/* do_it */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  file_done,                            <span class="comment">/* done */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  file_connect,                         <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connecting */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  file_disconnect,                      <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  0,                                    <span class="comment">/* defport */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="curl_8h.html#ab9dc18362468a060094b6fea044e2a40">CURLPROTO_FILE</a>,                       <span class="comment">/* protocol */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="urldata_8h.html#a3bfbbdae2857443d0580fc5b5b4a0a5b">PROTOPT_NONETWORK</a> | <a class="code" href="urldata_8h.html#a93a3791fdbb761285b636725fed39385">PROTOPT_NOURLQUERY</a> <span class="comment">/* flags */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;};</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_setup_connection(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">/* allocate the FILE specific struct */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a> = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a>));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * file_connect() gets called from Curl_protocol_connect() to allow us to</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * do protocol-specific actions at connect-time.  We emulate a</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * connect-then-transfer protocol and &quot;connect&quot; to the file here</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *<a class="code" href="struct_curl__handler.html#ac77e1b77c701181a1ba5e58922504524">done</a>)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">char</span> *real_path;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#ifdef DOS_FILESYSTEM</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">char</span> *actual_path;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">size_t</span> real_path_len;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="structdata.html">data</a>-&gt;state.up.path, 0, &amp;real_path,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                   &amp;real_path_len, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#ifdef DOS_FILESYSTEM</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">/* If the first character is a slash, and there&#39;s</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">     something that looks like a drive at the beginning of</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">     the path, skip the slash.  If we remove the initial</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">     slash in all cases, paths without drive letters end up</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">     relative to the current directory which isn&#39;t how</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">     browsers work.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     Some browsers accept | instead of : as the drive letter</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">     separator, so we do too.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">     On other platforms, we need the slash to indicate an</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">     absolute pathname.  On Windows, absolute paths start</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">     with a drive letter.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  actual_path = real_path;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span>((actual_path[0] == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      actual_path[1] &amp;&amp;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     (actual_path[2] == <span class="charliteral">&#39;:&#39;</span> || actual_path[2] == <span class="charliteral">&#39;|&#39;</span>)) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    actual_path[2] = <span class="charliteral">&#39;:&#39;</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    actual_path++;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    real_path_len--;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/* change path separators from &#39;/&#39; to &#39;\\&#39; for DOS, Windows and OS/2 */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; real_path_len; ++<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span>(actual_path[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      actual_path[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!actual_path[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]) { <span class="comment">/* binary zero */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(real_path);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a> = <a class="code" href="file_8c.html#ad7e5de2ac3cd7dfc9ca7e5db0ae41d29">open_readonly</a>(actual_path, O_RDONLY|<a class="code" href="tool__operate_8c.html#a36fa9b2e726512bc17a7a6d3e39002be">O_BINARY</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path = actual_path;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span>(memchr(real_path, 0, real_path_len)) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">/* binary zeroes indicate foul play */</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(real_path);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a> = <a class="code" href="file_8c.html#ad7e5de2ac3cd7dfc9ca7e5db0ae41d29">open_readonly</a>(real_path, O_RDONLY);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path = real_path;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;freepath = real_path; <span class="comment">/* free this when done */</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd = <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;set.upload &amp;&amp; (<a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a> == -1)) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Couldn&#39;t open file %s&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;state.up.path);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    file_done(conn, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a">CURLE_FILE_COULDNT_READ_FILE</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a">CURLE_FILE_COULDNT_READ_FILE</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_done(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                               <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> status, <span class="keywordtype">bool</span> premature)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  (void)status; <span class="comment">/* not used */</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  (void)premature; <span class="comment">/* not used */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;freepath);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path = NULL;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd != -1)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      close(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd = -1;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_disconnect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                <span class="keywordtype">bool</span> dead_connection)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  (void)dead_connection; <span class="comment">/* not used */</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;freepath);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path = NULL;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd != -1)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      close(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd = -1;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifdef DOS_FILESYSTEM</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">#define DIRSEP &#39;\\&#39;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="file_8c.html#a2c89f3449c0cc91f289ecbef54188d8d">  247</a></span>&#160;<span class="preprocessor">#define DIRSEP &#39;/&#39;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_upload(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dir = strchr(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path, <a class="code" href="file_8c.html#a2c89f3449c0cc91f289ecbef54188d8d">DIRSEP</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">int</span> mode;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> = <a class="code" href="structdata.html">data</a>-&gt;state.buffer;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> bytecount = 0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="curl__setup_8h.html#a1c6e64692c9b7c6e7dc70adb398b3115">struct_stat</a> file_stat;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *buf2;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">   * Since FILE: doesn&#39;t do the full init, we need to provide some extra</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">   * assignments here.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a29a93742706b21aad3b169dffd1f611a">upload_fromhere</a> = <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span>(!dir)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a">CURLE_FILE_COULDNT_READ_FILE</a>; <span class="comment">/* fix: better error code */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">if</span>(!dir[1])</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a">CURLE_FILE_COULDNT_READ_FILE</a>; <span class="comment">/* fix: better error code */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">#ifdef O_BINARY</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#define MODE_DEFAULT O_WRONLY|O_CREAT|O_BINARY</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#define MODE_DEFAULT O_WRONLY|O_CREAT</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    mode = <a class="code" href="file_8c.html#aa2ac0f45d353352c766262721c40e3b8">MODE_DEFAULT</a>|O_APPEND;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    mode = <a class="code" href="file_8c.html#aa2ac0f45d353352c766262721c40e3b8">MODE_DEFAULT</a>|O_TRUNC;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  fd = open(<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path, mode, conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a494f1fa838cd661944a18a1e2bd68397">new_file_perms</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">if</span>(fd &lt; 0) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Can&#39;t open %s for writing&quot;</span>, <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">if</span>(-1 != <a class="code" href="structdata.html">data</a>-&gt;state.infilesize)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">/* known size of data to &quot;upload&quot; */</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="structdata.html">data</a>-&gt;state.infilesize);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">/* treat the negative resume offset value as the case of &quot;-&quot; */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &lt; 0) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>(fstat(fd, &amp;file_stat)) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      close(fd);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Can&#39;t get the size of %s&quot;</span>, <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;path);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.resume_from = (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)file_stat.st_size;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">while</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">size_t</span> nread;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">size_t</span> nwrite;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">size_t</span> readcount;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="transfer_8c.html#a2d575b634fe05cd90230cc12d6b73f76">Curl_fillreadbuffer</a>(conn, <a class="code" href="structdata.html">data</a>-&gt;set.buffer_size, &amp;readcount);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span>(readcount &lt;= 0)  <span class="comment">/* fix questionable compare error. curlvms */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    nread = readcount;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">/*skip bytes before resume point*/</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">if</span>((<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)nread &lt;= data-&gt;<a class="code" href="ftp_8c.html#a77812d4945cd21094debbd06962f0f01">state</a>.resume_from) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.resume_from -= nread;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        nread = 0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        buf2 = <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        buf2 = <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> + <a class="code" href="structdata.html">data</a>-&gt;state.resume_from;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        nread -= (size_t)<a class="code" href="structdata.html">data</a>-&gt;state.resume_from;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.resume_from = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      buf2 = <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">/* write the data to the target */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    nwrite = write(fd, buf2, nread);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span>(nwrite != nread) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    bytecount += nread;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="progress_8c.html#a9458c724bbe21e16b9abf8f696a3916a">Curl_pgrsSetUploadCounter</a>(<a class="code" href="structdata.html">data</a>, bytecount);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a>(conn))</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="speedcheck_8c.html#a9bb3788a8c28461af0215fc47308d36c">Curl_speedcheck</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="timeval_8c.html#ae736e803680e1b7fa2b2868317b4b91f">Curl_now</a>());</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; <a class="code" href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a>(conn))</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  close(fd);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> * file_do() is the protocol-specific function for the do-phase, separated</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> * from the connect-phase above. Other protocols merely setup the transfer in</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> * the do-phase, to have it done in the main transfer loop but since some</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> * platforms we support don&#39;t allow select()ing etc on file handles (as</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> * opposed to sockets) we instead perform the whole do-operation in this</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> * function.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> file_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">/* This implementation ignores the host name in conformance with</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     RFC 1738. Only local files (reachable via the standard file system)</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">     are supported. This means that files on remotely mounted directories</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">     (via NFS, Samba, NT sharing) can be accessed through a file:// URL</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="curl__setup_8h.html#a1c6e64692c9b7c6e7dc70adb398b3115">struct_stat</a> statbuf; <span class="comment">/* struct_stat instead of struct stat just to allow the</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">                          Windows version to have a different struct without</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">                          having to redefine the simple word &#39;stat&#39; */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> expected_size = 0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordtype">bool</span> size_known;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">bool</span> fstated = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> = <a class="code" href="structdata.html">data</a>-&gt;state.buffer;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> bytecount = 0;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a> *<a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* unconditionally */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="progress_8c.html#a4887bd15abbedadf869cedab36e4eb34">Curl_pgrsStartNow</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.upload)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> file_upload(conn);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">/* get the fd from the connection phase */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a> = <a class="code" href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a>-&gt;fd;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">/* VMS: This only works reliable for STREAMLF files */</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">if</span>(-1 != fstat(<a class="code" href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">fd</a>, &amp;statbuf)) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">/* we could stat it, then read out the size */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    expected_size = statbuf.st_size;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">/* and store the modification time */</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;info.filetime = statbuf.st_mtime;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    fstated = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span>(fstated &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;state.range &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;set.timecondition) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="transfer_8c.html#a110f6f53341d61200abc2b0b7cdd53f2">Curl_meets_timecondition</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="structdata.html">data</a>-&gt;info.filetime)) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span>(fstated) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    time_t filetime;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">struct </span>tm <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>tm *tm = &amp;<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">char</span> header[80];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(header, <span class="keyword">sizeof</span>(header),</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;              <span class="stringliteral">&quot;Content-Length: %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              expected_size);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a>, header, 0);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a>,</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                               (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;Accept-ranges: bytes\r\n&quot;</span>, 0);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    filetime = (time_t)statbuf.st_mtime;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="parsedate_8c.html#a192aac16662dc4aaf80ef3722b581958">Curl_gmtime</a>(filetime, &amp;<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">/* format: &quot;Tue, 15 Nov 1994 12:45:26 GMT&quot; */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(header, <span class="keyword">sizeof</span>(header),</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              <span class="stringliteral">&quot;Last-Modified: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n%s&quot;</span>,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              <a class="code" href="parsedate_8c.html#afbefdd1c70bc7fde8f2369a4cf46a62f">Curl_wkday</a>[tm-&gt;tm_wday?tm-&gt;tm_wday-1:6],</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;              tm-&gt;tm_mday,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;              <a class="code" href="parsedate_8c.html#a4a84c69a44848f5947487bf91f86b733">Curl_month</a>[tm-&gt;tm_mon],</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              tm-&gt;tm_year + 1900,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;              tm-&gt;tm_hour,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;              tm-&gt;tm_min,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              tm-&gt;tm_sec,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;set.opt_no_body ? <span class="stringliteral">&quot;&quot;</span>: <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a>, header, 0);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">/* set the file size to make it available post transfer */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a>(<a class="code" href="structdata.html">data</a>, expected_size);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.opt_no_body)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">/* Check whether file range has been specified */</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl__range_8c.html#a82ce81e65f559e7316b160291d1a22b6">Curl_range</a>(conn);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">/* Adjust the start offset in case we want to get the N last bytes</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">   * of the stream if the filesize could be determined */</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &lt; 0) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span>(!fstated) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Can&#39;t get the size of file.&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62">CURLE_READ_ERROR</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.resume_from += (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)statbuf.st_size;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &lt;= expected_size)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    expected_size -= <a class="code" href="structdata.html">data</a>-&gt;state.resume_from;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;failed to resume file:// transfer&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa35bfdab90de5c981dc4e10e5e352a5e">CURLE_BAD_DOWNLOAD_RESUME</a>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">/* A high water mark has been specified so we obey... */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;req.maxdownload &gt; 0)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    expected_size = <a class="code" href="structdata.html">data</a>-&gt;req.maxdownload;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">if</span>(!fstated || (expected_size == 0))</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    size_known = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    size_known = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">/* The following is a shortcut implementation of file reading</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">     this is both more efficient than the former call to download() and</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">     it avoids problems with select() and recv() on file descriptors</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">     in Winsock */</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span>(fstated)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a>(<a class="code" href="structdata.html">data</a>, expected_size);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from !=</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       lseek(fd, <a class="code" href="structdata.html">data</a>-&gt;state.resume_from, SEEK_SET))</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa35bfdab90de5c981dc4e10e5e352a5e">CURLE_BAD_DOWNLOAD_RESUME</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="progress_8c.html#a1344967836d86ae13b5739ed0a6e6916">Curl_pgrsTime</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="progress_8h.html#abc090d144fb55d31dff488d24c46fb2aaca28f218d1fd3c4e65cd7b4d2dfe32ed">TIMER_STARTTRANSFER</a>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">while</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> nread;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/* Don&#39;t fill a whole buffer if we want less than all data */</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">size_t</span> bytestoread;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span>(size_known) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      bytestoread = (expected_size &lt; <a class="code" href="structdata.html">data</a>-&gt;set.buffer_size) ?</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a>(expected_size) : (size_t)<a class="code" href="structdata.html">data</a>-&gt;set.buffer_size;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      bytestoread = <a class="code" href="structdata.html">data</a>-&gt;set.buffer_size-1;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    nread = read(fd, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, bytestoread);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span>(nread &gt; 0)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[nread] = 0;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span>(nread &lt;= 0 || (size_known &amp;&amp; (expected_size == 0)))</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    bytecount += nread;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span>(size_known)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      expected_size -= nread;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nread);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="progress_8c.html#afd65889574fb7bde6ffcec48b0d8debb">Curl_pgrsSetDownloadCounter</a>(<a class="code" href="structdata.html">data</a>, bytecount);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a>(conn))</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="speedcheck_8c.html#a9bb3788a8c28461af0215fc47308d36c">Curl_speedcheck</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="timeval_8c.html#ae736e803680e1b7fa2b2868317b4b91f">Curl_now</a>());</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a>(conn))</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="ftp_8c_html_a77812d4945cd21094debbd06962f0f01"><div class="ttname"><a href="ftp_8c.html#a77812d4945cd21094debbd06962f0f01">state</a></div><div class="ttdeci">#define state(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="ftp_8c_source.html#l00101">ftp.c:101</a></div></div>
<div class="ttc" id="sendf_8h_html_aae18389dfefc98a5057629f6a46fd78f"><div class="ttname"><a href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a></div><div class="ttdeci">#define CLIENTWRITE_BODY</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00050">sendf.h:50</a></div></div>
<div class="ttc" id="curl_8h_html_ab9dc18362468a060094b6fea044e2a40"><div class="ttname"><a href="curl_8h.html#ab9dc18362468a060094b6fea044e2a40">CURLPROTO_FILE</a></div><div class="ttdeci">#define CURLPROTO_FILE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00875">curl.h:875</a></div></div>
<div class="ttc" id="escape_8c_html_a11aa4921a19102059a1d94e2be15477a"><div class="ttname"><a href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a></div><div class="ttdeci">CURLcode Curl_urldecode(struct Curl_easy *data, const char *string, size_t length, char **ostring, size_t *olen, bool reject_ctrl)</div><div class="ttdef"><b>Definition:</b> <a href="escape_8c_source.html#l00147">escape.c:147</a></div></div>
<div class="ttc" id="parsedate_8c_html_afbefdd1c70bc7fde8f2369a4cf46a62f"><div class="ttname"><a href="parsedate_8c.html#afbefdd1c70bc7fde8f2369a4cf46a62f">Curl_wkday</a></div><div class="ttdeci">const char *const Curl_wkday[]</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00085">parsedate.c:85</a></div></div>
<div class="ttc" id="struct_f_i_l_e_p_r_o_t_o_html_a56ff605a163bf34755904e417418dd76"><div class="ttname"><a href="struct_f_i_l_e_p_r_o_t_o.html#a56ff605a163bf34755904e417418dd76">FILEPROTO::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2lib_2_file_8h_source.html#l00033">file.h:33</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="struct_user_defined_html_a494f1fa838cd661944a18a1e2bd68397"><div class="ttname"><a href="struct_user_defined.html#a494f1fa838cd661944a18a1e2bd68397">UserDefined::new_file_perms</a></div><div class="ttdeci">long new_file_perms</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01667">urldata.h:1667</a></div></div>
<div class="ttc" id="progress_8c_html_a9458c724bbe21e16b9abf8f696a3916a"><div class="ttname"><a href="progress_8c.html#a9458c724bbe21e16b9abf8f696a3916a">Curl_pgrsSetUploadCounter</a></div><div class="ttdeci">void Curl_pgrsSetUploadCounter(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00336">progress.c:336</a></div></div>
<div class="ttc" id="file_8c_html_aa2ac0f45d353352c766262721c40e3b8"><div class="ttname"><a href="file_8c.html#aa2ac0f45d353352c766262721c40e3b8">MODE_DEFAULT</a></div><div class="ttdeci">#define MODE_DEFAULT</div></div>
<div class="ttc" id="progress_8c_html_a1344967836d86ae13b5739ed0a6e6916"><div class="ttname"><a href="progress_8c.html#a1344967836d86ae13b5739ed0a6e6916">Curl_pgrsTime</a></div><div class="ttdeci">void Curl_pgrsTime(struct Curl_easy *data, timerid timer)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00166">progress.c:166</a></div></div>
<div class="ttc" id="urldata_8h_html_a93a3791fdbb761285b636725fed39385"><div class="ttname"><a href="urldata_8h.html#a93a3791fdbb761285b636725fed39385">PROTOPT_NOURLQUERY</a></div><div class="ttdeci">#define PROTOPT_NOURLQUERY</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00717">urldata.h:717</a></div></div>
<div class="ttc" id="struct_curl__handler_html"><div class="ttname"><a href="struct_curl__handler.html">Curl_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00628">urldata.h:628</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="parsedate_8c_html_a4a84c69a44848f5947487bf91f86b733"><div class="ttname"><a href="parsedate_8c.html#a4a84c69a44848f5947487bf91f86b733">Curl_month</a></div><div class="ttdeci">const char *const Curl_month[]</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00090">parsedate.c:90</a></div></div>
<div class="ttc" id="file_8c_html_a2c89f3449c0cc91f289ecbef54188d8d"><div class="ttname"><a href="file_8c.html#a2c89f3449c0cc91f289ecbef54188d8d">DIRSEP</a></div><div class="ttdeci">#define DIRSEP</div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00247">file.c:247</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00526">curl.h:526</a></div></div>
<div class="ttc" id="components_2curl_2lib_2_file_8h_html"><div class="ttname"><a href="components_2curl_2lib_2_file_8h.html">file.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00461">curl.h:461</a></div></div>
<div class="ttc" id="parsedate_8h_html"><div class="ttname"><a href="parsedate_8h.html">parsedate.h</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a3dca40ce1e998420175eabe37246e05b"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="ttdeci">#define CURL_FORMAT_CURL_OFF_T</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00395">system.h:395</a></div></div>
<div class="ttc" id="progress_8h_html_abc090d144fb55d31dff488d24c46fb2aaca28f218d1fd3c4e65cd7b4d2dfe32ed"><div class="ttname"><a href="progress_8h.html#abc090d144fb55d31dff488d24c46fb2aaca28f218d1fd3c4e65cd7b4d2dfe32ed">TIMER_STARTTRANSFER</a></div><div class="ttdef"><b>Definition:</b> <a href="progress_8h_source.html#l00036">progress.h:36</a></div></div>
<div class="ttc" id="progress_8c_html_a4887bd15abbedadf869cedab36e4eb34"><div class="ttname"><a href="progress_8c.html#a4887bd15abbedadf869cedab36e4eb34">Curl_pgrsStartNow</a></div><div class="ttdeci">void Curl_pgrsStartNow(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00230">progress.c:230</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="speedcheck_8h_html"><div class="ttname"><a href="speedcheck_8h.html">speedcheck.h</a></div></div>
<div class="ttc" id="struct_f_i_l_e_p_r_o_t_o_html"><div class="ttname"><a href="struct_f_i_l_e_p_r_o_t_o.html">FILEPROTO</a></div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2lib_2_file_8h_source.html#l00029">file.h:29</a></div></div>
<div class="ttc" id="unit1308_8c_html_a70a830d3039f37216dde9bcf2460aec2"><div class="ttname"><a href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a></div><div class="ttdeci">char buffer[]</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00048">unit1308.c:48</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a494e2b4279dc064f7ed1d0abd602b28d"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_OFF_T curl_off_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00442">system.h:442</a></div></div>
<div class="ttc" id="tool__operate_8c_html_a36fa9b2e726512bc17a7a6d3e39002be"><div class="ttname"><a href="tool__operate_8c.html#a36fa9b2e726512bc17a7a6d3e39002be">O_BINARY</a></div><div class="ttdeci">#define O_BINARY</div><div class="ttdef"><b>Definition:</b> <a href="tool__operate_8c_source.html#l00087">tool_operate.c:87</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="timeval_8c_html_ae736e803680e1b7fa2b2868317b4b91f"><div class="ttname"><a href="timeval_8c.html#ae736e803680e1b7fa2b2868317b4b91f">Curl_now</a></div><div class="ttdeci">struct curltime Curl_now(void)</div><div class="ttdef"><b>Definition:</b> <a href="timeval_8c_source.html#l00154">timeval.c:154</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="progress_8c_html_a40686d443707afea0c0e47cee805df01"><div class="ttname"><a href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a></div><div class="ttdeci">int Curl_pgrsUpdate(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00369">progress.c:369</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62">CURLE_READ_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00492">curl.h:492</a></div></div>
<div class="ttc" id="struct_curl__handler_html_ac77e1b77c701181a1ba5e58922504524"><div class="ttname"><a href="struct_curl__handler.html#ac77e1b77c701181a1ba5e58922504524">Curl_handler::done</a></div><div class="ttdeci">Curl_done_func done</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00636">urldata.h:636</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="curlx_8c_html_af6458f5d187f1d7c82fb9ea7ef634b44"><div class="ttname"><a href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a></div><div class="ttdeci">#define ZERO_NULL</div><div class="ttdef"><b>Definition:</b> <a href="curlx_8c_source.html#l00131">curlx.c:131</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a8a13221afd448ab0b91f021b4f5ec7c7"><div class="ttname"><a href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">Curl_easy::req</a></div><div class="ttdeci">struct SingleRequest req</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01787">urldata.h:1787</a></div></div>
<div class="ttc" id="curl__range_8c_html_a82ce81e65f559e7316b160291d1a22b6"><div class="ttname"><a href="curl__range_8c.html#a82ce81e65f559e7316b160291d1a22b6">Curl_range</a></div><div class="ttdeci">CURLcode Curl_range(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="curl__range_8c_source.html#l00036">curl_range.c:36</a></div></div>
<div class="ttc" id="progress_8h_html"><div class="ttname"><a href="progress_8h.html">progress.h</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="file_8c_html_ad7e5de2ac3cd7dfc9ca7e5db0ae41d29"><div class="ttname"><a href="file_8c.html#ad7e5de2ac3cd7dfc9ca7e5db0ae41d29">open_readonly</a></div><div class="ttdeci">#define open_readonly(p, f)</div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00078">file.c:78</a></div></div>
<div class="ttc" id="config_8d_html_aea53e62b3bb322f5a6bf4ceb58066a37"><div class="ttname"><a href="config_8d.html#aea53e62b3bb322f5a6bf4ceb58066a37">file</a></div><div class="ttdeci">Long separated by or the equals sign.Long option names can optionally be given in the config file without the initial double dashes and if the colon or equals characters can be used as separators.If the option is specified with one or two there can be no colon or equals character between the option and its parameter.If the parameter is to contain the parameter must be enclosed within quotes.Within double the following escape sequences are r and v.A backslash preceding any other letter is ignored.If the first column of a config line is a the rest of the line will be treated as a comment.Only write one option per physical line in the config file.Specify the filename to config as to make curl read the file from stdin.Note that to be able to specify a URL in the config file</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="transfer_8c_html_a110f6f53341d61200abc2b0b7cdd53f2"><div class="ttname"><a href="transfer_8c.html#a110f6f53341d61200abc2b0b7cdd53f2">Curl_meets_timecondition</a></div><div class="ttdeci">bool Curl_meets_timecondition(struct Curl_easy *data, time_t timeofdoc)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l00412">transfer.c:412</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00512">curl.h:512</a></div></div>
<div class="ttc" id="progress_8c_html_a82906bd19baedaf94d95274dd2371b22"><div class="ttname"><a href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a></div><div class="ttdeci">void Curl_pgrsSetUploadSize(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00353">progress.c:353</a></div></div>
<div class="ttc" id="progress_8c_html_a00f01952b08507f31def8af5b088e53f"><div class="ttname"><a href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a></div><div class="ttdeci">void Curl_pgrsSetDownloadSize(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00341">progress.c:341</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a7357f5e474f98f5e52a70def2fd14c6a">CURLE_FILE_COULDNT_READ_FILE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00507">curl.h:507</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aa35bfdab90de5c981dc4e10e5e352a5e"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aa35bfdab90de5c981dc4e10e5e352a5e">CURLE_BAD_DOWNLOAD_RESUME</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00506">curl.h:506</a></div></div>
<div class="ttc" id="strtoofft_8h_html"><div class="ttname"><a href="strtoofft_8h.html">strtoofft.h</a></div></div>
<div class="ttc" id="sendf_8h_html_a5b56d764844bff170a6721d5e33dca34"><div class="ttname"><a href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a></div><div class="ttdeci">#define CLIENTWRITE_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00051">sendf.h:51</a></div></div>
<div class="ttc" id="curl__range_8h_html"><div class="ttname"><a href="curl__range_8h.html">curl_range.h</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="speedcheck_8c_html_a9bb3788a8c28461af0215fc47308d36c"><div class="ttname"><a href="speedcheck_8c.html#a9bb3788a8c28461af0215fc47308d36c">Curl_speedcheck</a></div><div class="ttdeci">CURLcode Curl_speedcheck(struct Curl_easy *data, struct curltime now)</div><div class="ttdef"><b>Definition:</b> <a href="speedcheck_8c_source.html#l00039">speedcheck.c:39</a></div></div>
<div class="ttc" id="struct_curl__easy_html_abcc5aa61af150adc1388b1a3492c2599"><div class="ttname"><a href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">Curl_easy::set</a></div><div class="ttdeci">struct UserDefined set</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01788">urldata.h:1788</a></div></div>
<div class="ttc" id="sendf_8c_html_ad59954133649b7538b387f940b86024f"><div class="ttname"><a href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a></div><div class="ttdeci">CURLcode Curl_client_write(struct connectdata *conn, int type, char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00651">sendf.c:651</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a3bfbbdae2857443d0580fc5b5b4a0a5b"><div class="ttname"><a href="urldata_8h.html#a3bfbbdae2857443d0580fc5b5b4a0a5b">PROTOPT_NONETWORK</a></div><div class="ttdeci">#define PROTOPT_NONETWORK</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00714">urldata.h:714</a></div></div>
<div class="ttc" id="struct_single_request_html_a5803af0f75195ad74badb6ced9b24b16"><div class="ttname"><a href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">SingleRequest::protop</a></div><div class="ttdeci">void * protop</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00619">urldata.h:619</a></div></div>
<div class="ttc" id="transfer_8c_html_a2d575b634fe05cd90230cc12d6b73f76"><div class="ttname"><a href="transfer_8c.html#a2d575b634fe05cd90230cc12d6b73f76">Curl_fillreadbuffer</a></div><div class="ttdeci">CURLcode Curl_fillreadbuffer(struct connectdata *conn, size_t bytes, size_t *nreadp)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l00124">transfer.c:124</a></div></div>
<div class="ttc" id="config-win32_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="config-win32_8h_source.html#l00379">config-win32.h:379</a></div></div>
<div class="ttc" id="file_8c_html_ad4db8d27c2dff81749fd0015a0ad24cd"><div class="ttname"><a href="file_8c.html#ad4db8d27c2dff81749fd0015a0ad24cd">Curl_handler_file</a></div><div class="ttdeci">const struct Curl_handler Curl_handler_file</div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00097">file.c:97</a></div></div>
<div class="ttc" id="progress_8c_html_afd65889574fb7bde6ffcec48b0d8debb"><div class="ttname"><a href="progress_8c.html#afd65889574fb7bde6ffcec48b0d8debb">Curl_pgrsSetDownloadCounter</a></div><div class="ttdeci">void Curl_pgrsSetDownloadCounter(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00306">progress.c:306</a></div></div>
<div class="ttc" id="parsedate_8c_html_a192aac16662dc4aaf80ef3722b581958"><div class="ttname"><a href="parsedate_8c.html#a192aac16662dc4aaf80ef3722b581958">Curl_gmtime</a></div><div class="ttdeci">CURLcode Curl_gmtime(time_t intime, struct tm *store)</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00581">parsedate.c:581</a></div></div>
<div class="ttc" id="struct_single_request_html_a29a93742706b21aad3b169dffd1f611a"><div class="ttname"><a href="struct_single_request.html#a29a93742706b21aad3b169dffd1f611a">SingleRequest::upload_fromhere</a></div><div class="ttdeci">char * upload_fromhere</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00608">urldata.h:608</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00489">curl.h:489</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="transfer_8h_html"><div class="ttname"><a href="transfer_8h.html">transfer.h</a></div></div>
<div class="ttc" id="escape_8h_html"><div class="ttname"><a href="escape_8h.html">escape.h</a></div></div>
<div class="ttc" id="warnless_8h_html"><div class="ttname"><a href="warnless_8h.html">warnless.h</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="warnless_8c_html_a9b1c2efcef4120b8096d53bc254bfb9b"><div class="ttname"><a href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a></div><div class="ttdeci">size_t curlx_sotouz(curl_off_t sonum)</div><div class="ttdef"><b>Definition:</b> <a href="warnless_8c_source.html#l00347">warnless.c:347</a></div></div>
<div class="ttc" id="url_8h_html"><div class="ttname"><a href="url_8h.html">url.h</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="getinfo_8h_html"><div class="ttname"><a href="getinfo_8h.html">getinfo.h</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a1c6e64692c9b7c6e7dc70adb398b3115"><div class="ttname"><a href="curl__setup_8h.html#a1c6e64692c9b7c6e7dc70adb398b3115">struct_stat</a></div><div class="ttdeci">#define struct_stat</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00389">curl_setup.h:389</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="file_8c.html">file.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
