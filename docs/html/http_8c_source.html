<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/http.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('http_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">http.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="http_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_HTTP</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef HAVE_NETINET_IN_H</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifdef HAVE_NETDB_H</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;netdb.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifdef HAVE_ARPA_INET_H</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifdef HAVE_NET_IF_H</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;net/if.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_IOCTL_H</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;sys/ioctl.h&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_PARAM_H</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;sys/param.h&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="transfer_8h.html">transfer.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="formdata_8h.html">formdata.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mime_8h.html">mime.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="progress_8h.html">progress.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cookie_8h.html">cookie.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vauth_8h.html">vauth/vauth.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtls_8h.html">vtls/vtls.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__digest_8h.html">http_digest.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__ntlm_8h.html">http_ntlm.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__ntlm__wb_8h.html">curl_ntlm_wb.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__negotiate_8h.html">http_negotiate.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="url_8h.html">url.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="share_8h.html">share.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hostip_8h.html">hostip.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http_8h.html">http.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="select_8h.html">select.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="parsedate_8h.html">parsedate.h</a>&quot;</span> <span class="comment">/* for the week day and month names */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtoofft_8h.html">strtoofft.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="multiif_8h.html">multiif.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="content__encoding_8h.html">content_encoding.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__proxy_8h.html">http_proxy.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="warnless_8h.html">warnless.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="non-ascii_8h.html">non-ascii.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pipeline_8h.html">pipeline.h</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http2_8h.html">http2.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connect_8h.html">connect.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strdup_8h.html">strdup.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> * Forward declarations.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> http_getsock_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                           <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                           <span class="keywordtype">int</span> <a class="code" href="struct_curl__easy.html#ae5487e7b1b5e91d240646325c575fd0c">numsocks</a>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> http_should_fail(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> add_haproxy_protocol_header(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">https_connecting</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> https_getsock(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                         <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                         <span class="keywordtype">int</span> <a class="code" href="struct_curl__easy.html#ae5487e7b1b5e91d240646325c575fd0c">numsocks</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">  103</a></span>&#160;<span class="preprocessor">#define https_connecting(x,y) CURLE_COULDNT_CONNECT</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * HTTP handler interface.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="http_8h.html#ada3b16c5ed5c539dfdfe51909d1224ec">  109</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> <a class="code" href="http_8c.html#ada3b16c5ed5c539dfdfe51909d1224ec">Curl_handler_http</a> = {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="stringliteral">&quot;HTTP&quot;</span>,                               <span class="comment">/* scheme */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="http_8c.html#ab8c4f46b5f0c91777ce7c37f28e2e383">Curl_http_setup_conn</a>,                 <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="http_8c.html#ac009a02368ec5154996b23065aa85a28">Curl_http</a>,                            <span class="comment">/* do_it */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="http_8c.html#ae3dc4a63f791cddc2b843736433a6c62">Curl_http_done</a>,                       <span class="comment">/* done */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="http_8c.html#aa380bd70f94bb31fc19b879223427e44">Curl_http_connect</a>,                    <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connecting */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  http_getsock_do,                      <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="urldata_8h.html#a5158b1e31a4e7aa84de308e3d792a1de">PORT_HTTP</a>,                            <span class="comment">/* defport */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="curl_8h.html#a4c4a3046bce0da437f299072f489bc02">CURLPROTO_HTTP</a>,                       <span class="comment">/* protocol */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="urldata_8h.html#a9ea1f37a358d8c3a9ee378b36e614b48">PROTOPT_CREDSPERREQUEST</a>               <span class="comment">/* flags */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;};</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * HTTPS handler interface.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> Curl_handler_https = {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="stringliteral">&quot;HTTPS&quot;</span>,                              <span class="comment">/* scheme */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="http_8c.html#ab8c4f46b5f0c91777ce7c37f28e2e383">Curl_http_setup_conn</a>,                 <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="http_8c.html#ac009a02368ec5154996b23065aa85a28">Curl_http</a>,                            <span class="comment">/* do_it */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="http_8c.html#ae3dc4a63f791cddc2b843736433a6c62">Curl_http_done</a>,                       <span class="comment">/* done */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="http_8c.html#aa380bd70f94bb31fc19b879223427e44">Curl_http_connect</a>,                    <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">https_connecting</a>,                     <span class="comment">/* connecting */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  https_getsock,                        <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  http_getsock_do,                      <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="urldata_8h.html#a054f94b51abab46052e1d78f0d1e03fd">PORT_HTTPS</a>,                           <span class="comment">/* defport */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a>,                      <span class="comment">/* protocol */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a> | <a class="code" href="urldata_8h.html#a9ea1f37a358d8c3a9ee378b36e614b48">PROTOPT_CREDSPERREQUEST</a> | <a class="code" href="urldata_8h.html#aed268b90593d1d852e7468aca80e7656">PROTOPT_ALPN_NPN</a> <span class="comment">/* flags */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;};</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="http_8h.html#ab8c4f46b5f0c91777ce7c37f28e2e383">  156</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#ab8c4f46b5f0c91777ce7c37f28e2e383">Curl_http_setup_conn</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">/* allocate the HTTP-specific struct for the Curl_easy, only to survive</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     during this request */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="structdata.html">data</a>-&gt;req.protop == NULL);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_h_t_t_p.html">HTTP</a>));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="mime_8c.html#a26e5fb189d0937d27da11d1c10c09565">Curl_mime_initpart</a>(&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">form</a>, conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.protop = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="urldata_8h.html#a34fcb7c4bc590f8c24dee47e14ed41d6">CONN_INUSE</a>(conn))</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">/* if not already multi-using, setup connection details */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="http2_8h.html#a2295b843d76aeb06631566bfebc73be8">Curl_http2_setup_conn</a>(conn);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="http2_8h.html#a5bdef737723c68dff0e4bde069b428ec">Curl_http2_setup_req</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * checkProxyHeaders() checks the linked list of custom proxy headers</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> * if proxy headers are not available, then it will lookup into http header</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * link list</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * It takes a connectdata struct as input instead of the Curl_easy simply to</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * know if this is a proxy request or not, as it then might check a different</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * header list. Provide the header prefix without colon!.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="http_8h.html#a058a82e5ae8dc800565a9b32d54af85c">  188</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="http_8c.html#a058a82e5ae8dc800565a9b32d54af85c">Curl_checkProxyheaders</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *thisheader)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">size_t</span> thislen = strlen(thisheader);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a> = (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ad6024fcc7a2aefd8d8d1359f9ae7955d">proxy</a> &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;set.sep_headers) ?</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;set.proxyheaders : <a class="code" href="structdata.html">data</a>-&gt;set.headers;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>; <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a> = <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;next) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;data, thisheader, thislen) &amp;&amp;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       <a class="code" href="transfer_8h.html#add920a73e8f85870585b3391b7e4feed">Curl_headersep</a>(<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;data[thislen]))</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;data;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> * Strip off leading and trailing whitespace from the value in the</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * given HTTP header line and return a strdupped copy. Returns NULL in</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * case of allocation failure. Returns an empty string if the header value</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * consists entirely of whitespace.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="http_8h.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">  212</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *header)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *start;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *end;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">/* Find the end of the header name */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">while</span>(*header &amp;&amp; (*header != <span class="charliteral">&#39;:&#39;</span>))</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    ++header;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span>(*header)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">/* Skip over colon */</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    ++header;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">/* Find the first non-space letter */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  start = header;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">while</span>(*start &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*start))</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    start++;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">/* data is in the host encoding so</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">     use &#39;\r&#39; and &#39;\n&#39; instead of 0x0d and 0x0a */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  end = strchr(start, <span class="charliteral">&#39;\r&#39;</span>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span>(!end)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    end = strchr(start, <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">if</span>(!end)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    end = strchr(start, <span class="charliteral">&#39;\0&#39;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span>(!end)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">/* skip all trailing space letters */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">while</span>((end &gt; start) &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*end))</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    end--;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">/* get length of the type */</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = end - start + 1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 1);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, start, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>] = 0; <span class="comment">/* zero terminate */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * http_output_basic() sets up an Authorization: header (or the proxy version)</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> * for HTTP Basic authentication.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> * Returns CURLcode.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> http_output_basic(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> = 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">char</span> *authorization = NULL;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">char</span> **userp;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *user;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *pwd;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">char</span> *out;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    userp = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    user = conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">user</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    pwd = conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ab2b6b7b0dc1dd09509d79ae5f52dd3b8">passwd</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    userp = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    user = conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    pwd = conn-&gt;<a class="code" href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">passwd</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  out = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%s:%s&quot;</span>, user, pwd);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span>(!out)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>, out, strlen(out), &amp;authorization, &amp;<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span>(!authorization) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a682b1c9a48ab0eff7ca39e6ee8728bbc">CURLE_REMOTE_ACCESS_DENIED</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*userp);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  *userp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%sAuthorization: Basic %s\r\n&quot;</span>,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                   <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ? <span class="stringliteral">&quot;Proxy-&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                   authorization);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(authorization);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span>(!*userp) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(out);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * http_output_bearer() sets up an Authorization: header</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> * for HTTP Bearer authentication.</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * Returns CURLcode.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> http_output_bearer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordtype">char</span> **userp;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  userp = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(*userp);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  *userp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Authorization: Bearer %s\r\n&quot;</span>,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                   conn-&gt;<a class="code" href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">oauth_bearer</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span>(!*userp) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">goto</span> <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a>:</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">/* pickoneauth() selects the most favourable authentication method from the</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"> * ones available and the ones we want.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> * return TRUE if one was picked</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> pickoneauth(<span class="keyword">struct</span> <a class="code" href="structauth.html">auth</a> *pick, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mask)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">bool</span> picked;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">/* only deal with authentication we want */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> avail = pick-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp; pick-&gt;<a class="code" href="structauth.html#a6400153286a044e63643d53d34094321">want</a> &amp; mask;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  picked = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">/* The order of these checks is highly relevant, as this will be the order</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">     of preference in case of the existence of multiple accepted types. */</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(avail &amp; <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    pick-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = <a class="code" href="http_8h.html#a31346b3abe9af85dfebb99a72714e7d0">CURLAUTH_PICKNONE</a>; <span class="comment">/* we select to use nothing */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    picked = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  pick-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> = <a class="code" href="curl_8h.html#a2623448e48f97bb09eb1a83b28da7735">CURLAUTH_NONE</a>; <span class="comment">/* clear it here */</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> picked;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> * Curl_http_perhapsrewind()</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"> * If we are doing POST or PUT {</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"> *   If we have more data to send {</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"> *     If we are doing NTLM {</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> *       Keep sending since we must not disconnect</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> *     else {</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> *       If there is more than just a little data left to send, close</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"> *       the current connection by force.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> *   }</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> *   If we have sent any data {</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"> *     If we don&#39;t have track of all the data {</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> *       call app to tell it to rewind</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> *     else {</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> *       rewind internally so that the operation can restart fine</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"> *   }</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> http_perhapsrewind(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;{</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> bytessent;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> expectsend = -1; <span class="comment">/* default is unknown */</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">/* If this is still NULL, we have not reach very far and we can safely</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">       skip this rewinding stuff */</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>:</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>:</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  bytessent = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/* This is a state where we are known to be negotiating and we don&#39;t send</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">       any data then. */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    expectsend = 0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a6fbb8f80996d3921279d0314179a4958">protoconnstart</a>) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">/* HTTP CONNECT in progress: there is no body */</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    expectsend = 0;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">/* figure out how much data we are expected to send */</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a>:</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.infilesize != -1)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        expectsend = <a class="code" href="structdata.html">data</a>-&gt;state.infilesize;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>:</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.infilesize != -1)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        expectsend = <a class="code" href="structdata.html">data</a>-&gt;state.infilesize;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      expectsend = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">rewindaftersend</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* default */</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">if</span>((expectsend == -1) || (expectsend &gt; bytessent)) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#if defined(USE_NTLM)</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">/* There is still data left to send */</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;state.authproxy.picked == <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>) ||</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;state.authhost.picked == <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>) ||</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;state.authproxy.picked == <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>) ||</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;state.authhost.picked == <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>)) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">if</span>(((expectsend - bytessent) &lt; 2000) ||</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         (conn-&gt;ntlm.state != <a class="code" href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54ad3a119ab713f7bb6f724b72353157c67">NTLMSTATE_NONE</a>) ||</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         (conn-&gt;proxyntlm.state != <a class="code" href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54ad3a119ab713f7bb6f724b72353157c67">NTLMSTATE_NONE</a>)) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">/* The NTLM-negotiation has started *OR* there is just a little (&lt;2K)</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">           data left to send, keep on sending. */</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">/* rewind data when completely done sending! */</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> &amp;&amp; (conn-&gt;<a class="code" href="structconnectdata.html#a73d6d39e7554e4d764099ab3f1181a40">writesockfd</a> != <a class="code" href="curl_8h.html#ada0bbe252b7b370ef4e135b93b2fe71e">CURL_SOCKET_BAD</a>)) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">rewindaftersend</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Rewind stream after send\n&quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">close</a>)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">/* this is already marked to get closed */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;NTLM send, close instead of sending %&quot;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot; bytes\n&quot;</span>,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)(expectsend - bytessent));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">/* This is not NTLM or many bytes left to send: close */</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;Mid-auth HTTP and much data left to send&quot;</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.size = 0; <span class="comment">/* don&#39;t download any more than 0 bytes */</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">/* There still is data left to send, but this connection is marked for</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">       closure so we can safely do the rewind right now */</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span>(bytessent)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">/* we rewind now at once since if we already sent something */</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="transfer_8c.html#a1ccf9c16ae7d51395fc19e946da56c09">Curl_readrewind</a>(conn);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"> * Curl_http_auth_act() gets called when all HTTP headers have been received</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"> * and it checks what authentication methods that are available and decides</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"> * which one (if any) to use. It will set &#39;newurl&#39; if an auth method was</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"> * picked.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="http_8h.html#a3827f32165b3a89ed16bb104eb00e185">  505</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a3827f32165b3a89ed16bb104eb00e185">Curl_http_auth_act</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">bool</span> pickhost = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">bool</span> pickproxy = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> authmask = ~0ul;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">oauth_bearer</a>)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    authmask &amp;= (<span class="keywordtype">unsigned</span> long)~<a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">if</span>(100 &lt;= <a class="code" href="structdata.html">data</a>-&gt;req.httpcode &amp;&amp; 199 &gt;= <a class="code" href="structdata.html">data</a>-&gt;req.httpcode)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">/* this is a transient response code, ignore */</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.authproblem)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structdata.html">data</a>-&gt;set.http_fail_on_error?<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3">CURLE_HTTP_RETURNED_ERROR</a>:<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a> || conn-&gt;<a class="code" href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">oauth_bearer</a>) &amp;&amp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     ((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode == 401) ||</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;req.httpcode &lt; 300))) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    pickhost = pickoneauth(&amp;<a class="code" href="structdata.html">data</a>-&gt;state.authhost, authmask);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span>(!pickhost)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.authhost.picked == <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a> &amp;&amp;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;       conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> &gt; 11) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Forcing HTTP/1.1 for NTLM&quot;</span>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <a class="code" href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a>(conn, <span class="stringliteral">&quot;Force HTTP/1.1 connection&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a297b95c9d8a6b73ab0d15f752e23ba8b">httpversion</a> = <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da2bdca7ce6479378784212fee3a068c74">CURL_HTTP_VERSION_1_1</a>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">proxy_user_passwd</a> &amp;&amp;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     ((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode == 407) ||</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;req.httpcode &lt; 300))) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    pickproxy = pickoneauth(&amp;<a class="code" href="structdata.html">data</a>-&gt;state.authproxy,</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                            authmask &amp; ~<a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span>(!pickproxy)</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span>(pickhost || pickproxy) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>) &amp;&amp;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;set.httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>) &amp;&amp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;       !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">rewindaftersend</a>) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = http_perhapsrewind(conn);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/* In case this is GSS auth, the newurl field is already allocated so</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">       we must make sure to free it before allocating a new one. As figured</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">       out in bug #2284386 */</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="structdata.html">data</a>-&gt;req.newurl);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.newurl = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url); <span class="comment">/* clone URL */</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode &lt; 300) &amp;&amp;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          (!<a class="code" href="structdata.html">data</a>-&gt;state.authhost.done) &amp;&amp;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">/* no (known) authentication available,</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">       authentication is not &quot;done&quot; yet and</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">       no authentication seems to be required and</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">       we didn&#39;t try HEAD or GET */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>) &amp;&amp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;set.httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>)) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.newurl = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url); <span class="comment">/* clone URL */</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl)</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.authhost.done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">if</span>(http_should_fail(conn)) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;The requested URL returned error: %d&quot;</span>,</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;req.httpcode);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3">CURLE_HTTP_RETURNED_ERROR</a>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"> * Output the correct authentication header depending on the auth type</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> * and whether or not it is to a proxy.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;output_auth_headers(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="structauth.html">auth</a> *authstatus,</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *request,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structauth.html">auth</a> = NULL;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_VERBOSE_STRINGS) || defined(USE_SPNEGO)</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#ifdef USE_SPNEGO</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keyword">struct </span>negotiatedata *negdata = <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ?</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    &amp;<a class="code" href="structdata.html">data</a>-&gt;state.proxyneg : &amp;<a class="code" href="structdata.html">data</a>-&gt;state.negotiate;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#ifdef CURL_DISABLE_CRYPTO_AUTH</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  (void)request;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  (void)<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#ifdef USE_SPNEGO</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  negdata-&gt;state = GSS_AUTHNONE;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span>((authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>) &amp;&amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;     negdata-&gt;context &amp;&amp; !<a class="code" href="stub__gssapi_8h.html#a62228ec4265fe12232abce1600122fe7">GSS_ERROR</a>(negdata-&gt;status)) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;Negotiate&quot;</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_output_negotiate(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    negdata-&gt;state = GSS_AUTHSENT;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#ifdef USE_NTLM</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span>(authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;NTLM&quot;</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_output_ntlm(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#if defined(USE_NTLM) &amp;&amp; defined(NTLM_WB_ENABLED)</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">if</span>(authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;NTLM_WB&quot;</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_output_ntlm_wb(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_CRYPTO_AUTH</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">if</span>(authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;Digest&quot;</span>;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http__digest_8c.html#aab69b19ade52810158b5ed4fca8a8141">Curl_output_digest</a>(conn,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>,</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)request,</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span>(authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">/* Basic */</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">proxy_user_passwd</a> &amp;&amp;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        !<a class="code" href="http_8c.html#a058a82e5ae8dc800565a9b32d54af85c">Curl_checkProxyheaders</a>(conn, <span class="stringliteral">&quot;Proxy-authorization&quot;</span>)) ||</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;       (!<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a> &amp;&amp;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Authorization&quot;</span>))) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;Basic&quot;</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = http_output_basic(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">/* NOTE: this function should set &#39;done&#39; TRUE, as the other auth</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">       functions work that way */</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    authstatus-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span>(authstatus-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">/* Bearer */</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span>((!<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">oauth_bearer</a> &amp;&amp;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Authorization:&quot;</span>))) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="structauth.html">auth</a> = <span class="stringliteral">&quot;Bearer&quot;</span>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = http_output_bearer(conn);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">/* NOTE: this function should set &#39;done&#39; TRUE, as the other auth</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">       functions work that way */</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    authstatus-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structauth.html">auth</a>) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;%s auth using %s with user &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ? <span class="stringliteral">&quot;Proxy&quot;</span> : <span class="stringliteral">&quot;Server&quot;</span>, <a class="code" href="structauth.html">auth</a>,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ? (conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">user</a> ? conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">user</a> : <span class="stringliteral">&quot;&quot;</span>) :</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                  (conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a> ? conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a> : <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    authstatus-&gt;<a class="code" href="structauth.html#a689bd3ff24200ef5883f251e3b57e56e">multipass</a> = (!authstatus-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a>) ? <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> : <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    authstatus-&gt;<a class="code" href="structauth.html#a689bd3ff24200ef5883f251e3b57e56e">multipass</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="http_8h.html#a9aa397285caa1ed8c0991d9ebd94962a">  712</a></span>&#160;<a class="code" href="http_8c.html#a9aa397285caa1ed8c0991d9ebd94962a">Curl_http_output_auth</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *request,</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                      <span class="keywordtype">bool</span> proxytunnel) <span class="comment">/* TRUE if this is the request setting</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">                                           up the proxy tunnel */</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;{</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keyword">struct </span><a class="code" href="structauth.html">auth</a> *authhost;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keyword">struct </span><a class="code" href="structauth.html">auth</a> *authproxy;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  authhost = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.authhost;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  authproxy = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.authproxy;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">proxy_user_passwd</a>) ||</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;     conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a> || conn-&gt;<a class="code" href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">oauth_bearer</a>)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">/* continue please */</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    authhost-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    authproxy-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>; <span class="comment">/* no authentication with no user or password */</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span>(authhost-&gt;<a class="code" href="structauth.html#a6400153286a044e63643d53d34094321">want</a> &amp;&amp; !authhost-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a>)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">/* The app has selected one or more methods, but none has been picked</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">       so far by a server round-trip. Then we set the picked one to the</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">       want one, and if this is one single bit it&#39;ll be used instantly. */</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    authhost-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = authhost-&gt;<a class="code" href="structauth.html#a6400153286a044e63643d53d34094321">want</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">if</span>(authproxy-&gt;<a class="code" href="structauth.html#a6400153286a044e63643d53d34094321">want</a> &amp;&amp; !authproxy-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a>)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">/* The app has selected one or more methods, but none has been picked so</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">       far by a proxy round-trip. Then we set the picked one to the want one,</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">       and if this is one single bit it&#39;ll be used instantly. */</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    authproxy-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> = authproxy-&gt;<a class="code" href="structauth.html#a6400153286a044e63643d53d34094321">want</a>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_PROXY</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">/* Send proxy authentication header if needed */</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">tunnel_proxy</a> == proxytunnel)) {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = output_auth_headers(conn, authproxy, request, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  (void)proxytunnel;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_PROXY */</span><span class="preprocessor"></span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">/* we have no proxy so let&#39;s pretend we&#39;re done authenticating</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">       with it */</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    authproxy-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">/* To prevent the user+password to get sent to other than the original</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">     host due to a location-follow, we do some weirdo checks here */</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;state.this_is_a_follow ||</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;     conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ac81c594d3bde6b99be89b39136967e91">netrc</a> ||</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;     !<a class="code" href="structdata.html">data</a>-&gt;state.first_host ||</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;set.allow_auth_to_other_hosts ||</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;     <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;state.first_host, conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>)) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = output_auth_headers(conn, authhost, request, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    authhost-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;}</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment"> * Curl_http_input_auth() deals with Proxy-Authenticate: and WWW-Authenticate:</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"> * headers. They are dealt with both in the transfer.c main loop and in the</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"> * proxy CONNECT loop.</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="http_8h.html#aae41d68de9f7b8f248f3d52f5b14e3f6">  786</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#aae41d68de9f7b8f248f3d52f5b14e3f6">Curl_http_input_auth</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structauth.html">auth</a>) <span class="comment">/* the first non-space */</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">   * This resource requires authentication</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="preprocessor">#ifdef USE_SPNEGO</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keyword">struct </span>negotiatedata *negdata = <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>?</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    &amp;<a class="code" href="structdata.html">data</a>-&gt;state.proxyneg:&amp;<a class="code" href="structdata.html">data</a>-&gt;state.negotiate;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *availp;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keyword">struct </span><a class="code" href="structauth.html">auth</a> *authp;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>) {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    availp = &amp;<a class="code" href="structdata.html">data</a>-&gt;info.proxyauthavail;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    authp = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.authproxy;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    availp = &amp;<a class="code" href="structdata.html">data</a>-&gt;info.httpauthavail;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    authp = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.authhost;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">   * Here we check if we want the specific single authentication (using ==) and</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">   * if we do, we initiate usage of it.</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">   * If the provided authentication is wanted as one out of several accepted</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">   * types (using &amp;), we OR this authentication type to the authavail</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">   * variable.</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">   * Note:</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">   * -&gt;picked is first set to the &#39;want&#39; value (one or more bits) before the</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">   * request is sent, and then it is again set _after_ all response 401/407</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">   * headers have been received but then only to a single preferred method</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">   * (bit).</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">while</span>(*<a class="code" href="structauth.html">auth</a>) {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#ifdef USE_SPNEGO</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Negotiate&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">if</span>((authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp; <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>) ||</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         Curl_auth_is_spnego_supported()) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        *availp |= <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span>(authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordflow">if</span>(negdata-&gt;state == GSS_AUTHSENT ||</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;             negdata-&gt;state == GSS_AUTHNONE) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_input_negotiate(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>, <a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;              <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;req.newurl = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;              <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;              <span class="comment">/* we received a GSS auth token and we dealt with it fine */</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;              negdata-&gt;state = GSS_AUTHRECV;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#ifdef USE_NTLM</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">/* NTLM support requires the SSL crypto libs */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;NTLM&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span>((authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp; <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>) ||</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;           (authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp; <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>) ||</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;           Curl_auth_is_ntlm_supported()) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          *availp |= <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="keywordflow">if</span>(authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a> ||</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;             authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>) {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="comment">/* NTLM authentication is picked and activated */</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_input_ntlm(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>, <a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="preprocessor">#ifdef NTLM_WB_ENABLED</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;              <span class="keywordflow">if</span>(authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                *availp &amp;= ~<a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp;= ~<a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                *availp |= <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <span class="comment">/* Get the challenge-message which will be passed to</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">                 * ntlm_auth for generating the type 3 message later */</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="keywordflow">while</span>(*<a class="code" href="structauth.html">auth</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*<a class="code" href="structauth.html">auth</a>))</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                  <a class="code" href="structauth.html">auth</a>++;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;NTLM&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                  <a class="code" href="structauth.html">auth</a> += strlen(<span class="stringliteral">&quot;NTLM&quot;</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                  <span class="keywordflow">while</span>(*<a class="code" href="structauth.html">auth</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*<a class="code" href="structauth.html">auth</a>))</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                    <a class="code" href="structauth.html">auth</a>++;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                  <span class="keywordflow">if</span>(*<a class="code" href="structauth.html">auth</a>) {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    conn-&gt;challenge_header = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    <span class="keywordflow">if</span>(!conn-&gt;challenge_header)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                  }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;              <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Authentication problem. Ignoring this.\n&quot;</span>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_CRYPTO_AUTH</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Digest&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <span class="keywordflow">if</span>((authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> &amp; <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>) != 0)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Ignoring duplicate digest auth header.\n&quot;</span>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="digest_8c.html#a75bcfc858ec12ca28e8b59a1ebc76c44">Curl_auth_is_digest_supported</a>()) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            *availp |= <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="comment">/* We call this function on input Digest headers even if Digest</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">             * authentication isn&#39;t activated yet, as we need to store the</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">             * incoming data from this header in case we are going to use</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">             * Digest */</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http__digest_8c.html#a6c12c2cb30a52657ed4c7df23f88158c">Curl_input_digest</a>(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>, <a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Authentication problem. Ignoring this.\n&quot;</span>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Basic&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            *availp |= <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="keywordflow">if</span>(authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>) {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              <span class="comment">/* We asked for Basic authentication but got a 40X back</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">                 anyway, which basically means our name+password isn&#39;t</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">                 valid. */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;              authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> = <a class="code" href="curl_8h.html#a2623448e48f97bb09eb1a83b28da7735">CURLAUTH_NONE</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Authentication problem. Ignoring this.\n&quot;</span>);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Bearer&quot;</span>, <a class="code" href="structauth.html">auth</a>)) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;              *availp |= <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;              authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> |= <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;              <span class="keywordflow">if</span>(authp-&gt;<a class="code" href="structauth.html#aae718acfacc079a7d76873e0c175491a">picked</a> == <a class="code" href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a>) {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                <span class="comment">/* We asked for Bearer authentication but got a 40X back</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">                  anyway, which basically means our token isn&#39;t valid. */</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                authp-&gt;<a class="code" href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">avail</a> = <a class="code" href="curl_8h.html#a2623448e48f97bb09eb1a83b28da7735">CURLAUTH_NONE</a>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Authentication problem. Ignoring this.\n&quot;</span>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;              }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">/* there may be multiple methods on one line, so keep reading */</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">while</span>(*<a class="code" href="structauth.html">auth</a> &amp;&amp; *<a class="code" href="structauth.html">auth</a> != <span class="charliteral">&#39;,&#39;</span>) <span class="comment">/* read up to the next comma */</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <a class="code" href="structauth.html">auth</a>++;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span>(*<a class="code" href="structauth.html">auth</a> == <span class="charliteral">&#39;,&#39;</span>) <span class="comment">/* if we&#39;re on a comma, skip it */</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <a class="code" href="structauth.html">auth</a>++;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">while</span>(*<a class="code" href="structauth.html">auth</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*<a class="code" href="structauth.html">auth</a>))</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="structauth.html">auth</a>++;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> http_should_fail(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;{</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordtype">int</span> httpcode;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(conn);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  httpcode = <a class="code" href="structdata.html">data</a>-&gt;req.httpcode;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">  ** If we haven&#39;t been asked to fail on error,</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">  ** don&#39;t fail.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;set.http_fail_on_error)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">  ** Any code &lt; 400 is never terminal.</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">if</span>(httpcode &lt; 400)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">  ** Any code &gt;= 400 that&#39;s not 401 or 407 is always</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">  ** a terminal error</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">if</span>((httpcode != 401) &amp;&amp; (httpcode != 407))</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">  ** All we have left to deal with is 401 and 407</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>((httpcode == 401) || (httpcode == 407));</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">  ** Examine the current authentication state to see if this</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">  ** is an error.  The idea is for this function to get</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">  ** called after processing all the headers in a response</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">  ** message.  So, if we&#39;ve been to asked to authenticate a</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">  ** particular stage, and we&#39;ve done it, we&#39;re OK.  But, if</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">  ** we&#39;re already completely authenticated, it&#39;s not OK to</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">  ** get another 401 or 407.</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">  **</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">  ** It is possible for authentication to go stale such that</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">  ** the client needs to reauthenticate.  Once that info is</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">  ** available, use it here.</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">  ** Either we&#39;re not authenticating, or we&#39;re supposed to</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">  ** be authenticating something else.  This is an error.</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span>((httpcode == 401) &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a>)</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordflow">if</span>((httpcode == 407) &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">proxy_user_passwd</a>)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structdata.html">data</a>-&gt;state.authproblem;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"> * readmoredata() is a &quot;fread() emulation&quot; to provide POST and/or request</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"> * data. It is used when a huge POST is to be made and the entire chunk wasn&#39;t</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment"> * sent in the first send(). This function will then be called from the</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"> * transfer.c loop when more data is to be sent to the peer.</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"> * Returns the amount of bytes it filled the buffer with.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> readmoredata(<span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                           <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>,</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                           <span class="keywordtype">size_t</span> nitems,</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                           <span class="keywordtype">void</span> *userp)</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;{</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keyword">struct </span><a class="code" href="structconnectdata.html">connectdata</a> *conn = (<span class="keyword">struct </span><a class="code" href="structconnectdata.html">connectdata</a> *)userp;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordtype">size_t</span> fullsize = <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> * nitems;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">/* nothing to return */</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">/* make sure that a HTTP request is never sent away chunked! */</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a0ba1903778006c214622044083c106c4">forbidchunk</a> = (<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a> == <a class="code" href="struct_h_t_t_p.html#a0249b638827cfaf90270d9c651a1035fa9d8155c9496f897f08cfcfbdd42a3cd0">HTTPSEND_REQUEST</a>)?<a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> &lt;= (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)fullsize) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>, (<span class="keywordtype">size_t</span>)<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    fullsize = (size_t)<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac2ec3c7f4f2e02717984fdccce274819">postsize</a>) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="comment">/* move backup data into focus and continue on that */</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ad2a1a48e07419d92ef27abec899793c9">postdata</a>;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac2ec3c7f4f2e02717984fdccce274819">postsize</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#ac5458d99c295f52472bde6d1da88f110">fread_func</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ab716577164f66a69879464de14483261">fread_func</a>;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#ade97ad375f82a96396846a9b2aa06716">in</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac6da073e602d3fc16265a4aaa2c3e564">fread_in</a>;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a>++; <span class="comment">/* move one step up */</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac2ec3c7f4f2e02717984fdccce274819">postsize</a> = 0;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = 0;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">return</span> fullsize;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>, fullsize);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> += fullsize;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> -= fullsize;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">return</span> fullsize;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;}</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/* ------------------------------------------------------------------------- */</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/* add_buffer functions */</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment"> * Curl_add_buffer_init() sets up and returns a fine buffer struct</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="http_8h.html#a8439073425968002da46c16791460fba"> 1093</a></span>&#160;<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *<a class="code" href="http_8c.html#a8439073425968002da46c16791460fba">Curl_add_buffer_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;{</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a>));</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment"> * Curl_add_buffer_free() frees all associated resources.</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="http_8h.html#adaf0c79a3bcc19f4c388cb5e0a33f030"> 1101</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a>(<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> **inp)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;{</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a> = *inp;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>) <span class="comment">/* deal with NULL input */</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  *inp = NULL;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;}</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment"> * Curl_add_buffer_send() sends a header buffer and frees all associated</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment"> * memory.  Body data may be appended to the header data if desired.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment"> * Returns CURLcode</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="http_8h.html#aac63462775197001083e4cc8752f2f73"> 1116</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> **inp,</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                               <span class="comment">/* add the number of sent bytes to this</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">                                  counter */</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                              <span class="keywordtype">long</span> *bytes_written,</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                               <span class="comment">/* how much of the buffer contains body data */</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                              <span class="keywordtype">size_t</span> included_body_bytes,</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                              <span class="keywordtype">int</span> socketindex)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;{</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> amount;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordtype">size_t</span> sendsize;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> sockfd;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordtype">size_t</span> headersize;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a> = *inp;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(socketindex &lt;= <a class="code" href="urldata_8h.html#ac1138557ffc9ee3a520805205b76daee">SECONDARYSOCKET</a>);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  sockfd = conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[socketindex];</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">/* The looping below is required since we use non-blocking sockets, but due</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">     to the circumstances we will just loop and try again and again etc */</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> = <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  headersize = <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> - included_body_bytes; <span class="comment">/* the initial part that isn&#39;t body</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">                                              is header */</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> &gt; included_body_bytes);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="non-ascii_8h.html#ab7de472e1367a01da556c8f5acad93bb">Curl_convert_to_network</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, headersize);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">/* Curl_convert_to_network calls failf if unsuccessful */</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">/* conversion failed, free memory and return to the caller */</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a>(inp);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a> ||</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;     conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#a1bc66a2c41e16eb2138fc7bc4f96021a">proxytype</a> == <a class="code" href="curl_8h.html#a8ebcd4e614f222aca6352ad5052634f8ae118261fbb43ab332f00f65574d08ec9">CURLPROXY_HTTPS</a>)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;     &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> != 20) {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">/* We never send more than CURL_MAX_WRITE_SIZE bytes in one single chunk</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">       when we speak HTTPS, as if only a fraction of it is sent now, this data</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">       needs to fit into the normal read-callback buffer later on and that</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">       buffer is using this size.</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    sendsize = <a class="code" href="curl__setup_8h.html#a5dd6efb91a5151f2bb4e4fff1b386582">CURLMIN</a>(<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, <a class="code" href="curl_8h.html#a0417440dcb84270d40959fa70aec6f86">CURL_MAX_WRITE_SIZE</a>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">/* OpenSSL is very picky and we must send the SAME buffer pointer to the</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">       library when we attempt to re-send this buffer. Sending the same data</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">       is not enough, we must use the exact same address. For this reason, we</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">       must copy the data to the uploadbuffer first, since that is the buffer</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">       we will be using if this send is retried later.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="transfer_8c.html#a15440032c495bf0f3f6c535ec5e811e3">Curl_get_upload_buffer</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="comment">/* malloc failed, free memory and return to the caller */</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <a class="code" href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a>(&amp;<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="structdata.html">data</a>-&gt;state.ulbuf, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, sendsize);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="structdata.html">data</a>-&gt;state.ulbuf;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    sendsize = <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#a6d7b9f1e0b64c65b824a115d0b00b5a2">Curl_write</a>(conn, sockfd, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, sendsize, &amp;amount);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">     * Note that we may not send the entire chunk at once, and we have a set</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">     * number of data bytes at the end of the big buffer (out of which we may</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">     * only send away a part).</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">/* how much of the header that was sent */</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">size_t</span> headlen = (size_t)amount&gt;headersize ? headersize : (<span class="keywordtype">size_t</span>)amount;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordtype">size_t</span> bodylen = amount - headlen;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.verbose) {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="comment">/* this data _may_ contain binary stuff */</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <a class="code" href="sendf_8c.html#a8b0f0a06869b888abb80a069182d0d5a">Curl_debug</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a39c388deb977296403ec7a28b6c5acbe">CURLINFO_HEADER_OUT</a>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, headlen);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keywordflow">if</span>(bodylen) {</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="comment">/* there was body data sent beyond the initial header part, pass that</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">           on to the debug callback too */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="sendf_8c.html#a8b0f0a06869b888abb80a069182d0d5a">Curl_debug</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a650f0c484d2be1b78af50ff3d5bf4ddc">CURLINFO_DATA_OUT</a>,</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                   <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> + headlen, bodylen);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      }</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    }</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">/* &#39;amount&#39; can never be a very large value here so typecasting it so a</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">       signed 31 bit value should not cause problems even if ssize_t is</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">       64bit */</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    *bytes_written += (long)amount;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>) {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">/* if we sent a piece of the body here, up the byte counter for it</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">         accordingly */</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a> += bodylen;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">if</span>((<span class="keywordtype">size_t</span>)amount != <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>) {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">/* The whole request could not be sent in one system call. We must</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">           queue it up and send it later when we get the chance. We must not</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">           loop here and wait until it might work again. */</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> -= amount;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer + amount;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="comment">/* backup the currently set pointers */</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ab716577164f66a69879464de14483261">fread_func</a> = <a class="code" href="structdata.html">data</a>-&gt;state.fread_func;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac6da073e602d3fc16265a4aaa2c3e564">fread_in</a> = <a class="code" href="structdata.html">data</a>-&gt;state.in;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ad2a1a48e07419d92ef27abec899793c9">postdata</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">backup</a>.<a class="code" href="struct_h_t_t_p_1_1back.html#ac2ec3c7f4f2e02717984fdccce274819">postsize</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="comment">/* set the new pointers for the request-sending */</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.fread_func = (<a class="code" href="curl_8h.html#a7516630ec17f247697dd3272be7ada74">curl_read_callback</a>)readmoredata;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.in = (<span class="keywordtype">void</span> *)conn;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> = <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = (<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>)<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a4d15176e17f7991a11ced10b22c9b091">send_buffer</a> = <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a> = <a class="code" href="struct_h_t_t_p.html#a0249b638827cfaf90270d9c651a1035fa9d8155c9496f897f08cfcfbdd42a3cd0">HTTPSEND_REQUEST</a>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      }</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a> = <a class="code" href="struct_h_t_t_p.html#a0249b638827cfaf90270d9c651a1035fa2d7e73a6f2680c507a7cc05dc974e1e4">HTTPSEND_BODY</a>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="comment">/* the full buffer was sent, clean up and return */</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">if</span>((<span class="keywordtype">size_t</span>)amount != <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">/* We have no continue-send mechanism now, fail. This can only happen</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">           when this function is used from the CONNECT sending function. We</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">           currently (stupidly) assume that the whole request is always sent</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">           away in the first single chunk.</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">           This needs FIXing.</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <a class="code" href="pipeline_8c.html#a2f59dc911931337300b0b3db60936f12">Curl_pipeline_leave_write</a>(conn);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a>(&amp;<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;}</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment"> * add_bufferf() add the formatted input to the buffer.</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="http_8h.html#a39954d736a5d61e59c4436f7b45320d9"> 1275</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> **inp, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordtype">char</span> *s;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  va_list ap;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a> = *inp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  va_start(ap, fmt);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  s = <a class="code" href="curl__printf_8h.html#a2add5ba8e130d30982d125214f83b921">vaprintf</a>(fmt, ap); <span class="comment">/* this allocs a new string to append */</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  va_end(ap);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">if</span>(s) {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(inp, s, strlen(s));</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(s);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">/* If we failed, we cleanup the whole buffer and return error */</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  *inp = NULL;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment"> * Curl_add_buffer() appends a memory chunk to the existing buffer</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01299"></a><span class="lineno"><a class="line" href="http_8h.html#a6aa25cbd0a914967d206e09f5f03eb2a"> 1299</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(<a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> **inp, <span class="keyword">const</span> <span class="keywordtype">void</span> *inptr,</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                         <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordtype">char</span> *new_rb;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a> = *inp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">if</span>(~size &lt; in-&gt;size_used) {</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">/* If resulting used size of send buffer would wrap size_t, cleanup</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">       the whole buffer and return error. Otherwise the required buffer</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">       size will fit into a single allocatable memory chunk */</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    *inp = NULL;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer ||</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;     ((<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used + <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>) &gt; (<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_max - 1))) {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">/* If current buffer size isn&#39;t enough to hold the result, use a</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">       buffer size that doubles the required size. If this new size</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">       would wrap size_t, then just use the largest possible one */</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordtype">size_t</span> new_size;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> &gt; (<span class="keywordtype">size_t</span>)-1 / 2) || (<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used &gt; (<span class="keywordtype">size_t</span>)-1 / 2) ||</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;       (~(<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> * 2) &lt; (<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used * 2)))</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      new_size = (size_t)-1;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      new_size = (<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used + <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>) * 2;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="comment">/* we have a buffer, enlarge the existing one */</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      new_rb = <a class="code" href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer, new_size);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="comment">/* create a new buffer */</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      new_rb = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(new_size);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span>(!new_rb) {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="comment">/* If we failed, we cleanup the whole buffer and return error */</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      *inp = NULL;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer = new_rb;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_max = new_size;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;buffer[<a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used], inptr, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <a class="code" href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a>-&gt;size_used += <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">/* end of the add_buffer functions */</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">/* ------------------------------------------------------------------------- */</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"> * Curl_compareheader()</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment"> * Returns TRUE if &#39;headerline&#39; contains the &#39;header&#39; with given &#39;content&#39;.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"> * Pass headers WITH the colon.</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l01364"></a><span class="lineno"><a class="line" href="http_8h.html#a7a3d531209e82b72841ec84587a45dba"> 1364</a></span>&#160;<a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *headerline, <span class="comment">/* line to check */</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">char</span> *header,  <span class="comment">/* header keyword _with_ colon */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>) <span class="comment">/* content string to find */</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">/* RFC2616, section 4.2 says: &quot;Each header field consists of a name followed</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">   * by a colon (&quot;:&quot;) and the field value. Field names are case-insensitive.</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">   * The field value MAY be preceded by any amount of LWS, though a single SP</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">   * is preferred.&quot; */</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordtype">size_t</span> hlen = strlen(header);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordtype">size_t</span> clen;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *start;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *end;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(headerline, header, hlen))</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* doesn&#39;t start with header */</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">/* pass the header */</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  start = &amp;headerline[hlen];</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="comment">/* pass all white spaces */</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <span class="keywordflow">while</span>(*start &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*start))</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    start++;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="comment">/* find the end of the header line */</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  end = strchr(start, <span class="charliteral">&#39;\r&#39;</span>); <span class="comment">/* lines end with CRLF */</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordflow">if</span>(!end) {</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">/* in case there&#39;s a non-standard compliant line here */</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    end = strchr(start, <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">if</span>(!end)</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="comment">/* hm, there&#39;s no line ending here, use the zero byte! */</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      end = strchr(start, <span class="charliteral">&#39;\0&#39;</span>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = end-start; <span class="comment">/* length of the content part of the input line */</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  clen = strlen(<a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>); <span class="comment">/* length of the word to find */</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="comment">/* find the content string in the rest of the line */</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">for</span>(; <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt;= clen; <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>--, start++) {</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(start, <a class="code" href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a>, clen))</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* match! */</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  }</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* no match */</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"> * Curl_http_connect() performs HTTP stuff to do at connect-time, called from</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment"> * the generic Curl_connect().</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01416"></a><span class="lineno"><a class="line" href="http_8h.html#aa380bd70f94bb31fc19b879223427e44"> 1416</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#aa380bd70f94bb31fc19b879223427e44">Curl_http_connect</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;{</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">/* We default to persistent connections. We set this already in this connect</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">     function to make the re-use checks properly be able to check this bit. */</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a>(conn, <span class="stringliteral">&quot;HTTP default&quot;</span>);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="comment">/* the CONNECT procedure might not have been completed */</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http__proxy_8c.html#ac79abdd8c0d0b2818f4478e91afcaa35">Curl_proxy_connect</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a36bae112580758d107fbe6bb465f6d0c">proxy_connect_closed</a>)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">/* this is not an error, just part of the connection negotiation */</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="url_8h.html#a5eef24a1090105370832043771d44f1e">CONNECT_FIRSTSOCKET_PROXY_SSL</a>())</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>; <span class="comment">/* wait for HTTPS proxy SSL initialization to complete */</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="http__proxy_8c.html#a64cc706da81f4e2a504fc457b79542e2">Curl_connect_ongoing</a>(conn))</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">/* nothing else to do except wait right now - we&#39;re not done here. */</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#abef91298dc05202c0eae538403f73d15">haproxyprotocol</a>) {</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">/* add HAProxy PROXY protocol header */</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = add_haproxy_protocol_header(conn);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  }</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">given</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a>) {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">/* perform SSL initialization */</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">https_connecting</a>(conn, done);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">/* this returns the socket to wait for in the DO and DOING state for the multi</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">   interface and then we&#39;re always _sending_ a request and thus we wait for</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">   the single socket to become writable only */</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> http_getsock_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                           <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                           <span class="keywordtype">int</span> numsocks)</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;{</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">/* write mode */</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  (void)numsocks; <span class="comment">/* unused, we trust it to be at least 1 */</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  socks[0] = conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#a9aabda59f0ff87c1db3a2d306a410713">GETSOCK_WRITESOCK</a>(0);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;}</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> add_haproxy_protocol_header(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;{</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="keywordtype">char</span> proxy_header[128];</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *req_buffer;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordtype">char</span> tcp_version[5];</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">/* Emit the correct prefix for IPv6 */</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aa4606cd7d5928857e28473a129c4ccf0">ipv6</a>) {</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    strcpy(tcp_version, <span class="stringliteral">&quot;TCP6&quot;</span>);</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    strcpy(tcp_version, <span class="stringliteral">&quot;TCP4&quot;</span>);</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  }</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(proxy_header,</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <span class="keyword">sizeof</span>(proxy_header),</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="stringliteral">&quot;PROXY %s %s %s %li %li\r\n&quot;</span>,</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            tcp_version,</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">info</a>.<a class="code" href="struct_pure_info.html#a3a794f84858062e5523ec92611f575a4">conn_local_ip</a>,</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">info</a>.<a class="code" href="struct_pure_info.html#af56f4ff8e248728ed7cc4ea5a8265b09">conn_primary_ip</a>,</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">info</a>.<a class="code" href="struct_pure_info.html#a31ac209baf108af8a0970ecf3c70afb9">conn_local_port</a>,</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">info</a>.<a class="code" href="struct_pure_info.html#a6a2945a5778dab8f85427526d4d59844">conn_primary_port</a>);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  req_buffer = <a class="code" href="http_8c.html#a8439073425968002da46c16791460fba">Curl_add_buffer_init</a>();</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">if</span>(!req_buffer)</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, proxy_header);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer,</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                conn,</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                &amp;conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">info</a>.<a class="code" href="struct_pure_info.html#af78fc7bbff71b833838cad38b6728a2b">request_size</a>,</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                0,</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">https_connecting</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;{</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>((conn) &amp;&amp; (conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>));</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">/* perform SSL initialization for this socket */</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, done);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a>(conn, <span class="stringliteral">&quot;Failed HTTPS connection&quot;</span>);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;}</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> https_getsock(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                         <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                         <span class="keywordtype">int</span> numsocks)</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;{</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vtls_8h.html#a665432b41da505b40f72af4161b011aa">Curl_ssl_getsock</a>(conn, socks, numsocks);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a>;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;}</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SSL */</span><span class="preprocessor"></span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment"> * Curl_http_done() gets called after a single HTTP request has been</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment"> * performed.</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"><a class="line" href="http_8h.html#ad7c199766b7e0fd6bf1948c50b2211e5"> 1542</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#ae3dc4a63f791cddc2b843736433a6c62">Curl_http_done</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                        <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> status, <span class="keywordtype">bool</span> premature)</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;{</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">/* Clear multipass flag. If authentication isn&#39;t done yet, then it will get</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">   * a chance to be set back to true when we output the next auth header */</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;state.authhost.multipass = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;state.authproxy.multipass = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="content__encoding_8c.html#ab341f4f03f5aa236c5e5b2b25e5ff806">Curl_unencode_cleanup</a>(conn);</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="preprocessor">#ifdef USE_SPNEGO</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.proxyneg.state == GSS_AUTHSENT ||</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;state.negotiate.state == GSS_AUTHSENT) {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="comment">/* add forbid re-use if http-code != 401/407 as a WA only needed for</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">     * 401/407 that signal auth failure (empty) otherwise state will be RECV</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">     * with current code.</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">     * Do not close CONNECT_ONLY connections. */</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode != 401) &amp;&amp; (<a class="code" href="structdata.html">data</a>-&gt;req.httpcode != 407) &amp;&amp;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;       !<a class="code" href="structdata.html">data</a>-&gt;set.connect_only)</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;Negotiate transfer completed&quot;</span>);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    Curl_cleanup_negotiate(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  }</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">/* set the proper values (possibly modified on POST) */</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a01e38af502b3798152533aa52884b423">seek_func</a> = <a class="code" href="structdata.html">data</a>-&gt;set.seek_func; <span class="comment">/* restore */</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ad7ad0216049eeb5099888585025e2202">seek_client</a> = <a class="code" href="structdata.html">data</a>-&gt;set.seek_client; <span class="comment">/* restore */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>)</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a4d15176e17f7991a11ced10b22c9b091">send_buffer</a>) {</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <a class="code" href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a>(&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a4d15176e17f7991a11ced10b22c9b091">send_buffer</a>);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  }</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <a class="code" href="http2_8h.html#aa085257d64dd169d466fb80802114c9a">Curl_http2_done</a>(conn, premature);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <a class="code" href="mime_8c.html#a3295a1b4557da56cd25b0a5217183118">Curl_mime_cleanpart</a>(&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">form</a>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq) {</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>:</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.bytecount = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a> + <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  }</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">if</span>(status)</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordflow">if</span>(!premature &amp;&amp; <span class="comment">/* this check is pointless when DONE is called before the</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">                      entire operation is complete */</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;     !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a2abc75753ca4206fe82edfd27c1479c6">retry</a> &amp;&amp;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;     !<a class="code" href="structdata.html">data</a>-&gt;set.connect_only &amp;&amp;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;     (<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a> +</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.headerbytecount -</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.deductheadercount) &lt;= 0) {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">/* If this connection isn&#39;t simply closed to be retried, AND nothing was</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">       read from the HTTP server (that counts), this can&#39;t be right so we</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">       return an error here */</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Empty reply from server&quot;</span>);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9c15eee85076ef8d51e4edb972b43492">CURLE_GOT_NOTHING</a>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;}</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment"> * Determine if we should use HTTP 1.1 (OR BETTER) for this request. Reasons</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment"> * to avoid it include:</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment"> * - if the user specifically requested HTTP 1.0</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment"> * - if the server we are connected to only supports 1.0</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment"> * - if any server previously contacted to handle this request only supports</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment"> * 1.0.</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> use_http_1_1plus(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;{</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;state.httpversion == 10) || (conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 10))</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.httpversion == <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035dabf20980d1f881523f95f620ddcce5667">CURL_HTTP_VERSION_1_0</a>) &amp;&amp;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;     (conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> &lt;= 10))</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">return</span> ((<a class="code" href="structdata.html">data</a>-&gt;set.httpversion == <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da4006f988c2417f7059cf2b5f0d79630f">CURL_HTTP_VERSION_NONE</a>) ||</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;          (<a class="code" href="structdata.html">data</a>-&gt;set.httpversion &gt;= <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da2bdca7ce6479378784212fee3a068c74">CURL_HTTP_VERSION_1_1</a>));</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;}</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *get_http_string(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;{</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="preprocessor">#ifdef USE_NGHTTP2</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#aa5f47898ac300afb3ebdb21478f4074d">httpc</a>.h2)</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;2&quot;</span>;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">if</span>(use_http_1_1plus(<a class="code" href="structdata.html">data</a>, conn))</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;1.1&quot;</span>;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;1.0&quot;</span>;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;}</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">/* check and possibly add an Expect: header */</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449">expect100</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                          <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                          <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *req_buffer)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;{</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;state.expect100header = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* default to false unless it is set</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">                                          to TRUE below */</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">if</span>(use_http_1_1plus(<a class="code" href="structdata.html">data</a>, conn) &amp;&amp;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;     (conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> != 20)) {</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">/* if not doing HTTP 1.0 or version 2, or disabled explicitly, we add an</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">       Expect: 100-continue to the headers which actually speeds up post</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">       operations (as there is one packet coming back from the web server) */</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Expect&quot;</span>);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.expect100header =</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;Expect:&quot;</span>, <span class="stringliteral">&quot;100-continue&quot;</span>);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                <span class="stringliteral">&quot;Expect: 100-continue\r\n&quot;</span>);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.expect100header = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    }</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  }</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div><div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023a"> 1678</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023a">proxy_use</a> {</div><div class="line"><a name="l01679"></a><span class="lineno"><a class="line" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064"> 1679</a></span>&#160;  <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064">HEADER_SERVER</a>,  <span class="comment">/* direct to server */</span></div><div class="line"><a name="l01680"></a><span class="lineno"><a class="line" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac"> 1680</a></span>&#160;  <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac">HEADER_PROXY</a>,   <span class="comment">/* regular request to proxy */</span></div><div class="line"><a name="l01681"></a><span class="lineno"><a class="line" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf"> 1681</a></span>&#160;  <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf">HEADER_CONNECT</a>  <span class="comment">/* sending CONNECT to a proxy */</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;};</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div><div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="http_8h.html#a14d14997ce72dcbad55dd95c7c3bf08e"> 1684</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a14d14997ce72dcbad55dd95c7c3bf08e">Curl_add_custom_headers</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                 <span class="keywordtype">bool</span> is_connect,</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                 <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *req_buffer)</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;{</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *h[2];</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordtype">int</span> numlists = 1; <span class="comment">/* by default */</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keyword">enum</span> <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023a">proxy_use</a> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">if</span>(is_connect)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> = <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf">HEADER_CONNECT</a>;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> = conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">tunnel_proxy</a>?</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac">HEADER_PROXY</a>:<a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064">HEADER_SERVER</a>;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>) {</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064">HEADER_SERVER</a>:</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    h[0] = <a class="code" href="structdata.html">data</a>-&gt;set.headers;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac">HEADER_PROXY</a>:</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    h[0] = <a class="code" href="structdata.html">data</a>-&gt;set.headers;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.sep_headers) {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      h[1] = <a class="code" href="structdata.html">data</a>-&gt;set.proxyheaders;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      numlists++;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf">HEADER_CONNECT</a>:</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.sep_headers)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      h[0] = <a class="code" href="structdata.html">data</a>-&gt;set.proxyheaders;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      h[0] = <a class="code" href="structdata.html">data</a>-&gt;set.headers;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  }</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">/* loop through one or two lists */</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; numlists; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a> = h[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>) {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordtype">char</span> *semicolonp = NULL;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = strchr(<a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keywordtype">char</span> *optr;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="comment">/* no colon, semicolon? */</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = strchr(<a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data, <span class="charliteral">&#39;;&#39;</span>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          optr = <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++; <span class="comment">/* pass the semicolon */</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          <span class="keywordflow">while</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>))</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          <span class="keywordflow">if</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <span class="comment">/* this may be used for something else in the future */</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            optr = NULL;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          }</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <span class="keywordflow">if</span>(*(--<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) == <span class="charliteral">&#39;;&#39;</span>) {</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;              <span class="comment">/* send no-value custom header if terminated by semicolon */</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;              *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <span class="charliteral">&#39;:&#39;</span>;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;              semicolonp = <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            }</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;          <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = optr;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        }</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      }</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="comment">/* we require a colon for this to be a true header */</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++; <span class="comment">/* pass the colon */</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">while</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>))</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;          <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">if</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> || semicolonp) {</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;          <span class="comment">/* only send this if the contents was non-blank or done special */</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;          <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a> &amp;&amp;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;             <span class="comment">/* a Host: header was sent already, don&#39;t pass on any custom Host:</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">                header as that will produce *two* in the same request! */</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;             <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Host:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            ;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a> &amp;&amp;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                  <span class="comment">/* this header (extended by formdata.c) is sent later */</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                  <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Type:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            ;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a> &amp;&amp;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                  <span class="comment">/* this header is sent later */</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                  <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Type:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            ;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> &amp;&amp;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                  <span class="comment">/* while doing auth neg, don&#39;t allow the custom length since</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">                     we will force length zero then */</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                  <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Length:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            ;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a> &amp;&amp;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                  <span class="comment">/* when asking for Transfer-Encoding, don&#39;t pass on a custom</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">                     Connection: */</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                  <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Connection:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            ;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 20) &amp;&amp;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                  <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Transfer-Encoding:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data))</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="comment">/* HTTP/2 doesn&#39;t support chunked requests */</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            ;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Authorization:&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data) &amp;&amp;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                  <span class="comment">/* be careful of sending this potentially sensitive header to</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">                     other hosts */</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                  (<a class="code" href="structdata.html">data</a>-&gt;state.this_is_a_follow &amp;&amp;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                   <a class="code" href="structdata.html">data</a>-&gt;state.first_host &amp;&amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                   !<a class="code" href="structdata.html">data</a>-&gt;set.allow_auth_to_other_hosts &amp;&amp;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                   !<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;state.first_host, conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>)))</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            ;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;data);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;          }</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          <span class="keywordflow">if</span>(semicolonp)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            *semicolonp = <span class="charliteral">&#39;;&#39;</span>; <span class="comment">/* put back the semicolon */</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        }</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a> = <a class="code" href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a>-&gt;next;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  }</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;}</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"><a class="line" href="http_8h.html#ae744c93532091a2164007f3451abb0e3"> 1815</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#ad61ec452bd9e1973fcbf1a700feecd88">Curl_add_timecondition</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *req_buffer)</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;{</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span>tm *tm;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keyword">struct </span>tm keeptime;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="keywordtype">char</span> datestr[80];</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *condp;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.timecondition == <a class="code" href="curl_8h.html#a845d262749bd413d724b58e26f713f25afedf4be1a889a36b688846763ca838f5">CURL_TIMECOND_NONE</a>)</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">/* no condition was asked for */</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="parsedate_8c.html#a192aac16662dc4aaf80ef3722b581958">Curl_gmtime</a>(<a class="code" href="structdata.html">data</a>-&gt;set.timevalue, &amp;keeptime);</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Invalid TIMEVALUE&quot;</span>);</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  }</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  tm = &amp;keeptime;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.timecondition) {</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a0e5145164e8e2a9d6eb43eef1c71f1af">CURLE_BAD_FUNCTION_ARGUMENT</a>;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a845d262749bd413d724b58e26f713f25ad13e365aab4f32a0ee193510118f533d">CURL_TIMECOND_IFMODSINCE</a>:</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    condp = <span class="stringliteral">&quot;If-Modified-Since&quot;</span>;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a845d262749bd413d724b58e26f713f25ab52a0e6ddf579f8f81b40d8a684155a6">CURL_TIMECOND_IFUNMODSINCE</a>:</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    condp = <span class="stringliteral">&quot;If-Unmodified-Since&quot;</span>;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a845d262749bd413d724b58e26f713f25a78e03271e03b8cd828de47160a602353">CURL_TIMECOND_LASTMOD</a>:</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    condp = <span class="stringliteral">&quot;Last-Modified&quot;</span>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  }</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="comment">/* The If-Modified-Since header family should have their times set in</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">   * GMT as RFC2616 defines: &quot;All HTTP date/time stamps MUST be</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">   * represented in Greenwich Mean Time (GMT), without exception. For the</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">   * purposes of HTTP, GMT is exactly equal to UTC (Coordinated Universal</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">   * Time).&quot; (see page 20 of RFC2616).</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="comment">/* format: &quot;Tue, 15 Nov 1994 12:45:26 GMT&quot; */</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(datestr, <span class="keyword">sizeof</span>(datestr),</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="stringliteral">&quot;%s: %s, %02d %s %4d %02d:%02d:%02d GMT\r\n&quot;</span>,</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            condp,</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <a class="code" href="parsedate_8c.html#afbefdd1c70bc7fde8f2369a4cf46a62f">Curl_wkday</a>[tm-&gt;tm_wday?tm-&gt;tm_wday-1:6],</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            tm-&gt;tm_mday,</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <a class="code" href="parsedate_8c.html#a4a84c69a44848f5947487bf91f86b733">Curl_month</a>[tm-&gt;tm_mon],</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            tm-&gt;tm_year + 1900,</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            tm-&gt;tm_hour,</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            tm-&gt;tm_min,</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            tm-&gt;tm_sec);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, datestr, strlen(datestr));</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;}</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment"> * Curl_http() gets called from the generic multi_do() function when a HTTP</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment"> * request is to be performed. This creates and sends a properly constructed</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment"> * HTTP request.</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01879"></a><span class="lineno"><a class="line" href="http_8h.html#ac009a02368ec5154996b23065aa85a28"> 1879</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#ac009a02368ec5154996b23065aa85a28">Curl_http</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;{</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_h_t_t_p.html">HTTP</a> *<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = <a class="code" href="structdata.html">data</a>-&gt;state.up.path;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *query = <a class="code" href="structdata.html">data</a>-&gt;state.up.query;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="keywordtype">bool</span> paste_ftp_userpwd = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordtype">char</span> ftp_typecode[<span class="keyword">sizeof</span>(<span class="stringliteral">&quot;/;type=?&quot;</span>)] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *te = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* transfer-encoding */</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *request;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8">Curl_HttpReq</a> httpreq = <a class="code" href="structdata.html">data</a>-&gt;set.httpreq;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordtype">char</span> *addcookies = NULL;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> included_body = 0;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *httpstring;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <a class="code" href="struct_curl__send__buffer.html">Curl_send_buffer</a> *req_buffer;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> <a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = 0; <span class="comment">/* curl_off_t to handle large file sizes */</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="comment">/* Always consider the DO phase done after this function call, even if there</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">     may be parts of the request that is not yet sent, since we can deal with</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">     the rest of the request in the PERFORM phase. */</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> &lt; 20) { <span class="comment">/* unless the connection is re-used and already</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">                                  http2 */</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">switch</span>(conn-&gt;<a class="code" href="structconnectdata.html#a0c1824e51ef689efcfddaa09a72c788b">negnpn</a>) {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a49d83160803f433b12209ed52aafc05f">CURL_HTTP_VERSION_2</a>:</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 20; <span class="comment">/* we know we&#39;re on HTTP/2 now */</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http2_8h.html#a2c3310e8f1eb576e38f798fb9dd2b951">Curl_http2_switched</a>(conn, NULL, 0);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da2bdca7ce6479378784212fee3a068c74">CURL_HTTP_VERSION_1_1</a>:</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="comment">/* continue with HTTP/1.1 when explicitly requested */</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="comment">/* Check if user wants to use HTTP/2 with clear TCP*/</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="preprocessor">#ifdef USE_NGHTTP2</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#a297b95c9d8a6b73ab0d15f752e23ba8b">httpversion</a> ==</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;         <a class="code" href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da6ecc2e3f6ae7980d0ed29cf391a8b3f2">CURL_HTTP_VERSION_2_PRIOR_KNOWLEDGE</a>) {</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <a class="code" href="curl__setup__once_8h.html#a805079d1643f348afa725659b45b6f87">DEBUGF</a>(<a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP/2 over clean TCP\n&quot;</span>));</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 20;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http2_8h.html#a2c3310e8f1eb576e38f798fb9dd2b951">Curl_http2_switched</a>(conn, NULL, 0);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    }</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">/* prepare for a http2 request */</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http2_8h.html#aad8497d84887a3deea025eb5c06cc5f9">Curl_http2_setup</a>(conn);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  }</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a> = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;state.this_is_a_follow) {</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="comment">/* Free to avoid leaking memory on multiple requests*/</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="structdata.html">data</a>-&gt;state.first_host);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.first_host = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;state.first_host)</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.first_remote_port = conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a> = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a> = 0;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a>&amp;(<a class="code" href="urldata_8h.html#a9d346cfcc0046f6c6ed206bde086ab2d">PROTO_FAMILY_HTTP</a>|<a class="code" href="curl_8h.html#a9ba581e59a874626d594c0f7c241d6d2">CURLPROTO_FTP</a>)) &amp;&amp;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;set.upload) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    httpreq = <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  }</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="comment">/* Now set the &#39;request&#39; pointer to the proper request string */</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fafe604c42ae587594510842a54ace673e">STRING_CUSTOMREQUEST</a>])</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    request = <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fafe604c42ae587594510842a54ace673e">STRING_CUSTOMREQUEST</a>];</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.opt_no_body)</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      request = <span class="stringliteral">&quot;HEAD&quot;</span>;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>((httpreq &gt; <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8af3836f82d9715e1fe9970e87daaccfb3">HTTPREQ_NONE</a>) &amp;&amp; (httpreq &lt; <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a2126c18fd1e70090d3c2a4cb3bc2561c">HTTPREQ_LAST</a>));</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="keywordflow">switch</span>(httpreq) {</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a>:</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        request = <span class="stringliteral">&quot;POST&quot;</span>;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>:</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        request = <span class="stringliteral">&quot;PUT&quot;</span>;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ab1850fbcf712c1fa244036e72aee74a4">HTTPREQ_OPTIONS</a>:</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        request = <span class="stringliteral">&quot;OPTIONS&quot;</span>;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordflow">default</span>: <span class="comment">/* this should never happen */</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>:</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        request = <span class="stringliteral">&quot;GET&quot;</span>;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>:</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        request = <span class="stringliteral">&quot;HEAD&quot;</span>;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    }</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  }</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="comment">/* The User-Agent string might have been allocated in url.c already, because</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">     it might have been used in the proxy connect, but if we have got a header</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">     with the user-agent string specified, we erase the previously made string</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">     here. */</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;User-Agent&quot;</span>)) {</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad0d3b107dbf2e7d40f2680e40498f1f3">uagent</a>);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad0d3b107dbf2e7d40f2680e40498f1f3">uagent</a> = NULL;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  }</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="comment">/* setup the authentication headers */</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a9aa397285caa1ed8c0991d9ebd94962a">Curl_http_output_auth</a>(conn, request, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;state.authhost.multipass || <a class="code" href="structdata.html">data</a>-&gt;state.authproxy.multipass) &amp;&amp;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;     (httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>) &amp;&amp;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;     (httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>)) {</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="comment">/* Auth is required and we are not authenticated yet. Make a PUT or POST</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">       with content-length zero as a &quot;probe&quot;. */</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a>);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;change.referer &amp;&amp; !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Referer&quot;</span>)) {</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Referer: %s\r\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;change.referer);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a>)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  }</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a> = NULL;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fada408f5a3bc95ce930076bb7f4970f3f">STRING_COOKIE</a>] &amp;&amp; !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Cookie&quot;</span>))</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    addcookies = <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fada408f5a3bc95ce930076bb7f4970f3f">STRING_COOKIE</a>];</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Accept-Encoding&quot;</span>) &amp;&amp;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a>]) {</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a>);</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a> =</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Accept-Encoding: %s\r\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a>]);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a>)</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  }</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a>);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a> = NULL;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  }</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#ifdef HAVE_LIBZ</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">/* we only consider transfer-encoding magic if libz support is built-in */</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;TE&quot;</span>) &amp;&amp;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;set.http_transfer_encoding) {</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="comment">/* When we are to insert a TE: header in the request, we must also insert</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">       TE in a Connection: header, so we need to merge the custom provided</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">       Connection: header and prevent the original to get sent. Note that if</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">       the user has inserted his/hers own TE: header we don&#39;t do this magic</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">       but then assume that the user will handle it all! */</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="keywordtype">char</span> *cptr = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="preprocessor">#define TE_HEADER &quot;TE: gzip\r\n&quot;</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a>);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span>(cptr) {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      cptr = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(cptr);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keywordflow">if</span>(!cptr)</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="comment">/* Create the (updated) Connection: header */</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Connection: %s%sTE\r\n&quot;</span> TE_HEADER,</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                                cptr ? cptr : <span class="stringliteral">&quot;&quot;</span>, (cptr &amp;&amp; *cptr) ? <span class="stringliteral">&quot;, &quot;</span>:<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(cptr);</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a>)</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  }</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keywordflow">switch</span>(httpreq) {</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a> = &amp;<a class="code" href="structdata.html">data</a>-&gt;set.mimepost;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="comment">/* Convert the form structure into a mime structure. */</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="mime_8c.html#a3295a1b4557da56cd25b0a5217183118">Curl_mime_cleanpart</a>(&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">form</a>);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="formdata_8c.html#ad3f5007831015b4fdf8b2078b525eeea">Curl_getformdata</a>(<a class="code" href="structdata.html">data</a>, &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">form</a>, <a class="code" href="structdata.html">data</a>-&gt;set.httppost,</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                              <a class="code" href="structdata.html">data</a>-&gt;state.fread_func);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a> = &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">form</a>;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a> = NULL;</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  }</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>) {</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cthdr = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Type&quot;</span>);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">/* Read and seek body only. */</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>-&gt;<a class="code" href="structcurl__mimepart__s.html#a79ba572d92b485a68687b7f9bdf8753f">flags</a> |= <a class="code" href="mime_8h.html#ae6faa301cc4b37f4112e9acc984db066">MIME_BODY_ONLY</a>;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="comment">/* Prepare the mime structure headers &amp; set content type. */</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">if</span>(cthdr)</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="keywordflow">for</span>(cthdr += 13; *cthdr == <span class="charliteral">&#39; &#39;</span>; cthdr++)</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        ;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>-&gt;<a class="code" href="structcurl__mimepart__s.html#a22079fe812eba3e01a075941c228643f">kind</a> == <a class="code" href="mime_8h.html#a3f7ea952d37b502d03fb5d8f8b9d7101a6167535771a4ad417b9d4cb82be44fe2">MIMEKIND_MULTIPART</a>)</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      cthdr = <span class="stringliteral">&quot;multipart/form-data&quot;</span>;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <a class="code" href="curl_8h.html#adbc451757ed5aeebdff70d9517e9ff49">curl_mime_headers</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>, <a class="code" href="structdata.html">data</a>-&gt;set.headers, 0);</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="mime_8c.html#aa3774f4f669549973a0ff85d5372dc8f">Curl_mime_prepare_headers</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>, cthdr,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                                       NULL, <a class="code" href="mime_8h.html#afdc5138da8e131f5e919d4f8e67ae172ac556c9982f42232a0d711e2e1a7dbd0a">MIMESTRATEGY_FORM</a>);</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <a class="code" href="curl_8h.html#adbc451757ed5aeebdff70d9517e9ff49">curl_mime_headers</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>, NULL, 0);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="mime_8c.html#a16da9e4dbf38be0096a6c63bd408c39c">Curl_mime_rewind</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = <a class="code" href="mime_8c.html#a5d447429cc681c949f0a2b9c60bebdae">Curl_mime_size</a>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>);</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  }</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Transfer-Encoding&quot;</span>);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="comment">/* Some kind of TE is requested, check if &#39;chunked&#39; is chosen */</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky =</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;Transfer-Encoding:&quot;</span>, <span class="stringliteral">&quot;chunked&quot;</span>);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  }</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="urldata_8h.html#a9d346cfcc0046f6c6ed206bde086ab2d">PROTO_FAMILY_HTTP</a>) &amp;&amp;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;       (((httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a> || httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>) &amp;&amp;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;       <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> &lt; 0) ||</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;       (<a class="code" href="structdata.html">data</a>-&gt;set.upload &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;state.infilesize == -1))) {</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>)</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        <span class="comment">/* don&#39;t enable chunked during auth neg */</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        ;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(use_http_1_1plus(<a class="code" href="structdata.html">data</a>, conn)) {</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="comment">/* HTTP, upload, unknown file size and not HTTP 1.0 */</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      }</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Chunky upload is not supported by HTTP 1.0&quot;</span>);</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a3e48e0195eb27ce292195e9133c70a18">CURLE_UPLOAD_FAILED</a>;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      }</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <span class="comment">/* else, no chunky upload */</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky)</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      te = <span class="stringliteral">&quot;Transfer-Encoding: chunked\r\n&quot;</span>;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  }</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a>);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Host&quot;</span>);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; (!<a class="code" href="structdata.html">data</a>-&gt;state.this_is_a_follow ||</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;             <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;state.first_host, conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>))) {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">/* If we have a given custom Host: header, we extract the host name in</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">       order to possibly use it for cookie reasons later on. We only allow the</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">       custom Host: header if this is NOT a redirect, as setting Host: in the</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">       redirected request is being out on thin ice. Except if the host name</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">       is the same as the first one! */</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordtype">char</span> *cookiehost = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">if</span>(!cookiehost)</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">if</span>(!*cookiehost)</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="comment">/* ignore empty data */</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(cookiehost);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="comment">/* If the host begins with &#39;[&#39;, we start searching for the port after</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">         the bracket has been closed */</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordflow">if</span>(*cookiehost == <span class="charliteral">&#39;[&#39;</span>) {</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordtype">char</span> *closingbracket;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="comment">/* since the &#39;cookiehost&#39; is an allocated memory area that will be</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">           freed later we cannot simply increment the pointer */</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        memmove(cookiehost, cookiehost + 1, strlen(cookiehost) - 1);</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        closingbracket = strchr(cookiehost, <span class="charliteral">&#39;]&#39;</span>);</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        <span class="keywordflow">if</span>(closingbracket)</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;          *closingbracket = 0;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        <span class="keywordtype">int</span> startsearch = 0;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="config_8d.html#a347714e01aa155d12f1607546a9d4545">colon</a> = strchr(cookiehost + startsearch, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="config_8d.html#a347714e01aa155d12f1607546a9d4545">colon</a>)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;          *<a class="code" href="config_8d.html#a347714e01aa155d12f1607546a9d4545">colon</a> = 0; <span class="comment">/* The host must not include an embedded port number */</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      }</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a>);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a> = cookiehost;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    }</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordflow">if</span>(strcmp(<span class="stringliteral">&quot;Host:&quot;</span>, <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)) {</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Host:%s\r\n&quot;</span>, &amp;<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>[5]);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a>)</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    }</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="comment">/* when clearing the header */</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a> = NULL;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  }</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="comment">/* When building Host: headers, we must put the host name within</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">       [brackets] if the host name is a plain IPv6-address. RFC2732-style. */</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordflow">if</span>(((conn-&gt;<a class="code" href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">given</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a>&amp;<a class="code" href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a>) &amp;&amp;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        (conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a> == <a class="code" href="urldata_8h.html#a054f94b51abab46052e1d78f0d1e03fd">PORT_HTTPS</a>)) ||</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;       ((conn-&gt;<a class="code" href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">given</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a>&amp;<a class="code" href="curl_8h.html#a4c4a3046bce0da437f299072f489bc02">CURLPROTO_HTTP</a>) &amp;&amp;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        (conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a> == <a class="code" href="urldata_8h.html#a5158b1e31a4e7aa84de308e3d792a1de">PORT_HTTP</a>)) )</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="comment">/* if(HTTPS on port 443) OR (HTTP on port 80) then don&#39;t include</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">         the port number in the host string */</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Host: %s%s%s\r\n&quot;</span>,</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                                    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#afbb3ed3c6e41a5e79efc77b3bf00376d">ipv6_ip</a>?<span class="stringliteral">&quot;[&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                    <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>,</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#afbb3ed3c6e41a5e79efc77b3bf00376d">ipv6_ip</a>?<span class="stringliteral">&quot;]&quot;</span>:<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Host: %s%s%s:%d\r\n&quot;</span>,</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                                    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#afbb3ed3c6e41a5e79efc77b3bf00376d">ipv6_ip</a>?<span class="stringliteral">&quot;[&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                                    <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>,</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                    conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#afbb3ed3c6e41a5e79efc77b3bf00376d">ipv6_ip</a>?<span class="stringliteral">&quot;]&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                    conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>);</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a>)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="comment">/* without Host: we can&#39;t make a nice request */</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  }</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_PROXY</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">tunnel_proxy</a>) {</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="comment">/* Using a proxy but does not tunnel through it */</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="comment">/* The path sent to the proxy is in fact the entire URL. But if the remote</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">       host is a IDN-name, we must make sure that the request we produce only</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">       uses the encoded host name! */</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="comment">/* and no fragment part */</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <a class="code" href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a> uc;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <a class="code" href="struct_curl___u_r_l.html">CURLU</a> *h = <a class="code" href="urlapi_8h.html#a67b5d249b020eeb8b9a3d0d2e2bf3a7f">curl_url_dup</a>(<a class="code" href="structdata.html">data</a>-&gt;state.uh);</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordflow">if</span>(!h)</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">dispname</a> != conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>) {</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      uc = <a class="code" href="urlapi_8h.html#a1cb93c92958648f06fab038f397cfeae">curl_url_set</a>(h, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a>, conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>, 0);</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <span class="keywordflow">if</span>(uc) {</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      }</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    }</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    uc = <a class="code" href="urlapi_8h.html#a1cb93c92958648f06fab038f397cfeae">curl_url_set</a>(h, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a>, NULL, 0);</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span>(uc) {</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;http&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;state.up.scheme)) {</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <span class="comment">/* when getting HTTP, we don&#39;t want the userinfo the URL */</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      uc = <a class="code" href="urlapi_8h.html#a1cb93c92958648f06fab038f397cfeae">curl_url_set</a>(h, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a>, NULL, 0);</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      <span class="keywordflow">if</span>(uc) {</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      }</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      uc = <a class="code" href="urlapi_8h.html#a1cb93c92958648f06fab038f397cfeae">curl_url_set</a>(h, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a>, NULL, 0);</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      <span class="keywordflow">if</span>(uc) {</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      }</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    }</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="comment">/* now extract the new version of the URL */</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    uc = <a class="code" href="urlapi_8h.html#abfb2378e801e13033e70c3819d8afca1">curl_url_get</a>(h, <a class="code" href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a>, &amp;<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, 0);</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">if</span>(uc) {</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    }</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;change.url_alloc)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;change.url = <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;change.url_alloc = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <a class="code" href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a>(h);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;ftp&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;state.up.scheme)) {</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.proxy_transfer_mode) {</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="comment">/* when doing ftp, append ;type=&lt;a|i&gt; if not present */</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> = strstr(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, <span class="stringliteral">&quot;;type=&quot;</span>);</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> &amp;&amp; <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>[6] &amp;&amp; <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>[7] == 0) {</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;          <span class="keywordflow">switch</span>(<a class="code" href="strcase_8c.html#a555bbf5fd8dc146336474a2bb7959524">Curl_raw_toupper</a>(<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>[6])) {</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;          <span class="keywordflow">default</span>:</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> = NULL;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;          }</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>) {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;          <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = ftp_typecode;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;          <span class="comment">/* avoid sending invalid URLs like ftp://example.com;type=i if the</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">           * user specified ftp://example.com without the slash */</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;          <span class="keywordflow">if</span>(!*<a class="code" href="structdata.html">data</a>-&gt;state.up.path &amp;&amp; <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>[strlen(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>) - 1] != <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++ = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;          }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;          <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="keyword">sizeof</span>(ftp_typecode) - 1, <span class="stringliteral">&quot;;type=%c&quot;</span>,</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                    <a class="code" href="structdata.html">data</a>-&gt;set.prefer_ascii ? <span class="charliteral">&#39;a&#39;</span> : <span class="charliteral">&#39;i&#39;</span>);</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        }</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      }</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a> &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a533a91ae8c5add54fadaeac5dce92729">userpwd_in_url</a>)</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        paste_ftp_userpwd = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    }</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  }</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_PROXY */</span><span class="preprocessor"></span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a5690f2fad1c28f7840da5f2db675df60">p_accept</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Accept&quot;</span>)?NULL:<span class="stringliteral">&quot;Accept: */*\r\n&quot;</span>;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a> == httpreq || <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a> == httpreq) &amp;&amp;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;     <a class="code" href="structdata.html">data</a>-&gt;state.resume_from) {</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="comment">/**********************************************************************</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">     * Resuming upload in HTTP means that we PUT or POST and that we have</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">     * got a resume_from value set. The resume value has already created</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">     * a Range: header that will be passed along. We need to &quot;fast forward&quot;</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">     * the file the given number of bytes and decrease the assume upload</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">     * file size before we continue this venture in the dark lands of HTTP.</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment">     * Resuming mime/form posting at an offset &gt; 0 has no sense and is ignored.</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">     *********************************************************************/</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &lt; 0) {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">       * This is meant to get the size of the present remote-file by itself.</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">       * We don&#39;t support this now. Bail out!</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.resume_from = 0;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    }</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;state.this_is_a_follow) {</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <span class="comment">/* do we still game? */</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      <span class="comment">/* Now, let&#39;s read off the proper amount of bytes from the</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">         input. */</span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="keywordtype">int</span> seekerr = <a class="code" href="curl_8h.html#a34eb017e0a29378f976becdaa94160d1">CURL_SEEKFUNC_CANTSEEK</a>;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a01e38af502b3798152533aa52884b423">seek_func</a>) {</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <a class="code" href="multi_8c.html#af60eeb6175f9a25baeee40253c56330e">Curl_set_in_callback</a>(<a class="code" href="structdata.html">data</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        seekerr = conn-&gt;<a class="code" href="structconnectdata.html#a01e38af502b3798152533aa52884b423">seek_func</a>(conn-&gt;<a class="code" href="structconnectdata.html#ad7ad0216049eeb5099888585025e2202">seek_client</a>, <a class="code" href="structdata.html">data</a>-&gt;state.resume_from,</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                                  SEEK_SET);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="multi_8c.html#af60eeb6175f9a25baeee40253c56330e">Curl_set_in_callback</a>(<a class="code" href="structdata.html">data</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="keywordflow">if</span>(seekerr != <a class="code" href="curl_8h.html#af7074ca58279ac7ad8f78b9954a31160">CURL_SEEKFUNC_OK</a>) {</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> passed = 0;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <span class="keywordflow">if</span>(seekerr != <a class="code" href="curl_8h.html#a34eb017e0a29378f976becdaa94160d1">CURL_SEEKFUNC_CANTSEEK</a>) {</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Could not seek stream&quot;</span>);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62">CURLE_READ_ERROR</a>;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        }</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="comment">/* when seekerr == CURL_SEEKFUNC_CANTSEEK (can&#39;t seek to offset) */</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;          <span class="keywordtype">size_t</span> readthisamountnow =</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            (<a class="code" href="structdata.html">data</a>-&gt;state.resume_from - passed &gt; <a class="code" href="structdata.html">data</a>-&gt;set.buffer_size) ?</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            (<span class="keywordtype">size_t</span>)<a class="code" href="structdata.html">data</a>-&gt;set.buffer_size :</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <a class="code" href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from - passed);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;          <span class="keywordtype">size_t</span> actuallyread =</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;state.fread_func(<a class="code" href="structdata.html">data</a>-&gt;state.buffer, 1, readthisamountnow,</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                                   <a class="code" href="structdata.html">data</a>-&gt;state.in);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;          passed += actuallyread;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;          <span class="keywordflow">if</span>((actuallyread == 0) || (actuallyread &gt; readthisamountnow)) {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="comment">/* this checks for greater-than only to make sure that the</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">               CURL_READFUNC_ABORT return code still aborts */</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Could only read %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                  <span class="stringliteral">&quot; bytes from the input&quot;</span>, passed);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62">CURLE_READ_ERROR</a>;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;          }</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        } <span class="keywordflow">while</span>(passed &lt; data-&gt;<a class="code" href="ftp_8c.html#a77812d4945cd21094debbd06962f0f01">state</a>.resume_from);</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      }</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="comment">/* now, decrease the size of the read */</span></div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.infilesize&gt;0) {</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.infilesize -= <a class="code" href="structdata.html">data</a>-&gt;state.resume_from;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.infilesize &lt;= 0) {</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;          <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;File already completely uploaded&quot;</span>);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac6544fd7da6ddfd7893d74095b17a28d">CURLE_PARTIAL_FILE</a>;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        }</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      }</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      <span class="comment">/* we&#39;ve passed, proceed as normal */</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    }</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  }</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.use_range) {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">     * A range is selected. We use different headers whether we&#39;re downloading</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">     * or uploading and we always let customized headers override our internal</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">     * ones if any such are specified.</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="keywordflow">if</span>(((httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a>) || (httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>)) &amp;&amp;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;       !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Range&quot;</span>)) {</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <span class="comment">/* if a line like this was already allocated, free the previous one */</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a>);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a> = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Range: bytes=%s\r\n&quot;</span>,</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                                         <a class="code" href="structdata.html">data</a>-&gt;state.range);</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    }</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a> || httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>) &amp;&amp;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;            !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Range&quot;</span>)) {</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="comment">/* if a line like this was already allocated, free the previous one */</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a>);</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.set_resume_from &lt; 0) {</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <span class="comment">/* Upload resume was asked for, but we don&#39;t know the size of the</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">           remote part so we tell the server (and act accordingly) that we</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">           upload the whole file (again) */</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a> =</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;          <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Content-Range: bytes 0-%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                  <span class="stringliteral">&quot;/%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                  <a class="code" href="structdata.html">data</a>-&gt;state.infilesize - 1, <a class="code" href="structdata.html">data</a>-&gt;state.infilesize);</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      }</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from) {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="comment">/* This is because &quot;resume&quot; was selected */</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> total_expected_size =</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;state.resume_from + <a class="code" href="structdata.html">data</a>-&gt;state.infilesize;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a> =</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;          <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Content-Range: bytes %s%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                  <span class="stringliteral">&quot;/%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                  <a class="code" href="structdata.html">data</a>-&gt;state.range, total_expected_size-1,</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                  total_expected_size);</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      }</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <span class="comment">/* Range was selected and then we just pass the incoming range and</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">           append total size */</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a> =</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;          <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;Content-Range: bytes %s/%&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                  <a class="code" href="structdata.html">data</a>-&gt;state.range, <a class="code" href="structdata.html">data</a>-&gt;state.infilesize);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      }</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a>)</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    }</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  }</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  httpstring = get_http_string(<a class="code" href="structdata.html">data</a>, conn);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="comment">/* initialize a dynamic send-buffer */</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  req_buffer = <a class="code" href="http_8c.html#a8439073425968002da46c16791460fba">Curl_add_buffer_init</a>();</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keywordflow">if</span>(!req_buffer)</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="comment">/* add the main request stuff */</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="comment">/* GET/HEAD/POST/PUT */</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;%s &quot;</span>, request);</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa46bb6588f09bb6ada12d29bdeddc2539">STRING_TARGET</a>]) {</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa46bb6588f09bb6ada12d29bdeddc2539">STRING_TARGET</a>];</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    query = NULL;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  }</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  <span class="comment">/* url */</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">tunnel_proxy</a>) {</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a> = <a class="code" href="structdata.html">data</a>-&gt;change.url;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>, strlen(<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>));</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  }</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(paste_ftp_userpwd)</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;ftp://%s:%s@%s&quot;</span>,</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                              conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a>, conn-&gt;<a class="code" href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">passwd</a>,</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                              <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> + <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;ftp://&quot;</span>) - 1);</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>, strlen(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>));</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span>(query)</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;?%s&quot;</span>, query);</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  }</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> =</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* ftp typecode (;type=x) */</span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                     <span class="stringliteral">&quot; HTTP/%s\r\n&quot;</span> <span class="comment">/* HTTP version */</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* host */</span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* proxyuserpwd */</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* userpwd */</span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* range */</span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* user agent */</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* accept */</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* TE: */</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* accept-encoding */</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* referer */</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* Proxy-Connection */</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                     <span class="stringliteral">&quot;%s&quot;</span>,<span class="comment">/* transfer-encoding */</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                     ftp_typecode,</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                     httpstring,</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                     (conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a>?conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">host</a>:<span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a>?</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>?conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                     (<a class="code" href="structdata.html">data</a>-&gt;state.use_range &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a>)?</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">rangeline</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                     (<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa2523615707384ca20d7db90cf57e504c">STRING_USERAGENT</a>] &amp;&amp;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                      *<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa2523615707384ca20d7db90cf57e504c">STRING_USERAGENT</a>] &amp;&amp;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad0d3b107dbf2e7d40f2680e40498f1f3">uagent</a>)?</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad0d3b107dbf2e7d40f2680e40498f1f3">uagent</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                     <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a5690f2fad1c28f7840da5f2db675df60">p_accept</a>?<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a5690f2fad1c28f7840da5f2db675df60">p_accept</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a>?conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">te</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                     (<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a>] &amp;&amp;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                      *<a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a>] &amp;&amp;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a>)?</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">accept_encoding</a>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                     (<a class="code" href="structdata.html">data</a>-&gt;change.referer &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a>)?</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                     conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">ref</a>:<span class="stringliteral">&quot;&quot;</span> <span class="comment">/* Referer: &lt;data&gt; */</span>,</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                     (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                      !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">tunnel_proxy</a> &amp;&amp;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                      !<a class="code" href="http_8c.html#a058a82e5ae8dc800565a9b32d54af85c">Curl_checkProxyheaders</a>(conn, <span class="stringliteral">&quot;Proxy-Connection&quot;</span>))?</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                     <span class="stringliteral">&quot;Proxy-Connection: Keep-Alive\r\n&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                     te</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      );</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  <span class="comment">/* clear userpwd and proxyuserpwd to avoid re-using old credentials</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment">   * from re-used connections */</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a>);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <span class="keywordflow">if</span>(!(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a>&amp;<a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>) &amp;&amp;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;     conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> != 20 &amp;&amp;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;     (<a class="code" href="structdata.html">data</a>-&gt;set.httpversion == <a class="code" href="curl_8h.html#a49d83160803f433b12209ed52aafc05f">CURL_HTTP_VERSION_2</a>)) {</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="comment">/* append HTTP2 upgrade magic stuff to the HTTP request if it isn&#39;t done</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">       over SSL */</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http2_8h.html#a6e4353e22d54047ab6052b3a8fb49886">Curl_http2_request_upgrade</a>(req_buffer, conn);</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  }</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;cookies || addcookies) {</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *co = NULL; <span class="comment">/* no cookies from start */</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;cookies) {</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      co = <a class="code" href="cookie_8c.html#a14f67e6a0c8364b8d4990de8150f32c0">Curl_cookie_getlist</a>(<a class="code" href="structdata.html">data</a>-&gt;cookies,</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                               conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a>?</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                               conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a>:<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>,</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                               <a class="code" href="structdata.html">data</a>-&gt;state.up.path,</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                               (conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a>&amp;<a class="code" href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a>)?</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                               <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>);</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="keywordflow">if</span>(co) {</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="keyword">struct </span><a class="code" href="struct_cookie.html">Cookie</a> *store = co;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="comment">/* now loop through all cookies that matched */</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keywordflow">while</span>(co) {</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="keywordflow">if</span>(co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>) {</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;          <span class="keywordflow">if</span>(0 == count) {</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;Cookie: &quot;</span>);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;          }</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                                    <span class="stringliteral">&quot;%s%s=%s&quot;</span>, count?<span class="stringliteral">&quot;; &quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                                    co-&gt;<a class="code" href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">name</a>, co-&gt;<a class="code" href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">value</a>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;          count++;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        }</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        co = co-&gt;<a class="code" href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">next</a>; <span class="comment">/* next cookie please */</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <a class="code" href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a>(store);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordflow">if</span>(addcookies &amp;&amp; !<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keywordflow">if</span>(!count)</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;Cookie: &quot;</span>);</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;%s%s&quot;</span>, count?<span class="stringliteral">&quot;; &quot;</span>:<span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                                  addcookies);</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        count++;</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      }</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    }</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="keywordflow">if</span>(count &amp;&amp; !<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  }</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#ad61ec452bd9e1973fcbf1a700feecd88">Curl_add_timecondition</a>(<a class="code" href="structdata.html">data</a>, req_buffer);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a14d14997ce72dcbad55dd95c7c3bf08e">Curl_add_custom_headers</a>(conn, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, req_buffer);</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> = NULL;  <span class="comment">/* nothing to post at this point */</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, -1); <span class="comment">/* upload size is unknown atm */</span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="comment">/* If &#39;authdone&#39; is FALSE, we must not set the write socket index to the</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="comment">     Curl_transfer() call below, as we&#39;re not ready to actually upload any</span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="comment">     data yet. */</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="keywordflow">switch</span>(httpreq) {</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>: <span class="comment">/* Let&#39;s PUT the data to the server! */</span></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>)</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      postsize = 0;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      postsize = <a class="code" href="structdata.html">data</a>-&gt;state.infilesize;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="keywordflow">if</span>((postsize != -1) &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky &amp;&amp;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;       (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> || !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Length&quot;</span>))) {</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="comment">/* only add Content-Length if not uploading chunked */</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                                <span class="stringliteral">&quot;Content-Length: %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                <span class="stringliteral">&quot;\r\n&quot;</span>, postsize);</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    }</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keywordflow">if</span>(postsize != 0) {</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449">expect100</a>(<a class="code" href="structdata.html">data</a>, conn, req_buffer);</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    }</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2); <span class="comment">/* end of headers */</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="comment">/* set the upload size to the progress meter */</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, postsize);</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="comment">/* this sends the buffer and frees all the buffer resources */</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer, conn,</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                                  &amp;<a class="code" href="structdata.html">data</a>-&gt;info.request_size, 0, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed sending PUT request&quot;</span>);</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      <span class="comment">/* prepare for transfer */</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                          &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a>, postsize?<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>:-1,</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                          postsize?&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>:NULL);</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="comment">/* This is form posting using mime data. */</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) {</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="comment">/* nothing to post! */</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;Content-Length: 0\r\n\r\n&quot;</span>);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer, conn,</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                                    &amp;<a class="code" href="structdata.html">data</a>-&gt;info.request_size, 0, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed sending POST request&quot;</span>);</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="comment">/* setup variables for the upcoming transfer */</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a>,</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                            -1, NULL);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    }</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    postsize = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="comment">/* We only set Content-Length and allow a custom Content-Length if</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">       we don&#39;t upload data chunked, as RFC2616 forbids us to set both</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment">       kinds of headers (Transfer-Encoding: chunked and Content-Length) */</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordflow">if</span>(postsize != -1 &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky &amp;&amp;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;       (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> || !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Length&quot;</span>))) {</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      <span class="comment">/* we allow replacing this header if not during auth negotiation,</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="comment">         although it isn&#39;t very wise to actually set your own */</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                                <span class="stringliteral">&quot;Content-Length: %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                                <span class="stringliteral">&quot;\r\n&quot;</span>, postsize);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    }</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="comment">/* Output mime-generated headers. */</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    {</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *hdr;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="keywordflow">for</span>(hdr = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>-&gt;<a class="code" href="structcurl__mimepart__s.html#a74d921c113fd98a562923807ed68e129">curlheaders</a>; hdr; hdr = hdr-&gt;<a class="code" href="structcurl__slist.html#a56fcfc41d89a47865933c310d316a108">next</a>) {</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;%s\r\n&quot;</span>, hdr-&gt;<a class="code" href="structcurl__slist.html#a5fe4d926491a1c9b8b9a73c40505f601">data</a>);</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      }</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    }</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <span class="comment">/* For really small posts we don&#39;t use Expect: headers at all, and for</span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">       the somewhat bigger ones we allow the app to disable it. Just make</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">       sure that the expect100header is always set to the preferred value</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">       here. */</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Expect&quot;</span>);</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.expect100header =</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;Expect:&quot;</span>, <span class="stringliteral">&quot;100-continue&quot;</span>);</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(postsize &gt; <a class="code" href="http_8h.html#ab59be342b3bfa354581f70f00a8b10fc">EXPECT_100_THRESHOLD</a> || postsize &lt; 0) {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449">expect100</a>(<a class="code" href="structdata.html">data</a>, conn, req_buffer);</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    }</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.expect100header = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="comment">/* make the request end in a true CRLF */</span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <span class="comment">/* set the upload size to the progress meter */</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, postsize);</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="comment">/* Read from mime structure. */</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.fread_func = (<a class="code" href="curl_8h.html#a7516630ec17f247697dd3272be7ada74">curl_read_callback</a>) <a class="code" href="mime_8c.html#a421afd16d330a7d51f13ec1aecca05be">Curl_mime_read</a>;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.in = (<span class="keywordtype">void</span> *) <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">sendit</a>;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a> = HTTPSEND_BODY;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="comment">/* this sends the buffer and frees all the buffer resources */</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer, conn,</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                                  &amp;<a class="code" href="structdata.html">data</a>-&gt;info.request_size, 0, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed sending POST request&quot;</span>);</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="comment">/* prepare for transfer */</span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                          &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a>, postsize?<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>:-1,</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                          postsize?&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>:NULL);</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a>:</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="comment">/* this is the simple POST, using x-www-form-urlencoded style */</span></div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>)</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      postsize = 0;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="comment">/* the size of the post body */</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      postsize = <a class="code" href="structdata.html">data</a>-&gt;state.infilesize;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="comment">/* We only set Content-Length and allow a custom Content-Length if</span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">       we don&#39;t upload data chunked, as RFC2616 forbids us to set both</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment">       kinds of headers (Transfer-Encoding: chunked and Content-Length) */</span></div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="keywordflow">if</span>((postsize != -1) &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky &amp;&amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;       (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a> || !<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Length&quot;</span>))) {</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      <span class="comment">/* we allow replacing this header if not during auth negotiation,</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">         although it isn&#39;t very wise to actually set your own */</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                <span class="stringliteral">&quot;Content-Length: %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                <span class="stringliteral">&quot;\r\n&quot;</span>, postsize);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    }</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Content-Type&quot;</span>)) {</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer,</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                                <span class="stringliteral">&quot;Content-Type: application/&quot;</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                                <span class="stringliteral">&quot;x-www-form-urlencoded\r\n&quot;</span>);</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="comment">/* For really small posts we don&#39;t use Expect: headers at all, and for</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment">       the somewhat bigger ones we allow the app to disable it. Just make</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment">       sure that the expect100header is always set to the preferred value</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment">       here. */</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = <a class="code" href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a>(conn, <span class="stringliteral">&quot;Expect&quot;</span>);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) {</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.expect100header =</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="stringliteral">&quot;Expect:&quot;</span>, <span class="stringliteral">&quot;100-continue&quot;</span>);</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    }</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(postsize &gt; <a class="code" href="http_8h.html#ab59be342b3bfa354581f70f00a8b10fc">EXPECT_100_THRESHOLD</a> || postsize &lt; 0) {</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449">expect100</a>(<a class="code" href="structdata.html">data</a>, conn, req_buffer);</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    }</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;state.expect100header = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.postfields) {</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="comment">/* In HTTP2, we send request body in DATA frame regardless of</span></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">         its size. */</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> != 20 &amp;&amp;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;         !<a class="code" href="structdata.html">data</a>-&gt;state.expect100header &amp;&amp;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;         (postsize &lt; <a class="code" href="http_8h.html#a940ebf8ac84737c7753b5fe6d8472563">MAX_INITIAL_POST_SIZE</a>)) {</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="comment">/* if we don&#39;t use expect: 100  AND</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">           postsize is less than MAX_INITIAL_POST_SIZE</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">           then append the post data to the HTTP request header. This limit</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">           is no magic limit but only set to prevent really huge POSTs to</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment">           get the data duplicated with malloc() and family. */</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2); <span class="comment">/* end of headers! */</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky) {</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;          <span class="comment">/* We&#39;re not sending it &#39;chunked&#39;, append it to the request</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">             already now to reduce the number if send() calls */</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <a class="code" href="structdata.html">data</a>-&gt;set.postfields,</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                                   (<span class="keywordtype">size_t</span>)postsize);</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;          included_body = postsize;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        }</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;          <span class="keywordflow">if</span>(postsize) {</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;            <span class="comment">/* Append the POST data chunky-style */</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a>(&amp;req_buffer, <span class="stringliteral">&quot;%x\r\n&quot;</span>, (<span class="keywordtype">int</span>)postsize);</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;              <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <a class="code" href="structdata.html">data</a>-&gt;set.postfields,</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                                       (<span class="keywordtype">size_t</span>)postsize);</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;              <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;              included_body = postsize + 2;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            }</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          }</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\x30\x0d\x0a\x0d\x0a&quot;</span>, 5);</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;          <span class="comment">/* 0  CR  LF  CR  LF */</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;          included_body += 5;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="comment">/* Make sure the progress information is accurate */</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, postsize);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      }</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="comment">/* A huge POST coming up, do data separate from the request */</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = postsize;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> = <a class="code" href="structdata.html">data</a>-&gt;set.postfields;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">sending</a> = HTTPSEND_BODY;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.fread_func = (<a class="code" href="curl_8h.html#a7516630ec17f247697dd3272be7ada74">curl_read_callback</a>)readmoredata;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.in = (<span class="keywordtype">void</span> *)conn;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        <span class="comment">/* set the upload size to the progress meter */</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a>);</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2); <span class="comment">/* end of headers! */</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      }</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    }</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2); <span class="comment">/* end of headers! */</span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky &amp;&amp; conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) {</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <span class="comment">/* Chunky upload is selected and we&#39;re negotiating auth still, send</span></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment">           end-of-data only */</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer,</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                                 <span class="stringliteral">&quot;\x30\x0d\x0a\x0d\x0a&quot;</span>, 5);</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <span class="comment">/* 0  CR  LF  CR  LF */</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      }</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.infilesize) {</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        <span class="comment">/* set the upload size to the progress meter */</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <a class="code" href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a>(<a class="code" href="structdata.html">data</a>, postsize?postsize:-1);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="comment">/* set the pointer to mark that we will send the post body using the</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">           read callback, but only if we&#39;re not in authenticate</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment">           negotiation  */</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) {</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;          <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a> = (<span class="keywordtype">char</span> *)&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;          <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">postsize</a> = postsize;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        }</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      }</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    }</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="comment">/* issue the request */</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer, conn, &amp;<a class="code" href="structdata.html">data</a>-&gt;info.request_size,</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                                  (<span class="keywordtype">size_t</span>)included_body, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed sending HTTP POST request&quot;</span>);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;      <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                          &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a>, <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>?<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>:-1,</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                          <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>?&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>:NULL);</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a>(&amp;req_buffer, <span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="comment">/* issue the request */</span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a>(&amp;req_buffer, conn,</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                                  &amp;<a class="code" href="structdata.html">data</a>-&gt;info.request_size, 0, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed sending HTTP request&quot;</span>);</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="comment">/* HTTP GET/HEAD download: */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">readbytecount</a>,</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                          <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>?<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>:-1,</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                          <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">postdata</a>?&amp;<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>:NULL);</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  }</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>) {</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="comment">/* if a request-body has been sent off, we make sure this progress is noted</span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment">       properly */</span></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <a class="code" href="progress_8c.html#a9458c724bbe21e16b9abf8f696a3916a">Curl_pgrsSetUploadCounter</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>);</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a>(conn))</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a>;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a> &gt;= postsize) {</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="comment">/* already sent the entire request body, mark the &quot;upload&quot; as</span></div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="comment">         complete */</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;upload completely sent off: %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;            <span class="stringliteral">&quot; out of %&quot;</span> <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a> <span class="stringliteral">&quot; bytes\n&quot;</span>,</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;            <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>, postsize);</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.upload_done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.keepon &amp;= ~<a class="code" href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a>; <span class="comment">/* we&#39;re done writing */</span></div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.exp100 = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a>; <span class="comment">/* already sent */</span></div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <a class="code" href="multi_8c.html#ab12ca318b29f9bd535afc9bea98b82bb">Curl_expire_done</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da9ce9f2e0534f44e7777fac288d3c522a">EXPIRE_100_TIMEOUT</a>);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    }</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.writebytecount = <a class="code" href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a>-&gt;<a class="code" href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">writebytecount</a>;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;  }</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 20) &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky)</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="comment">/* upload_chunky was set above to set up the request in a chunky fashion,</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">       but is disabled here again to avoid that the chunked encoded version is</span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">       actually used when sending the request body over h2 */</span></div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.upload_chunky = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;}</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;</div><div class="line"><a name="l02945"></a><span class="lineno"><a class="line" href="http_8c.html#a5e8926572799ef0618c27df845d36395"> 2945</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l02946"></a><span class="lineno"><a class="line" href="http_8c.html#a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75"> 2946</a></span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75">STATUS_UNKNOWN</a>, <span class="comment">/* not enough data to tell yet */</span></div><div class="line"><a name="l02947"></a><span class="lineno"><a class="line" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e"> 2947</a></span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a>, <span class="comment">/* a status line was read */</span></div><div class="line"><a name="l02948"></a><span class="lineno"><a class="line" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0"> 2948</a></span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a> <span class="comment">/* not a status line */</span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;} <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a>;</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">/* Check a string for a prefix. Check no more than &#39;len&#39; bytes */</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> checkprefixmax(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cert_8d.html#ad21adcb792d0eec29088bb9e0b006a1a">prefix</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;{</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <span class="keywordtype">size_t</span> ch = <a class="code" href="curl__setup_8h.html#a5dd6efb91a5151f2bb4e4fff1b386582">CURLMIN</a>(strlen(<a class="code" href="cert_8d.html#ad21adcb792d0eec29088bb9e0b006a1a">prefix</a>), <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#a65444a26674d01b4fa07858339c10592">curl_strnequal</a>(<a class="code" href="cert_8d.html#ad21adcb792d0eec29088bb9e0b006a1a">prefix</a>, <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, ch);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;}</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment"> * checkhttpprefix()</span></div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment"> * Returns TRUE if member of the list matches prefix of string</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="keyword">static</span> <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a></div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;checkhttpprefix(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;{</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a> = <a class="code" href="structdata.html">data</a>-&gt;set.http200aliases;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a>;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> onmatch = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt;= 5? <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a> : <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75">STATUS_UNKNOWN</a>;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="preprocessor">#ifdef CURL_DOES_CONVERSIONS</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  <span class="comment">/* convert from the network encoding using a scratch area */</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  <span class="keywordtype">char</span> *scratch = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(s);</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  <span class="keywordflow">if</span>(NULL == scratch) {</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed to allocate memory for conversion!&quot;</span>);</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* can&#39;t return CURLE_OUT_OF_MEMORY so return FALSE */</span></div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  }</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a> != <a class="code" href="non-ascii_8h.html#a7f86eb6237ad590baa14e82fae9d6d83">Curl_convert_from_network</a>(<a class="code" href="structdata.html">data</a>, scratch, strlen(s) + 1)) {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    <span class="comment">/* Curl_convert_from_network calls failf if unsuccessful */</span></div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(scratch);</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* can&#39;t return CURLE_foobar so return FALSE */</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  }</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;  s = scratch;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DOES_CONVERSIONS */</span><span class="preprocessor"></span></div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  <span class="keywordflow">while</span>(<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>) {</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <span class="keywordflow">if</span>(checkprefixmax(<a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;data, s, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)) {</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = onmatch;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    }</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a> = <a class="code" href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a>-&gt;next;</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  }</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a>) &amp;&amp; (checkprefixmax(<span class="stringliteral">&quot;HTTP/&quot;</span>, s, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)))</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = onmatch;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="preprocessor">#ifdef CURL_DOES_CONVERSIONS</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(scratch);</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DOES_CONVERSIONS */</span><span class="preprocessor"></span></div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;}</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_RTSP</span></div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;<span class="keyword">static</span> <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a></div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;checkrtspprefix(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;{</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a>;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> onmatch = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt;= 5? <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a> : <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75">STATUS_UNKNOWN</a>;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="preprocessor">#ifdef CURL_DOES_CONVERSIONS</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  <span class="comment">/* convert from the network encoding using a scratch area */</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordtype">char</span> *scratch = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(s);</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <span class="keywordflow">if</span>(NULL == scratch) {</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed to allocate memory for conversion!&quot;</span>);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* can&#39;t return CURLE_OUT_OF_MEMORY so return FALSE */</span></div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  }</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a> != <a class="code" href="non-ascii_8h.html#a7f86eb6237ad590baa14e82fae9d6d83">Curl_convert_from_network</a>(<a class="code" href="structdata.html">data</a>, scratch, strlen(s) + 1)) {</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="comment">/* Curl_convert_from_network calls failf if unsuccessful */</span></div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* can&#39;t return CURLE_foobar so return FALSE */</span></div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  }</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(checkprefixmax(<span class="stringliteral">&quot;RTSP/&quot;</span>, scratch, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>))</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = onmatch;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(scratch);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  (void)<a class="code" href="structdata.html">data</a>; <span class="comment">/* unused */</span></div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <span class="keywordflow">if</span>(checkprefixmax(<span class="stringliteral">&quot;RTSP/&quot;</span>, s, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>))</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = onmatch;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DOES_CONVERSIONS */</span><span class="preprocessor"></span></div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;}</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_RTSP */</span><span class="preprocessor"></span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="keyword">static</span> <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a></div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;checkprotoprefix(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;{</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_RTSP</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a>)</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="keywordflow">return</span> checkrtspprefix(<a class="code" href="structdata.html">data</a>, s, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  (void)conn;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_RTSP */</span><span class="preprocessor"></span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  <span class="keywordflow">return</span> checkhttpprefix(<a class="code" href="structdata.html">data</a>, s, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;}</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment"> * header_append() copies a chunk of data to the end of the already received</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment"> * header. We make sure that the full string fit in the allocated header</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment"> * buffer, or else we enlarge it.</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> header_append(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="struct_single_request.html">SingleRequest</a> *k,</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                              <span class="keywordtype">size_t</span> length)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;{</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="keywordtype">size_t</span> newsize = k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a> + length;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <span class="keywordflow">if</span>(newsize &gt; <a class="code" href="curl_8h.html#a7a2d5bd19a5af3674e7d8ecab1a4dfaf">CURL_MAX_HTTP_HEADER</a>) {</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="comment">/* The reason to have a max limit for this is to avoid the risk of a bad</span></div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">       server feeding libcurl with a never-ending header that will cause</span></div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">       reallocs infinitely */</span></div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Rejected %zu bytes header (max is %d)!&quot;</span>, newsize,</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          <a class="code" href="curl_8h.html#a7a2d5bd19a5af3674e7d8ecab1a4dfaf">CURL_MAX_HTTP_HEADER</a>);</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  }</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="keywordflow">if</span>(newsize &gt;= <a class="code" href="structdata.html">data</a>-&gt;state.headersize) {</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="comment">/* We enlarge the header buffer as it is too small */</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keywordtype">char</span> *newbuff;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    <span class="keywordtype">size_t</span> hbufp_index;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    newsize = <a class="code" href="curl__setup_8h.html#a13581d0a607ddfc267cd384346e7f048">CURLMAX</a>((k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a> + length) * 3 / 2, <a class="code" href="structdata.html">data</a>-&gt;state.headersize*2);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    hbufp_index = k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> - <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    newbuff = <a class="code" href="curl__memory_8h.html#aa568500a9ca507b5a53de5372c81f26a">realloc</a>(<a class="code" href="structdata.html">data</a>-&gt;state.headerbuff, newsize);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordflow">if</span>(!newbuff) {</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Failed to alloc memory for big header!&quot;</span>);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    }</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.headersize = newsize;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff = newbuff;</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> = <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff + hbufp_index;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  }</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a>, k-&gt;<a class="code" href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">str_start</a>, length);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> += length;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a> += length;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  *k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> = 0;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;}</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> print_http_error(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;{</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_single_request.html">SingleRequest</a> *k = &amp;<a class="code" href="structdata.html">data</a>-&gt;req;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keywordtype">char</span> *beg = k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <span class="comment">/* make sure that data-&gt;req.p points to the HTTP status line */</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="keywordflow">if</span>(!strncmp(beg, <span class="stringliteral">&quot;HTTP&quot;</span>, 4)) {</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="comment">/* skip to HTTP status code */</span></div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    beg = strchr(beg, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keywordflow">if</span>(beg &amp;&amp; *++beg) {</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      <span class="comment">/* find trailing CR */</span></div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      <span class="keywordtype">char</span> end_char = <span class="charliteral">&#39;\r&#39;</span>;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      <span class="keywordtype">char</span> *end = strchr(beg, end_char);</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      <span class="keywordflow">if</span>(!end) {</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        <span class="comment">/* try to find LF (workaround for non-compliant HTTP servers) */</span></div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        end_char = <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        end = strchr(beg, end_char);</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      }</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      <span class="keywordflow">if</span>(end) {</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <span class="comment">/* temporarily replace CR or LF by NUL and print the error message */</span></div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        *end = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;The requested URL returned error: %s&quot;</span>, beg);</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        <span class="comment">/* restore the previously replaced CR or LF */</span></div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        *end = end_char;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      }</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    }</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  }</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <span class="comment">/* fall-back to printing the HTTP status code only */</span></div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;The requested URL returned error: %d&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>);</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;}</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment"> * Read any HTTP header lines from the server and pass them to the client app.</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03131"></a><span class="lineno"><a class="line" href="http_8h.html#a06db2840299ee6694923087317b8133a"> 3131</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="http_8c.html#a06db2840299ee6694923087317b8133a">Curl_http_readwrite_headers</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                                       <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                                       <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> *nread,</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                                       <span class="keywordtype">bool</span> *stop_reading)</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;{</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_single_request.html">SingleRequest</a> *k = &amp;<a class="code" href="structdata.html">data</a>-&gt;req;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> onread = *nread;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <span class="keywordtype">char</span> *ostr = k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a>;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  <span class="comment">/* header line within buffer loop */</span></div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="keywordtype">size_t</span> rest_length;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keywordtype">size_t</span> full_length;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keywordtype">int</span> writetype;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="comment">/* str_start is start of line within buf */</span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">str_start</a> = k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a>;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <span class="comment">/* data is in network encoding so use 0x0a instead of &#39;\n&#39; */</span></div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">end_ptr</a> = memchr(k-&gt;<a class="code" href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">str_start</a>, 0x0a, *nread);</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">end_ptr</a>) {</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="comment">/* Not a complete header line within buffer, append the data to</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">         the end of the headerbuff. */</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = header_append(<a class="code" href="structdata.html">data</a>, k, *nread);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a>) {</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="comment">/* check if this looks like a protocol header */</span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> st = checkprotoprefix(<a class="code" href="structdata.html">data</a>, conn, <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff,</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                                         k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>);</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        <span class="keywordflow">if</span>(st == <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a>) {</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;          <span class="comment">/* this is not the beginning of a protocol first header line */</span></div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#acd41ba7d3b44e699dd1a46ec4754e151">badheader</a> = <a class="code" href="struct_single_request.html#af317a717e518249384a1db5a4b57d0f9a6a1237a08b80b653a99c1db76b8fbd30">HEADER_ALLBAD</a>;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;          <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;bad HTTP: No end-of-message indicator&quot;</span>);</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      }</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">/* read more and try again */</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    }</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="comment">/* decrease the size of the remaining (supposed) header line */</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    rest_length = (k-&gt;<a class="code" href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">end_ptr</a> - k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a>) + 1;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    *nread -= (<a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a>)rest_length;</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a> = k-&gt;<a class="code" href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">end_ptr</a> + 1; <span class="comment">/* move past new line */</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    full_length = k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a> - k-&gt;<a class="code" href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">str_start</a>;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = header_append(<a class="code" href="structdata.html">data</a>, k, full_length);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">end_ptr</a> = k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a>;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> = <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="comment">/****</span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">     * We now have a FULL header line that p points to</span></div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">     *****/</span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a>) {</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <span class="comment">/* the first read header */</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a> st = checkprotoprefix(<a class="code" href="structdata.html">data</a>, conn, <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff,</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;                                       k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>);</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      <span class="keywordflow">if</span>(st == <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a>) {</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;bad HTTP: No end-of-message indicator&quot;</span>);</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        <span class="comment">/* this is not the beginning of a protocol first header line */</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="keywordflow">if</span>(*nread)</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;          <span class="comment">/* since there&#39;s more, this is a partial bad header */</span></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#acd41ba7d3b44e699dd1a46ec4754e151">badheader</a> = <a class="code" href="struct_single_request.html#af317a717e518249384a1db5a4b57d0f9a2f41dfd2516fec41c456bb75df75a805">HEADER_PARTHEADER</a>;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;          <span class="comment">/* this was all we read so it&#39;s all a bad header */</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#acd41ba7d3b44e699dd1a46ec4754e151">badheader</a> = <a class="code" href="struct_single_request.html#af317a717e518249384a1db5a4b57d0f9a6a1237a08b80b653a99c1db76b8fbd30">HEADER_ALLBAD</a>;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;          *nread = onread;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a> = ostr;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        }</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      }</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    }</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="comment">/* headers are in network encoding so</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">       use 0x0a and 0x0d instead of &#39;\n&#39; and &#39;\r&#39; */</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="keywordflow">if</span>((0x0a == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) || (0x0d == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      <span class="keywordtype">size_t</span> headerlen;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      <span class="comment">/* Zero-length header line means end of headers! */</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="preprocessor">#ifdef CURL_DOES_CONVERSIONS</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      <span class="keywordflow">if</span>(0x0d == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) {</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> = <span class="charliteral">&#39;\r&#39;</span>; <span class="comment">/* replace with CR in host encoding */</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>++;       <span class="comment">/* pass the CR byte */</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      }</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      <span class="keywordflow">if</span>(0x0a == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) {</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> = <span class="charliteral">&#39;\n&#39;</span>; <span class="comment">/* replace with LF in host encoding */</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>++;       <span class="comment">/* pass the LF byte */</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      }</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="keywordflow">if</span>(<span class="charliteral">&#39;\r&#39;</span> == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>++; <span class="comment">/* pass the \r byte */</span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <span class="keywordflow">if</span>(<span class="charliteral">&#39;\n&#39;</span> == *k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>++; <span class="comment">/* pass the \n byte */</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DOES_CONVERSIONS */</span><span class="preprocessor"></span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <span class="keywordflow">if</span>(100 &lt;= k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &amp;&amp; 199 &gt;= k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>) {</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        <span class="comment">/* &quot;A user agent MAY ignore unexpected 1xx status responses.&quot; */</span></div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        <span class="keywordflow">switch</span>(k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>) {</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keywordflow">case</span> 100:</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;          <span class="comment">/*</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">           * We have made a HTTP PUT or POST and this is 1.1-lingo</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">           * that tells us that the server is OK with this and ready</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment">           * to receive the data.</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">           * However, we&#39;ll get more headers now so we must get</span></div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment">           * back into the header-parsing state!</span></div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a> = 0; <span class="comment">/* restart the header line counter */</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;          <span class="comment">/* if we did wait for this do enable write now! */</span></div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;          <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">exp100</a> &gt; <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a>) {</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">exp100</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a>;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">keepon</a> |= <a class="code" href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a>;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            <a class="code" href="multi_8c.html#ab12ca318b29f9bd535afc9bea98b82bb">Curl_expire_done</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da9ce9f2e0534f44e7777fac288d3c522a">EXPIRE_100_TIMEOUT</a>);</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;          }</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        <span class="keywordflow">case</span> 101:</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;          <span class="comment">/* Switching Protocols */</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;          <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#aedc2a164dd5fddd6e7420472035424ef">upgr101</a> == <a class="code" href="urldata_8h.html#a7d475a6687b678c11cce8221797e46ddaa9c52d61737ee3b48ca077b1f408e8d8">UPGR101_REQUESTED</a>) {</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;            <span class="comment">/* Switching to HTTP/2 */</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;            <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Received 101\n&quot;</span>);</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#aedc2a164dd5fddd6e7420472035424ef">upgr101</a> = <a class="code" href="urldata_8h.html#a7d475a6687b678c11cce8221797e46dda5438320c9e5960ae04acfd8d213faa57">UPGR101_RECEIVED</a>;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;            <span class="comment">/* we&#39;ll get more headers (HTTP/2 response) */</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a> = 0; <span class="comment">/* restart the header line counter */</span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;            <span class="comment">/* switch to http2 now. The bytes after response headers</span></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="comment">               are also processed here, otherwise they are lost. */</span></div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http2_8h.html#a2c3310e8f1eb576e38f798fb9dd2b951">Curl_http2_switched</a>(conn, k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a>, *nread);</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            *nread = 0;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;          }</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="comment">/* Switching to another protocol (e.g. WebSocket) */</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* no more header to parse! */</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;          }</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;          <span class="comment">/* the status code 1xx indicates a provisional response, so</span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment">             we&#39;ll get another set of headers */</span></div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a> = 0; <span class="comment">/* restart the header line counter */</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        }</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      }</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* no more header to parse! */</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        <span class="keywordflow">if</span>((k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a> == -1) &amp;&amp; !k-&gt;<a class="code" href="struct_single_request.html#a3018293fe5f120a8a4c77d16207ab5da">chunk</a> &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">close</a> &amp;&amp;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;           (conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 11) &amp;&amp;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;           !(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a>) &amp;&amp;</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;           <a class="code" href="structdata.html">data</a>-&gt;set.httpreq != <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a>) {</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;          <span class="comment">/* On HTTP 1.1, when connection is not to get closed, but no</span></div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">             Content-Length nor Transfer-Encoding chunked have been</span></div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment">             received, according to RFC2616 section 4.4 point 5, we</span></div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">             assume that the server will close the connection to</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="comment">             signal the end of the document. */</span></div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;no chunk, no close, no size. Assume close to &quot;</span></div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                <span class="stringliteral">&quot;signal end\n&quot;</span>);</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;          <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;HTTP: No end-of-message indicator&quot;</span>);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        }</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      }</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <span class="comment">/* At this point we have some idea about the fate of the connection.</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="comment">         If we are closing the connection it may result auth failure. */</span></div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="preprocessor">#if defined(USE_NTLM)</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">close</a> &amp;&amp;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;         (((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode == 401) &amp;&amp;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;           (conn-&gt;ntlm.state == <a class="code" href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54afabd35bacd3e2bdb1f3bba2bb4432ddf">NTLMSTATE_TYPE2</a>)) ||</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;          ((<a class="code" href="structdata.html">data</a>-&gt;req.httpcode == 407) &amp;&amp;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;           (conn-&gt;proxyntlm.state == <a class="code" href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54afabd35bacd3e2bdb1f3bba2bb4432ddf">NTLMSTATE_TYPE2</a>)))) {</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Connection closure while negotiating auth (HTTP 1.0?)\n&quot;</span>);</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.authproblem = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      }</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">       * When all the headers have been parsed, see if we should give</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="comment">       * up and return an error.</span></div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      <span class="keywordflow">if</span>(http_should_fail(conn)) {</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;The requested URL returned error: %d&quot;</span>,</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;              k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>);</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3">CURLE_HTTP_RETURNED_ERROR</a>;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      }</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <span class="comment">/* now, only output this if the header AND body are requested:</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      writetype = <a class="code" href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a>;</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.include_header)</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        writetype |= <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      headerlen = k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> - <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, writetype,</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                                 <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff,</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                                 headerlen);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;info.header_size += (long)headerlen;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.headerbytecount += (long)headerlen;</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.deductheadercount =</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        (100 &lt;= k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &amp;&amp; 199 &gt;= k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>)?<a class="code" href="structdata.html">data</a>-&gt;req.headerbytecount:0;</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;      <span class="comment">/* Curl_http_auth_act() checks what authentication methods</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment">       * that are available and decides which one (if any) to</span></div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment">       * use. It will set &#39;newurl&#39; if an auth method was picked. */</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#a3827f32165b3a89ed16bb104eb00e185">Curl_http_auth_act</a>(conn);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &gt;= 300) {</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        <span class="keywordflow">if</span>((!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">authneg</a>) &amp;&amp; !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">close</a> &amp;&amp;</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;           !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">rewindaftersend</a>) {</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;          <span class="comment">/*</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">           * General treatment of errors when about to send data. Including :</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">           * &quot;417 Expectation Failed&quot;, while waiting for 100-continue.</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">           *</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">           * The check for close above is done simply because of something</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment">           * else has already deemed the connection to get closed then</span></div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment">           * something else should&#39;ve considered the big picture and we</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment">           * avoid this check.</span></div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">           *</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment">           * rewindaftersend indicates that something has told libcurl to</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="comment">           * continue sending even if it gets discarded</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;          <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.httpreq) {</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a>:</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a>:</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a>:</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a>:</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;            <span class="comment">/* We got an error response. If this happened before the whole</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="comment">             * request body has been sent we stop sending and mark the</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="comment">             * connection for closure after we&#39;ve read the entire response.</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            <a class="code" href="multi_8c.html#ab12ca318b29f9bd535afc9bea98b82bb">Curl_expire_done</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da9ce9f2e0534f44e7777fac288d3c522a">EXPIRE_100_TIMEOUT</a>);</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a8e8fb4ea5e024d91a2c1ee812694254a">upload_done</a>) {</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.http_keep_sending_on_error) {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP error before end of send, keep sending\n&quot;</span>);</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">exp100</a> &gt; <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a>) {</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                  k-&gt;<a class="code" href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">exp100</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a>;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                  k-&gt;<a class="code" href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">keepon</a> |= <a class="code" href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a>;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                }</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;              }</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;              <span class="keywordflow">else</span> {</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP error before end of send, stop sending\n&quot;</span>);</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;Stop sending data before everything sent&quot;</span>);</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                k-&gt;<a class="code" href="struct_single_request.html#a8e8fb4ea5e024d91a2c1ee812694254a">upload_done</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                k-&gt;<a class="code" href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">keepon</a> &amp;= ~<a class="code" href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a>; <span class="comment">/* don&#39;t send */</span></div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.expect100header)</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                  k-&gt;<a class="code" href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">exp100</a> = <a class="code" href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449a5d37d933155aed027aad828ec1245e09">EXP100_FAILED</a>;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;              }</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            }</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;          <span class="keywordflow">default</span>: <span class="comment">/* default label present to avoid compiler warnings */</span></div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;          }</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        }</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">rewindaftersend</a>) {</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;          <span class="comment">/* We rewind after a complete send, so thus we continue</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment">             sending now */</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Keep sending data to get tossed away!\n&quot;</span>);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">keepon</a> |= <a class="code" href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a>;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        }</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      }</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a>) {</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="comment">         * really end-of-headers.</span></div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment">         * If we requested a &quot;no body&quot;, this is a good time to get</span></div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment">         * out and return home.</span></div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.opt_no_body)</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;          *stop_reading = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_RTSP</span></div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a>) &amp;&amp;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                (<a class="code" href="structdata.html">data</a>-&gt;set.rtspreq == <a class="code" href="urldata_8h.html#a816857c637b57c60b680d1bf575ef159a4b76a91757deee490e11c850676b29da">RTSPREQ_DESCRIBE</a>) &amp;&amp;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                (k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a> &lt;= -1))</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;          <span class="comment">/* Respect section 4.4 of rfc2326: If the Content-Length header is</span></div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="comment">             absent, a length 0 must be assumed.  It will prevent libcurl from</span></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;<span class="comment">             hanging on DESCRIBE request that got refused for whatever</span></div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">             reason */</span></div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;          *stop_reading = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;          <span class="comment">/* If we know the expected size of this document, we set the</span></div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment">             maximum download size to the size of the expected</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment">             document or else, we won&#39;t know when to stop reading!</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment">             Note that we set the download maximum even if we read a</span></div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="comment">             &quot;Connection: close&quot; header, to make sure that</span></div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment">             &quot;Content-Length: 0&quot; still prevents us from attempting to</span></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="comment">             read the (missing) response-body.</span></div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;          <span class="comment">/* According to RFC2616 section 4.4, we MUST ignore</span></div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="comment">             Content-Length: headers if we are now receiving data</span></div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="comment">             using chunked Transfer-Encoding.</span></div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;          <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#a3018293fe5f120a8a4c77d16207ab5da">chunk</a>)</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">maxdownload</a> = k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a> = -1;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        }</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        <span class="keywordflow">if</span>(-1 != k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a>) {</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;          <span class="comment">/* We do this operation even if no_body is true, since this</span></div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment">             data might be retrieved later with curl_easy_getinfo()</span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="comment">             and its CURLINFO_CONTENT_LENGTH_DOWNLOAD option. */</span></div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;          <a class="code" href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a>(<a class="code" href="structdata.html">data</a>, k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a>);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">maxdownload</a> = k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a>;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;        }</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;        <span class="comment">/* If max download size is *zero* (nothing) we already have</span></div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment">           nothing and can safely return ok now!  But for HTTP/2, we&#39;d</span></div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">           like to call http2_handle_stream_close to properly close a</span></div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="comment">           stream.  In order to do this, we keep reading until we</span></div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="comment">           close the stream. */</span></div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordflow">if</span>(0 == k-&gt;<a class="code" href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">maxdownload</a></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;#<span class="keywordflow">if</span> defined(USE_NGHTTP2)</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;           &amp;&amp; !((conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="urldata_8h.html#a9d346cfcc0046f6c6ed206bde086ab2d">PROTO_FAMILY_HTTP</a>) &amp;&amp;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 20)</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;#endif</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;           )</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          *stop_reading = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        <span class="keywordflow">if</span>(*stop_reading) {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;          <span class="comment">/* we make sure that this socket isn&#39;t read more now */</span></div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">keepon</a> &amp;= ~<a class="code" href="urldata_8h.html#ab141b3290dad267f76cd77a91c641146">KEEP_RECV</a>;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        }</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.verbose)</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;          <a class="code" href="sendf_8c.html#a8b0f0a06869b888abb80a069182d0d5a">Curl_debug</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a7d8a29d35245d116245a1bd1f31f0175">CURLINFO_HEADER_IN</a>,</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                     k-&gt;<a class="code" href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">str_start</a>, headerlen);</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="keywordflow">break</span>;          <span class="comment">/* exit header line loop */</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      }</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      <span class="comment">/* We continue reading headers, so reset the line-based</span></div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;<span class="comment">         header parsing variables hbufp &amp;&amp; hbuflen */</span></div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> = <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff;</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a> = 0;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    }</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment">     * Checks for special headers coming up.</span></div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">headerline</a>++) {</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="comment">/* This is the first header, it MUST be the error code line</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">         or else we consider this to be the body right away! */</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      <span class="keywordtype">int</span> httpversion_major;</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="keywordtype">int</span> rtspversion_major;</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <span class="keywordtype">int</span> nc = 0;</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="preprocessor">#ifdef CURL_DOES_CONVERSIONS</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="preprocessor">#define HEADER1 scratch</span></div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="preprocessor">#define SCRATCHSIZE 21</span></div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> res;</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="keywordtype">char</span> scratch[SCRATCHSIZE + 1]; <span class="comment">/* &quot;HTTP/major.minor 123&quot; */</span></div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;      <span class="comment">/* We can&#39;t really convert this yet because we</span></div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="comment">         don&#39;t know if it&#39;s the 1st header line or the body.</span></div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment">         So we do a partial conversion into a scratch area,</span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">         leaving the data at k-&gt;p as-is.</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      strncpy(&amp;scratch[0], k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, SCRATCHSIZE);</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      scratch[SCRATCHSIZE] = 0; <span class="comment">/* null terminate */</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      res = <a class="code" href="non-ascii_8h.html#a7f86eb6237ad590baa14e82fae9d6d83">Curl_convert_from_network</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                                      &amp;scratch[0],</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                                      SCRATCHSIZE);</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      <span class="keywordflow">if</span>(res)</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        <span class="comment">/* Curl_convert_from_network calls failf if unsuccessful */</span></div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="preprocessor">#define HEADER1 k-&gt;p </span><span class="comment">/* no conversion needed, just use k-&gt;p */</span><span class="preprocessor"></span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DOES_CONVERSIONS */</span><span class="preprocessor"></span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="urldata_8h.html#a9d346cfcc0046f6c6ed206bde086ab2d">PROTO_FAMILY_HTTP</a>) {</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">         * https://tools.ietf.org/html/rfc7230#section-3.1.2</span></div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">         * The response code is always a three-digit number in HTTP as the spec</span></div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">         * says. We try to allow any number here, but we cannot make</span></div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="comment">         * guarantees on future behaviors since it isn&#39;t within the protocol.</span></div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        <span class="keywordtype">char</span> separator;</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        nc = sscanf(<a class="code" href="http_8c.html#a5c85b5569e59e6f859ac92b0ba3c0920">HEADER1</a>,</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                    <span class="stringliteral">&quot; HTTP/%1d.%1d%c%3d&quot;</span>,</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                    &amp;httpversion_major,</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                    &amp;conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a>,</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                    &amp;separator,</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                    &amp;k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>);</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        <span class="keywordflow">if</span>(nc == 1 &amp;&amp; httpversion_major == 2 &amp;&amp;</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;           1 == sscanf(<a class="code" href="http_8c.html#a5c85b5569e59e6f859ac92b0ba3c0920">HEADER1</a>, <span class="stringliteral">&quot; HTTP/2 %d&quot;</span>, &amp;k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>)) {</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 0;</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;          nc = 4;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;          separator = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        }</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        <span class="keywordflow">if</span>((nc == 4) &amp;&amp; (<span class="charliteral">&#39; &#39;</span> == separator)) {</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> += 10 * httpversion_major;</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;          <span class="keywordflow">if</span>(k-&gt;<a class="code" href="struct_single_request.html#aedc2a164dd5fddd6e7420472035424ef">upgr101</a> == <a class="code" href="urldata_8h.html#a7d475a6687b678c11cce8221797e46dda5438320c9e5960ae04acfd8d213faa57">UPGR101_RECEIVED</a>) {</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            <span class="comment">/* supposedly upgraded to http2 now */</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> != 20)</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;              <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Lying server, not serving HTTP/2\n&quot;</span>);</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;          }</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        }</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!nc) {</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;          <span class="comment">/* this is the real world, not a Nirvana</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment">             NCSA 1.5.x returns this crap when asked for HTTP/1.1</span></div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;          nc = sscanf(<a class="code" href="http_8c.html#a5c85b5569e59e6f859ac92b0ba3c0920">HEADER1</a>, <span class="stringliteral">&quot; HTTP %3d&quot;</span>, &amp;k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>);</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 10;</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;          <span class="comment">/* If user has set option HTTP200ALIASES,</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="comment">             compare header line against list of aliases</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;          <span class="keywordflow">if</span>(!nc) {</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;            <span class="keywordflow">if</span>(checkhttpprefix(<a class="code" href="structdata.html">data</a>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>) == <a class="code" href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a>) {</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;              nc = 1;</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;              k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> = 200;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;              conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 10;</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            }</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;          }</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        }</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;          <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Unsupported HTTP version in response\n&quot;</span>);</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a>;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        }</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      }</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a>) {</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        <span class="keywordtype">char</span> separator;</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        nc = sscanf(<a class="code" href="http_8c.html#a5c85b5569e59e6f859ac92b0ba3c0920">HEADER1</a>,</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                    <span class="stringliteral">&quot; RTSP/%1d.%1d%c%3d&quot;</span>,</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                    &amp;rtspversion_major,</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                    &amp;conn-&gt;<a class="code" href="structconnectdata.html#a7fc9d1959e8ab749e8cb00ba91063b5b">rtspversion</a>,</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                    &amp;separator,</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                    &amp;k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>);</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;        <span class="keywordflow">if</span>((nc == 4) &amp;&amp; (<span class="charliteral">&#39; &#39;</span> == separator)) {</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a7fc9d1959e8ab749e8cb00ba91063b5b">rtspversion</a> += 10 * rtspversion_major;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> = 11; <span class="comment">/* For us, RTSP acts like HTTP 1.1 */</span></div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        }</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;          <span class="comment">/* TODO: do we care about the other cases here? */</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;          nc = 0;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;        }</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      }</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      <span class="keywordflow">if</span>(nc) {</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;info.httpcode = k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;info.httpversion = conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a>;</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;state.httpversion ||</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;           <a class="code" href="structdata.html">data</a>-&gt;state.httpversion &gt; conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a>)</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          <span class="comment">/* store the lowest server version we encounter */</span></div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;state.httpversion = conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a>;</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;<span class="comment">         * This code executes as part of processing the header.  As a</span></div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;<span class="comment">         * result, it&#39;s not totally clear how to interpret the</span></div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;<span class="comment">         * response code yet as that depends on what other headers may</span></div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="comment">         * be present.  401 and 407 may be errors, but may be OK</span></div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;<span class="comment">         * depending on how authentication is working.  Other codes</span></div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="comment">         * are definitely errors, so give up here.</span></div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from &amp;&amp; <a class="code" href="structdata.html">data</a>-&gt;set.httpreq == <a class="code" href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a> &amp;&amp;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;             k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> == 416) {</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;          <span class="comment">/* &quot;Requested Range Not Satisfiable&quot;, just proceed and</span></div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">             pretend this is no error */</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a6ded6fbb86cb5457049ff225c7ee8827">ignorebody</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* Avoid appending error msg to good data. */</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        }</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.http_fail_on_error &amp;&amp; (k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &gt;= 400) &amp;&amp;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;           ((k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> != 401) || !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a>) &amp;&amp;</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;           ((k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> != 407) || !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">proxy_user_passwd</a>) ) {</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;          <span class="comment">/* serious error, go home! */</span></div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;          print_http_error(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3">CURLE_HTTP_RETURNED_ERROR</a>;</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;        }</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 10) {</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;          <span class="comment">/* Default action for HTTP/1.0 must be to close, unless</span></div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<span class="comment">             we get one of those fancy headers that tell us the</span></div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="comment">             server keeps it open for us! */</span></div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP 1.0, assume close after body\n&quot;</span>);</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;          <a class="code" href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a>(conn, <span class="stringliteral">&quot;HTTP/1.0 close after body&quot;</span>);</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        }</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 20 ||</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                (k-&gt;<a class="code" href="struct_single_request.html#aedc2a164dd5fddd6e7420472035424ef">upgr101</a> == <a class="code" href="urldata_8h.html#a7d475a6687b678c11cce8221797e46ddaa9c52d61737ee3b48ca077b1f408e8d8">UPGR101_REQUESTED</a> &amp;&amp; k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> == 101)) {</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;          <a class="code" href="curl__setup__once_8h.html#a805079d1643f348afa725659b45b6f87">DEBUGF</a>(<a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP/2 found, allow multiplexing\n&quot;</span>));</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;          <span class="comment">/* HTTP/2 cannot blacklist multiplexing since it is a core</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="comment">             functionality of the protocol */</span></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;          conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a>-&gt;<a class="code" href="structconnectbundle.html#a22977226b49d058b284fe58643165d8b">multiuse</a> = <a class="code" href="conncache_8h.html#ac54a8f8827585a80d5bd688c05e2c6ad">BUNDLE_MULTIPLEX</a>;</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        }</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> &gt;= 11 &amp;&amp;</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                !conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">close</a>) {</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;          <span class="comment">/* If HTTP version is &gt;= 1.1 and connection is persistent</span></div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="comment">             server supports pipelining. */</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;          <a class="code" href="curl__setup__once_8h.html#a805079d1643f348afa725659b45b6f87">DEBUGF</a>(<a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                       <span class="stringliteral">&quot;HTTP 1.1 or later with persistent connection, &quot;</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                       <span class="stringliteral">&quot;pipelining supported\n&quot;</span>));</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;          <span class="comment">/* Activate pipelining if needed */</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;          <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a>) {</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="pipeline_8c.html#ad10d0db7abba34ad41cd6a26eb8e23e9">Curl_pipeline_site_blacklisted</a>(<a class="code" href="structdata.html">data</a>, conn))</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;              conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a>-&gt;<a class="code" href="structconnectbundle.html#a22977226b49d058b284fe58643165d8b">multiuse</a> = <a class="code" href="conncache_8h.html#a3fead10caa803fd2f106fe9916140c73">BUNDLE_PIPELINING</a>;</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;          }</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        }</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;        <span class="keywordflow">switch</span>(k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>) {</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;        <span class="keywordflow">case</span> 204:</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;          <span class="comment">/* (quote from RFC2616, section 10.2.5): The server has</span></div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">           * fulfilled the request but does not need to return an</span></div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="comment">           * entity-body ... The 204 response MUST NOT include a</span></div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;<span class="comment">           * message-body, and thus is always terminated by the first</span></div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="comment">           * empty line after the header fields. */</span></div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;          <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;        <span class="keywordflow">case</span> 304:</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;          <span class="comment">/* (quote from RFC2616, section 10.3.5): The 304 response</span></div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="comment">           * MUST NOT contain a message-body, and thus is always</span></div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="comment">           * terminated by the first empty line after the header</span></div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="comment">           * fields.  */</span></div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.timecondition)</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;info.timecond = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a> = 0;</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">maxdownload</a> = 0;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;          k-&gt;<a class="code" href="struct_single_request.html#aa15f48119eaea7af17077d2d232d1046">ignorecl</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* ignore Content-Length headers */</span></div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;          <span class="comment">/* nothing */</span></div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;        }</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      }</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a97c471abe695b617c7695de635b49440">header</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;   <span class="comment">/* this is not a header line */</span></div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      }</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    }</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="non-ascii_8h.html#a7f86eb6237ad590baa14e82fae9d6d83">Curl_convert_from_network</a>(<a class="code" href="structdata.html">data</a>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, strlen(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>));</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    <span class="comment">/* Curl_convert_from_network calls failf if unsuccessful */</span></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="comment">/* Check for Content-Length: header lines to get size */</span></div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#aa15f48119eaea7af17077d2d232d1046">ignorecl</a> &amp;&amp; !<a class="code" href="structdata.html">data</a>-&gt;set.ignorecl &amp;&amp;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;       <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Length:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> contentlength;</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      <a class="code" href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437f">CURLofft</a> offt = <a class="code" href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + 15, NULL, 10, &amp;contentlength);</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;      <span class="keywordflow">if</span>(offt == <a class="code" href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa477bb16832a9729f9e07669908f16445">CURL_OFFT_OK</a>) {</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.max_filesize &amp;&amp;</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;           contentlength &gt; <a class="code" href="structdata.html">data</a>-&gt;set.max_filesize) {</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;          <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Maximum file size exceeded&quot;</span>);</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a575639ff443233dd9af2c1835192ad3a">CURLE_FILESIZE_EXCEEDED</a>;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        }</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a> = contentlength;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">maxdownload</a> = k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a>;</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;        <span class="comment">/* we set the progress download size already at this point</span></div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="comment">           just to make it easier for apps/callbacks to extract this</span></div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="comment">           info as soon as possible */</span></div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        <a class="code" href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a>(<a class="code" href="structdata.html">data</a>, k-&gt;<a class="code" href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">size</a>);</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      }</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(offt == <a class="code" href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121">CURL_OFFT_FLOW</a>) {</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="comment">/* out of range */</span></div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.max_filesize) {</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;          <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Maximum file size exceeded&quot;</span>);</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a575639ff443233dd9af2c1835192ad3a">CURLE_FILESIZE_EXCEEDED</a>;</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;        }</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;        <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;overflow content-length&quot;</span>);</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Overflow Content-Length: value!\n&quot;</span>);</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      }</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="comment">/* negative or just rubbish - bad HTTP */</span></div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Invalid Content-Length: value&quot;</span>);</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9c2850d0cbdb8743ad056150ca51e191">CURLE_WEIRD_SERVER_REPLY</a>;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      }</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    }</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="comment">/* check for Content-Type: header lines to get the MIME-type */</span></div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Type:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <span class="keywordtype">char</span> *contenttype = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>);</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="keywordflow">if</span>(!contenttype)</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <span class="keywordflow">if</span>(!*contenttype)</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <span class="comment">/* ignore empty data */</span></div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(contenttype);</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="structdata.html">data</a>-&gt;info.contenttype);</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;info.contenttype = contenttype;</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      }</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    }</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Server:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> &lt; 20) {</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        <span class="comment">/* only do this for non-h2 servers */</span></div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        <span class="keywordtype">char</span> *server_name = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>);</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        <span class="comment">/* Turn off pipelining if the server version is blacklisted  */</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a> &amp;&amp; (conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a>-&gt;<a class="code" href="structconnectbundle.html#a22977226b49d058b284fe58643165d8b">multiuse</a> == <a class="code" href="conncache_8h.html#a3fead10caa803fd2f106fe9916140c73">BUNDLE_PIPELINING</a>)) {</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="pipeline_8c.html#aced63ee23828ec4458ec8987be090054">Curl_pipeline_server_blacklisted</a>(<a class="code" href="structdata.html">data</a>, server_name))</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">bundle</a>-&gt;<a class="code" href="structconnectbundle.html#a22977226b49d058b284fe58643165d8b">multiuse</a> = <a class="code" href="conncache_8h.html#aee2246f67704d9b14c7a9d2ffdf1644b">BUNDLE_NO_MULTIUSE</a>;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        }</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(server_name);</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;      }</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    }</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 10) &amp;&amp;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp;</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;            <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>,</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                               <span class="stringliteral">&quot;Proxy-Connection:&quot;</span>, <span class="stringliteral">&quot;keep-alive&quot;</span>)) {</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;<span class="comment">       * When a HTTP/1.0 reply comes when using a proxy, the</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="comment">       * &#39;Proxy-Connection: keep-alive&#39; line tells us the</span></div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="comment">       * connection will be kept alive for our pleasure.</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="comment">       * Default action for 1.0 is to close.</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      <a class="code" href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a>(conn, <span class="stringliteral">&quot;Proxy-Connection keep-alive&quot;</span>); <span class="comment">/* don&#39;t close */</span></div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP/1.0 proxy connection set to keep alive!\n&quot;</span>);</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    }</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 11) &amp;&amp;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">httpproxy</a> &amp;&amp;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;            <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>,</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                               <span class="stringliteral">&quot;Proxy-Connection:&quot;</span>, <span class="stringliteral">&quot;close&quot;</span>)) {</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="comment">       * We get a HTTP/1.1 response from a proxy and it says it&#39;ll</span></div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;<span class="comment">       * close down after this transfer.</span></div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      <a class="code" href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a>(conn, <span class="stringliteral">&quot;Proxy-Connection: asked to close after done&quot;</span>);</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP/1.1 proxy connection set close!\n&quot;</span>);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;    }</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((conn-&gt;<a class="code" href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">httpversion</a> == 10) &amp;&amp;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            <a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, <span class="stringliteral">&quot;Connection:&quot;</span>, <span class="stringliteral">&quot;keep-alive&quot;</span>)) {</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="comment">       * A HTTP/1.0 reply with the &#39;Connection: keep-alive&#39; line</span></div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">       * tells us the connection will be kept alive for our</span></div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="comment">       * pleasure.  Default action for 1.0 is to close.</span></div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="comment">       * [RFC2068, section 19.7.1] */</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <a class="code" href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a>(conn, <span class="stringliteral">&quot;Connection keep-alive&quot;</span>);</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;HTTP/1.0 connection set to keep alive!\n&quot;</span>);</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    }</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, <span class="stringliteral">&quot;Connection:&quot;</span>, <span class="stringliteral">&quot;close&quot;</span>)) {</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment">       * [RFC 2616, section 8.1.2.1]</span></div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="comment">       * &quot;Connection: close&quot; is HTTP/1.1 language and means that</span></div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="comment">       * the connection will close when this request has been</span></div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;<span class="comment">       * served.</span></div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <a class="code" href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a>(conn, <span class="stringliteral">&quot;Connection: close used&quot;</span>);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    }</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Transfer-Encoding:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;      <span class="comment">/* One or more encodings. We check for chunked and/or a compression</span></div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="comment">         algorithm. */</span></div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="comment">       * [RFC 2616, section 3.6.1] A &#39;chunked&#39; transfer encoding</span></div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">       * means that the server will send a series of &quot;chunks&quot;. Each</span></div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="comment">       * chunk starts with line with info (including size of the</span></div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;<span class="comment">       * coming block) (terminated with CRLF), then a block of data</span></div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment">       * with the previously mentioned size. There can be any amount</span></div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment">       * of chunks, and a chunk-data set to zero signals the</span></div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">       * end-of-chunks. */</span></div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a>(conn, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + 18, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    }</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Encoding:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) &amp;&amp;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a>]) {</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="comment">       * Process Content-Encoding. Look for the values: identity,</span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">       * gzip, deflate, compress, x-gzip and x-compress. x-gzip and</span></div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="comment">       * x-compress are the same as gzip and compress. (Sec 3.5 RFC</span></div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">       * 2616). zlib cannot handle compress.  However, errors are</span></div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment">       * handled further down when the response body is processed</span></div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a>(conn, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + 17, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    }</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Content-Range:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      <span class="comment">/* Content-Range: bytes [num]-</span></div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="comment">         Content-Range: bytes: [num]-</span></div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">         Content-Range: [num]-</span></div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="comment">         Content-Range: [asterisk]/[total]</span></div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="comment">         The second format was added since Sun&#39;s webserver</span></div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment">         JavaWebServer/1.1.1 obviously sends the header this way!</span></div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment">         The third added since some servers use that!</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment">         The forth means the requested range was unsatisfied.</span></div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + 14;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="comment">/* Move forward until first digit or asterisk */</span></div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      <span class="keywordflow">while</span>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> &amp;&amp; !<a class="code" href="curl__ctype_8h.html#acc3e9b1176bd8c62c4fe0e017007e719">ISDIGIT</a>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>) &amp;&amp; *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> != <span class="charliteral">&#39;*&#39;</span>)</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;        <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++;</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;      <span class="comment">/* if it truly stopped on a digit */</span></div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="curl__ctype_8h.html#acc3e9b1176bd8c62c4fe0e017007e719">ISDIGIT</a>(*<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)) {</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, NULL, 10, &amp;k-&gt;<a class="code" href="struct_single_request.html#a4e848ac3b0bc1ad154534e607c1db87e">offset</a>)) {</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.resume_from == k-&gt;<a class="code" href="struct_single_request.html#a4e848ac3b0bc1ad154534e607c1db87e">offset</a>)</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            <span class="comment">/* we asked for a resume and we got it */</span></div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;            k-&gt;<a class="code" href="struct_single_request.html#ac259c8cd70d58252f455cf673e4d9df9">content_range</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        }</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      }</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.resume_from = 0; <span class="comment">/* get everything */</span></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    }</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_COOKIES)</span></div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;cookies &amp;&amp;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;            <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Set-Cookie:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>)) {</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>,</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                      <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <a class="code" href="cookie_8c.html#a6e800bf3fd9b6cea2a826408bcdf235c">Curl_cookie_add</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                      <a class="code" href="structdata.html">data</a>-&gt;cookies, <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + 11,</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                      <span class="comment">/* If there is a custom-set Host: name, use it</span></div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="comment">                         here, or else use real peer host name. */</span></div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a>?</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                      conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">cookiehost</a>:conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>,</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                      <a class="code" href="structdata.html">data</a>-&gt;state.up.path);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a>);</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;    }</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Last-Modified:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) &amp;&amp;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;            (<a class="code" href="structdata.html">data</a>-&gt;set.timecondition || <a class="code" href="structdata.html">data</a>-&gt;set.get_filetime) ) {</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      time_t secs = <a class="code" href="retry-max-time_8d.html#a612021c6b1f447b49053406818ef4ee6">time</a>(NULL);</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;      k-&gt;<a class="code" href="struct_single_request.html#a9da5df2779ae21bdf94e14359214dbcf">timeofdoc</a> = <a class="code" href="curl_8h.html#ad4dd80e15a6f20cdd628a7f222fcb8eb">curl_getdate</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a> + strlen(<span class="stringliteral">&quot;Last-Modified:&quot;</span>),</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;                                  &amp;secs);</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.get_filetime)</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;info.filetime = k-&gt;<a class="code" href="struct_single_request.html#a9da5df2779ae21bdf94e14359214dbcf">timeofdoc</a>;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    }</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;WWW-Authenticate:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) &amp;&amp;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;             (401 == k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>)) ||</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            (<a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Proxy-authenticate:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) &amp;&amp;</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;             (407 == k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a>))) {</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> = (k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> == 407) ? <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> : <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="structauth.html">auth</a> = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>);</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="structauth.html">auth</a>)</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="http_8c.html#aae41d68de9f7b8f248f3d52f5b14e3f6">Curl_http_input_auth</a>(conn, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>, <a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="structauth.html">auth</a>);</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    }</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &gt;= 300 &amp;&amp; k-&gt;<a class="code" href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">httpcode</a> &lt; 400) &amp;&amp;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;            <a class="code" href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a>(<span class="stringliteral">&quot;Location:&quot;</span>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>) &amp;&amp;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;            !<a class="code" href="structdata.html">data</a>-&gt;req.location) {</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      <span class="comment">/* this is the URL that the server advises us to use instead */</span></div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">location</a> = <a class="code" href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a>(k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>);</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">location</a>)</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      <span class="keywordflow">if</span>(!*<a class="code" href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">location</a>)</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        <span class="comment">/* ignore empty data */</span></div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">location</a>);</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.location = <a class="code" href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">location</a>;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.http_follow_location) {</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;          <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl);</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;req.newurl = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="structdata.html">data</a>-&gt;req.location); <span class="comment">/* clone */</span></div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="structdata.html">data</a>-&gt;req.newurl)</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;          <span class="comment">/* some cases of POST and PUT etc needs to rewind the data</span></div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="comment">             stream at this point */</span></div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = http_perhapsrewind(conn);</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        }</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      }</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    }</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">protocol</a> &amp; <a class="code" href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a>) {</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="lib_2rtsp_8c.html#afa54e7575f81e2d69ecdb747a10dcbba">Curl_rtsp_parseheader</a>(conn, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>);</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    }</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment">     * End of header-checks. Write them to the client.</span></div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    writetype = <a class="code" href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a>;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.include_header)</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;      writetype |= <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>;</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;set.verbose)</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <a class="code" href="sendf_8c.html#a8b0f0a06869b888abb80a069182d0d5a">Curl_debug</a>(<a class="code" href="structdata.html">data</a>, <a class="code" href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a7d8a29d35245d116245a1bd1f31f0175">CURLINFO_HEADER_IN</a>, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, (<span class="keywordtype">size_t</span>)k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>);</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, writetype, k-&gt;<a class="code" href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">p</a>, k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>);</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;info.header_size += (long)k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>;</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.headerbytecount += (<span class="keywordtype">long</span>)k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a>;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="comment">/* reset hbufp pointer &amp;&amp; hbuflen */</span></div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">hbufp</a> = <a class="code" href="structdata.html">data</a>-&gt;state.headerbuff;</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">hbuflen</a> = 0;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  }</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <span class="keywordflow">while</span>(*k-&gt;<a class="code" href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">str</a>); <span class="comment">/* header line within buffer */</span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  <span class="comment">/* We might have reached the end of the header part here, but</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment">     there might be a non-header part left in the end of the read</span></div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="comment">     buffer. */</span></div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;}</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_HTTP */</span><span class="preprocessor"></span></div><div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_ab315df4d7a2183c40c2bf882c09e3832"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#ab315df4d7a2183c40c2bf882c09e3832">connectdata::dynamically_allocated_data::rangeline</a></div><div class="ttdeci">char * rangeline</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00931">urldata.h:931</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="struct_pure_info_html_af56f4ff8e248728ed7cc4ea5a8265b09"><div class="ttname"><a href="struct_pure_info.html#af56f4ff8e248728ed7cc4ea5a8265b09">PureInfo::conn_primary_ip</a></div><div class="ttdeci">char conn_primary_ip[MAX_IPADR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01070">urldata.h:1070</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8ab1850fbcf712c1fa244036e72aee74a4"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ab1850fbcf712c1fa244036e72aee74a4">HTTPREQ_OPTIONS</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01140">urldata.h:1140</a></div></div>
<div class="ttc" id="struct_connect_bits_html_ad6024fcc7a2aefd8d8d1359f9ae7955d"><div class="ttname"><a href="struct_connect_bits.html#ad6024fcc7a2aefd8d8d1359f9ae7955d">ConnectBits::proxy</a></div><div class="ttdeci">bool proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00387">urldata.h:387</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_ad820faf61489113ffbe96f23040c02a2"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#ad820faf61489113ffbe96f23040c02a2">connectdata::dynamically_allocated_data::te</a></div><div class="ttdeci">char * te</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00936">urldata.h:936</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a15aced4a015c44ff454787debee23520"><div class="ttname"><a href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">Curl_easy::state</a></div><div class="ttdeci">struct UrlState state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01795">urldata.h:1795</a></div></div>
<div class="ttc" id="urldata_8h_html_aed268b90593d1d852e7468aca80e7656"><div class="ttname"><a href="urldata_8h.html#aed268b90593d1d852e7468aca80e7656">PROTOPT_ALPN_NPN</a></div><div class="ttdeci">#define PROTOPT_ALPN_NPN</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00721">urldata.h:721</a></div></div>
<div class="ttc" id="url_8h_html_a5eef24a1090105370832043771d44f1e"><div class="ttname"><a href="url_8h.html#a5eef24a1090105370832043771d44f1e">CONNECT_FIRSTSOCKET_PROXY_SSL</a></div><div class="ttdeci">#define CONNECT_FIRSTSOCKET_PROXY_SSL()</div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00103">url.h:103</a></div></div>
<div class="ttc" id="http_8c_html_a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75"><div class="ttname"><a href="http_8c.html#a5e8926572799ef0618c27df845d36395a8784710c767afb4232082a6570164a75">STATUS_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l02946">http.c:2946</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_af03324bf31aec4772357d7d826ca75d9"><div class="ttname"><a href="struct_h_t_t_p.html#af03324bf31aec4772357d7d826ca75d9">HTTP::sending</a></div><div class="ttdeci">enum HTTP::@38 sending</div></div>
<div class="ttc" id="ftp_8c_html_a77812d4945cd21094debbd06962f0f01"><div class="ttname"><a href="ftp_8c.html#a77812d4945cd21094debbd06962f0f01">state</a></div><div class="ttdeci">#define state(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="ftp_8c_source.html#l00101">ftp.c:101</a></div></div>
<div class="ttc" id="sendf_8h_html_aae18389dfefc98a5057629f6a46fd78f"><div class="ttname"><a href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a></div><div class="ttdeci">#define CLIENTWRITE_BODY</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00050">sendf.h:50</a></div></div>
<div class="ttc" id="curl_8h_html_a4c4a3046bce0da437f299072f489bc02"><div class="ttname"><a href="curl_8h.html#a4c4a3046bce0da437f299072f489bc02">CURLPROTO_HTTP</a></div><div class="ttdeci">#define CURLPROTO_HTTP</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00865">curl.h:865</a></div></div>
<div class="ttc" id="struct_curl__easy_html_ae5487e7b1b5e91d240646325c575fd0c"><div class="ttname"><a href="struct_curl__easy.html#ae5487e7b1b5e91d240646325c575fd0c">Curl_easy::numsocks</a></div><div class="ttdeci">int numsocks</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01774">urldata.h:1774</a></div></div>
<div class="ttc" id="formdata_8h_html"><div class="ttname"><a href="formdata_8h.html">formdata.h</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a7a7b20d08be448324d83ed41df90adfb"><div class="ttname"><a href="struct_connect_bits.html#a7a7b20d08be448324d83ed41df90adfb">ConnectBits::httpproxy</a></div><div class="ttdeci">bool httpproxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00388">urldata.h:388</a></div></div>
<div class="ttc" id="share_8h_html"><div class="ttname"><a href="share_8h.html">share.h</a></div></div>
<div class="ttc" id="structconnectdata_html_a9312f162d29fe7f59bc2b5dbeda85d9d"><div class="ttname"><a href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">connectdata::bits</a></div><div class="ttdeci">struct ConnectBits bits</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00894">urldata.h:894</a></div></div>
<div class="ttc" id="struct_curl__send__buffer_html"><div class="ttname"><a href="struct_curl__send__buffer.html">Curl_send_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00053">http.h:53</a></div></div>
<div class="ttc" id="curl_8h_html_adbc451757ed5aeebdff70d9517e9ff49"><div class="ttname"><a href="curl_8h.html#adbc451757ed5aeebdff70d9517e9ff49">curl_mime_headers</a></div><div class="ttdeci">CURL_EXTERN CURLcode curl_mime_headers(curl_mimepart *part, struct curl_slist *headers, int take_ownership)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01436">mime.c:1436</a></div></div>
<div class="ttc" id="parsedate_8c_html_afbefdd1c70bc7fde8f2369a4cf46a62f"><div class="ttname"><a href="parsedate_8c.html#afbefdd1c70bc7fde8f2369a4cf46a62f">Curl_wkday</a></div><div class="ttdeci">const char *const Curl_wkday[]</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00085">parsedate.c:85</a></div></div>
<div class="ttc" id="strtoofft_8h_html_a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121"><div class="ttname"><a href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa89818840af17cd9066388aca5f24a121">CURL_OFFT_FLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8h_source.html#l00045">strtoofft.h:45</a></div></div>
<div class="ttc" id="curl_8h_html_af7074ca58279ac7ad8f78b9954a31160"><div class="ttname"><a href="curl_8h.html#af7074ca58279ac7ad8f78b9954a31160">CURL_SEEKFUNC_OK</a></div><div class="ttdeci">#define CURL_SEEKFUNC_OK</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00343">curl.h:343</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a47a7594226909fde48bb7035956fdfa9"><div class="ttname"><a href="struct_h_t_t_p.html#a47a7594226909fde48bb7035956fdfa9">HTTP::form</a></div><div class="ttdeci">curl_mimepart form</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00143">http.h:143</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8af3836f82d9715e1fe9970e87daaccfb3"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8af3836f82d9715e1fe9970e87daaccfb3">HTTPREQ_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01133">urldata.h:1133</a></div></div>
<div class="ttc" id="http_8c_html_aff2e5d77b1c52a19bb70081af429bda2"><div class="ttname"><a href="http_8c.html#aff2e5d77b1c52a19bb70081af429bda2">Curl_add_buffer</a></div><div class="ttdeci">CURLcode Curl_add_buffer(Curl_send_buffer **inp, const void *inptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01299">http.c:1299</a></div></div>
<div class="ttc" id="struct_cookie_html_a2d9e794ef1e543d4cedab22acf50717b"><div class="ttname"><a href="struct_cookie.html#a2d9e794ef1e543d4cedab22acf50717b">Cookie::next</a></div><div class="ttdeci">struct Cookie * next</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00029">cookie.h:29</a></div></div>
<div class="ttc" id="http__ntlm_8h_html"><div class="ttname"><a href="http__ntlm_8h.html">http_ntlm.h</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="urlapi_8h_html_a41c5e8b4caf610a0984ef4473ca4163e"><div class="ttname"><a href="urlapi_8h.html#a41c5e8b4caf610a0984ef4473ca4163e">curl_url_cleanup</a></div><div class="ttdeci">CURL_EXTERN void curl_url_cleanup(CURLU *handle)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00884">urlapi.c:884</a></div></div>
<div class="ttc" id="strtoofft_8h_html_a515bb1ee04e33ae6fdb4d80dd897437fa477bb16832a9729f9e07669908f16445"><div class="ttname"><a href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437fa477bb16832a9729f9e07669908f16445">CURL_OFFT_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8h_source.html#l00044">strtoofft.h:44</a></div></div>
<div class="ttc" id="curl_8h_html_a71a1fde704d583a1f5dc57f77f1e957b"><div class="ttname"><a href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a></div><div class="ttdeci">#define CURLAUTH_BASIC</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00706">curl.h:706</a></div></div>
<div class="ttc" id="http_8c_html_aae41d68de9f7b8f248f3d52f5b14e3f6"><div class="ttname"><a href="http_8c.html#aae41d68de9f7b8f248f3d52f5b14e3f6">Curl_http_input_auth</a></div><div class="ttdeci">CURLcode Curl_http_input_auth(struct connectdata *conn, bool proxy, const char *auth)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00786">http.c:786</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a0a15328bccb6e0baf3d1c6150eb39449a5d37d933155aed027aad828ec1245e09"><div class="ttname"><a href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449a5d37d933155aed027aad828ec1245e09">EXP100_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00494">urldata.h:494</a></div></div>
<div class="ttc" id="struct_single_request_html_a2882cf5772c7b4c4da2042900b24c572"><div class="ttname"><a href="struct_single_request.html#a2882cf5772c7b4c4da2042900b24c572">SingleRequest::headerline</a></div><div class="ttdeci">int headerline</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00561">urldata.h:561</a></div></div>
<div class="ttc" id="struct_single_request_html_a8e8fb4ea5e024d91a2c1ee812694254a"><div class="ttname"><a href="struct_single_request.html#a8e8fb4ea5e024d91a2c1ee812694254a">SingleRequest::upload_done</a></div><div class="ttdeci">bool upload_done</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00588">urldata.h:588</a></div></div>
<div class="ttc" id="progress_8c_html_a9458c724bbe21e16b9abf8f696a3916a"><div class="ttname"><a href="progress_8c.html#a9458c724bbe21e16b9abf8f696a3916a">Curl_pgrsSetUploadCounter</a></div><div class="ttdeci">void Curl_pgrsSetUploadCounter(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00336">progress.c:336</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a0e5145164e8e2a9d6eb43eef1c71f1af"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a0e5145164e8e2a9d6eb43eef1c71f1af">CURLE_BAD_FUNCTION_ARGUMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00513">curl.h:513</a></div></div>
<div class="ttc" id="connect_8h_html_a0f98be540dd5a5f56c9ec98dc2489661"><div class="ttname"><a href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a></div><div class="ttdeci">#define connclose(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8h_source.html#l00145">connect.h:145</a></div></div>
<div class="ttc" id="curl_8h_html_a9704d2633927f77efaa3e3c6f1c23a14a7d8a29d35245d116245a1bd1f31f0175"><div class="ttname"><a href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a7d8a29d35245d116245a1bd1f31f0175">CURLINFO_HEADER_IN</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00434">curl.h:434</a></div></div>
<div class="ttc" id="noproxy_8d_html_a62c6b6923733b98c3d4f01e07d04d958"><div class="ttname"><a href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a></div><div class="ttdeci">Long if one is specified.The only wildcard is a single which matches all and effectively disables the proxy.Each name in this list is matched as either a domain which contains the or the hostname itself.For local.com would match local.local.and www.local.but not www.notlocal.com.This option overrides the environment variables that disable the proxy.If there s an environment variable disabling a proxy</div><div class="ttdef"><b>Definition:</b> <a href="noproxy_8d_source.html#l00006">noproxy.d:6</a></div></div>
<div class="ttc" id="struct_single_request_html_aedc2a164dd5fddd6e7420472035424ef"><div class="ttname"><a href="struct_single_request.html#aedc2a164dd5fddd6e7420472035424ef">SingleRequest::upgr101</a></div><div class="ttdeci">enum upgrade101 upgr101</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00576">urldata.h:576</a></div></div>
<div class="ttc" id="multi_8c_html_ab12ca318b29f9bd535afc9bea98b82bb"><div class="ttname"><a href="multi_8c.html#ab12ca318b29f9bd535afc9bea98b82bb">Curl_expire_done</a></div><div class="ttdeci">void Curl_expire_done(struct Curl_easy *data, expire_id id)</div><div class="ttdef"><b>Definition:</b> <a href="multi_8c_source.html#l03059">multi.c:3059</a></div></div>
<div class="ttc" id="urldata_8h_html_a0a15328bccb6e0baf3d1c6150eb39449"><div class="ttname"><a href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449">expect100</a></div><div class="ttdeci">expect100</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00489">urldata.h:489</a></div></div>
<div class="ttc" id="struct_url_state_html_ade97ad375f82a96396846a9b2aa06716"><div class="ttname"><a href="struct_url_state.html#ade97ad375f82a96396846a9b2aa06716">UrlState::in</a></div><div class="ttdeci">void * in</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01355">urldata.h:1355</a></div></div>
<div class="ttc" id="pipeline_8c_html_ad10d0db7abba34ad41cd6a26eb8e23e9"><div class="ttname"><a href="pipeline_8c.html#ad10d0db7abba34ad41cd6a26eb8e23e9">Curl_pipeline_site_blacklisted</a></div><div class="ttdeci">bool Curl_pipeline_site_blacklisted(struct Curl_easy *handle, struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="pipeline_8c_source.html#l00165">pipeline.c:165</a></div></div>
<div class="ttc" id="structcurl__slist_html"><div class="ttname"><a href="structcurl__slist.html">curl_slist</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02394">curl.h:2394</a></div></div>
<div class="ttc" id="struct_single_request_html_a8516340c7835dfd47166418da27c40a0"><div class="ttname"><a href="struct_single_request.html#a8516340c7835dfd47166418da27c40a0">SingleRequest::maxdownload</a></div><div class="ttdeci">curl_off_t maxdownload</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00537">urldata.h:537</a></div></div>
<div class="ttc" id="http_8h_html_a940ebf8ac84737c7753b5fe6d8472563"><div class="ttname"><a href="http_8h.html#a940ebf8ac84737c7753b5fe6d8472563">MAX_INITIAL_POST_SIZE</a></div><div class="ttdeci">#define MAX_INITIAL_POST_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00115">http.h:115</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a6fbb8f80996d3921279d0314179a4958"><div class="ttname"><a href="struct_connect_bits.html#a6fbb8f80996d3921279d0314179a4958">ConnectBits::protoconnstart</a></div><div class="ttdeci">bool protoconnstart</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00400">urldata.h:400</a></div></div>
<div class="ttc" id="struct_single_request_html_a0ba1903778006c214622044083c106c4"><div class="ttname"><a href="struct_single_request.html#a0ba1903778006c214622044083c106c4">SingleRequest::forbidchunk</a></div><div class="ttdeci">bool forbidchunk</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00615">urldata.h:615</a></div></div>
<div class="ttc" id="structconnectdata_html_a0c1824e51ef689efcfddaa09a72c788b"><div class="ttname"><a href="structconnectdata.html#a0c1824e51ef689efcfddaa09a72c788b">connectdata::negnpn</a></div><div class="ttdeci">int negnpn</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01032">urldata.h:1032</a></div></div>
<div class="ttc" id="curl_8h_html_a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95"><div class="ttname"><a href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02619">curl.h:2619</a></div></div>
<div class="ttc" id="urldata_8h_html_a56b23efdd8d04b0179b52224a251bcb7"><div class="ttname"><a href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a></div><div class="ttdeci">#define FIRSTSOCKET</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00480">urldata.h:480</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8">Curl_HttpReq</a></div><div class="ttdeci">Curl_HttpReq</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01132">urldata.h:1132</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a4d15176e17f7991a11ced10b22c9b091"><div class="ttname"><a href="struct_h_t_t_p.html#a4d15176e17f7991a11ced10b22c9b091">HTTP::send_buffer</a></div><div class="ttdeci">Curl_send_buffer * send_buffer</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00160">http.h:160</a></div></div>
<div class="ttc" id="connect_8h_html_a39c490691a02b6643d80882c12b189ed"><div class="ttname"><a href="connect_8h.html#a39c490691a02b6643d80882c12b189ed">streamclose</a></div><div class="ttdeci">#define streamclose(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8h_source.html#l00144">connect.h:144</a></div></div>
<div class="ttc" id="curl_8h_html_abc5c98fcc1211af2b80116dd6e0a035dabf20980d1f881523f95f620ddcce5667"><div class="ttname"><a href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035dabf20980d1f881523f95f620ddcce5667">CURL_HTTP_VERSION_1_0</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01925">curl.h:1925</a></div></div>
<div class="ttc" id="http_8c_html_a3827f32165b3a89ed16bb104eb00e185"><div class="ttname"><a href="http_8c.html#a3827f32165b3a89ed16bb104eb00e185">Curl_http_auth_act</a></div><div class="ttdeci">CURLcode Curl_http_auth_act(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00505">http.c:505</a></div></div>
<div class="ttc" id="curl_8h_html_ada0bbe252b7b370ef4e135b93b2fe71e"><div class="ttname"><a href="curl_8h.html#ada0bbe252b7b370ef4e135b93b2fe71e">CURL_SOCKET_BAD</a></div><div class="ttdeci">#define CURL_SOCKET_BAD</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00131">curl.h:131</a></div></div>
<div class="ttc" id="struct_curl__handler_html"><div class="ttname"><a href="struct_curl__handler.html">Curl_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00628">urldata.h:628</a></div></div>
<div class="ttc" id="http__proxy_8h_html"><div class="ttname"><a href="http__proxy_8h.html">http_proxy.h</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a6eae71582b7872d0ab88d0227d3561dc"><div class="ttname"><a href="struct_curl__easy.html#a6eae71582b7872d0ab88d0227d3561dc">Curl_easy::info</a></div><div class="ttdeci">struct PureInfo info</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01798">urldata.h:1798</a></div></div>
<div class="ttc" id="retry-max-time_8d_html_a612021c6b1f447b49053406818ef4ee6"><div class="ttname"><a href="retry-max-time_8d.html#a612021c6b1f447b49053406818ef4ee6">time</a></div><div class="ttdeci">Long the request will be made and while it may take longer than this given time period.To limit a single request s maximum time</div><div class="ttdef"><b>Definition:</b> <a href="retry-max-time_8d_source.html#l00008">retry-max-time.d:8</a></div></div>
<div class="ttc" id="http_8c_html_ad61ec452bd9e1973fcbf1a700feecd88"><div class="ttname"><a href="http_8c.html#ad61ec452bd9e1973fcbf1a700feecd88">Curl_add_timecondition</a></div><div class="ttdeci">CURLcode Curl_add_timecondition(struct Curl_easy *data, Curl_send_buffer *req_buffer)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01815">http.c:1815</a></div></div>
<div class="ttc" id="curl_8h_html_a34eb017e0a29378f976becdaa94160d1"><div class="ttname"><a href="curl_8h.html#a34eb017e0a29378f976becdaa94160d1">CURL_SEEKFUNC_CANTSEEK</a></div><div class="ttdeci">#define CURL_SEEKFUNC_CANTSEEK</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00345">curl.h:345</a></div></div>
<div class="ttc" id="struct_single_request_html_a4e848ac3b0bc1ad154534e607c1db87e"><div class="ttname"><a href="struct_single_request.html#a4e848ac3b0bc1ad154534e607c1db87e">SingleRequest::offset</a></div><div class="ttdeci">curl_off_t offset</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00570">urldata.h:570</a></div></div>
<div class="ttc" id="mime_8c_html_a3295a1b4557da56cd25b0a5217183118"><div class="ttname"><a href="mime_8c.html#a3295a1b4557da56cd25b0a5217183118">Curl_mime_cleanpart</a></div><div class="ttdeci">void Curl_mime_cleanpart(curl_mimepart *part)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01100">mime.c:1100</a></div></div>
<div class="ttc" id="struct_url_state_html_ac5458d99c295f52472bde6d1da88f110"><div class="ttname"><a href="struct_url_state.html#ac5458d99c295f52472bde6d1da88f110">UrlState::fread_func</a></div><div class="ttdeci">curl_read_callback fread_func</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01354">urldata.h:1354</a></div></div>
<div class="ttc" id="connect_8h_html"><div class="ttname"><a href="connect_8h.html">connect.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a682b1c9a48ab0eff7ca39e6ee8728bbc"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a682b1c9a48ab0eff7ca39e6ee8728bbc">CURLE_REMOTE_ACCESS_DENIED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00468">curl.h:468</a></div></div>
<div class="ttc" id="structconnectdata_html_a7fc9d1959e8ab749e8cb00ba91063b5b"><div class="ttname"><a href="structconnectdata.html#a7fc9d1959e8ab749e8cb00ba91063b5b">connectdata::rtspversion</a></div><div class="ttdeci">int rtspversion</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00870">urldata.h:870</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="struct_h_t_t_p_1_1back_html_ac2ec3c7f4f2e02717984fdccce274819"><div class="ttname"><a href="struct_h_t_t_p_1_1back.html#ac2ec3c7f4f2e02717984fdccce274819">HTTP::back::postsize</a></div><div class="ttdeci">curl_off_t postsize</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00149">http.h:149</a></div></div>
<div class="ttc" id="http_8c_html_a058a82e5ae8dc800565a9b32d54af85c"><div class="ttname"><a href="http_8c.html#a058a82e5ae8dc800565a9b32d54af85c">Curl_checkProxyheaders</a></div><div class="ttdeci">char * Curl_checkProxyheaders(const struct connectdata *conn, const char *thisheader)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00188">http.c:188</a></div></div>
<div class="ttc" id="http__digest_8h_html"><div class="ttname"><a href="http__digest_8h.html">http_digest.h</a></div></div>
<div class="ttc" id="structcurl__slist_html_a5fe4d926491a1c9b8b9a73c40505f601"><div class="ttname"><a href="structcurl__slist.html#a5fe4d926491a1c9b8b9a73c40505f601">curl_slist::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02395">curl.h:2395</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a36bae112580758d107fbe6bb465f6d0c"><div class="ttname"><a href="struct_connect_bits.html#a36bae112580758d107fbe6bb465f6d0c">ConnectBits::proxy_connect_closed</a></div><div class="ttdeci">bool proxy_connect_closed</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00430">urldata.h:430</a></div></div>
<div class="ttc" id="urldata_8h_html_ad606881f90e46a7ccaa95859a6fdef54afabd35bacd3e2bdb1f3bba2bb4432ddf"><div class="ttname"><a href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54afabd35bacd3e2bdb1f3bba2bb4432ddf">NTLMSTATE_TYPE2</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00299">urldata.h:299</a></div></div>
<div class="ttc" id="struct_single_request_html_a6ca30fe8e465c2b5be16ee98769120b8"><div class="ttname"><a href="struct_single_request.html#a6ca30fe8e465c2b5be16ee98769120b8">SingleRequest::keepon</a></div><div class="ttdeci">int keepon</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00586">urldata.h:586</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="parsedate_8c_html_a4a84c69a44848f5947487bf91f86b733"><div class="ttname"><a href="parsedate_8c.html#a4a84c69a44848f5947487bf91f86b733">Curl_month</a></div><div class="ttdeci">const char *const Curl_month[]</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00090">parsedate.c:90</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="urlapi_8h_html_abfb2378e801e13033e70c3819d8afca1"><div class="ttname"><a href="urlapi_8h.html#abfb2378e801e13033e70c3819d8afca1">curl_url_get</a></div><div class="ttdeci">CURL_EXTERN CURLUcode curl_url_get(CURLU *handle, CURLUPart what, char **part, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00920">urlapi.c:920</a></div></div>
<div class="ttc" id="struct_single_request_html_a6ded6fbb86cb5457049ff225c7ee8827"><div class="ttname"><a href="struct_single_request.html#a6ded6fbb86cb5457049ff225c7ee8827">SingleRequest::ignorebody</a></div><div class="ttdeci">bool ignorebody</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00591">urldata.h:591</a></div></div>
<div class="ttc" id="pipeline_8h_html"><div class="ttname"><a href="pipeline_8h.html">pipeline.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a95d1430b03a5f959134870f3a578eb1d">CURLE_UNSUPPORTED_PROTOCOL</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00459">curl.h:459</a></div></div>
<div class="ttc" id="base64_8c_html_a1208ff63d0b4ca9cead4a3cdefc033c2"><div class="ttname"><a href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a></div><div class="ttdeci">CURLcode Curl_base64_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00290">base64.c:290</a></div></div>
<div class="ttc" id="structconnectdata_html_ae7924587f916593e1fb682086f298ce8"><div class="ttname"><a href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">connectdata::handler</a></div><div class="ttdeci">const struct Curl_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00905">urldata.h:905</a></div></div>
<div class="ttc" id="proto-redir_8d_html_a3663ac2460793e505561ad6c89686402"><div class="ttname"><a href="proto-redir_8d.html#a3663ac2460793e505561ad6c89686402">http</a></div><div class="ttdeci">Long allow only HTTP and HTTPS on http</div><div class="ttdef"><b>Definition:</b> <a href="proto-redir_8d_source.html#l00010">proto-redir.d:10</a></div></div>
<div class="ttc" id="curl_8h_html_a0417440dcb84270d40959fa70aec6f86"><div class="ttname"><a href="curl_8h.html#a0417440dcb84270d40959fa70aec6f86">CURL_MAX_WRITE_SIZE</a></div><div class="ttdeci">#define CURL_MAX_WRITE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00230">curl.h:230</a></div></div>
<div class="ttc" id="cookie_8h_html"><div class="ttname"><a href="cookie_8h.html">cookie.h</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a23d7b88872d6ead46c978b567908d587"><div class="ttname"><a href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a></div><div class="ttdeci">#define DEBUGASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00401">curl_setup_once.h:401</a></div></div>
<div class="ttc" id="urldata_8h_html_a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952"><div class="ttname"><a href="urldata_8h.html#a0a15328bccb6e0baf3d1c6150eb39449ac77a92a2088eebb5391259dcf6eb9952">EXP100_SEND_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00490">urldata.h:490</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a5baeb2599d955f02334cf910943a42b2"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a5baeb2599d955f02334cf910943a42b2">connectdata::dynamically_allocated_data::ref</a></div><div class="ttdeci">char * ref</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00932">urldata.h:932</a></div></div>
<div class="ttc" id="structcurl__mimepart__s_html_a79ba572d92b485a68687b7f9bdf8753f"><div class="ttname"><a href="structcurl__mimepart__s.html#a79ba572d92b485a68687b7f9bdf8753f">curl_mimepart_s::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00119">mime.h:119</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a0249b638827cfaf90270d9c651a1035fa2d7e73a6f2680c507a7cc05dc974e1e4"><div class="ttname"><a href="struct_h_t_t_p.html#a0249b638827cfaf90270d9c651a1035fa2d7e73a6f2680c507a7cc05dc974e1e4">HTTP::HTTPSEND_BODY</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00155">http.h:155</a></div></div>
<div class="ttc" id="conncache_8h_html_aee2246f67704d9b14c7a9d2ffdf1644b"><div class="ttname"><a href="conncache_8h.html#aee2246f67704d9b14c7a9d2ffdf1644b">BUNDLE_NO_MULTIUSE</a></div><div class="ttdeci">#define BUNDLE_NO_MULTIUSE</div><div class="ttdef"><b>Definition:</b> <a href="conncache_8h_source.html#l00041">conncache.h:41</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00526">curl.h:526</a></div></div>
<div class="ttc" id="http_8h_html_ab59be342b3bfa354581f70f00a8b10fc"><div class="ttname"><a href="http_8h.html#ab59be342b3bfa354581f70f00a8b10fc">EXPECT_100_THRESHOLD</a></div><div class="ttdeci">#define EXPECT_100_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00124">http.h:124</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a2b85345ded219e5d8efedcdff780a7ee"><div class="ttname"><a href="struct_h_t_t_p.html#a2b85345ded219e5d8efedcdff780a7ee">HTTP::readbytecount</a></div><div class="ttdeci">curl_off_t readbytecount</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00139">http.h:139</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9c2850d0cbdb8743ad056150ca51e191"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9c2850d0cbdb8743ad056150ca51e191">CURLE_WEIRD_SERVER_REPLY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00467">curl.h:467</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="http2_8h_html_a6e4353e22d54047ab6052b3a8fb49886"><div class="ttname"><a href="http2_8h.html#a6e4353e22d54047ab6052b3a8fb49886">Curl_http2_request_upgrade</a></div><div class="ttdeci">#define Curl_http2_request_upgrade(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00068">http2.h:68</a></div></div>
<div class="ttc" id="urldata_8h_html_ab141b3290dad267f76cd77a91c641146"><div class="ttname"><a href="urldata_8h.html#ab141b3290dad267f76cd77a91c641146">KEEP_RECV</a></div><div class="ttdeci">#define KEEP_RECV</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00458">urldata.h:458</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a1e57e9a26e10b0a871f2539d24994cd3">CURLE_HTTP_RETURNED_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00488">curl.h:488</a></div></div>
<div class="ttc" id="mime_8h_html_ae6faa301cc4b37f4112e9acc984db066"><div class="ttname"><a href="mime_8h.html#ae6faa301cc4b37f4112e9acc984db066">MIME_BODY_ONLY</a></div><div class="ttdeci">#define MIME_BODY_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00031">mime.h:31</a></div></div>
<div class="ttc" id="structcurl__mimepart__s_html_a22079fe812eba3e01a075941c228643f"><div class="ttname"><a href="structcurl__mimepart__s.html#a22079fe812eba3e01a075941c228643f">curl_mimepart_s::kind</a></div><div class="ttdeci">enum mimekind kind</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00106">mime.h:106</a></div></div>
<div class="ttc" id="urldata_8h_html_ad606881f90e46a7ccaa95859a6fdef54ad3a119ab713f7bb6f724b72353157c67"><div class="ttname"><a href="urldata_8h.html#ad606881f90e46a7ccaa95859a6fdef54ad3a119ab713f7bb6f724b72353157c67">NTLMSTATE_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00297">urldata.h:297</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aca19517adc74c705bb46cd5f505f3456">HTTPREQ_HEAD</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01139">urldata.h:1139</a></div></div>
<div class="ttc" id="curl_8h_html_a845d262749bd413d724b58e26f713f25ad13e365aab4f32a0ee193510118f533d"><div class="ttname"><a href="curl_8h.html#a845d262749bd413d724b58e26f713f25ad13e365aab4f32a0ee193510118f533d">CURL_TIMECOND_IFMODSINCE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02017">curl.h:2017</a></div></div>
<div class="ttc" id="struct_pure_info_html_a3a794f84858062e5523ec92611f575a4"><div class="ttname"><a href="struct_pure_info.html#a3a794f84858062e5523ec92611f575a4">PureInfo::conn_local_ip</a></div><div class="ttdeci">char conn_local_ip[MAX_IPADR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01073">urldata.h:1073</a></div></div>
<div class="ttc" id="multi_8c_html_af60eeb6175f9a25baeee40253c56330e"><div class="ttname"><a href="multi_8c.html#af60eeb6175f9a25baeee40253c56330e">Curl_set_in_callback</a></div><div class="ttdeci">void Curl_set_in_callback(struct Curl_easy *data, bool value)</div><div class="ttdef"><b>Definition:</b> <a href="multi_8c_source.html#l03174">multi.c:3174</a></div></div>
<div class="ttc" id="mime_8c_html_aa3774f4f669549973a0ff85d5372dc8f"><div class="ttname"><a href="mime_8c.html#aa3774f4f669549973a0ff85d5372dc8f">Curl_mime_prepare_headers</a></div><div class="ttdeci">CURLcode Curl_mime_prepare_headers(curl_mimepart *part, const char *contenttype, const char *disposition, enum mimestrategy strategy)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01678">mime.c:1678</a></div></div>
<div class="ttc" id="transfer_8h_html_add920a73e8f85870585b3391b7e4feed"><div class="ttname"><a href="transfer_8h.html#add920a73e8f85870585b3391b7e4feed">Curl_headersep</a></div><div class="ttdeci">#define Curl_headersep(x)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8h_source.html#l00025">transfer.h:25</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a34d2478b945364d0d1bc6cb5f2845f71">HTTPREQ_POST_MIME</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01137">urldata.h:1137</a></div></div>
<div class="ttc" id="struct_cookie_html_a7c5ae1aec00ae68e702c9653b591f1d9"><div class="ttname"><a href="struct_cookie.html#a7c5ae1aec00ae68e702c9653b591f1d9">Cookie::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00030">cookie.h:30</a></div></div>
<div class="ttc" id="parsedate_8h_html"><div class="ttname"><a href="parsedate_8h.html">parsedate.h</a></div></div>
<div class="ttc" id="urldata_8h_html_ac1138557ffc9ee3a520805205b76daee"><div class="ttname"><a href="urldata_8h.html#ac1138557ffc9ee3a520805205b76daee">SECONDARYSOCKET</a></div><div class="ttdeci">#define SECONDARYSOCKET</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00481">urldata.h:481</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa568500a9ca507b5a53de5372c81f26a"><div class="ttname"><a href="curl__memory_8h.html#aa568500a9ca507b5a53de5372c81f26a">realloc</a></div><div class="ttdeci">#define realloc(ptr, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00128">curl_memory.h:128</a></div></div>
<div class="ttc" id="http2_8h_html_aa085257d64dd169d466fb80802114c9a"><div class="ttname"><a href="http2_8h.html#aa085257d64dd169d466fb80802114c9a">Curl_http2_done</a></div><div class="ttdeci">#define Curl_http2_done(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00075">http2.h:75</a></div></div>
<div class="ttc" id="struct_pure_info_html_af78fc7bbff71b833838cad38b6728a2b"><div class="ttname"><a href="struct_pure_info.html#af78fc7bbff71b833838cad38b6728a2b">PureInfo::request_size</a></div><div class="ttdeci">long request_size</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01055">urldata.h:1055</a></div></div>
<div class="ttc" id="vtls_8h_html_a5ee046324452a0fe07e54818257fe04c"><div class="ttname"><a href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a></div><div class="ttdeci">#define Curl_ssl_connect_nonblocking(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00270">vtls.h:270</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="structconnectdata_html_a7cafd86e79828b97b1c186b83d39f565"><div class="ttname"><a href="structconnectdata.html#a7cafd86e79828b97b1c186b83d39f565">connectdata::oauth_bearer</a></div><div class="ttdeci">char * oauth_bearer</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00867">urldata.h:867</a></div></div>
<div class="ttc" id="http_8c_html_aa380bd70f94bb31fc19b879223427e44"><div class="ttname"><a href="http_8c.html#aa380bd70f94bb31fc19b879223427e44">Curl_http_connect</a></div><div class="ttdeci">CURLcode Curl_http_connect(struct connectdata *conn, bool *done)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01416">http.c:1416</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a3dca40ce1e998420175eabe37246e05b"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a3dca40ce1e998420175eabe37246e05b">CURL_FORMAT_CURL_OFF_T</a></div><div class="ttdeci">#define CURL_FORMAT_CURL_OFF_T</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00395">system.h:395</a></div></div>
<div class="ttc" id="http_8c_html_ab0c856a8320e36a478b5fd2422ef023a"><div class="ttname"><a href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023a">proxy_use</a></div><div class="ttdeci">proxy_use</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01678">http.c:1678</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a7fb027f5ed81ce6a618e7fb0e3a2e5e2"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">connectdata::dynamically_allocated_data::userpwd</a></div><div class="ttdeci">char * userpwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00930">urldata.h:930</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="curl_8h_html_a9ba581e59a874626d594c0f7c241d6d2"><div class="ttname"><a href="curl_8h.html#a9ba581e59a874626d594c0f7c241d6d2">CURLPROTO_FTP</a></div><div class="ttdeci">#define CURLPROTO_FTP</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00867">curl.h:867</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a533a91ae8c5add54fadaeac5dce92729"><div class="ttname"><a href="struct_connect_bits.html#a533a91ae8c5add54fadaeac5dce92729">ConnectBits::userpwd_in_url</a></div><div class="ttdeci">bool userpwd_in_url</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00426">urldata.h:426</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a58a76486bc087b55e1e7a3bf8e90254c"><div class="ttname"><a href="struct_curl__handler.html#a58a76486bc087b55e1e7a3bf8e90254c">Curl_handler::protocol</a></div><div class="ttdeci">unsigned int protocol</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00700">urldata.h:700</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a0249b638827cfaf90270d9c651a1035fa9d8155c9496f897f08cfcfbdd42a3cd0"><div class="ttname"><a href="struct_h_t_t_p.html#a0249b638827cfaf90270d9c651a1035fa9d8155c9496f897f08cfcfbdd42a3cd0">HTTP::HTTPSEND_REQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00154">http.h:154</a></div></div>
<div class="ttc" id="content__encoding_8h_html"><div class="ttname"><a href="content__encoding_8h.html">content_encoding.h</a></div></div>
<div class="ttc" id="unit1308_8c_html_a70a830d3039f37216dde9bcf2460aec2"><div class="ttname"><a href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a></div><div class="ttdeci">char buffer[]</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00048">unit1308.c:48</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a494e2b4279dc064f7ed1d0abd602b28d"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_OFF_T curl_off_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00442">system.h:442</a></div></div>
<div class="ttc" id="http__digest_8c_html_a6c12c2cb30a52657ed4c7df23f88158c"><div class="ttname"><a href="http__digest_8c.html#a6c12c2cb30a52657ed4c7df23f88158c">Curl_input_digest</a></div><div class="ttdeci">CURLcode Curl_input_digest(struct connectdata *conn, bool proxy, const char *header)</div><div class="ttdef"><b>Definition:</b> <a href="http__digest_8c_source.html#l00043">http_digest.c:43</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="curl_8h_html_abc5c98fcc1211af2b80116dd6e0a035da2bdca7ce6479378784212fee3a068c74"><div class="ttname"><a href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da2bdca7ce6479378784212fee3a068c74">CURL_HTTP_VERSION_1_1</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01926">curl.h:1926</a></div></div>
<div class="ttc" id="mime_8h_html_a3f7ea952d37b502d03fb5d8f8b9d7101a6167535771a4ad417b9d4cb82be44fe2"><div class="ttname"><a href="mime_8h.html#a3f7ea952d37b502d03fb5d8f8b9d7101a6167535771a4ad417b9d4cb82be44fe2">MIMEKIND_MULTIPART</a></div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00043">mime.h:43</a></div></div>
<div class="ttc" id="curl_8h_html_ab525ce31876f836dd9dd066dd75bcabe"><div class="ttname"><a href="curl_8h.html#ab525ce31876f836dd9dd066dd75bcabe">CURLAUTH_BEARER</a></div><div class="ttdeci">#define CURLAUTH_BEARER</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00716">curl.h:716</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="structconnectdata_html_a4df63a4042ad767671bb3bfd74aa68fc"><div class="ttname"><a href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">connectdata::http_proxy</a></div><div class="ttdeci">struct proxy_info http_proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00837">urldata.h:837</a></div></div>
<div class="ttc" id="struct_single_request_html_a9da5df2779ae21bdf94e14359214dbcf"><div class="ttname"><a href="struct_single_request.html#a9da5df2779ae21bdf94e14359214dbcf">SingleRequest::timeofdoc</a></div><div class="ttdeci">time_t timeofdoc</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00580">urldata.h:580</a></div></div>
<div class="ttc" id="http_8h_html"><div class="ttname"><a href="http_8h.html">http.h</a></div></div>
<div class="ttc" id="structconnectdata_html_a01e38af502b3798152533aa52884b423"><div class="ttname"><a href="structconnectdata.html#a01e38af502b3798152533aa52884b423">connectdata::seek_func</a></div><div class="ttdeci">curl_seek_callback seek_func</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00973">urldata.h:973</a></div></div>
<div class="ttc" id="struct_connect_bits_html_af764c68e6af921d2073c498f80741ea4"><div class="ttname"><a href="struct_connect_bits.html#af764c68e6af921d2073c498f80741ea4">ConnectBits::tunnel_proxy</a></div><div class="ttdeci">bool tunnel_proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00405">urldata.h:405</a></div></div>
<div class="ttc" id="structconnectdata_html_a4bb3a85b09c8a63a0b526a24f9b1897a"><div class="ttname"><a href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">connectdata::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00864">urldata.h:864</a></div></div>
<div class="ttc" id="urldata_8h_html_ad851f566879d5b859ec9181a21318b64"><div class="ttname"><a href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a></div><div class="ttdeci">#define PROTOPT_SSL</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00706">urldata.h:706</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8a2126c18fd1e70090d3c2a4cb3bc2561c"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a2126c18fd1e70090d3c2a4cb3bc2561c">HTTPREQ_LAST</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01142">urldata.h:1142</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="struct_single_request_html_af317a717e518249384a1db5a4b57d0f9a6a1237a08b80b653a99c1db76b8fbd30"><div class="ttname"><a href="struct_single_request.html#af317a717e518249384a1db5a4b57d0f9a6a1237a08b80b653a99c1db76b8fbd30">SingleRequest::HEADER_ALLBAD</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00558">urldata.h:558</a></div></div>
<div class="ttc" id="http_8c_html_a7a3d531209e82b72841ec84587a45dba"><div class="ttname"><a href="http_8c.html#a7a3d531209e82b72841ec84587a45dba">Curl_compareheader</a></div><div class="ttdeci">bool Curl_compareheader(const char *headerline, const char *header, const char *content)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01364">http.c:1364</a></div></div>
<div class="ttc" id="struct_h_t_t_p_1_1back_html_ad2a1a48e07419d92ef27abec899793c9"><div class="ttname"><a href="struct_h_t_t_p_1_1back.html#ad2a1a48e07419d92ef27abec899793c9">HTTP::back::postdata</a></div><div class="ttdeci">const char * postdata</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00148">http.h:148</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa2523615707384ca20d7db90cf57e504c"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa2523615707384ca20d7db90cf57e504c">STRING_USERAGENT</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01437">urldata.h:1437</a></div></div>
<div class="ttc" id="progress_8c_html_a40686d443707afea0c0e47cee805df01"><div class="ttname"><a href="progress_8c.html#a40686d443707afea0c0e47cee805df01">Curl_pgrsUpdate</a></div><div class="ttdeci">int Curl_pgrsUpdate(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00369">progress.c:369</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a5dd6efb91a5151f2bb4e4fff1b386582"><div class="ttname"><a href="curl__setup_8h.html#a5dd6efb91a5151f2bb4e4fff1b386582">CURLMIN</a></div><div class="ttdeci">#define CURLMIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00810">curl_setup.h:810</a></div></div>
<div class="ttc" id="struct_single_request_html_a7b830d1607062193706245f7f4512ac9"><div class="ttname"><a href="struct_single_request.html#a7b830d1607062193706245f7f4512ac9">SingleRequest::size</a></div><div class="ttdeci">curl_off_t size</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00534">urldata.h:534</a></div></div>
<div class="ttc" id="struct_pure_info_html_a6a2945a5778dab8f85427526d4d59844"><div class="ttname"><a href="struct_pure_info.html#a6a2945a5778dab8f85427526d4d59844">PureInfo::conn_primary_port</a></div><div class="ttdeci">long conn_primary_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01071">urldata.h:1071</a></div></div>
<div class="ttc" id="struct_connect_bits_html_afbb3ed3c6e41a5e79efc77b3bf00376d"><div class="ttname"><a href="struct_connect_bits.html#afbb3ed3c6e41a5e79efc77b3bf00376d">ConnectBits::ipv6_ip</a></div><div class="ttdeci">bool ipv6_ip</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00392">urldata.h:392</a></div></div>
<div class="ttc" id="vtls_8h_html"><div class="ttname"><a href="vtls_8h.html">vtls.h</a></div></div>
<div class="ttc" id="conncache_8h_html_ac54a8f8827585a80d5bd688c05e2c6ad"><div class="ttname"><a href="conncache_8h.html#ac54a8f8827585a80d5bd688c05e2c6ad">BUNDLE_MULTIPLEX</a></div><div class="ttdeci">#define BUNDLE_MULTIPLEX</div><div class="ttdef"><b>Definition:</b> <a href="conncache_8h_source.html#l00044">conncache.h:44</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951adaff0cec927d10c0ec5059ee0104ef62">CURLE_READ_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00492">curl.h:492</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="struct_single_request_html_afcc113884223e5e1329d1f0a29427cb8"><div class="ttname"><a href="struct_single_request.html#afcc113884223e5e1329d1f0a29427cb8">SingleRequest::exp100</a></div><div class="ttdeci">enum expect100 exp100</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00575">urldata.h:575</a></div></div>
<div class="ttc" id="curl_8h_html_a2947f26fc8cf96c0e438edb33e9e39ae"><div class="ttname"><a href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a></div><div class="ttdeci">#define CURLAUTH_NEGOTIATE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00708">curl.h:708</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a575639ff443233dd9af2c1835192ad3a"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a575639ff443233dd9af2c1835192ad3a">CURLE_FILESIZE_EXCEEDED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00535">curl.h:535</a></div></div>
<div class="ttc" id="anyauth_8d_html_a076c285cdc160cc073b20f7cf28ef85f"><div class="ttname"><a href="anyauth_8d.html#a076c285cdc160cc073b20f7cf28ef85f">headers</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response headers</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="structauth_html"><div class="ttname"><a href="structauth.html">auth</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01172">urldata.h:1172</a></div></div>
<div class="ttc" id="http2_8h_html_a2c3310e8f1eb576e38f798fb9dd2b951"><div class="ttname"><a href="http2_8h.html#a2c3310e8f1eb576e38f798fb9dd2b951">Curl_http2_switched</a></div><div class="ttdeci">#define Curl_http2_switched(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00070">http2.h:70</a></div></div>
<div class="ttc" id="form_8d_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00048">form.d:48</a></div></div>
<div class="ttc" id="mime_8c_html_a421afd16d330a7d51f13ec1aecca05be"><div class="ttname"><a href="mime_8c.html#a421afd16d330a7d51f13ec1aecca05be">Curl_mime_read</a></div><div class="ttdeci">size_t Curl_mime_read(char *buffer, size_t size, size_t nitems, void *instream)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01532">mime.c:1532</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="structconnectdata_html_a8c6daf7fa40e95c75eac915b7496a32a"><div class="ttname"><a href="structconnectdata.html#a8c6daf7fa40e95c75eac915b7496a32a">connectdata::httpversion</a></div><div class="ttdeci">int httpversion</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00869">urldata.h:869</a></div></div>
<div class="ttc" id="transfer_8c_html_a1ccf9c16ae7d51395fc19e946da56c09"><div class="ttname"><a href="transfer_8c.html#a1ccf9c16ae7d51395fc19e946da56c09">Curl_readrewind</a></div><div class="ttdeci">CURLcode Curl_readrewind(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l00283">transfer.c:283</a></div></div>
<div class="ttc" id="struct_single_request_html_ac259c8cd70d58252f455cf673e4d9df9"><div class="ttname"><a href="struct_single_request.html#ac259c8cd70d58252f455cf673e4d9df9">SingleRequest::content_range</a></div><div class="ttdeci">bool content_range</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00569">urldata.h:569</a></div></div>
<div class="ttc" id="curlx_8c_html_af6458f5d187f1d7c82fb9ea7ef634b44"><div class="ttname"><a href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a></div><div class="ttdeci">#define ZERO_NULL</div><div class="ttdef"><b>Definition:</b> <a href="curlx_8c_source.html#l00131">curlx.c:131</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a3e48e0195eb27ce292195e9133c70a18"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a3e48e0195eb27ce292195e9133c70a18">CURLE_UPLOAD_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00491">curl.h:491</a></div></div>
<div class="ttc" id="curl_8h_html_a2623448e48f97bb09eb1a83b28da7735"><div class="ttname"><a href="curl_8h.html#a2623448e48f97bb09eb1a83b28da7735">CURLAUTH_NONE</a></div><div class="ttdeci">#define CURLAUTH_NONE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00705">curl.h:705</a></div></div>
<div class="ttc" id="share_8c_html_a85cdae024464c8d7e96a232797028d72"><div class="ttname"><a href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a></div><div class="ttdeci">CURLSHcode Curl_share_unlock(struct Curl_easy *data, curl_lock_data type)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00244">share.c:244</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a8a13221afd448ab0b91f021b4f5ec7c7"><div class="ttname"><a href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">Curl_easy::req</a></div><div class="ttdeci">struct SingleRequest req</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01787">urldata.h:1787</a></div></div>
<div class="ttc" id="progress_8h_html"><div class="ttname"><a href="progress_8h.html">progress.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa9a91e127e9f7b99054e3ac6926548793">STRING_ENCODING</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01407">urldata.h:1407</a></div></div>
<div class="ttc" id="struct_single_request_html_a41830e3278cea8f3828e42071da3e452"><div class="ttname"><a href="struct_single_request.html#a41830e3278cea8f3828e42071da3e452">SingleRequest::httpcode</a></div><div class="ttdeci">int httpcode</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00572">urldata.h:572</a></div></div>
<div class="ttc" id="curl_8h_html_a83d34123b66749720352af4bcb17a8e4"><div class="ttname"><a href="curl_8h.html#a83d34123b66749720352af4bcb17a8e4">CURLPROTO_HTTPS</a></div><div class="ttdeci">#define CURLPROTO_HTTPS</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00866">curl.h:866</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fada408f5a3bc95ce930076bb7f4970f3f"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fada408f5a3bc95ce930076bb7f4970f3f">STRING_COOKIE</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01402">urldata.h:1402</a></div></div>
<div class="ttc" id="curl_8h_html_a57c429ed3dc3a2dc9ff5c6eba392b6b2"><div class="ttname"><a href="curl_8h.html#a57c429ed3dc3a2dc9ff5c6eba392b6b2">CURLPROTO_RTSP</a></div><div class="ttdeci">#define CURLPROTO_RTSP</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00883">curl.h:883</a></div></div>
<div class="ttc" id="transfer_8c_html_a8ccd1948f2a90c90b6fd1ac993e44a32"><div class="ttname"><a href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a></div><div class="ttdeci">void Curl_setup_transfer(struct connectdata *conn, int sockindex, curl_off_t size, bool getheader, curl_off_t *bytecountp, int writesockindex, curl_off_t *writecountp)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l01743">transfer.c:1743</a></div></div>
<div class="ttc" id="http_8c_html_aac63462775197001083e4cc8752f2f73"><div class="ttname"><a href="http_8c.html#aac63462775197001083e4cc8752f2f73">Curl_add_buffer_send</a></div><div class="ttdeci">CURLcode Curl_add_buffer_send(Curl_send_buffer **inp, struct connectdata *conn, long *bytes_written, size_t included_body_bytes, int socketindex)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01116">http.c:1116</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa46bb6588f09bb6ada12d29bdeddc2539"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa46bb6588f09bb6ada12d29bdeddc2539">STRING_TARGET</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01474">urldata.h:1474</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="struct_single_request_html_a83841cbaec57fb35d0ca5e9d1908d3b0"><div class="ttname"><a href="struct_single_request.html#a83841cbaec57fb35d0ca5e9d1908d3b0">SingleRequest::hbuflen</a></div><div class="ttdeci">size_t hbuflen</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00564">urldata.h:564</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a13581d0a607ddfc267cd384346e7f048"><div class="ttname"><a href="curl__setup_8h.html#a13581d0a607ddfc267cd384346e7f048">CURLMAX</a></div><div class="ttdeci">#define CURLMAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00809">curl_setup.h:809</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a65da3b0e3ff058a8f80b5d90ff51f40c"><div class="ttname"><a href="struct_h_t_t_p.html#a65da3b0e3ff058a8f80b5d90ff51f40c">HTTP::postdata</a></div><div class="ttdeci">const char * postdata</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00135">http.h:135</a></div></div>
<div class="ttc" id="urlapi_8h_html_a1cb93c92958648f06fab038f397cfeae"><div class="ttname"><a href="urlapi_8h.html#a1cb93c92958648f06fab038f397cfeae">curl_url_set</a></div><div class="ttdeci">CURL_EXTERN CURLUcode curl_url_set(CURLU *handle, CURLUPart what, const char *part, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l01097">urlapi.c:1097</a></div></div>
<div class="ttc" id="cookie_8c_html_a6e800bf3fd9b6cea2a826408bcdf235c"><div class="ttname"><a href="cookie_8c.html#a6e800bf3fd9b6cea2a826408bcdf235c">Curl_cookie_add</a></div><div class="ttdeci">struct Cookie * Curl_cookie_add(struct Curl_easy *data, struct CookieInfo *c, bool httpheader, bool noexpire, char *lineptr, const char *domain, const char *path)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l00426">cookie.c:426</a></div></div>
<div class="ttc" id="mime_8h_html"><div class="ttname"><a href="mime_8h.html">mime.h</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_ad61a3f1f01ef29d9fa9a8b495f8abbfc"><div class="ttname"><a href="struct_h_t_t_p.html#ad61a3f1f01ef29d9fa9a8b495f8abbfc">HTTP::sendit</a></div><div class="ttdeci">curl_mimepart * sendit</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00133">http.h:133</a></div></div>
<div class="ttc" id="curl__ntlm__wb_8h_html"><div class="ttname"><a href="curl__ntlm__wb_8h.html">curl_ntlm_wb.h</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a810a2b88f3ab6e69daac56a95997d288"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">connectdata::dynamically_allocated_data::proxyuserpwd</a></div><div class="ttdeci">char * proxyuserpwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00927">urldata.h:927</a></div></div>
<div class="ttc" id="mime_8c_html_a16da9e4dbf38be0096a6c63bd408c39c"><div class="ttname"><a href="mime_8c.html#a16da9e4dbf38be0096a6c63bd408c39c">Curl_mime_rewind</a></div><div class="ttdeci">CURLcode Curl_mime_rewind(curl_mimepart *part)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01541">mime.c:1541</a></div></div>
<div class="ttc" id="content__encoding_8c_html_a4bb1030923af3fb6cd027301fc4dd1db"><div class="ttname"><a href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a></div><div class="ttdeci">CURLcode Curl_build_unencoding_stack(struct connectdata *conn, const char *enclist, int maybechunked)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00939">content_encoding.c:939</a></div></div>
<div class="ttc" id="struct_user_defined_html_abef91298dc05202c0eae538403f73d15"><div class="ttname"><a href="struct_user_defined.html#abef91298dc05202c0eae538403f73d15">UserDefined::haproxyprotocol</a></div><div class="ttdeci">bool haproxyprotocol</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01717">urldata.h:1717</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba652d7cac677d1aca71efd0386e57f927">CURLUPART_URL</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00052">urlapi.h:52</a></div></div>
<div class="ttc" id="structcurl__slist_html_a56fcfc41d89a47865933c310d316a108"><div class="ttname"><a href="structcurl__slist.html#a56fcfc41d89a47865933c310d316a108">curl_slist::next</a></div><div class="ttdeci">struct curl_slist * next</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02396">curl.h:2396</a></div></div>
<div class="ttc" id="http_8c_html_aa860a0fb397fe6fc2b33fa2628aa5f8b"><div class="ttname"><a href="http_8c.html#aa860a0fb397fe6fc2b33fa2628aa5f8b">Curl_copy_header_value</a></div><div class="ttdeci">char * Curl_copy_header_value(const char *header)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00212">http.c:212</a></div></div>
<div class="ttc" id="http__negotiate_8h_html"><div class="ttname"><a href="http__negotiate_8h.html">http_negotiate.h</a></div></div>
<div class="ttc" id="struct_single_request_html_aa15f48119eaea7af17077d2d232d1046"><div class="ttname"><a href="struct_single_request.html#aa15f48119eaea7af17077d2d232d1046">SingleRequest::ignorecl</a></div><div class="ttdeci">bool ignorecl</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00592">urldata.h:592</a></div></div>
<div class="ttc" id="strtoofft_8c_html_a3c9f5c063165fc15454feac4def889d7"><div class="ttname"><a href="strtoofft_8c.html#a3c9f5c063165fc15454feac4def889d7">curlx_strtoofft</a></div><div class="ttdeci">CURLofft curlx_strtoofft(const char *str, char **endp, int base, curl_off_t *num)</div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8c_source.html#l00215">strtoofft.c:215</a></div></div>
<div class="ttc" id="struct_user_defined_html_a297b95c9d8a6b73ab0d15f752e23ba8b"><div class="ttname"><a href="struct_user_defined.html#a297b95c9d8a6b73ab0d15f752e23ba8b">UserDefined::httpversion</a></div><div class="ttdeci">long httpversion</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01591">urldata.h:1591</a></div></div>
<div class="ttc" id="struct_cookie_html_a6db50d84be2536a3cbe68964e471128f"><div class="ttname"><a href="struct_cookie.html#a6db50d84be2536a3cbe68964e471128f">Cookie::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00031">cookie.h:31</a></div></div>
<div class="ttc" id="digest_8c_html_a75bcfc858ec12ca28e8b59a1ebc76c44"><div class="ttname"><a href="digest_8c.html#a75bcfc858ec12ca28e8b59a1ebc76c44">Curl_auth_is_digest_supported</a></div><div class="ttdeci">bool Curl_auth_is_digest_supported(void)</div><div class="ttdef"><b>Definition:</b> <a href="digest_8c_source.html#l00329">digest.c:329</a></div></div>
<div class="ttc" id="strcase_8h_html_a48c605aaef9b3681c41d91096b6baad0"><div class="ttname"><a href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a></div><div class="ttdeci">#define strncasecompare(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00036">strcase.h:36</a></div></div>
<div class="ttc" id="select_8h_html"><div class="ttname"><a href="select_8h.html">select.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a309ade641c94c3e710ae887405dba78b">CURLE_ABORTED_BY_CALLBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00512">curl.h:512</a></div></div>
<div class="ttc" id="strdup_8c_html_a3a3f98ad97deebcb223f165b377f3879"><div class="ttname"><a href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a></div><div class="ttdeci">void * Curl_saferealloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="strdup_8c_source.html#l00093">strdup.c:93</a></div></div>
<div class="ttc" id="mime_8h_html_afdc5138da8e131f5e919d4f8e67ae172ac556c9982f42232a0d711e2e1a7dbd0a"><div class="ttname"><a href="mime_8h.html#afdc5138da8e131f5e919d4f8e67ae172ac556c9982f42232a0d711e2e1a7dbd0a">MIMESTRATEGY_FORM</a></div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00064">mime.h:64</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba236a55190e38fc4c46bfcff176207e72">CURLUPART_PASSWORD</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00055">urlapi.h:55</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8aae19a0f63b68ec93cabbd9f3074fb496">HTTPREQ_POST</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01135">urldata.h:1135</a></div></div>
<div class="ttc" id="struct_single_request_html_afabf76ed046873a4f5a5b83735c0b9da"><div class="ttname"><a href="struct_single_request.html#afabf76ed046873a4f5a5b83735c0b9da">SingleRequest::hbufp</a></div><div class="ttdeci">char * hbufp</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00563">urldata.h:563</a></div></div>
<div class="ttc" id="struct_single_request_html_abad0ca3c76032134d15077908bdbc7a1"><div class="ttname"><a href="struct_single_request.html#abad0ca3c76032134d15077908bdbc7a1">SingleRequest::str</a></div><div class="ttdeci">char * str</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00565">urldata.h:565</a></div></div>
<div class="ttc" id="non-ascii_8h_html_a7f86eb6237ad590baa14e82fae9d6d83"><div class="ttname"><a href="non-ascii_8h.html#a7f86eb6237ad590baa14e82fae9d6d83">Curl_convert_from_network</a></div><div class="ttdeci">#define Curl_convert_from_network(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="non-ascii_8h_source.html#l00057">non-ascii.h:57</a></div></div>
<div class="ttc" id="struct_single_request_html_a6d84363528b8597bdb00ac4859f46697"><div class="ttname"><a href="struct_single_request.html#a6d84363528b8597bdb00ac4859f46697">SingleRequest::end_ptr</a></div><div class="ttdeci">char * end_ptr</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00567">urldata.h:567</a></div></div>
<div class="ttc" id="progress_8c_html_a82906bd19baedaf94d95274dd2371b22"><div class="ttname"><a href="progress_8c.html#a82906bd19baedaf94d95274dd2371b22">Curl_pgrsSetUploadSize</a></div><div class="ttdeci">void Curl_pgrsSetUploadSize(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00353">progress.c:353</a></div></div>
<div class="ttc" id="conncache_8h_html_a3fead10caa803fd2f106fe9916140c73"><div class="ttname"><a href="conncache_8h.html#a3fead10caa803fd2f106fe9916140c73">BUNDLE_PIPELINING</a></div><div class="ttdeci">#define BUNDLE_PIPELINING</div><div class="ttdef"><b>Definition:</b> <a href="conncache_8h_source.html#l00043">conncache.h:43</a></div></div>
<div class="ttc" id="progress_8c_html_a00f01952b08507f31def8af5b088e53f"><div class="ttname"><a href="progress_8c.html#a00f01952b08507f31def8af5b088e53f">Curl_pgrsSetDownloadSize</a></div><div class="ttdeci">void Curl_pgrsSetDownloadSize(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00341">progress.c:341</a></div></div>
<div class="ttc" id="non-ascii_8h_html_ab7de472e1367a01da556c8f5acad93bb"><div class="ttname"><a href="non-ascii_8h.html#ab7de472e1367a01da556c8f5acad93bb">Curl_convert_to_network</a></div><div class="ttdeci">#define Curl_convert_to_network(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="non-ascii_8h_source.html#l00056">non-ascii.h:56</a></div></div>
<div class="ttc" id="config_8d_html_a347714e01aa155d12f1607546a9d4545"><div class="ttname"><a href="config_8d.html#a347714e01aa155d12f1607546a9d4545">colon</a></div><div class="ttdeci">Long separated by colon</div><div class="ttdef"><b>Definition:</b> <a href="config_8d_source.html#l00011">config.d:11</a></div></div>
<div class="ttc" id="multiif_8h_html_ad755633cd6d4e90c3df49fefd1052bad"><div class="ttname"><a href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a></div><div class="ttdeci">#define GETSOCK_BLANK</div><div class="ttdef"><b>Definition:</b> <a href="multiif_8h_source.html#l00045">multiif.h:45</a></div></div>
<div class="ttc" id="transfer_8c_html_a15440032c495bf0f3f6c535ec5e811e3"><div class="ttname"><a href="transfer_8c.html#a15440032c495bf0f3f6c535ec5e811e3">Curl_get_upload_buffer</a></div><div class="ttdeci">CURLcode Curl_get_upload_buffer(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l00110">transfer.c:110</a></div></div>
<div class="ttc" id="strtoofft_8h_html"><div class="ttname"><a href="strtoofft_8h.html">strtoofft.h</a></div></div>
<div class="ttc" id="sendf_8c_html_a8b0f0a06869b888abb80a069182d0d5a"><div class="ttname"><a href="sendf_8c.html#a8b0f0a06869b888abb80a069182d0d5a">Curl_debug</a></div><div class="ttdeci">int Curl_debug(struct Curl_easy *data, curl_infotype type, char *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00776">sendf.c:776</a></div></div>
<div class="ttc" id="sendf_8h_html_a5b56d764844bff170a6721d5e33dca34"><div class="ttname"><a href="sendf_8h.html#a5b56d764844bff170a6721d5e33dca34">CLIENTWRITE_HEADER</a></div><div class="ttdeci">#define CLIENTWRITE_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00051">sendf.h:51</a></div></div>
<div class="ttc" id="urldata_8h_html_a93237a6ee2f27182bb966487a03bce44"><div class="ttname"><a href="urldata_8h.html#a93237a6ee2f27182bb966487a03bce44">KEEP_SEND</a></div><div class="ttdeci">#define KEEP_SEND</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00459">urldata.h:459</a></div></div>
<div class="ttc" id="structproxy__info_html_ab2b6b7b0dc1dd09509d79ae5f52dd3b8"><div class="ttname"><a href="structproxy__info.html#ab2b6b7b0dc1dd09509d79ae5f52dd3b8">proxy_info::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00756">urldata.h:756</a></div></div>
<div class="ttc" id="curl_8h_html_a7516630ec17f247697dd3272be7ada74"><div class="ttname"><a href="curl_8h.html#a7516630ec17f247697dd3272be7ada74">curl_read_callback</a></div><div class="ttdeci">size_t(* curl_read_callback)(char *buffer, size_t size, size_t nitems, void *instream)</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00358">curl.h:358</a></div></div>
<div class="ttc" id="curl_8h_html_ab0e8299ededa678028a9e5796b0f77ce"><div class="ttname"><a href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a></div><div class="ttdeci">#define CURLAUTH_NTLM</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00713">curl.h:713</a></div></div>
<div class="ttc" id="sendf_8c_html_a6d7b9f1e0b64c65b824a115d0b00b5a2"><div class="ttname"><a href="sendf_8c.html#a6d7b9f1e0b64c65b824a115d0b00b5a2">Curl_write</a></div><div class="ttdeci">CURLcode Curl_write(struct connectdata *conn, curl_socket_t sockfd, const void *mem, size_t len, ssize_t *written)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00338">sendf.c:338</a></div></div>
<div class="ttc" id="multiif_8h_html_a9aabda59f0ff87c1db3a2d306a410713"><div class="ttname"><a href="multiif_8h.html#a9aabda59f0ff87c1db3a2d306a410713">GETSOCK_WRITESOCK</a></div><div class="ttdeci">#define GETSOCK_WRITESOCK(x)</div><div class="ttdef"><b>Definition:</b> <a href="multiif_8h_source.html#l00048">multiif.h:48</a></div></div>
<div class="ttc" id="curl_8h_html_a9704d2633927f77efaa3e3c6f1c23a14a39c388deb977296403ec7a28b6c5acbe"><div class="ttname"><a href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a39c388deb977296403ec7a28b6c5acbe">CURLINFO_HEADER_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00435">curl.h:435</a></div></div>
<div class="ttc" id="structconnectbundle_html_a22977226b49d058b284fe58643165d8b"><div class="ttname"><a href="structconnectbundle.html#a22977226b49d058b284fe58643165d8b">connectbundle::multiuse</a></div><div class="ttdeci">int multiuse</div><div class="ttdef"><b>Definition:</b> <a href="conncache_8h_source.html#l00047">conncache.h:47</a></div></div>
<div class="ttc" id="fail-early_8d_html_a2b978ebca1e6cb7fcbcb9a6b51701ce3"><div class="ttname"><a href="fail-early_8d.html#a2b978ebca1e6cb7fcbcb9a6b51701ce3">fail</a></div><div class="ttdeci">Long do not continue it will attempt to operate on each given one by one.By it will ignore errors if there are more URLs given and the last URL s success will determine the error code curl returns.So early failures will be hidden by subsequent successful transfers.Using this curl will instead return an error on the first transfer that independent of the amount of URLs that are given on the command line.This no transfer failures go undetected by scripts and similar.This option is global and does not need to be specified for each use of next.This option does not imply fail</div><div class="ttdef"><b>Definition:</b> <a href="fail-early_8d_source.html#l00002">fail-early.d:2</a></div></div>
<div class="ttc" id="stub__gssapi_8h_html_a62228ec4265fe12232abce1600122fe7"><div class="ttname"><a href="stub__gssapi_8h.html#a62228ec4265fe12232abce1600122fe7">GSS_ERROR</a></div><div class="ttdeci">#define GSS_ERROR(status)</div><div class="ttdef"><b>Definition:</b> <a href="stub__gssapi_8h_source.html#l00030">stub_gssapi.h:30</a></div></div>
<div class="ttc" id="structconnectdata_html_a878ad8b625208d9aa421852225c33b30"><div class="ttname"><a href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">connectdata::given</a></div><div class="ttdeci">const struct Curl_handler * given</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00906">urldata.h:906</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a7d475a6687b678c11cce8221797e46dda5438320c9e5960ae04acfd8d213faa57"><div class="ttname"><a href="urldata_8h.html#a7d475a6687b678c11cce8221797e46dda5438320c9e5960ae04acfd8d213faa57">UPGR101_RECEIVED</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00500">urldata.h:500</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a92cc38ee21acd0ebfeb725f35ee9241b"><div class="ttname"><a href="struct_connect_bits.html#a92cc38ee21acd0ebfeb725f35ee9241b">ConnectBits::rewindaftersend</a></div><div class="ttdeci">bool rewindaftersend</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00413">urldata.h:413</a></div></div>
<div class="ttc" id="http_8c_html_ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf"><div class="ttname"><a href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aac767d19d173d1415044b28924e5b77bf">HEADER_CONNECT</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01681">http.c:1681</a></div></div>
<div class="ttc" id="pipeline_8c_html_a2f59dc911931337300b0b3db60936f12"><div class="ttname"><a href="pipeline_8c.html#a2f59dc911931337300b0b3db60936f12">Curl_pipeline_leave_write</a></div><div class="ttdeci">void Curl_pipeline_leave_write(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="pipeline_8c_source.html#l00367">pipeline.c:367</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="http_8c_html_a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e"><div class="ttname"><a href="http_8c.html#a5e8926572799ef0618c27df845d36395ad6bb356eea903fc91c6f40e158b9913e">STATUS_DONE</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l02947">http.c:2947</a></div></div>
<div class="ttc" id="http_8c_html_a5e8926572799ef0618c27df845d36395"><div class="ttname"><a href="http_8c.html#a5e8926572799ef0618c27df845d36395">statusline</a></div><div class="ttdeci">statusline</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l02945">http.c:2945</a></div></div>
<div class="ttc" id="urldata_8h_html_a7d475a6687b678c11cce8221797e46ddaa9c52d61737ee3b48ca077b1f408e8d8"><div class="ttname"><a href="urldata_8h.html#a7d475a6687b678c11cce8221797e46ddaa9c52d61737ee3b48ca077b1f408e8d8">UPGR101_REQUESTED</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00499">urldata.h:499</a></div></div>
<div class="ttc" id="strdup_8h_html"><div class="ttname"><a href="strdup_8h.html">strdup.h</a></div></div>
<div class="ttc" id="structconnectdata_html_aa5f47898ac300afb3ebdb21478f4074d"><div class="ttname"><a href="structconnectdata.html#aa5f47898ac300afb3ebdb21478f4074d">connectdata::httpc</a></div><div class="ttdeci">struct http_conn httpc</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01004">urldata.h:1004</a></div></div>
<div class="ttc" id="struct_curl__easy_html_abcc5aa61af150adc1388b1a3492c2599"><div class="ttname"><a href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">Curl_easy::set</a></div><div class="ttdeci">struct UserDefined set</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01788">urldata.h:1788</a></div></div>
<div class="ttc" id="pipeline_8c_html_aced63ee23828ec4458ec8987be090054"><div class="ttname"><a href="pipeline_8c.html#aced63ee23828ec4458ec8987be090054">Curl_pipeline_server_blacklisted</a></div><div class="ttdeci">bool Curl_pipeline_server_blacklisted(struct Curl_easy *handle, char *server_name)</div><div class="ttdef"><b>Definition:</b> <a href="pipeline_8c_source.html#l00239">pipeline.c:239</a></div></div>
<div class="ttc" id="urlapi_8h_html_a6a5b8d5c719d5d893048d2410d74d1de"><div class="ttname"><a href="urlapi_8h.html#a6a5b8d5c719d5d893048d2410d74d1de">CURLUcode</a></div><div class="ttdeci">CURLUcode</div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00030">urlapi.h:30</a></div></div>
<div class="ttc" id="multiif_8h_html"><div class="ttname"><a href="multiif_8h.html">multiif.h</a></div></div>
<div class="ttc" id="strtoofft_8h_html_a515bb1ee04e33ae6fdb4d80dd897437f"><div class="ttname"><a href="strtoofft_8h.html#a515bb1ee04e33ae6fdb4d80dd897437f">CURLofft</a></div><div class="ttdeci">CURLofft</div><div class="ttdef"><b>Definition:</b> <a href="strtoofft_8h_source.html#l00043">strtoofft.h:43</a></div></div>
<div class="ttc" id="sendf_8c_html_ad59954133649b7538b387f940b86024f"><div class="ttname"><a href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a></div><div class="ttdeci">CURLcode Curl_client_write(struct connectdata *conn, int type, char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00651">sendf.c:651</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2ebab322766509b004b024796aa64977308b">CURLUPART_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00061">urlapi.h:61</a></div></div>
<div class="ttc" id="http__proxy_8c_html_a64cc706da81f4e2a504fc457b79542e2"><div class="ttname"><a href="http__proxy_8c.html#a64cc706da81f4e2a504fc457b79542e2">Curl_connect_ongoing</a></div><div class="ttdeci">bool Curl_connect_ongoing(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="http__proxy_8c_source.html#l00144">http_proxy.c:144</a></div></div>
<div class="ttc" id="struct_connect_bits_html_aaf15319fba965e2d87ac0ac839ae8351"><div class="ttname"><a href="struct_connect_bits.html#aaf15319fba965e2d87ac0ac839ae8351">ConnectBits::close</a></div><div class="ttdeci">bool close</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00381">urldata.h:381</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_u_r_l_8h_html_ad62c324cbfcc92532598792c6d0f6494"><div class="ttname"><a href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a></div><div class="ttdeci">uint8_t url[16]</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_u_r_l_8h_source.html#l00037">BLEEddystoneURL.h:37</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_a5690f2fad1c28f7840da5f2db675df60"><div class="ttname"><a href="struct_h_t_t_p.html#a5690f2fad1c28f7840da5f2db675df60">HTTP::p_accept</a></div><div class="ttdeci">const char * p_accept</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00138">http.h:138</a></div></div>
<div class="ttc" id="struct_single_request_html_af317a717e518249384a1db5a4b57d0f9a2f41dfd2516fec41c456bb75df75a805"><div class="ttname"><a href="struct_single_request.html#af317a717e518249384a1db5a4b57d0f9a2f41dfd2516fec41c456bb75df75a805">SingleRequest::HEADER_PARTHEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00556">urldata.h:556</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="structconnectdata_html_a73d6d39e7554e4d764099ab3f1181a40"><div class="ttname"><a href="structconnectdata.html#a73d6d39e7554e4d764099ab3f1181a40">connectdata::writesockfd</a></div><div class="ttdeci">curl_socket_t writesockfd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00920">urldata.h:920</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="structauth_html_a689bd3ff24200ef5883f251e3b57e56e"><div class="ttname"><a href="structauth.html#a689bd3ff24200ef5883f251e3b57e56e">auth::multipass</a></div><div class="ttdeci">bool multipass</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01180">urldata.h:1180</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_ab818628aee06527d680ef20a16a53c6e"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#ab818628aee06527d680ef20a16a53c6e">connectdata::dynamically_allocated_data::host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00933">urldata.h:933</a></div></div>
<div class="ttc" id="struct_single_request_html_a8ede6bd89f1bff101e4a1a62ddf14134"><div class="ttname"><a href="struct_single_request.html#a8ede6bd89f1bff101e4a1a62ddf14134">SingleRequest::location</a></div><div class="ttdeci">char * location</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00595">urldata.h:595</a></div></div>
<div class="ttc" id="mime_8c_html_a5d447429cc681c949f0a2b9c60bebdae"><div class="ttname"><a href="mime_8c.html#a5d447429cc681c949f0a2b9c60bebdae">Curl_mime_size</a></div><div class="ttdeci">curl_off_t Curl_mime_size(curl_mimepart *part)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01587">mime.c:1587</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae4322de705c516b61756f9874183ef05">HTTPREQ_GET</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01134">urldata.h:1134</a></div></div>
<div class="ttc" id="curl_8h_html_a845d262749bd413d724b58e26f713f25afedf4be1a889a36b688846763ca838f5"><div class="ttname"><a href="curl_8h.html#a845d262749bd413d724b58e26f713f25afedf4be1a889a36b688846763ca838f5">CURL_TIMECOND_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02015">curl.h:2015</a></div></div>
<div class="ttc" id="http_8c_html_a9d59c75ba3bca5012f00cee23482b4b3"><div class="ttname"><a href="http_8c.html#a9d59c75ba3bca5012f00cee23482b4b3">https_connecting</a></div><div class="ttdeci">#define https_connecting(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00103">http.c:103</a></div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="get_8d_html_a72405a3df7019c7ac95d2f3be7247548"><div class="ttname"><a href="get_8d.html#a72405a3df7019c7ac95d2f3be7247548">head</a></div><div class="ttdeci">Long this option will make all data specified with data binary or data urlencode to be used in an HTTP GET request instead of the POST request that otherwise would be used.The data will be appended to the URL with a separator.If used in combination with head</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="struct_single_request_html_a97c471abe695b617c7695de635b49440"><div class="ttname"><a href="struct_single_request.html#a97c471abe695b617c7695de635b49440">SingleRequest::header</a></div><div class="ttdeci">bool header</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00553">urldata.h:553</a></div></div>
<div class="ttc" id="struct_connect_bits_html_aafa3f0b216458e430a067bb46beab02b"><div class="ttname"><a href="struct_connect_bits.html#aafa3f0b216458e430a067bb46beab02b">ConnectBits::proxy_user_passwd</a></div><div class="ttdeci">bool proxy_user_passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00391">urldata.h:391</a></div></div>
<div class="ttc" id="struct_single_request_html_a5803af0f75195ad74badb6ced9b24b16"><div class="ttname"><a href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">SingleRequest::protop</a></div><div class="ttdeci">void * protop</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00619">urldata.h:619</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fafe604c42ae587594510842a54ace673e"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fafe604c42ae587594510842a54ace673e">STRING_CUSTOMREQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01404">urldata.h:1404</a></div></div>
<div class="ttc" id="http_8c_html_a06db2840299ee6694923087317b8133a"><div class="ttname"><a href="http_8c.html#a06db2840299ee6694923087317b8133a">Curl_http_readwrite_headers</a></div><div class="ttdeci">CURLcode Curl_http_readwrite_headers(struct Curl_easy *data, struct connectdata *conn, ssize_t *nread, bool *stop_reading)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l03131">http.c:3131</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_ad0d3b107dbf2e7d40f2680e40498f1f3"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#ad0d3b107dbf2e7d40f2680e40498f1f3">connectdata::dynamically_allocated_data::uagent</a></div><div class="ttdeci">char * uagent</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00928">urldata.h:928</a></div></div>
<div class="ttc" id="vtls_8h_html_a665432b41da505b40f72af4161b011aa"><div class="ttname"><a href="vtls_8h.html#a665432b41da505b40f72af4161b011aa">Curl_ssl_getsock</a></div><div class="ttdeci">int Curl_ssl_getsock(struct connectdata *conn, curl_socket_t *socks, int numsocks)</div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8a4b328e0aa83f04505b21057059a9715f">HTTPREQ_PUT</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01138">urldata.h:1138</a></div></div>
<div class="ttc" id="non-ascii_8h_html"><div class="ttname"><a href="non-ascii_8h.html">non-ascii.h</a></div></div>
<div class="ttc" id="struct_pure_info_html_a31ac209baf108af8a0970ecf3c70afb9"><div class="ttname"><a href="struct_pure_info.html#a31ac209baf108af8a0970ecf3c70afb9">PureInfo::conn_local_port</a></div><div class="ttdeci">long conn_local_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01074">urldata.h:1074</a></div></div>
<div class="ttc" id="urldata_8h_html_aabb7db968656c3ee0555ea3d8784310da9ce9f2e0534f44e7777fac288d3c522a"><div class="ttname"><a href="urldata_8h.html#aabb7db968656c3ee0555ea3d8784310da9ce9f2e0534f44e7777fac288d3c522a">EXPIRE_100_TIMEOUT</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01206">urldata.h:1206</a></div></div>
<div class="ttc" id="curl_8h_html_a7a2d5bd19a5af3674e7d8ecab1a4dfaf"><div class="ttname"><a href="curl_8h.html#a7a2d5bd19a5af3674e7d8ecab1a4dfaf">CURL_MAX_HTTP_HEADER</a></div><div class="ttdeci">#define CURL_MAX_HTTP_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00237">curl.h:237</a></div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="urldata_8h_html_a054f94b51abab46052e1d78f0d1e03fd"><div class="ttname"><a href="urldata_8h.html#a054f94b51abab46052e1d78f0d1e03fd">PORT_HTTPS</a></div><div class="ttdeci">#define PORT_HTTPS</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00033">urldata.h:33</a></div></div>
<div class="ttc" id="curl_8h_html_af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1"><div class="ttname"><a href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549ca0b91c2d37a109fecce2640cf69d18df1">CURL_LOCK_DATA_COOKIE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02607">curl.h:2607</a></div></div>
<div class="ttc" id="http2_8h_html_a5bdef737723c68dff0e4bde069b428ec"><div class="ttname"><a href="http2_8h.html#a5bdef737723c68dff0e4bde069b428ec">Curl_http2_setup_req</a></div><div class="ttdeci">#define Curl_http2_setup_req(x)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00072">http2.h:72</a></div></div>
<div class="ttc" id="http2_8h_html"><div class="ttname"><a href="http2_8h.html">http2.h</a></div></div>
<div class="ttc" id="curl_8h_html_a8ebcd4e614f222aca6352ad5052634f8ae118261fbb43ab332f00f65574d08ec9"><div class="ttname"><a href="curl_8h.html#a8ebcd4e614f222aca6352ad5052634f8ae118261fbb43ab332f00f65574d08ec9">CURLPROXY_HTTPS</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00677">curl.h:677</a></div></div>
<div class="ttc" id="struct_single_request_html_a4830599ec2512bfe94a3a08809841b4b"><div class="ttname"><a href="struct_single_request.html#a4830599ec2512bfe94a3a08809841b4b">SingleRequest::p</a></div><div class="ttdeci">char * p</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00568">urldata.h:568</a></div></div>
<div class="ttc" id="transfer_8c_html_a0649a25288fefe787c7bedddadb8a31d"><div class="ttname"><a href="transfer_8c.html#a0649a25288fefe787c7bedddadb8a31d">Curl_checkheaders</a></div><div class="ttdeci">char * Curl_checkheaders(const struct connectdata *conn, const char *thisheader)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l00093">transfer.c:93</a></div></div>
<div class="ttc" id="config-win32_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="config-win32_8h_source.html#l00379">config-win32.h:379</a></div></div>
<div class="ttc" id="http_8c_html_a9aa397285caa1ed8c0991d9ebd94962a"><div class="ttname"><a href="http_8c.html#a9aa397285caa1ed8c0991d9ebd94962a">Curl_http_output_auth</a></div><div class="ttdeci">CURLcode Curl_http_output_auth(struct connectdata *conn, const char *request, const char *path, bool proxytunnel)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00712">http.c:712</a></div></div>
<div class="ttc" id="struct_connect_bits_html_ac81c594d3bde6b99be89b39136967e91"><div class="ttname"><a href="struct_connect_bits.html#ac81c594d3bde6b99be89b39136967e91">ConnectBits::netrc</a></div><div class="ttdeci">bool netrc</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00425">urldata.h:425</a></div></div>
<div class="ttc" id="http__digest_8c_html_aab69b19ade52810158b5ed4fca8a8141"><div class="ttname"><a href="http__digest_8c.html#aab69b19ade52810158b5ed4fca8a8141">Curl_output_digest</a></div><div class="ttdeci">CURLcode Curl_output_digest(struct connectdata *conn, bool proxy, const unsigned char *request, const unsigned char *uripath)</div><div class="ttdef"><b>Definition:</b> <a href="http__digest_8c_source.html#l00070">http_digest.c:70</a></div></div>
<div class="ttc" id="structconnectdata_html_a13cc2123ad38902e8ad44e67f10ed7aa"><div class="ttname"><a href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">connectdata::sock</a></div><div class="ttdeci">curl_socket_t sock[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00874">urldata.h:874</a></div></div>
<div class="ttc" id="curl_8h_html_ad4dd80e15a6f20cdd628a7f222fcb8eb"><div class="ttname"><a href="curl_8h.html#ad4dd80e15a6f20cdd628a7f222fcb8eb">curl_getdate</a></div><div class="ttdeci">CURL_EXTERN time_t curl_getdate(const char *p, const time_t *unused)</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00559">parsedate.c:559</a></div></div>
<div class="ttc" id="mime_8c_html_a26e5fb189d0937d27da11d1c10c09565"><div class="ttname"><a href="mime_8c.html#a26e5fb189d0937d27da11d1c10c09565">Curl_mime_initpart</a></div><div class="ttdeci">void Curl_mime_initpart(curl_mimepart *part, struct Curl_easy *easy)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l01245">mime.c:1245</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba347b25d9d344dbf29c5274bd184ac706">CURLUPART_HOST</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00057">urlapi.h:57</a></div></div>
<div class="ttc" id="parsedate_8c_html_a192aac16662dc4aaf80ef3722b581958"><div class="ttname"><a href="parsedate_8c.html#a192aac16662dc4aaf80ef3722b581958">Curl_gmtime</a></div><div class="ttdeci">CURLcode Curl_gmtime(time_t intime, struct tm *store)</div><div class="ttdef"><b>Definition:</b> <a href="parsedate_8c_source.html#l00581">parsedate.c:581</a></div></div>
<div class="ttc" id="http_8c_html_ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac"><div class="ttname"><a href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aa438fe9dc3e5064d4ea041361fe94e4ac">HEADER_PROXY</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01680">http.c:1680</a></div></div>
<div class="ttc" id="connect_8h_html_acdca2a91749c4f2ca1805e482bad0f90"><div class="ttname"><a href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a></div><div class="ttdeci">#define connkeep(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8h_source.html#l00146">connect.h:146</a></div></div>
<div class="ttc" id="http_8c_html_a93b36c38666b0081c09b3638f4b2c8f2"><div class="ttname"><a href="http_8c.html#a93b36c38666b0081c09b3638f4b2c8f2">Curl_add_bufferf</a></div><div class="ttdeci">CURLcode Curl_add_bufferf(Curl_send_buffer **inp, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01275">http.c:1275</a></div></div>
<div class="ttc" id="struct_h_t_t_p_1_1back_html_ab716577164f66a69879464de14483261"><div class="ttname"><a href="struct_h_t_t_p_1_1back.html#ab716577164f66a69879464de14483261">HTTP::back::fread_func</a></div><div class="ttdeci">curl_read_callback fread_func</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00146">http.h:146</a></div></div>
<div class="ttc" id="structauth_html_accd2174ae1200c36506d9ebd853cc9a0"><div class="ttname"><a href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">auth::done</a></div><div class="ttdeci">bool done</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01178">urldata.h:1178</a></div></div>
<div class="ttc" id="struct_single_request_html_af2f3e08b65781f0ff20d40257c6f9274"><div class="ttname"><a href="struct_single_request.html#af2f3e08b65781f0ff20d40257c6f9274">SingleRequest::str_start</a></div><div class="ttdeci">char * str_start</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00566">urldata.h:566</a></div></div>
<div class="ttc" id="content__encoding_8c_html_ab341f4f03f5aa236c5e5b2b25e5ff806"><div class="ttname"><a href="content__encoding_8c.html#ab341f4f03f5aa236c5e5b2b25e5ff806">Curl_unencode_cleanup</a></div><div class="ttdeci">void Curl_unencode_cleanup(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00909">content_encoding.c:909</a></div></div>
<div class="ttc" id="http_8c_html_ab8c4f46b5f0c91777ce7c37f28e2e383"><div class="ttname"><a href="http_8c.html#ab8c4f46b5f0c91777ce7c37f28e2e383">Curl_http_setup_conn</a></div><div class="ttdeci">CURLcode Curl_http_setup_conn(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00156">http.c:156</a></div></div>
<div class="ttc" id="structauth_html_a528e3d9dd89f7435a5536e0b0a771c82"><div class="ttname"><a href="structauth.html#a528e3d9dd89f7435a5536e0b0a771c82">auth::avail</a></div><div class="ttdeci">unsigned long avail</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01176">urldata.h:1176</a></div></div>
<div class="ttc" id="structauth_html_aae718acfacc079a7d76873e0c175491a"><div class="ttname"><a href="structauth.html#aae718acfacc079a7d76873e0c175491a">auth::picked</a></div><div class="ttdeci">unsigned long picked</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01175">urldata.h:1175</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="struct_h_t_t_p_1_1back_html_ac6da073e602d3fc16265a4aaa2c3e564"><div class="ttname"><a href="struct_h_t_t_p_1_1back.html#ac6da073e602d3fc16265a4aaa2c3e564">HTTP::back::fread_in</a></div><div class="ttdeci">void * fread_in</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00147">http.h:147</a></div></div>
<div class="ttc" id="structconnectdata_html_a2bb9cb7096c4799e15ed1b449c5c7f1b"><div class="ttname"><a href="structconnectdata.html#a2bb9cb7096c4799e15ed1b449c5c7f1b">connectdata::bundle</a></div><div class="ttdeci">struct connectbundle * bundle</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01031">urldata.h:1031</a></div></div>
<div class="ttc" id="header_8d_html_aa3b968e072109a68f98fd988ad6639af"><div class="ttname"><a href="header_8d.html#aa3b968e072109a68f98fd988ad6639af">content</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header content</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="header_8d_html_af039c1a4bf9f7d5ffdd981d66cd3fb2d"><div class="ttname"><a href="header_8d.html#af039c1a4bf9f7d5ffdd981d66cd3fb2d">in</a></div><div class="ttdeci">Long your externally set header will be used instead of the one.This allows you to make even trickier stuff than curl would normally do.You should not replace internally set headers without knowing perfectly well what you re doing.Remove an header by giving a replacement without content on the right side of the as in</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00009">header.d:9</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_acc3e9b1176bd8c62c4fe0e017007e719"><div class="ttname"><a href="curl__ctype_8h.html#acc3e9b1176bd8c62c4fe0e017007e719">ISDIGIT</a></div><div class="ttdeci">#define ISDIGIT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00065">curl_ctype.h:65</a></div></div>
<div class="ttc" id="curl_8h_html_a845d262749bd413d724b58e26f713f25a78e03271e03b8cd828de47160a602353"><div class="ttname"><a href="curl_8h.html#a845d262749bd413d724b58e26f713f25a78e03271e03b8cd828de47160a602353">CURL_TIMECOND_LASTMOD</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02019">curl.h:2019</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_aa07a14421f4a6ec64d3f73f9c2fa9bce"><div class="ttname"><a href="struct_h_t_t_p.html#aa07a14421f4a6ec64d3f73f9c2fa9bce">HTTP::postsize</a></div><div class="ttdeci">curl_off_t postsize</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00134">http.h:134</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a2fc887b2697c63980406a19108b82a24"><div class="ttname"><a href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">Curl_handler::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00702">urldata.h:702</a></div></div>
<div class="ttc" id="transfer_8h_html"><div class="ttname"><a href="transfer_8h.html">transfer.h</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a65fc1659abbe70105a0a13e70b12befd"><div class="ttname"><a href="struct_connect_bits.html#a65fc1659abbe70105a0a13e70b12befd">ConnectBits::authneg</a></div><div class="ttdeci">bool authneg</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00409">urldata.h:409</a></div></div>
<div class="ttc" id="cookie_8c_html_a14f67e6a0c8364b8d4990de8150f32c0"><div class="ttname"><a href="cookie_8c.html#a14f67e6a0c8364b8d4990de8150f32c0">Curl_cookie_getlist</a></div><div class="ttdeci">struct Cookie * Curl_cookie_getlist(struct CookieInfo *c, const char *host, const char *path, bool secure)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01218">cookie.c:1218</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9c15eee85076ef8d51e4edb972b43492"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9c15eee85076ef8d51e4edb972b43492">CURLE_GOT_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00522">curl.h:522</a></div></div>
<div class="ttc" id="http_8c_html_ae3dc4a63f791cddc2b843736433a6c62"><div class="ttname"><a href="http_8c.html#ae3dc4a63f791cddc2b843736433a6c62">Curl_http_done</a></div><div class="ttdeci">CURLcode Curl_http_done(struct connectdata *conn, CURLcode status, bool premature)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01542">http.c:1542</a></div></div>
<div class="ttc" id="http2_8h_html_a2295b843d76aeb06631566bfebc73be8"><div class="ttname"><a href="http2_8h.html#a2295b843d76aeb06631566bfebc73be8">Curl_http2_setup_conn</a></div><div class="ttdeci">#define Curl_http2_setup_conn(x)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00071">http2.h:71</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="http_8c_html_ac009a02368ec5154996b23065aa85a28"><div class="ttname"><a href="http_8c.html#ac009a02368ec5154996b23065aa85a28">Curl_http</a></div><div class="ttdeci">CURLcode Curl_http(struct connectdata *conn, bool *done)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01879">http.c:1879</a></div></div>
<div class="ttc" id="structconnectdata_html_a347307932d5d64be48527b2f3ed666ca"><div class="ttname"><a href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">connectdata::proto</a></div><div class="ttdeci">union connectdata::@45 proto</div></div>
<div class="ttc" id="urldata_8h_html_a34fcb7c4bc590f8c24dee47e14ed41d6"><div class="ttname"><a href="urldata_8h.html#a34fcb7c4bc590f8c24dee47e14ed41d6">CONN_INUSE</a></div><div class="ttdeci">#define CONN_INUSE(c)</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00803">urldata.h:803</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_aba0d54486cf031467f38895a0c29a5b3"><div class="ttname"><a href="struct_h_t_t_p.html#aba0d54486cf031467f38895a0c29a5b3">HTTP::writebytecount</a></div><div class="ttdeci">curl_off_t writebytecount</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00140">http.h:140</a></div></div>
<div class="ttc" id="share_8c_html_a5dcfa53b653176b92395464a33b509cb"><div class="ttname"><a href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a></div><div class="ttdeci">CURLSHcode Curl_share_lock(struct Curl_easy *data, curl_lock_data type, curl_lock_access accesstype)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00226">share.c:226</a></div></div>
<div class="ttc" id="lib_2rtsp_8c_html_afa54e7575f81e2d69ecdb747a10dcbba"><div class="ttname"><a href="lib_2rtsp_8c.html#afa54e7575f81e2d69ecdb747a10dcbba">Curl_rtsp_parseheader</a></div><div class="ttdeci">CURLcode Curl_rtsp_parseheader(struct connectdata *conn, char *header)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2rtsp_8c_source.html#l00788">rtsp.c:788</a></div></div>
<div class="ttc" id="structcurl__mimepart__s_html_a74d921c113fd98a562923807ed68e129"><div class="ttname"><a href="structcurl__mimepart__s.html#a74d921c113fd98a562923807ed68e129">curl_mimepart_s::curlheaders</a></div><div class="ttdeci">struct curl_slist * curlheaders</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00113">mime.h:113</a></div></div>
<div class="ttc" id="http_8c_html_a8439073425968002da46c16791460fba"><div class="ttname"><a href="http_8c.html#a8439073425968002da46c16791460fba">Curl_add_buffer_init</a></div><div class="ttdeci">Curl_send_buffer * Curl_add_buffer_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01093">http.c:1093</a></div></div>
<div class="ttc" id="curl_8h_html_abc5c98fcc1211af2b80116dd6e0a035da6ecc2e3f6ae7980d0ed29cf391a8b3f2"><div class="ttname"><a href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da6ecc2e3f6ae7980d0ed29cf391a8b3f2">CURL_HTTP_VERSION_2_PRIOR_KNOWLEDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01929">curl.h:1929</a></div></div>
<div class="ttc" id="struct_connect_bits_html_aa4606cd7d5928857e28473a129c4ccf0"><div class="ttname"><a href="struct_connect_bits.html#aa4606cd7d5928857e28473a129c4ccf0">ConnectBits::ipv6</a></div><div class="ttdeci">bool ipv6</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00394">urldata.h:394</a></div></div>
<div class="ttc" id="strcase_8h_html_a23b67e200b6f4c3ead633c94b3edcdb3"><div class="ttname"><a href="strcase_8h.html#a23b67e200b6f4c3ead633c94b3edcdb3">checkprefix</a></div><div class="ttdeci">#define checkprefix(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00046">strcase.h:46</a></div></div>
<div class="ttc" id="curl_8h_html_a49d83160803f433b12209ed52aafc05f"><div class="ttname"><a href="curl_8h.html#a49d83160803f433b12209ed52aafc05f">CURL_HTTP_VERSION_2</a></div><div class="ttdeci">#define CURL_HTTP_VERSION_2</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01938">curl.h:1938</a></div></div>
<div class="ttc" id="structconnectdata_html_ad7ad0216049eeb5099888585025e2202"><div class="ttname"><a href="structconnectdata.html#ad7ad0216049eeb5099888585025e2202">connectdata::seek_client</a></div><div class="ttdeci">void * seek_client</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00974">urldata.h:974</a></div></div>
<div class="ttc" id="curl_8h_html_ae8273f5a281c589c89d0d3ab2f565a93"><div class="ttname"><a href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a></div><div class="ttdeci">#define CURLAUTH_DIGEST</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00707">curl.h:707</a></div></div>
<div class="ttc" id="http_8c_html_a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0"><div class="ttname"><a href="http_8c.html#a5e8926572799ef0618c27df845d36395abf530b11ecaf1a6bbab49b3c9175b4d0">STATUS_BAD</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l02948">http.c:2948</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a802d4850777aae029b9aa17dc163580d"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a802d4850777aae029b9aa17dc163580d">connectdata::dynamically_allocated_data::accept_encoding</a></div><div class="ttdeci">char * accept_encoding</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00929">urldata.h:929</a></div></div>
<div class="ttc" id="cookie_8c_html_a4e0b732b5a4ce674481a17c5c0b1ade6"><div class="ttname"><a href="cookie_8c.html#a4e0b732b5a4ce674481a17c5c0b1ade6">Curl_cookie_freelist</a></div><div class="ttdeci">void Curl_cookie_freelist(struct Cookie *co)</div><div class="ttdef"><b>Definition:</b> <a href="cookie_8c_source.html#l01341">cookie.c:1341</a></div></div>
<div class="ttc" id="warnless_8h_html"><div class="ttname"><a href="warnless_8h.html">warnless.h</a></div></div>
<div class="ttc" id="urldata_8h_html_ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389"><div class="ttname"><a href="urldata_8h.html#ac67e77846b7b67d5808da8f1dfa2eab8ae11eeb30f15276332563390b730fd389">HTTPREQ_POST_FORM</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01136">urldata.h:1136</a></div></div>
<div class="ttc" id="curl_8h_html_a9704d2633927f77efaa3e3c6f1c23a14a650f0c484d2be1b78af50ff3d5bf4ddc"><div class="ttname"><a href="curl_8h.html#a9704d2633927f77efaa3e3c6f1c23a14a650f0c484d2be1b78af50ff3d5bf4ddc">CURLINFO_DATA_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00437">curl.h:437</a></div></div>
<div class="ttc" id="urldata_8h_html_a5158b1e31a4e7aa84de308e3d792a1de"><div class="ttname"><a href="urldata_8h.html#a5158b1e31a4e7aa84de308e3d792a1de">PORT_HTTP</a></div><div class="ttdeci">#define PORT_HTTP</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00032">urldata.h:32</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html"><div class="ttname"><a href="struct_h_t_t_p.html">HTTP</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00132">http.h:132</a></div></div>
<div class="ttc" id="structauth_html_a6400153286a044e63643d53d34094321"><div class="ttname"><a href="structauth.html#a6400153286a044e63643d53d34094321">auth::want</a></div><div class="ttdeci">unsigned long want</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01173">urldata.h:1173</a></div></div>
<div class="ttc" id="urldata_8h_html_a9ea1f37a358d8c3a9ee378b36e614b48"><div class="ttname"><a href="urldata_8h.html#a9ea1f37a358d8c3a9ee378b36e614b48">PROTOPT_CREDSPERREQUEST</a></div><div class="ttdeci">#define PROTOPT_CREDSPERREQUEST</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00719">urldata.h:719</a></div></div>
<div class="ttc" id="structproxy__info_html_a1bc66a2c41e16eb2138fc7bc4f96021a"><div class="ttname"><a href="structproxy__info.html#a1bc66a2c41e16eb2138fc7bc4f96021a">proxy_info::proxytype</a></div><div class="ttdeci">curl_proxytype proxytype</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00754">urldata.h:754</a></div></div>
<div class="ttc" id="urlapi_8h_html_a67b5d249b020eeb8b9a3d0d2e2bf3a7f"><div class="ttname"><a href="urlapi_8h.html#a67b5d249b020eeb8b9a3d0d2e2bf3a7f">curl_url_dup</a></div><div class="ttdeci">CURL_EXTERN CURLU * curl_url_dup(CURLU *in)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00899">urlapi.c:899</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a2abc75753ca4206fe82edfd27c1479c6"><div class="ttname"><a href="struct_connect_bits.html#a2abc75753ca4206fe82edfd27c1479c6">ConnectBits::retry</a></div><div class="ttdeci">bool retry</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00403">urldata.h:403</a></div></div>
<div class="ttc" id="urlapi_8h_html_aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0"><div class="ttname"><a href="urlapi_8h.html#aa61ba3e924e11f4a7f208aa051a5d2eba31b7e4d52954c2d447b851e4891cf7a0">CURLUPART_USER</a></div><div class="ttdef"><b>Definition:</b> <a href="urlapi_8h_source.html#l00054">urlapi.h:54</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a2add5ba8e130d30982d125214f83b921"><div class="ttname"><a href="curl__printf_8h.html#a2add5ba8e130d30982d125214f83b921">vaprintf</a></div><div class="ttdeci">#define vaprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00047">curl_printf.h:47</a></div></div>
<div class="ttc" id="hostip_8h_html"><div class="ttname"><a href="hostip_8h.html">hostip.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ac6544fd7da6ddfd7893d74095b17a28d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ac6544fd7da6ddfd7893d74095b17a28d">CURLE_PARTIAL_FILE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00484">curl.h:484</a></div></div>
<div class="ttc" id="urldata_8h_html_a816857c637b57c60b680d1bf575ef159a4b76a91757deee490e11c850676b29da"><div class="ttname"><a href="urldata_8h.html#a816857c637b57c60b680d1bf575ef159a4b76a91757deee490e11c850676b29da">RTSPREQ_DESCRIBE</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01148">urldata.h:1148</a></div></div>
<div class="ttc" id="http_8h_html_a31346b3abe9af85dfebb99a72714e7d0"><div class="ttname"><a href="http_8h.html#a31346b3abe9af85dfebb99a72714e7d0">CURLAUTH_PICKNONE</a></div><div class="ttdeci">#define CURLAUTH_PICKNONE</div><div class="ttdef"><b>Definition:</b> <a href="http_8h_source.html#l00100">http.h:100</a></div></div>
<div class="ttc" id="structconnectdata_html_a94e8ccd4c3824eb5353efcd5016908fa"><div class="ttname"><a href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">connectdata::allocptr</a></div><div class="ttdeci">struct connectdata::dynamically_allocated_data allocptr</div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="http_8c_html_ada3b16c5ed5c539dfdfe51909d1224ec"><div class="ttname"><a href="http_8c.html#ada3b16c5ed5c539dfdfe51909d1224ec">Curl_handler_http</a></div><div class="ttdeci">const struct Curl_handler Curl_handler_http</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l00109">http.c:109</a></div></div>
<div class="ttc" id="http_8c_html_ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064"><div class="ttname"><a href="http_8c.html#ab0c856a8320e36a478b5fd2422ef023aab7de5afd8b165fdeccb65768c449b064">HEADER_SERVER</a></div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01679">http.c:1679</a></div></div>
<div class="ttc" id="warnless_8c_html_a9b1c2efcef4120b8096d53bc254bfb9b"><div class="ttname"><a href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a></div><div class="ttdeci">size_t curlx_sotouz(curl_off_t sonum)</div><div class="ttdef"><b>Definition:</b> <a href="warnless_8c_source.html#l00347">warnless.c:347</a></div></div>
<div class="ttc" id="curl_8h_html_adb5a46d02359d2379dc7e0904c987828"><div class="ttname"><a href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a></div><div class="ttdeci">int curl_socket_t</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00130">curl.h:130</a></div></div>
<div class="ttc" id="http2_8h_html_aad8497d84887a3deea025eb5c06cc5f9"><div class="ttname"><a href="http2_8h.html#aad8497d84887a3deea025eb5c06cc5f9">Curl_http2_setup</a></div><div class="ttdeci">#define Curl_http2_setup(x)</div><div class="ttdef"><b>Definition:</b> <a href="http2_8h_source.html#l00069">http2.h:69</a></div></div>
<div class="ttc" id="struct_single_request_html_acd41ba7d3b44e699dd1a46ec4754e151"><div class="ttname"><a href="struct_single_request.html#acd41ba7d3b44e699dd1a46ec4754e151">SingleRequest::badheader</a></div><div class="ttdeci">enum SingleRequest::@43 badheader</div></div>
<div class="ttc" id="curl_8h_html_abc73006227ef9c2827f26b33d7cbadce"><div class="ttname"><a href="curl_8h.html#abc73006227ef9c2827f26b33d7cbadce">CURLAUTH_NTLM_WB</a></div><div class="ttdeci">#define CURLAUTH_NTLM_WB</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00715">curl.h:715</a></div></div>
<div class="ttc" id="cert_8d_html_ad21adcb792d0eec29088bb9e0b006a1a"><div class="ttname"><a href="cert_8d.html#ad21adcb792d0eec29088bb9e0b006a1a">prefix</a></div><div class="ttdeci">Short FTPS or another SSL based protocol.The certificate must be in PKCS engine.If the optional password isn t it will be queried for on the terminal.Note that this option assumes a &amp;certificate file that is the key and the client certificate concatenated ! See cert and key to specify them independently.If curl is built against the NSS SSL library then this option can tell curl the nickname of the certificate to use within the NSS database defined by the environment variable please precede it with. prefix</div><div class="ttdef"><b>Definition:</b> <a href="cert_8d_source.html#l00021">cert.d:21</a></div></div>
<div class="ttc" id="vauth_8h_html"><div class="ttname"><a href="vauth_8h.html">vauth.h</a></div></div>
<div class="ttc" id="url_8h_html"><div class="ttname"><a href="url_8h.html">url.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a9d346cfcc0046f6c6ed206bde086ab2d"><div class="ttname"><a href="urldata_8h.html#a9d346cfcc0046f6c6ed206bde086ab2d">PROTO_FAMILY_HTTP</a></div><div class="ttdeci">#define PROTO_FAMILY_HTTP</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00066">urldata.h:66</a></div></div>
<div class="ttc" id="structproxy__info_html_adba1abda48be65b7b737625d591193f9"><div class="ttname"><a href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">proxy_info::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00755">urldata.h:755</a></div></div>
<div class="ttc" id="struct_h_t_t_p_html_ae62bcf28b1521243d84564626bc68c97"><div class="ttname"><a href="struct_h_t_t_p.html#ae62bcf28b1521243d84564626bc68c97">HTTP::backup</a></div><div class="ttdeci">struct HTTP::back backup</div></div>
<div class="ttc" id="get_8d_html_a38b0ef81b65f2aee282c8c217a123176"><div class="ttname"><a href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a></div><div class="ttdeci">Long this option will make all data specified with data</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="strcase_8c_html_a555bbf5fd8dc146336474a2bb7959524"><div class="ttname"><a href="strcase_8c.html#a555bbf5fd8dc146336474a2bb7959524">Curl_raw_toupper</a></div><div class="ttdeci">char Curl_raw_toupper(char in)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8c_source.html#l00031">strcase.c:31</a></div></div>
<div class="ttc" id="struct_single_request_html"><div class="ttname"><a href="struct_single_request.html">SingleRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00533">urldata.h:533</a></div></div>
<div class="ttc" id="structhostname_html_aee7d0ff8210c25b87d6fdeacf8ea7939"><div class="ttname"><a href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">hostname::dispname</a></div><div class="ttdeci">const char * dispname</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00450">urldata.h:450</a></div></div>
<div class="ttc" id="http_8c_html_adaf0c79a3bcc19f4c388cb5e0a33f030"><div class="ttname"><a href="http_8c.html#adaf0c79a3bcc19f4c388cb5e0a33f030">Curl_add_buffer_free</a></div><div class="ttdeci">void Curl_add_buffer_free(Curl_send_buffer **inp)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01101">http.c:1101</a></div></div>
<div class="ttc" id="curl_8h_html_a845d262749bd413d724b58e26f713f25ab52a0e6ddf579f8f81b40d8a684155a6"><div class="ttname"><a href="curl_8h.html#a845d262749bd413d724b58e26f713f25ab52a0e6ddf579f8f81b40d8a684155a6">CURL_TIMECOND_IFUNMODSINCE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02018">curl.h:2018</a></div></div>
<div class="ttc" id="http_8c_html_a5c85b5569e59e6f859ac92b0ba3c0920"><div class="ttname"><a href="http_8c.html#a5c85b5569e59e6f859ac92b0ba3c0920">HEADER1</a></div><div class="ttdeci">#define HEADER1</div></div>
<div class="ttc" id="struct_connect_bits_html_a3bfd8a5d78dc98e435348b877e19f619"><div class="ttname"><a href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">ConnectBits::user_passwd</a></div><div class="ttdeci">bool user_passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00390">urldata.h:390</a></div></div>
<div class="ttc" id="struct_single_request_html_a3018293fe5f120a8a4c77d16207ab5da"><div class="ttname"><a href="struct_single_request.html#a3018293fe5f120a8a4c77d16207ab5da">SingleRequest::chunk</a></div><div class="ttdeci">bool chunk</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00610">urldata.h:610</a></div></div>
<div class="ttc" id="curl_8h_html_a65444a26674d01b4fa07858339c10592"><div class="ttname"><a href="curl_8h.html#a65444a26674d01b4fa07858339c10592">curl_strnequal</a></div><div class="ttdeci">CURL_EXTERN int curl_strnequal(const char *s1, const char *s2, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8c_source.html#l00174">strcase.c:174</a></div></div>
<div class="ttc" id="http_8c_html_a14d14997ce72dcbad55dd95c7c3bf08e"><div class="ttname"><a href="http_8c.html#a14d14997ce72dcbad55dd95c7c3bf08e">Curl_add_custom_headers</a></div><div class="ttdeci">CURLcode Curl_add_custom_headers(struct connectdata *conn, bool is_connect, Curl_send_buffer *req_buffer)</div><div class="ttdef"><b>Definition:</b> <a href="http_8c_source.html#l01684">http.c:1684</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_ae18576e8daa81e213781ac6c0183109f"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#ae18576e8daa81e213781ac6c0183109f">connectdata::dynamically_allocated_data::cookiehost</a></div><div class="ttdeci">char * cookiehost</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00934">urldata.h:934</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="formdata_8c_html_ad3f5007831015b4fdf8b2078b525eeea"><div class="ttname"><a href="formdata_8c.html#ad3f5007831015b4fdf8b2078b525eeea">Curl_getformdata</a></div><div class="ttdeci">CURLcode Curl_getformdata(struct Curl_easy *data, curl_mimepart *finalform, struct curl_httppost *post, curl_read_callback fread_func)</div><div class="ttdef"><b>Definition:</b> <a href="formdata_8c_source.html#l00806">formdata.c:806</a></div></div>
<div class="ttc" id="structconnectdata_html_a82d9732a096255f5d8741c4a0ea990eb"><div class="ttname"><a href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">connectdata::remote_port</a></div><div class="ttdeci">int remote_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00840">urldata.h:840</a></div></div>
<div class="ttc" id="structconnectdata_html_a85cb9da7776d42c440612d2940a7fcb4"><div class="ttname"><a href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">connectdata::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00863">urldata.h:863</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl_8h_html_abc5c98fcc1211af2b80116dd6e0a035da4006f988c2417f7059cf2b5f0d79630f"><div class="ttname"><a href="curl_8h.html#abc5c98fcc1211af2b80116dd6e0a035da4006f988c2417f7059cf2b5f0d79630f">CURL_HTTP_VERSION_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01922">curl.h:1922</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
<div class="ttc" id="struct_cookie_html"><div class="ttname"><a href="struct_cookie.html">Cookie</a></div><div class="ttdef"><b>Definition:</b> <a href="cookie_8h_source.html#l00028">cookie.h:28</a></div></div>
<div class="ttc" id="struct_curl___u_r_l_html"><div class="ttname"><a href="struct_curl___u_r_l.html">Curl_URL</a></div><div class="ttdef"><b>Definition:</b> <a href="lib_2urlapi_8c_source.html#l00053">urlapi.c:53</a></div></div>
<div class="ttc" id="util_8c_html_a3b02c6de5c049804444a246f7fdf46b4"><div class="ttname"><a href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a></div><div class="ttdeci">const char * path</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00194">util.c:194</a></div></div>
<div class="ttc" id="http__proxy_8c_html_ac79abdd8c0d0b2818f4478e91afcaa35"><div class="ttname"><a href="http__proxy_8c.html#ac79abdd8c0d0b2818f4478e91afcaa35">Curl_proxy_connect</a></div><div class="ttdeci">CURLcode Curl_proxy_connect(struct connectdata *conn, int sockindex)</div><div class="ttdef"><b>Definition:</b> <a href="http__proxy_8c_source.html#l00072">http_proxy.c:72</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a805079d1643f348afa725659b45b6f87"><div class="ttname"><a href="curl__setup__once_8h.html#a805079d1643f348afa725659b45b6f87">DEBUGF</a></div><div class="ttdeci">#define DEBUGF(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00390">curl_setup_once.h:390</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="http_8c.html">http.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
