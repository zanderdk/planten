<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/cpp_utils/WebSocket.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_web_socket_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WebSocket.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_web_socket_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * WebSocket.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Sep 2, 2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_web_socket_8h.html">WebSocket.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_task_8h.html">Task.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_general_utils_8h.html">GeneralUtils.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;esp_log.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keyword">extern</span> uint16_t <a class="code" href="_web_socket_8cpp.html#aee0c3c901bd90b3760c5e69dff6c5f58">lwip_ntohs</a>(uint16_t);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">extern</span> uint32_t <a class="code" href="_web_socket_8cpp.html#a7e4133c98661e1e258f6c636e3c1245c">lwip_ntohl</a>(uint32_t);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">extern</span> uint16_t <a class="code" href="_web_socket_8cpp.html#a5f9d3d3ad8fc8c55f29bfad1e862d2f8">lwip_htons</a>(uint16_t);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">extern</span> uint32_t <a class="code" href="_web_socket_8cpp.html#a379424b6bc52498c9dca693c6aea3549">lwip_htonl</a>(uint32_t);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* LOG_TAG = <span class="stringliteral">&quot;WebSocket&quot;</span>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// WebSocket op codes as found in a WebSocket frame.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_CONTINUE = 0x00;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_TEXT     = 0x01;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_BINARY   = 0x02;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_CLOSE    = 0x08;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_PING     = 0x09;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t OPCODE_PONG     = 0x0a;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// Structure definition for the WebSocket frame.</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="struct_frame.html">   33</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_frame.html">Frame</a> {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Byte 0</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">   35</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">opCode</a> : 4; <span class="comment">// [7:4]</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="struct_frame.html#a8d2ebd82ce8e048073381bb90e0edb36">   36</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#a8d2ebd82ce8e048073381bb90e0edb36">rsv3</a>   : 1; <span class="comment">// [3]</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="struct_frame.html#aafd7354ead1eef8839866234d9c51b84">   37</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#aafd7354ead1eef8839866234d9c51b84">rsv2</a>   : 1; <span class="comment">// [2]</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="struct_frame.html#a59f506c78c294e70bc22523a04afbc6d">   38</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#a59f506c78c294e70bc22523a04afbc6d">rsv1</a>   : 1; <span class="comment">// [1]</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">   39</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">fin</a>    : 1; <span class="comment">// [0]</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Byte 1</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">   42</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">len</a>    : 7; <span class="comment">// [7:1]</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">   43</a></span>&#160;    uint8_t <a class="code" href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">mask</a>   : 1; <span class="comment">// [0]</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> dumpFrame(<a class="code" href="struct_frame.html">Frame</a> frame) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::ostringstream oss;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;Fin: &quot;</span> &lt;&lt; (int) frame.<a class="code" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">fin</a> &lt;&lt; <span class="stringliteral">&quot;, OpCode: &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) frame.<a class="code" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">opCode</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">switch</span> (frame.<a class="code" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">opCode</a>) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">case</span> OPCODE_BINARY: {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; BINARY&quot;</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">case</span> OPCODE_CONTINUE: {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; CONTINUE&quot;</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">case</span> OPCODE_CLOSE: {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; CLOSE&quot;</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">case</span> OPCODE_PING: {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; PING&quot;</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">case</span> OPCODE_PONG: {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; PONG&quot;</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">case</span> OPCODE_TEXT: {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; TEXT&quot;</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            oss &lt;&lt; <span class="stringliteral">&quot; Unknown&quot;</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;, Mask: &quot;</span> &lt;&lt; (int) frame.<a class="code" href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">mask</a> &lt;&lt; <span class="stringliteral">&quot;, len: &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) frame.<a class="code" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">len</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;WebSocket frame: %s&quot;</span>, oss.str().c_str());</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;} <span class="comment">// dumpFrame</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="class_web_socket_reader.html">   96</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_web_socket_reader.html">WebSocketReader</a>: <span class="keyword">public</span> <a class="code" href="class_task.html">Task</a> {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_web_socket_reader.html#ae252876205a066b268ab1666c86e55e5">   98</a></span>&#160;    <a class="code" href="class_web_socket_reader.html#ae252876205a066b268ab1666c86e55e5">WebSocketReader</a>() {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        m_end = <span class="keyword">false</span>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_web_socket_reader.html#a6de169c863a3a0ce254acf3a694b9c93">  101</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_web_socket_reader.html#a6de169c863a3a0ce254acf3a694b9c93">end</a>() {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        m_end = <span class="keyword">true</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">bool</span> m_end;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">void</span> run(<span class="keywordtype">void</span>* <a class="code" href="structdata.html">data</a>) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="class_web_socket.html">WebSocket</a>* pWebSocket = (<a class="code" href="class_web_socket.html">WebSocket</a>*) <a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;WebSocketReader Task started, socket: %s&quot;</span>, pWebSocket-&gt;<a class="code" href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">getSocket</a>().<a class="code" href="class_socket.html#a377ac3bcbf52e36dc08bca6ad0c8a97f">toString</a>().c_str());</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="class_socket.html">Socket</a> peerSocket = pWebSocket-&gt;<a class="code" href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">getSocket</a>();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="struct_frame.html">Frame</a> frame;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (m_end) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Waiting on socket data for socket %s&quot;</span>, peerSocket.toString().c_str());</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">int</span> length = peerSocket.receive((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame), <span class="keyword">true</span>); <span class="comment">// Read exact</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (length != <span class="keyword">sizeof</span>(frame)) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Socket read error&quot;</span>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                pWebSocket-&gt;<a class="code" href="class_web_socket.html#a57b53de6aeafeb1f57eed90a3357aaa8">close</a>();</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Received data from web socket.  Length: %d&quot;</span>, length);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            dumpFrame(frame);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">// The following section parses the WebSocket frame.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            uint32_t payloadLen = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            uint8_t  mask[4];</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span> (frame.len &lt; 126) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                payloadLen = frame.len;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frame.len == 126) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                uint16_t tempLen;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                peerSocket.receive((uint8_t*) &amp;tempLen, <span class="keyword">sizeof</span>(tempLen), <span class="keyword">true</span>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                payloadLen = ntohs(tempLen);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frame.len == 127) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                uint64_t tempLen;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                peerSocket.receive((uint8_t*) &amp;tempLen, <span class="keyword">sizeof</span>(tempLen), <span class="keyword">true</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                payloadLen = ntohl((uint32_t) tempLen);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">if</span> (frame.mask == 1) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                peerSocket.receive(mask, <span class="keyword">sizeof</span>(mask), <span class="keyword">true</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (payloadLen == 0) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Web socket payload is not present&quot;</span>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Web socket payload, length=%d:&quot;</span>, payloadLen);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="class_web_socket_handler.html">WebSocketHandler</a>* pWebSocketHandler = pWebSocket-&gt;<a class="code" href="class_web_socket.html#a93cd22aa94f9c0ef2a49e78a822aaa88">getHandler</a>();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">switch</span> (frame.opCode) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordflow">case</span> OPCODE_TEXT:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">case</span> OPCODE_BINARY: {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="keywordflow">if</span> (pWebSocketHandler != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        <a class="code" href="class_web_socket_input_streambuf.html">WebSocketInputStreambuf</a> streambuf(pWebSocket-&gt;<a class="code" href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">getSocket</a>(), payloadLen, (frame.mask == 1) ? mask : <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        pWebSocketHandler-&gt;<a class="code" href="class_web_socket_handler.html#a0bd22f329ec6953580c3d4907e5ecc18">onMessage</a>(&amp;streambuf, pWebSocket);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        <span class="comment">//streambuf.discard();</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="comment">// If the WebSocket operation code is close then we are closing the connection.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">case</span> OPCODE_CLOSE: {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    pWebSocket-&gt;m_receivedClose = <span class="keyword">true</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <span class="keywordflow">if</span> (pWebSocketHandler != <span class="keyword">nullptr</span>) { <span class="comment">// If we have a handler, invoke the onClose method upon it.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        pWebSocketHandler-&gt;<a class="code" href="class_web_socket_handler.html#a0ae1d5bde410e9f720bcc007ffd4cd0e">onClose</a>();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    pWebSocket-&gt;<a class="code" href="class_web_socket.html#a57b53de6aeafeb1f57eed90a3357aaa8">close</a>();                <span class="comment">// Close the websocket.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordflow">case</span> OPCODE_CONTINUE: {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">case</span> OPCODE_PING: {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">case</span> OPCODE_PONG: {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;Unknown opcode: %d&quot;</span>, frame.opCode);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            } <span class="comment">// Switch opCode</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        } <span class="comment">// while (true)</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        ESP_LOGD(<span class="stringliteral">&quot;WebSocketReader&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; run&quot;</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    } <span class="comment">// run</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}; <span class="comment">// WebSocketReader</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_web_socket_handler.html#a0ae1d5bde410e9f720bcc007ffd4cd0e">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket_handler.html#a0ae1d5bde410e9f720bcc007ffd4cd0e">WebSocketHandler::onClose</a>() {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onClose&quot;</span>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onClose&quot;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;} <span class="comment">// onClose</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="class_web_socket_handler.html#a0bd22f329ec6953580c3d4907e5ecc18">  220</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket_handler.html#a0bd22f329ec6953580c3d4907e5ecc18">WebSocketHandler::onMessage</a>(<a class="code" href="class_web_socket_input_streambuf.html">WebSocketInputStreambuf</a>* pWebSocketInputStreambuf, <a class="code" href="class_web_socket.html">WebSocket</a>* pWebSocket) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onMessage&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onMessage&quot;</span>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;} <span class="comment">// onData</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="class_web_socket_handler.html#a0cc7913f3f6c9ae8e390401db99e659e">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket_handler.html#a0cc7913f3f6c9ae8e390401db99e659e">WebSocketHandler::onError</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> error) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; onError: %s&quot;</span>, error.c_str());</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketHandler&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; onError&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;} <span class="comment">// onError</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="class_web_socket.html#a30c8399db86bb20fdc8facd5d68c79de">  239</a></span>&#160;<a class="code" href="class_web_socket.html#a30c8399db86bb20fdc8facd5d68c79de">WebSocket::WebSocket</a>(<a class="code" href="class_socket.html">Socket</a> socket) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    m_receivedClose     = <span class="keyword">false</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    m_sentClose         = <span class="keyword">false</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    m_socket            = socket;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    m_pWebSockerReader  = <span class="keyword">new</span> <a class="code" href="class_web_socket.html#afccf93c4ac44f2347ab84d7e2419a2ca">WebSocketReader</a>();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    m_pWebSocketHandler = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;} <span class="comment">// WebSocket</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="class_web_socket.html#a48afbe9b82fde4479913a1b931444729">  251</a></span>&#160;<a class="code" href="class_web_socket.html#a48afbe9b82fde4479913a1b931444729">WebSocket::~WebSocket</a>() {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    m_pWebSockerReader-&gt;<a class="code" href="class_task.html#aba5eb3d6c2a034aa0e319383fbec68c4">stop</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">delete</span> m_pWebSockerReader;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;} <span class="comment">// ~WebSocket</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="class_web_socket.html#a57b53de6aeafeb1f57eed90a3357aaa8">  262</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket.html#a57b53de6aeafeb1f57eed90a3357aaa8">WebSocket::close</a>(uint16_t status, <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> message) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; close(): status: %d, message: %s&quot;</span>, status, message.c_str());</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (m_sentClose) {             <span class="comment">// If we have previously sent a close request then we can close the underlying socket.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;Closing the underlying socket&quot;</span>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        m_socket.<a class="code" href="class_socket.html#aef06605c6725958004116983f1a2051f">close</a>();            <span class="comment">// Close the underlying socket.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        m_pWebSockerReader-&gt;<a class="code" href="class_web_socket_reader.html#a6de169c863a3a0ce254acf3a694b9c93">end</a>();   <span class="comment">// Stop the web socket reader.</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    m_sentClose = <span class="keyword">true</span>;              <span class="comment">// Flag that we have sent a close request.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="struct_frame.html">Frame</a> frame;                     <span class="comment">// Build the web socket frame indicating a close request.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    frame.<a class="code" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">fin</a>    = 1;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    frame.<a class="code" href="struct_frame.html#a59f506c78c294e70bc22523a04afbc6d">rsv1</a>   = 0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    frame.<a class="code" href="struct_frame.html#aafd7354ead1eef8839866234d9c51b84">rsv2</a>   = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    frame.<a class="code" href="struct_frame.html#a8d2ebd82ce8e048073381bb90e0edb36">rsv3</a>   = 0;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    frame.<a class="code" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">opCode</a> = OPCODE_CLOSE;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    frame.<a class="code" href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">mask</a>   = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    frame.<a class="code" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">len</a>    = message.length() + 2;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame));</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &gt; 0) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>(status);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &gt; 0) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>(message);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (m_receivedClose || <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == 0 || <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == -1) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        m_socket.<a class="code" href="class_socket.html#aef06605c6725958004116983f1a2051f">close</a>();            <span class="comment">// Close the underlying socket.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        m_pWebSockerReader-&gt;<a class="code" href="class_web_socket_reader.html#a6de169c863a3a0ce254acf3a694b9c93">end</a>();   <span class="comment">// Stop the web socket reader.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;} <span class="comment">// close</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="class_web_socket.html#a93cd22aa94f9c0ef2a49e78a822aaa88">  303</a></span>&#160;<a class="code" href="class_web_socket_handler.html">WebSocketHandler</a>* <a class="code" href="class_web_socket.html#a93cd22aa94f9c0ef2a49e78a822aaa88">WebSocket::getHandler</a>() {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span> m_pWebSocketHandler;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;} <span class="comment">// getHandler</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">  312</a></span>&#160;<a class="code" href="class_socket.html">Socket</a> <a class="code" href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">WebSocket::getSocket</a>() {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> m_socket;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;} <span class="comment">// getSocket</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="class_web_socket.html#a9632cea9451d149a1dda489a3d0975cf">  324</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket.html#a9632cea9451d149a1dda489a3d0975cf">WebSocket::send</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="structdata.html">data</a>, uint8_t sendType) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; send: Length: %d&quot;</span>, <a class="code" href="structdata.html">data</a>.length());</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="struct_frame.html">Frame</a> frame;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    frame.<a class="code" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">fin</a>    = 1;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    frame.rsv1   = 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    frame.rsv2   = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    frame.rsv3   = 0;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    frame.opCode = (sendType == <a class="code" href="class_web_socket.html#aa0c2054d8b9ec168598b9c7f52b125e7">SEND_TYPE_TEXT</a>) ? OPCODE_TEXT : OPCODE_BINARY;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    frame.mask   = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structdata.html">data</a>.length() &lt; 126) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        frame.len = <a class="code" href="structdata.html">data</a>.length();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame));</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        frame.len = 126;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>(htons((uint16_t) <a class="code" href="structdata.html">data</a>.length()));  <span class="comment">// Convert to network byte order from host byte order</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*)<a class="code" href="structdata.html">data</a>.data(), <a class="code" href="structdata.html">data</a>.length());</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; send&quot;</span>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;} <span class="comment">// send_cpp</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="class_web_socket.html#a8cb4296ffa57b80cbec6694c4611bdea">  353</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket.html#a9632cea9451d149a1dda489a3d0975cf">WebSocket::send</a>(uint8_t* <a class="code" href="structdata.html">data</a>, uint16_t length, uint8_t sendType) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; send: Length: %d&quot;</span>, length);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="struct_frame.html">Frame</a> frame;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    frame.<a class="code" href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">fin</a>    = 1;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    frame.<a class="code" href="struct_frame.html#a59f506c78c294e70bc22523a04afbc6d">rsv1</a>   = 0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    frame.<a class="code" href="struct_frame.html#aafd7354ead1eef8839866234d9c51b84">rsv2</a>   = 0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    frame.<a class="code" href="struct_frame.html#a8d2ebd82ce8e048073381bb90e0edb36">rsv3</a>   = 0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    frame.<a class="code" href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">opCode</a> = (sendType==<a class="code" href="class_web_socket.html#aa0c2054d8b9ec168598b9c7f52b125e7">SEND_TYPE_TEXT</a>) ? OPCODE_TEXT : OPCODE_BINARY;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    frame.<a class="code" href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">mask</a>   = 0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (length &lt; 126) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        frame.<a class="code" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">len</a> = length;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        frame.<a class="code" href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">len</a> = 126;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>((uint8_t*) &amp;frame, <span class="keyword">sizeof</span>(frame));</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>(htons(length));  <span class="comment">// Convert to network byte order from host byte order</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    m_socket.<a class="code" href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">send</a>(<a class="code" href="structdata.html">data</a>, length);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; send&quot;</span>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="class_web_socket.html#aad812ebe8eb8405006c0ed8c8e567239">  382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket.html#aad812ebe8eb8405006c0ed8c8e567239">WebSocket::setHandler</a>(<a class="code" href="class_web_socket_handler.html">WebSocketHandler</a>* pHandler) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    m_pWebSocketHandler = pHandler;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;} <span class="comment">// setHandler</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">void</span> WebSocket::startReader() {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; startReader: Socket: %s&quot;</span>, m_socket.<a class="code" href="class_socket.html#a377ac3bcbf52e36dc08bca6ad0c8a97f">toString</a>().c_str());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    m_pWebSockerReader-&gt;<a class="code" href="class_task.html#a6f13d13787e21dc929b61d112b863433">start</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;} <span class="comment">// startReader</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="class_web_socket_input_streambuf.html#a89ecd4bd0c30e8681bce57217b107502">  404</a></span>&#160;<a class="code" href="class_web_socket_input_streambuf.html#a89ecd4bd0c30e8681bce57217b107502">WebSocketInputStreambuf::WebSocketInputStreambuf</a>(</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="class_socket.html">Socket</a>   socket,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">size_t</span>   dataLength,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    uint8_t* pMask,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">size_t</span>   bufferSize) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    m_socket     = socket;    <span class="comment">// The socket we will be reading from</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    m_dataLength = dataLength; <span class="comment">// The size of the record we wish to read.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    m_pMask      = pMask;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    m_bufferSize = bufferSize; <span class="comment">// The size of the buffer used to hold data</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    m_sizeRead   = 0;          <span class="comment">// The size of data read from the socket</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    m_buffer = <span class="keyword">new</span> <span class="keywordtype">char</span>[bufferSize]; <span class="comment">// Create the buffer used to hold the data read from the socket.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    setg(m_buffer, m_buffer, m_buffer); <span class="comment">// Set the initial get buffer pointers to no data.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;} <span class="comment">// WebSocketInputStreambuf</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="class_web_socket_input_streambuf.html#ab2452c9871aa4c0404e773d6b7dc02cb">  423</a></span>&#160;<a class="code" href="class_web_socket_input_streambuf.html#ab2452c9871aa4c0404e773d6b7dc02cb">WebSocketInputStreambuf::~WebSocketInputStreambuf</a>() {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">delete</span>[] m_buffer;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="class_web_socket_input_streambuf.html#af91a50709423669d4ade7713a612dc64">discard</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;} <span class="comment">// ~WebSocketInputRecordStreambuf</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="class_web_socket_input_streambuf.html#af91a50709423669d4ade7713a612dc64">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_web_socket_input_streambuf.html#af91a50709423669d4ade7713a612dc64">WebSocketInputStreambuf::discard</a>() {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    uint8_t <a class="code" href="_m_f_r_c522_8h.html#ab8ef12fab634c171394422d0ee8baf94">byte</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputStreambuf&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; discard: Discarding %d bytes&quot;</span>, m_dataLength - m_sizeRead);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">while</span>(m_sizeRead &lt; m_dataLength) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        m_socket.<a class="code" href="class_socket.html#abeb5751e47f3fa96755aba55d29c300a">receive</a>(&amp;<a class="code" href="_m_f_r_c522_8h.html#ab8ef12fab634c171394422d0ee8baf94">byte</a>, 1);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        m_sizeRead++;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputStreambuf&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; discard&quot;</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;} <span class="comment">// discard</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="class_web_socket_input_streambuf.html#a8cf5dcebbeefc1670767ac619472e0bb">  456</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="class_web_socket_input_streambuf.html#a8cf5dcebbeefc1670767ac619472e0bb">WebSocketInputStreambuf::getRecordSize</a>() {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span> m_dataLength;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;} <span class="comment">// getRecordSize</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="class_web_socket_input_streambuf.html#aed7065a593c58510569031142ce62e94">  465</a></span>&#160;WebSocketInputStreambuf::int_type <a class="code" href="class_web_socket_input_streambuf.html#aed7065a593c58510569031142ce62e94">WebSocketInputStreambuf::underflow</a>() {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputStreambuf&quot;</span>, <span class="stringliteral">&quot;&gt;&gt; underflow&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// If we have already read as many bytes as our record definition says we should read</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// then don&#39;t attempt to ready any further.</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (m_sizeRead &gt;= <a class="code" href="class_web_socket_input_streambuf.html#a8cf5dcebbeefc1670767ac619472e0bb">getRecordSize</a>()) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputStreambuf&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; underflow: Already read maximum&quot;</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">return</span> EOF;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// We wish to refill the buffer.  We want to read data from the socket.  We want to read either</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// the size of the buffer to fill it or the maximum number of bytes remaining to be read.</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// We will choose which ever is smaller as the number of bytes to read into the buffer.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">size_t</span> remainingBytes = <a class="code" href="class_web_socket_input_streambuf.html#a8cf5dcebbeefc1670767ac619472e0bb">getRecordSize</a>() - m_sizeRead;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">size_t</span> sizeToRead;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> (remainingBytes &lt; m_bufferSize) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        sizeToRead = remainingBytes;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        sizeToRead = m_bufferSize;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputRecordStreambuf&quot;</span>, <span class="stringliteral">&quot;- getting next buffer of data; size request: %d&quot;</span>, sizeToRead);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">size_t</span> bytesRead = m_socket.<a class="code" href="class_socket.html#abeb5751e47f3fa96755aba55d29c300a">receive</a>((uint8_t*) m_buffer, sizeToRead, <span class="keyword">true</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (bytesRead == 0) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputRecordStreambuf&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; underflow: Read 0 bytes&quot;</span>);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> EOF;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// If the WebSocket frame shows that we have a mask bit set then we have to unmask the data.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (m_pMask != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; bytesRead; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            m_buffer[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = m_buffer[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] ^ m_pMask[(m_sizeRead + <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>) % 4];</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    m_sizeRead += bytesRead;  <span class="comment">// Increase the count of number of bytes actually read from the source.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    setg(m_buffer, m_buffer, m_buffer + bytesRead); <span class="comment">// Changethe buffer pointers to reflect the new data read.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    ESP_LOGD(<span class="stringliteral">&quot;WebSocketInputRecordStreambuf&quot;</span>, <span class="stringliteral">&quot;&lt;&lt; underflow - got %d more bytes&quot;</span>, bytesRead);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> traits_type::to_int_type(*gptr());</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;} <span class="comment">// underflow</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="class_web_socket_handler.html#a18479a69a03eeed897c4334543023724">  511</a></span>&#160;<a class="code" href="class_web_socket_handler.html#a18479a69a03eeed897c4334543023724">WebSocketHandler::~WebSocketHandler</a>() {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;} <span class="comment">// ~WebSocketHandler()</span></div><div class="ttc" id="struct_frame_html_ab4e901c578917ab7b317cb98b6a52389"><div class="ttname"><a href="struct_frame.html#ab4e901c578917ab7b317cb98b6a52389">Frame::len</a></div><div class="ttdeci">uint8_t len</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00042">WebSocket.cpp:42</a></div></div>
<div class="ttc" id="_general_utils_8h_html"><div class="ttname"><a href="_general_utils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="class_socket_html_abeb5751e47f3fa96755aba55d29c300a"><div class="ttname"><a href="class_socket.html#abeb5751e47f3fa96755aba55d29c300a">Socket::receive</a></div><div class="ttdeci">size_t receive(uint8_t *data, size_t length, bool exact=false)</div><div class="ttdoc">Receive data from the partner. Receive data from the socket partner. If exact = false, we read as much data as is available without blocking up to length. If exact = true, we will block until we have received exactly length bytes or there are no more bytes to read. </div><div class="ttdef"><b>Definition:</b> <a href="_socket_8cpp_source.html#l00349">Socket.cpp:349</a></div></div>
<div class="ttc" id="_web_socket_8h_html"><div class="ttname"><a href="_web_socket_8h.html">WebSocket.h</a></div></div>
<div class="ttc" id="class_web_socket_reader_html_a6de169c863a3a0ce254acf3a694b9c93"><div class="ttname"><a href="class_web_socket_reader.html#a6de169c863a3a0ce254acf3a694b9c93">WebSocketReader::end</a></div><div class="ttdeci">void end()</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00101">WebSocket.cpp:101</a></div></div>
<div class="ttc" id="class_web_socket_html_afccf93c4ac44f2347ab84d7e2419a2ca"><div class="ttname"><a href="class_web_socket.html#afccf93c4ac44f2347ab84d7e2419a2ca">WebSocket::WebSocketReader</a></div><div class="ttdeci">friend class WebSocketReader</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8h_source.html#l00091">WebSocket.h:91</a></div></div>
<div class="ttc" id="class_task_html_a6f13d13787e21dc929b61d112b863433"><div class="ttname"><a href="class_task.html#a6f13d13787e21dc929b61d112b863433">Task::start</a></div><div class="ttdeci">void start(void *taskData=nullptr)</div><div class="ttdoc">Start an instance of the task. </div><div class="ttdef"><b>Definition:</b> <a href="_task_8cpp_source.html#l00070">Task.cpp:70</a></div></div>
<div class="ttc" id="struct_frame_html"><div class="ttname"><a href="struct_frame.html">Frame</a></div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00033">WebSocket.cpp:33</a></div></div>
<div class="ttc" id="_task_8h_html"><div class="ttname"><a href="_task_8h.html">Task.h</a></div></div>
<div class="ttc" id="class_web_socket_html_a57b53de6aeafeb1f57eed90a3357aaa8"><div class="ttname"><a href="class_web_socket.html#a57b53de6aeafeb1f57eed90a3357aaa8">WebSocket::close</a></div><div class="ttdeci">void close(uint16_t status=CLOSE_NORMAL_CLOSURE, std::string message=&quot;&quot;)</div><div class="ttdoc">Close the Web socket. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00262">WebSocket.cpp:262</a></div></div>
<div class="ttc" id="_web_socket_8cpp_html_aee0c3c901bd90b3760c5e69dff6c5f58"><div class="ttname"><a href="_web_socket_8cpp.html#aee0c3c901bd90b3760c5e69dff6c5f58">lwip_ntohs</a></div><div class="ttdeci">uint16_t lwip_ntohs(uint16_t)</div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_socket_html_aef06605c6725958004116983f1a2051f"><div class="ttname"><a href="class_socket.html#aef06605c6725958004116983f1a2051f">Socket::close</a></div><div class="ttdeci">int close()</div><div class="ttdoc">Close the socket. </div><div class="ttdef"><b>Definition:</b> <a href="_socket_8cpp_source.html#l00135">Socket.cpp:135</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html_ab2452c9871aa4c0404e773d6b7dc02cb"><div class="ttname"><a href="class_web_socket_input_streambuf.html#ab2452c9871aa4c0404e773d6b7dc02cb">WebSocketInputStreambuf::~WebSocketInputStreambuf</a></div><div class="ttdeci">~WebSocketInputStreambuf()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00423">WebSocket.cpp:423</a></div></div>
<div class="ttc" id="_m_f_r_c522_8h_html_ab8ef12fab634c171394422d0ee8baf94"><div class="ttname"><a href="_m_f_r_c522_8h.html#ab8ef12fab634c171394422d0ee8baf94">byte</a></div><div class="ttdeci">uint8_t byte</div><div class="ttdef"><b>Definition:</b> <a href="_m_f_r_c522_8h_source.html#l00082">MFRC522.h:82</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="class_socket_html_ad9757badfe9d9903d07ef7c70279ad77"><div class="ttname"><a href="class_socket.html#ad9757badfe9d9903d07ef7c70279ad77">Socket::send</a></div><div class="ttdeci">int send(std::string value) const</div><div class="ttdoc">Send a string to the partner. </div><div class="ttdef"><b>Definition:</b> <a href="_socket_8cpp_source.html#l00457">Socket.cpp:457</a></div></div>
<div class="ttc" id="class_web_socket_html_aad812ebe8eb8405006c0ed8c8e567239"><div class="ttname"><a href="class_web_socket.html#aad812ebe8eb8405006c0ed8c8e567239">WebSocket::setHandler</a></div><div class="ttdeci">void setHandler(WebSocketHandler *handler)</div><div class="ttdoc">Set the Web socket handler associated with this Websocket. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00382">WebSocket.cpp:382</a></div></div>
<div class="ttc" id="struct_frame_html_aafd7354ead1eef8839866234d9c51b84"><div class="ttname"><a href="struct_frame.html#aafd7354ead1eef8839866234d9c51b84">Frame::rsv2</a></div><div class="ttdeci">uint8_t rsv2</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00037">WebSocket.cpp:37</a></div></div>
<div class="ttc" id="class_web_socket_reader_html"><div class="ttname"><a href="class_web_socket_reader.html">WebSocketReader</a></div><div class="ttdoc">A task that will watch web socket inputs. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00096">WebSocket.cpp:96</a></div></div>
<div class="ttc" id="class_socket_html_a377ac3bcbf52e36dc08bca6ad0c8a97f"><div class="ttname"><a href="class_socket.html#a377ac3bcbf52e36dc08bca6ad0c8a97f">Socket::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Get the string representation of this socket. </div><div class="ttdef"><b>Definition:</b> <a href="_socket_8cpp_source.html#l00614">Socket.cpp:614</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="struct_frame_html_aecf183afec93f838be459c675dbd8a9b"><div class="ttname"><a href="struct_frame.html#aecf183afec93f838be459c675dbd8a9b">Frame::opCode</a></div><div class="ttdeci">uint8_t opCode</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00035">WebSocket.cpp:35</a></div></div>
<div class="ttc" id="class_web_socket_html_a30c8399db86bb20fdc8facd5d68c79de"><div class="ttname"><a href="class_web_socket.html#a30c8399db86bb20fdc8facd5d68c79de">WebSocket::WebSocket</a></div><div class="ttdeci">WebSocket(Socket socket)</div><div class="ttdoc">Construct a WebSocket instance. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00239">WebSocket.cpp:239</a></div></div>
<div class="ttc" id="class_web_socket_html_aab1c6f5102716a4200d930ec0e63546e"><div class="ttname"><a href="class_web_socket.html#aab1c6f5102716a4200d930ec0e63546e">WebSocket::getSocket</a></div><div class="ttdeci">Socket getSocket()</div><div class="ttdoc">Get the underlying socket for the websocket. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00312">WebSocket.cpp:312</a></div></div>
<div class="ttc" id="struct_frame_html_a59f506c78c294e70bc22523a04afbc6d"><div class="ttname"><a href="struct_frame.html#a59f506c78c294e70bc22523a04afbc6d">Frame::rsv1</a></div><div class="ttdeci">uint8_t rsv1</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00038">WebSocket.cpp:38</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html"><div class="ttname"><a href="class_web_socket_input_streambuf.html">WebSocketInputStreambuf</a></div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8h_source.html#l00021">WebSocket.h:21</a></div></div>
<div class="ttc" id="class_web_socket_handler_html_a0cc7913f3f6c9ae8e390401db99e659e"><div class="ttname"><a href="class_web_socket_handler.html#a0cc7913f3f6c9ae8e390401db99e659e">WebSocketHandler::onError</a></div><div class="ttdeci">virtual void onError(std::string error)</div><div class="ttdoc">The default onError handler. If no over-riding handler is provided for the &quot;error&quot; event...</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00230">WebSocket.cpp:230</a></div></div>
<div class="ttc" id="_web_socket_8cpp_html_a7e4133c98661e1e258f6c636e3c1245c"><div class="ttname"><a href="_web_socket_8cpp.html#a7e4133c98661e1e258f6c636e3c1245c">lwip_ntohl</a></div><div class="ttdeci">uint32_t lwip_ntohl(uint32_t)</div></div>
<div class="ttc" id="class_web_socket_html_a48afbe9b82fde4479913a1b931444729"><div class="ttname"><a href="class_web_socket.html#a48afbe9b82fde4479913a1b931444729">WebSocket::~WebSocket</a></div><div class="ttdeci">virtual ~WebSocket()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00251">WebSocket.cpp:251</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html_a89ecd4bd0c30e8681bce57217b107502"><div class="ttname"><a href="class_web_socket_input_streambuf.html#a89ecd4bd0c30e8681bce57217b107502">WebSocketInputStreambuf::WebSocketInputStreambuf</a></div><div class="ttdeci">WebSocketInputStreambuf(Socket socket, size_t dataLength, uint8_t *pMask=nullptr, size_t bufferSize=2048)</div><div class="ttdoc">Create a Web Socket input record streambuf. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00404">WebSocket.cpp:404</a></div></div>
<div class="ttc" id="class_web_socket_handler_html_a18479a69a03eeed897c4334543023724"><div class="ttname"><a href="class_web_socket_handler.html#a18479a69a03eeed897c4334543023724">WebSocketHandler::~WebSocketHandler</a></div><div class="ttdeci">virtual ~WebSocketHandler()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00511">WebSocket.cpp:511</a></div></div>
<div class="ttc" id="class_web_socket_handler_html"><div class="ttname"><a href="class_web_socket_handler.html">WebSocketHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8h_source.html#l00047">WebSocket.h:47</a></div></div>
<div class="ttc" id="struct_frame_html_ac17b1793ab77f448924d8bd0724b8f3f"><div class="ttname"><a href="struct_frame.html#ac17b1793ab77f448924d8bd0724b8f3f">Frame::fin</a></div><div class="ttdeci">uint8_t fin</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00039">WebSocket.cpp:39</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html_a8cf5dcebbeefc1670767ac619472e0bb"><div class="ttname"><a href="class_web_socket_input_streambuf.html#a8cf5dcebbeefc1670767ac619472e0bb">WebSocketInputStreambuf::getRecordSize</a></div><div class="ttdeci">size_t getRecordSize()</div><div class="ttdoc">Get the size of the expected record. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00456">WebSocket.cpp:456</a></div></div>
<div class="ttc" id="_web_socket_8cpp_html_a5f9d3d3ad8fc8c55f29bfad1e862d2f8"><div class="ttname"><a href="_web_socket_8cpp.html#a5f9d3d3ad8fc8c55f29bfad1e862d2f8">lwip_htons</a></div><div class="ttdeci">uint16_t lwip_htons(uint16_t)</div></div>
<div class="ttc" id="class_web_socket_html_aa0c2054d8b9ec168598b9c7f52b125e7"><div class="ttname"><a href="class_web_socket.html#aa0c2054d8b9ec168598b9c7f52b125e7">WebSocket::SEND_TYPE_TEXT</a></div><div class="ttdeci">static const uint8_t SEND_TYPE_TEXT</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8h_source.html#l00078">WebSocket.h:78</a></div></div>
<div class="ttc" id="class_socket_html"><div class="ttname"><a href="class_socket.html">Socket</a></div><div class="ttdoc">Encapsulate a socket. </div><div class="ttdef"><b>Definition:</b> <a href="_socket_8h_source.html#l00062">Socket.h:62</a></div></div>
<div class="ttc" id="class_web_socket_reader_html_ae252876205a066b268ab1666c86e55e5"><div class="ttname"><a href="class_web_socket_reader.html#ae252876205a066b268ab1666c86e55e5">WebSocketReader::WebSocketReader</a></div><div class="ttdeci">WebSocketReader()</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00098">WebSocket.cpp:98</a></div></div>
<div class="ttc" id="struct_frame_html_a9461456e2f07e6294c4d9d985e7cdb2e"><div class="ttname"><a href="struct_frame.html#a9461456e2f07e6294c4d9d985e7cdb2e">Frame::mask</a></div><div class="ttdeci">uint8_t mask</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00043">WebSocket.cpp:43</a></div></div>
<div class="ttc" id="class_web_socket_html_a9632cea9451d149a1dda489a3d0975cf"><div class="ttname"><a href="class_web_socket.html#a9632cea9451d149a1dda489a3d0975cf">WebSocket::send</a></div><div class="ttdeci">void send(std::string data, uint8_t sendType=SEND_TYPE_BINARY)</div><div class="ttdoc">Send data down the web socket See the WebSocket spec (RFC6455) section &quot;6.1 Sending Data&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00324">WebSocket.cpp:324</a></div></div>
<div class="ttc" id="class_web_socket_html"><div class="ttname"><a href="class_web_socket.html">WebSocket</a></div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8h_source.html#l00060">WebSocket.h:60</a></div></div>
<div class="ttc" id="class_web_socket_handler_html_a0ae1d5bde410e9f720bcc007ffd4cd0e"><div class="ttname"><a href="class_web_socket_handler.html#a0ae1d5bde410e9f720bcc007ffd4cd0e">WebSocketHandler::onClose</a></div><div class="ttdeci">virtual void onClose()</div><div class="ttdoc">The default onClose handler. If no over-riding handler is provided for the &quot;close&quot; event...</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00204">WebSocket.cpp:204</a></div></div>
<div class="ttc" id="class_task_html"><div class="ttname"><a href="class_task.html">Task</a></div><div class="ttdoc">Encapsulate a runnable task. </div><div class="ttdef"><b>Definition:</b> <a href="_task_8h_source.html#l00034">Task.h:34</a></div></div>
<div class="ttc" id="class_task_html_aba5eb3d6c2a034aa0e319383fbec68c4"><div class="ttname"><a href="class_task.html#aba5eb3d6c2a034aa0e319383fbec68c4">Task::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdoc">Stop the task. </div><div class="ttdef"><b>Definition:</b> <a href="_task_8cpp_source.html#l00084">Task.cpp:84</a></div></div>
<div class="ttc" id="_web_socket_8cpp_html_a379424b6bc52498c9dca693c6aea3549"><div class="ttname"><a href="_web_socket_8cpp.html#a379424b6bc52498c9dca693c6aea3549">lwip_htonl</a></div><div class="ttdeci">uint32_t lwip_htonl(uint32_t)</div></div>
<div class="ttc" id="struct_frame_html_a8d2ebd82ce8e048073381bb90e0edb36"><div class="ttname"><a href="struct_frame.html#a8d2ebd82ce8e048073381bb90e0edb36">Frame::rsv3</a></div><div class="ttdeci">uint8_t rsv3</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00036">WebSocket.cpp:36</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html_aed7065a593c58510569031142ce62e94"><div class="ttname"><a href="class_web_socket_input_streambuf.html#aed7065a593c58510569031142ce62e94">WebSocketInputStreambuf::underflow</a></div><div class="ttdeci">int_type underflow()</div><div class="ttdoc">Handle the request to read data from the stream but we need more data from the source. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00465">WebSocket.cpp:465</a></div></div>
<div class="ttc" id="class_web_socket_handler_html_a0bd22f329ec6953580c3d4907e5ecc18"><div class="ttname"><a href="class_web_socket_handler.html#a0bd22f329ec6953580c3d4907e5ecc18">WebSocketHandler::onMessage</a></div><div class="ttdeci">virtual void onMessage(WebSocketInputStreambuf *pWebSocketInputStreambuf, WebSocket *pWebSocket)</div><div class="ttdoc">The default onData handler. If no over-riding handler is provided for the &quot;message&quot; event...</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00220">WebSocket.cpp:220</a></div></div>
<div class="ttc" id="class_web_socket_input_streambuf_html_af91a50709423669d4ade7713a612dc64"><div class="ttname"><a href="class_web_socket_input_streambuf.html#af91a50709423669d4ade7713a612dc64">WebSocketInputStreambuf::discard</a></div><div class="ttdeci">void discard()</div><div class="ttdoc">Discard data for the record that has not yet been read. </div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00441">WebSocket.cpp:441</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="class_web_socket_html_a93cd22aa94f9c0ef2a49e78a822aaa88"><div class="ttname"><a href="class_web_socket.html#a93cd22aa94f9c0ef2a49e78a822aaa88">WebSocket::getHandler</a></div><div class="ttdeci">WebSocketHandler * getHandler()</div><div class="ttdoc">Get the current WebSocketHandler A web socket handler is a user registered class instance that is cal...</div><div class="ttdef"><b>Definition:</b> <a href="_web_socket_8cpp_source.html#l00303">WebSocket.cpp:303</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e66062f3a4d2a5b6b6746a6b0f9c85ac.html">cpp_utils</a></li><li class="navelem"><a class="el" href="_web_socket_8cpp.html">WebSocket.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
