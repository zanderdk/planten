<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/http_negotiate.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('http__negotiate_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">http_negotiate.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="http__negotiate_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2016, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_HTTP) &amp;&amp; defined(USE_SPNEGO)</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__negotiate_8h.html">http_negotiate.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vauth_8h.html">vauth/vauth.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_input_negotiate(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *header)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* Point to the username, password, service and host */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *userp;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *passwdp;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *service;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">/* Point to the correct struct with this */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">struct </span>negotiatedata *neg_ctx;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">struct </span><a class="code" href="structauth.html">auth</a> *authp;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    userp = conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">user</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    passwdp = conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ab2b6b7b0dc1dd09509d79ae5f52dd3b8">passwd</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    service = <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fab458333e11e352f97cd8e2e33f50db24">STRING_PROXY_SERVICE_NAME</a>] ?</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fab458333e11e352f97cd8e2e33f50db24">STRING_PROXY_SERVICE_NAME</a>] : <span class="stringliteral">&quot;HTTP&quot;</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    neg_ctx = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.proxyneg;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    authp = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#a72256af9934bd90829f0a2b12780d808">authproxy</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    userp = conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    passwdp = conn-&gt;<a class="code" href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">passwd</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    service = <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa6cdba334cc2271ad35e23103c05cd44e">STRING_SERVICE_NAME</a>] ?</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;              <a class="code" href="structdata.html">data</a>-&gt;set.str[<a class="code" href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa6cdba334cc2271ad35e23103c05cd44e">STRING_SERVICE_NAME</a>] : <span class="stringliteral">&quot;HTTP&quot;</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    neg_ctx = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.negotiate;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    authp = &amp;conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#ab66874c8e7aafee4b45c5bca83b90118">authhost</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">/* Not set means empty */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span>(!userp)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    userp = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span>(!passwdp)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    passwdp = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">/* Obtain the input token, if any */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  header += strlen(<span class="stringliteral">&quot;Negotiate&quot;</span>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">while</span>(*header &amp;&amp; <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*header))</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    header++;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen(header);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">/* Is this the first call in a new negotiation? */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span>(neg_ctx-&gt;context) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">/* The server rejected our authentication and hasn&#39;t suppled any more</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">      negotiation mechanisms */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513">CURLE_LOGIN_DENIED</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* Initialize the security context and decode our challenge */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_auth_decode_spnego_message(<a class="code" href="structdata.html">data</a>, userp, passwdp, service,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                           <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, header, neg_ctx);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    Curl_auth_spnego_cleanup(neg_ctx);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* If the status is different than 0 and we encountered no errors</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    it means we have to continue. 0 is the OK value for both GSSAPI</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    (GSS_S_COMPLETE) and SSPI (SEC_E_OK) */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    authp-&gt;<a class="code" href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">done</a> = !neg_ctx-&gt;status;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_output_negotiate(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">struct </span>negotiatedata *neg_ctx = <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ? &amp;conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.proxyneg :</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    &amp;conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.negotiate;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">char</span> *base64 = NULL;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">char</span> *userp;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = Curl_auth_create_spnego_message(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, neg_ctx, &amp;base64, &amp;<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  userp = <a class="code" href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a>(<span class="stringliteral">&quot;%sAuthorization: Negotiate %s\r\n&quot;</span>, <a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a> ? <span class="stringliteral">&quot;Proxy-&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                  base64);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">proxyuserpwd</a> = userp;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">allocptr</a>.<a class="code" href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">userpwd</a> = userp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(base64);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">return</span> (userp == NULL) ? <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a> : <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">void</span> Curl_cleanup_negotiate(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  Curl_auth_spnego_cleanup(&amp;<a class="code" href="structdata.html">data</a>-&gt;state.negotiate);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  Curl_auth_spnego_cleanup(&amp;<a class="code" href="structdata.html">data</a>-&gt;state.proxyneg);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !CURL_DISABLE_HTTP &amp;&amp; USE_SPNEGO */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a15aced4a015c44ff454787debee23520"><div class="ttname"><a href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">Curl_easy::state</a></div><div class="ttdeci">struct UrlState state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01795">urldata.h:1795</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="noproxy_8d_html_a62c6b6923733b98c3d4f01e07d04d958"><div class="ttname"><a href="noproxy_8d.html#a62c6b6923733b98c3d4f01e07d04d958">proxy</a></div><div class="ttdeci">Long if one is specified.The only wildcard is a single which matches all and effectively disables the proxy.Each name in this list is matched as either a domain which contains the or the hostname itself.For local.com would match local.local.and www.local.but not www.notlocal.com.This option overrides the environment variables that disable the proxy.If there s an environment variable disabling a proxy</div><div class="ttdef"><b>Definition:</b> <a href="noproxy_8d_source.html#l00006">noproxy.d:6</a></div></div>
<div class="ttc" id="structproxy__info_html_ae2cc9c2eb5c4ea0c4b92bf067e391bdc"><div class="ttname"><a href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">proxy_info::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00752">urldata.h:752</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a7fb027f5ed81ce6a618e7fb0e3a2e5e2"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a7fb027f5ed81ce6a618e7fb0e3a2e5e2">connectdata::dynamically_allocated_data::userpwd</a></div><div class="ttdeci">char * userpwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00930">urldata.h:930</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="structconnectdata_html_a4df63a4042ad767671bb3bfd74aa68fc"><div class="ttname"><a href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">connectdata::http_proxy</a></div><div class="ttdeci">struct proxy_info http_proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00837">urldata.h:837</a></div></div>
<div class="ttc" id="structconnectdata_html_a4bb3a85b09c8a63a0b526a24f9b1897a"><div class="ttname"><a href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">connectdata::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00864">urldata.h:864</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513">CURLE_LOGIN_DENIED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00540">curl.h:540</a></div></div>
<div class="ttc" id="structauth_html"><div class="ttname"><a href="structauth.html">auth</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01172">urldata.h:1172</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fa6cdba334cc2271ad35e23103c05cd44e"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fa6cdba334cc2271ad35e23103c05cd44e">STRING_SERVICE_NAME</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01460">urldata.h:1460</a></div></div>
<div class="ttc" id="structconnectdata_1_1dynamically__allocated__data_html_a810a2b88f3ab6e69daac56a95997d288"><div class="ttname"><a href="structconnectdata_1_1dynamically__allocated__data.html#a810a2b88f3ab6e69daac56a95997d288">connectdata::dynamically_allocated_data::proxyuserpwd</a></div><div class="ttdeci">char * proxyuserpwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00927">urldata.h:927</a></div></div>
<div class="ttc" id="http__negotiate_8h_html"><div class="ttname"><a href="http__negotiate_8h.html">http_negotiate.h</a></div></div>
<div class="ttc" id="struct_url_state_html_a72256af9934bd90829f0a2b12780d808"><div class="ttname"><a href="struct_url_state.html#a72256af9934bd90829f0a2b12780d808">UrlState::authproxy</a></div><div class="ttdeci">struct auth authproxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01295">urldata.h:1295</a></div></div>
<div class="ttc" id="structproxy__info_html_ab2b6b7b0dc1dd09509d79ae5f52dd3b8"><div class="ttname"><a href="structproxy__info.html#ab2b6b7b0dc1dd09509d79ae5f52dd3b8">proxy_info::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00756">urldata.h:756</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a3e3dfee99c81f563d18ef4626d8886e1"><div class="ttname"><a href="curl__printf_8h.html#a3e3dfee99c81f563d18ef4626d8886e1">aprintf</a></div><div class="ttdeci">#define aprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00046">curl_printf.h:46</a></div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="struct_url_state_html_ab66874c8e7aafee4b45c5bca83b90118"><div class="ttname"><a href="struct_url_state.html#ab66874c8e7aafee4b45c5bca83b90118">UrlState::authhost</a></div><div class="ttdeci">struct auth authhost</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01294">urldata.h:1294</a></div></div>
<div class="ttc" id="structauth_html_accd2174ae1200c36506d9ebd853cc9a0"><div class="ttname"><a href="structauth.html#accd2174ae1200c36506d9ebd853cc9a0">auth::done</a></div><div class="ttdeci">bool done</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01178">urldata.h:1178</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="urldata_8h_html_a9607658ec977f6ca435daf26b82f6b3fab458333e11e352f97cd8e2e33f50db24"><div class="ttname"><a href="urldata_8h.html#a9607658ec977f6ca435daf26b82f6b3fab458333e11e352f97cd8e2e33f50db24">STRING_PROXY_SERVICE_NAME</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01459">urldata.h:1459</a></div></div>
<div class="ttc" id="structconnectdata_html_a94e8ccd4c3824eb5353efcd5016908fa"><div class="ttname"><a href="structconnectdata.html#a94e8ccd4c3824eb5353efcd5016908fa">connectdata::allocptr</a></div><div class="ttdeci">struct connectdata::dynamically_allocated_data allocptr</div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="vauth_8h_html"><div class="ttname"><a href="vauth_8h.html">vauth.h</a></div></div>
<div class="ttc" id="structproxy__info_html_adba1abda48be65b7b737625d591193f9"><div class="ttname"><a href="structproxy__info.html#adba1abda48be65b7b737625d591193f9">proxy_info::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00755">urldata.h:755</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="structconnectdata_html_a85cb9da7776d42c440612d2940a7fcb4"><div class="ttname"><a href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">connectdata::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00863">urldata.h:863</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="http__negotiate_8c.html">http_negotiate.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
