<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/vtls/vtls.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('vtls_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">vtls.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vtls_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* This file is for implementing all &quot;generic&quot; SSL functions that all libcurl</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">   internals should use. It is then responsible for calling the proper</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">   &quot;backend&quot; function.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   SSL-functions in libcurl should call functions in this source file, and not</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">   to any specific SSL-layer.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   Curl_ssl_ - prefix for generic ones</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">   Note that this source code uses the functions of the configured SSL</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">   backend via the global Curl_ssl instance.</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">   &quot;SSL/TLS Strong Encryption: An Introduction&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   https://httpd.apache.org/docs/2.0/ssl/ssl_intro.html</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_TYPES_H</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_STAT_H</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifdef HAVE_FCNTL_H</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtls_8h.html">vtls.h</a>&quot;</span> <span class="comment">/* generic SSL protos etc */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slist_8h.html">slist.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="url_8h.html">url.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="progress_8h.html">progress.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="share_8h.html">share.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="multiif_8h.html">multiif.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timeval_8h.html">timeval.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__md5_8h.html">curl_md5.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="warnless_8h.html">warnless.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">/* The last #include files should be: */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/* convenience macro to check if this handle is using a shared SSL session */</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">   72</a></span>&#160;<span class="preprocessor">#define SSLSESSION_SHARED(data) (data-&gt;share &amp;&amp;                        \</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">                                 (data-&gt;share-&gt;specifier &amp;             \</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">                                  (1&lt;&lt;CURL_LOCK_DATA_SSL_SESSION)))</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">   76</a></span>&#160;<span class="preprocessor">#define CLONE_STRING(var)                    \</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">  if(source-&gt;var) {                          \</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">    dest-&gt;var = strdup(source-&gt;var);         \</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">    if(!dest-&gt;var)                           \</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">      return FALSE;                          \</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">  }                                          \</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">  else                                       \</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">    dest-&gt;var = NULL;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="vtls_8h.html#a20030f6c13c9de65950bb8cac1bfb0f9">   86</a></span>&#160;<a class="code" href="vtls_8c.html#a20030f6c13c9de65950bb8cac1bfb0f9">Curl_ssl_config_matches</a>(<span class="keyword">struct</span> <a class="code" href="structssl__primary__config.html">ssl_primary_config</a>* <a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="structssl__primary__config.html">ssl_primary_config</a>* needle)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;version == needle-&gt;<a class="code" href="structssl__primary__config.html#ac276158be45d7efe6872bfbfc009b417">version</a>) &amp;&amp;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;     (<a class="code" href="structdata.html">data</a>-&gt;version_max == needle-&gt;<a class="code" href="structssl__primary__config.html#aaaea4d07233992dd9e14488afa8cd390">version_max</a>) &amp;&amp;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;     (<a class="code" href="structdata.html">data</a>-&gt;verifypeer == needle-&gt;<a class="code" href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">verifypeer</a>) &amp;&amp;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;     (<a class="code" href="structdata.html">data</a>-&gt;verifyhost == needle-&gt;<a class="code" href="structssl__primary__config.html#af116cf82e957a2ca2f0b39eb0c709d43">verifyhost</a>) &amp;&amp;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     (<a class="code" href="structdata.html">data</a>-&gt;verifystatus == needle-&gt;<a class="code" href="structssl__primary__config.html#a9d3a4c7283e422bfa31cf1d32aeb75a0">verifystatus</a>) &amp;&amp;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;CApath, needle-&gt;<a class="code" href="structssl__primary__config.html#a876a1cef5c1d2207132acf10c47a0dda">CApath</a>) &amp;&amp;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;CAfile, needle-&gt;<a class="code" href="structssl__primary__config.html#a78312575bac5d2efa2ca67246b06fad7">CAfile</a>) &amp;&amp;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;clientcert, needle-&gt;<a class="code" href="structssl__primary__config.html#a186023a4b2e5503d44a766edb5c1f574">clientcert</a>) &amp;&amp;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;random_file, needle-&gt;<a class="code" href="structssl__primary__config.html#ac1cdc117fe9f6a1317ad585554e1344a">random_file</a>) &amp;&amp;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;egdsocket, needle-&gt;<a class="code" href="structssl__primary__config.html#a2e5524f42582a8bea0116656ed301293">egdsocket</a>) &amp;&amp;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;cipher_list, needle-&gt;<a class="code" href="structssl__primary__config.html#ad91b52cac0c59e8af54800a84702f311">cipher_list</a>) &amp;&amp;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;     <a class="code" href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;cipher_list13, needle-&gt;<a class="code" href="structssl__primary__config.html#a6f5ec68609ac2c004ca79f37a3822e05">cipher_list13</a>))</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="vtls_8h.html#a9468007b0049e63d8dac0a8096beb0c4">  107</a></span>&#160;<a class="code" href="vtls_8c.html#a9468007b0049e63d8dac0a8096beb0c4">Curl_clone_primary_ssl_config</a>(<span class="keyword">struct</span> <a class="code" href="structssl__primary__config.html">ssl_primary_config</a> *source,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="structssl__primary__config.html">ssl_primary_config</a> *dest)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#ac276158be45d7efe6872bfbfc009b417">version</a> = source-&gt;<a class="code" href="structssl__primary__config.html#ac276158be45d7efe6872bfbfc009b417">version</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#aaaea4d07233992dd9e14488afa8cd390">version_max</a> = source-&gt;<a class="code" href="structssl__primary__config.html#aaaea4d07233992dd9e14488afa8cd390">version_max</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">verifypeer</a> = source-&gt;<a class="code" href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">verifypeer</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#af116cf82e957a2ca2f0b39eb0c709d43">verifyhost</a> = source-&gt;<a class="code" href="structssl__primary__config.html#af116cf82e957a2ca2f0b39eb0c709d43">verifyhost</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#a9d3a4c7283e422bfa31cf1d32aeb75a0">verifystatus</a> = source-&gt;<a class="code" href="structssl__primary__config.html#a9d3a4c7283e422bfa31cf1d32aeb75a0">verifystatus</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  dest-&gt;<a class="code" href="structssl__primary__config.html#a7e4e88d7f01f46a1aa30751906eac785">sessionid</a> = source-&gt;<a class="code" href="structssl__primary__config.html#a7e4e88d7f01f46a1aa30751906eac785">sessionid</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(CApath);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(CAfile);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(clientcert);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(random_file);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(egdsocket);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(cipher_list);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a>(cipher_list13);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="vtls_8h.html#a5f50ad085ea4993229348232d4719407">  128</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8c.html#a5f50ad085ea4993229348232d4719407">Curl_free_primary_ssl_config</a>(<span class="keyword">struct</span> <a class="code" href="structssl__primary__config.html">ssl_primary_config</a>* sslc)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#a876a1cef5c1d2207132acf10c47a0dda">CApath</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#a78312575bac5d2efa2ca67246b06fad7">CAfile</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#a186023a4b2e5503d44a766edb5c1f574">clientcert</a>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#ac1cdc117fe9f6a1317ad585554e1344a">random_file</a>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#a2e5524f42582a8bea0116656ed301293">egdsocket</a>);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#ad91b52cac0c59e8af54800a84702f311">cipher_list</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sslc-&gt;<a class="code" href="structssl__primary__config.html#a6f5ec68609ac2c004ca79f37a3822e05">cipher_list13</a>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> multissl_init(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *backend);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="vtls_8h.html#a31c6901e598df0934bf3e1464136910c">  143</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8c.html#a31c6901e598df0934bf3e1464136910c">Curl_ssl_backend</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  multissl_init(NULL);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#a9136e3e9b797273b4089097e07ce707e">id</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="curl_8h.html#a908c5b707ac681212b8f8688cf76689da221aaf856b5e48cc0315c0fc62fc8caf">CURLSSLBACKEND_NONE</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/* &quot;global&quot; init done? */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> init_ssl = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#abbbadc98add94562999814ac8d7298a8">Curl_ssl_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">/* make sure this is only done once */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span>(init_ssl)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  init_ssl = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* never again */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a49b2b5753c234a1eb7f05181eea0e61a">init</a>();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/* Global cleanup */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#a8b77e1da26e4c27161d4701d268d2056">Curl_ssl_cleanup</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span>(init_ssl) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">/* only cleanup if we did a previous init */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a75bdb71feb2246298a5730d61bfed6a6">cleanup</a>();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    init_ssl = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> ssl_prefs_check(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">/* check for CURLOPT_SSLVERSION invalid parameter value */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">long</span> sslver = <a class="code" href="structdata.html">data</a>-&gt;set.ssl.primary.version;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span>((sslver &lt; 0) || (sslver &gt;= <a class="code" href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea4fba35de2c7eebf13b096ac6c13d8219">CURL_SSLVERSION_LAST</a>)) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Unrecognized parameter value passed via CURLOPT_SSLVERSION&quot;</span>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">switch</span>(<a class="code" href="structdata.html">data</a>-&gt;set.ssl.primary.version_max) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df">CURL_SSLVERSION_MAX_NONE</a>:</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0">CURL_SSLVERSION_MAX_DEFAULT</a>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.ssl.primary.version_max &gt;&gt; 16) &lt; sslver) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;CURL_SSLVERSION_MAX incompatible with CURL_SSLVERSION&quot;</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;ssl_connect_init_proxy(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aec16dc8e44e2c34947cf23a7e0211b53">proxy_ssl_connected</a>[sockindex]);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c">ssl_connection_complete</a> == conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">state</a> &amp;&amp;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     !conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a>) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">struct </span>ssl_backend_data *pbdata;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>(!(<a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad8aeedd93171e98d8db0049085d40f31">supports</a> &amp; <a class="code" href="vtls_8h.html#aa47defd1c2f78f3225dfc06c638c8689">SSLSUPP_HTTPS_PROXY</a>))</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">/* The pointers to the ssl backend data, which is opaque here, are swapped</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">       rather than move the contents. */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    pbdata = conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex].backend;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">proxy_ssl</a>[sockindex] = conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex];</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(&amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex], 0, <span class="keyword">sizeof</span>(conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex]));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(pbdata, 0, <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a67125f10866c619561ae6a7d38c4cd6f">sizeof_ssl_backend_data</a>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].backend = pbdata;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<a class="code" href="vtls_8h.html#aab12c9ee7a4c9d065f76d3ab539bdb62">Curl_ssl_connect</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aec16dc8e44e2c34947cf23a7e0211b53">proxy_ssl_connected</a>[sockindex]) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = ssl_connect_init_proxy(conn, sockindex);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span>(!ssl_prefs_check(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>))</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">/* mark this is being ssl-enabled from here on. */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">state</a> = <a class="code" href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa56d3789a93aa76bfd92fb6bd88720773">ssl_connection_negotiating</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad095aecbd9d52877e333ce815c726279">connect</a>(conn, sockindex);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="progress_8c.html#a1344967836d86ae13b5739ed0a6e6916">Curl_pgrsTime</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <a class="code" href="progress_8h.html#abc090d144fb55d31dff488d24c46fb2aa2234f553d2849429bca27d7d4c898107">TIMER_APPCONNECT</a>); <span class="comment">/* SSL is connected */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<a class="code" href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                             <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#aec16dc8e44e2c34947cf23a7e0211b53">proxy_ssl_connected</a>[sockindex]) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = ssl_connect_init_proxy(conn, sockindex);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span>(!ssl_prefs_check(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>))</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">/* mark this is being ssl requested from here on. */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a422cb9e62c56c537d9238c398cd8c4e2">connect_nonblocking</a>(conn, sockindex, done);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> &amp;&amp; *done)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="progress_8c.html#a1344967836d86ae13b5739ed0a6e6916">Curl_pgrsTime</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <a class="code" href="progress_8h.html#abc090d144fb55d31dff488d24c46fb2aa2234f553d2849429bca27d7d4c898107">TIMER_APPCONNECT</a>); <span class="comment">/* SSL is connected */</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> * Lock shared SSL session data</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">void</span> Curl_ssl_sessionid_lock(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>))</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cae1d5692a2f2f61e7194c5c0eb7227ae1">CURL_LOCK_DATA_SSL_SESSION</a>, <a class="code" href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> * Unlock shared SSL session data</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">void</span> Curl_ssl_sessionid_unlock(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>))</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <a class="code" href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cae1d5692a2f2f61e7194c5c0eb7227ae1">CURL_LOCK_DATA_SSL_SESSION</a>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"> * Check if there&#39;s a session ID for the given connection in the cache, and if</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> * there&#39;s one suitable, it is provided. Returns TRUE when no entry matched.</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordtype">bool</span> Curl_ssl_getsessionid(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                           <span class="keywordtype">void</span> **ssl_sessionid,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                           <span class="keywordtype">size_t</span> *idsize, <span class="comment">/* set 0 if unknown */</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                           <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a> *check;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">long</span> *general_age;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">bool</span> no_match = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> isProxy = <a class="code" href="url_8h.html#ac1bb6fc72c7dbc5a230d369f9113fd24">CONNECT_PROXY_SSL</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__primary__config.html">ssl_primary_config</a> * <span class="keyword">const</span> ssl_config = isProxy ?</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    &amp;conn-&gt;<a class="code" href="structconnectdata.html#ad7c678f6933c3681e5d4e31d0a2a6494">proxy_ssl_config</a> :</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    &amp;conn-&gt;<a class="code" href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">ssl_config</a>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> = isProxy ? conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a> :</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">int</span> port = isProxy ? (int)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a> : conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  *ssl_sessionid = NULL;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a>(primary.sessionid));</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a>(primary.sessionid))</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">/* session ID re-use is disabled */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">/* Lock if shared */</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a>(<a class="code" href="structdata.html">data</a>))</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    general_age = &amp;<a class="code" href="structdata.html">data</a>-&gt;share-&gt;sessionage;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    general_age = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.sessionage;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; i &lt; data-&gt;<span class="keyword">set</span>.general_ssl.max_ssl_sessions; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    check = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span>(!check-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a>)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">/* not session ID means blank entry */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, check-&gt;<a class="code" href="structcurl__ssl__session.html#ae32e7338526a0b717bbe57225026e892">name</a>) &amp;&amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;       ((!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae55bdf35c39d2f5556e9ea5576b9b92e">conn_to_host</a> &amp;&amp; !check-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a>) ||</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae55bdf35c39d2f5556e9ea5576b9b92e">conn_to_host</a> &amp;&amp; check-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a> &amp;&amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(conn-&gt;<a class="code" href="structconnectdata.html#aaf06c7a3f4e682976ea7c3fc86273aa6">conn_to_host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>, check-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a>))) &amp;&amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;       ((!conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae84bd59ece78f702a2fcac5438edf7e5">conn_to_port</a> &amp;&amp; check-&gt;<a class="code" href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">conn_to_port</a> == -1) ||</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        (conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae84bd59ece78f702a2fcac5438edf7e5">conn_to_port</a> &amp;&amp; check-&gt;<a class="code" href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">conn_to_port</a> != -1 &amp;&amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         conn-&gt;<a class="code" href="structconnectdata.html#ad1a5d617e25de38754bdafb919593c32">conn_to_port</a> == check-&gt;<a class="code" href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">conn_to_port</a>)) &amp;&amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       (port == check-&gt;<a class="code" href="structcurl__ssl__session.html#ae98a6ef2da16a32b737c5d86eaf44a3f">remote_port</a>) &amp;&amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;       <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>, check-&gt;<a class="code" href="structcurl__ssl__session.html#a27c3a3f0b5fb94ca0412cb5fa2f7a634">scheme</a>) &amp;&amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       <a class="code" href="vtls_8c.html#a20030f6c13c9de65950bb8cac1bfb0f9">Curl_ssl_config_matches</a>(ssl_config, &amp;check-&gt;<a class="code" href="structcurl__ssl__session.html#a8452e789a5667cf862731b2e45371fc4">ssl_config</a>)) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">/* yes, we have a session ID! */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      (*general_age)++;          <span class="comment">/* increase general age */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      check-&gt;<a class="code" href="structcurl__ssl__session.html#a65a8746c5666a1b482fd09dc581d3283">age</a> = *general_age; <span class="comment">/* set this as used in this age */</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      *ssl_sessionid = check-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">if</span>(idsize)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        *idsize = check-&gt;<a class="code" href="structcurl__ssl__session.html#a111e5a8e6a18837f049d90c2747bb609">idsize</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      no_match = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> no_match;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> * Kill a single session ID entry in the cache.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#a93fc7815a67581a10af46e077c24cb79">Curl_ssl_kill_session</a>(<span class="keyword">struct</span> <a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a> *session)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span>(session-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a>) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">/* defensive check */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">/* free the ID the SSL-layer specific way */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a160d83129b03dc642e91d4b4761b0731">session_free</a>(session-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    session-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a> = NULL;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    session-&gt;<a class="code" href="structcurl__ssl__session.html#a65a8746c5666a1b482fd09dc581d3283">age</a> = 0; <span class="comment">/* fresh */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="vtls_8c.html#a5f50ad085ea4993229348232d4719407">Curl_free_primary_ssl_config</a>(&amp;session-&gt;<a class="code" href="structcurl__ssl__session.html#a8452e789a5667cf862731b2e45371fc4">ssl_config</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(session-&gt;<a class="code" href="structcurl__ssl__session.html#ae32e7338526a0b717bbe57225026e892">name</a>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(session-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> * Delete the given session ID from the cache.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordtype">void</span> Curl_ssl_delsessionid(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">void</span> *ssl_sessionid)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="structdata.html">data</a>-&gt;set.general_ssl.max_ssl_sessions; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a> *check = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span>(check-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a> == ssl_sessionid) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="vtls_8h.html#a93fc7815a67581a10af46e077c24cb79">Curl_ssl_kill_session</a>(check);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"> * Store session id in the session cache. The ID passed on to this function</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"> * must already have been extracted and allocated the proper way for the SSL</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> * layer. Curl_XXXX_session_free() will be called to free/kill the session ID</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> * later on.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ssl_addsessionid(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                               <span class="keywordtype">void</span> *ssl_sessionid,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                               <span class="keywordtype">size_t</span> <a class="code" href="structcurl__ssl__session.html#a111e5a8e6a18837f049d90c2747bb609">idsize</a>,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                               <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>; <span class="comment">/* the mother of all structs */</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a> *store = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[0];</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">long</span> oldest_age = <a class="code" href="structdata.html">data</a>-&gt;state.session[0].age; <span class="comment">/* zero if unused */</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">char</span> *clone_host;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">char</span> *clone_conn_to_host;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">conn_to_port</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordtype">long</span> *general_age;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> isProxy = <a class="code" href="url_8h.html#ac1bb6fc72c7dbc5a230d369f9113fd24">CONNECT_PROXY_SSL</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__primary__config.html">ssl_primary_config</a> * <span class="keyword">const</span> ssl_config = isProxy ?</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    &amp;conn-&gt;<a class="code" href="structconnectdata.html#ad7c678f6933c3681e5d4e31d0a2a6494">proxy_ssl_config</a> :</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    &amp;conn-&gt;<a class="code" href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">ssl_config</a>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>(<a class="code" href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a>(primary.sessionid));</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  clone_host = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(isProxy ? conn-&gt;<a class="code" href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">http_proxy</a>.<a class="code" href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a> : conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">if</span>(!clone_host)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>; <span class="comment">/* bail out */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae55bdf35c39d2f5556e9ea5576b9b92e">conn_to_host</a>) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    clone_conn_to_host = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(conn-&gt;<a class="code" href="structconnectdata.html#aaf06c7a3f4e682976ea7c3fc86273aa6">conn_to_host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span>(!clone_conn_to_host) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clone_host);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>; <span class="comment">/* bail out */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    clone_conn_to_host = NULL;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#ae84bd59ece78f702a2fcac5438edf7e5">conn_to_port</a>)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    conn_to_port = conn-&gt;<a class="code" href="structconnectdata.html#ad1a5d617e25de38754bdafb919593c32">conn_to_port</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    conn_to_port = -1;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">/* Now we should add the session ID and the host name to the cache, (remove</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">     the oldest if necessary) */</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">/* If using shared SSL session, lock! */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a>(<a class="code" href="structdata.html">data</a>)) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    general_age = &amp;<a class="code" href="structdata.html">data</a>-&gt;share-&gt;sessionage;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    general_age = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.sessionage;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">/* find an empty slot for us, or find the oldest */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 1; (<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="structdata.html">data</a>-&gt;set.general_ssl.max_ssl_sessions) &amp;&amp;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].sessionid; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].age &lt; oldest_age) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      oldest_age = <a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].age;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      store = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> == <a class="code" href="structdata.html">data</a>-&gt;set.general_ssl.max_ssl_sessions)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">/* cache is full, we must &quot;kill&quot; the oldest entry! */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="vtls_8h.html#a93fc7815a67581a10af46e077c24cb79">Curl_ssl_kill_session</a>(store);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    store = &amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; <span class="comment">/* use this slot */</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">/* now init the session struct wisely */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a> = ssl_sessionid;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#a111e5a8e6a18837f049d90c2747bb609">idsize</a> = idsize;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#a65a8746c5666a1b482fd09dc581d3283">age</a> = *general_age;    <span class="comment">/* set current age */</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">/* free it if there&#39;s one already present */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(store-&gt;<a class="code" href="structcurl__ssl__session.html#ae32e7338526a0b717bbe57225026e892">name</a>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(store-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#ae32e7338526a0b717bbe57225026e892">name</a> = clone_host;               <span class="comment">/* clone host name */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">conn_to_host</a> = clone_conn_to_host; <span class="comment">/* clone connect to host name */</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">conn_to_port</a> = conn_to_port; <span class="comment">/* connect to port number */</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">/* port number */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#ae98a6ef2da16a32b737c5d86eaf44a3f">remote_port</a> = isProxy ? (int)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a> : conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  store-&gt;<a class="code" href="structcurl__ssl__session.html#a27c3a3f0b5fb94ca0412cb5fa2f7a634">scheme</a> = conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">scheme</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="vtls_8c.html#a9468007b0049e63d8dac0a8096beb0c4">Curl_clone_primary_ssl_config</a>(ssl_config, &amp;store-&gt;<a class="code" href="structcurl__ssl__session.html#a8452e789a5667cf862731b2e45371fc4">ssl_config</a>)) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    store-&gt;<a class="code" href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">sessionid</a> = NULL; <span class="comment">/* let caller free sessionid */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clone_host);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(clone_conn_to_host);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#a396bfd7b7888300739b9c3b323ab0907">Curl_ssl_close_all</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">/* kill the session ID cache if not shared */</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.session &amp;&amp; !<a class="code" href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a>(<a class="code" href="structdata.html">data</a>)) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; <a class="code" href="structdata.html">data</a>-&gt;set.general_ssl.max_ssl_sessions; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">/* the single-killer function handles empty table slots */</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="vtls_8h.html#a93fc7815a67581a10af46e077c24cb79">Curl_ssl_kill_session</a>(&amp;<a class="code" href="structdata.html">data</a>-&gt;state.session[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/* free the cache data */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="structdata.html">data</a>-&gt;state.session);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a68084094b73391e157c71d993b34582a">close_all</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#if defined(USE_OPENSSL) || defined(USE_GNUTLS) || defined(USE_SCHANNEL) || \</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">  defined(USE_DARWINSSL) || defined(USE_POLARSSL) || defined(USE_NSS) || \</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">  defined(USE_MBEDTLS) || defined(USE_CYASSL)</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a665432b41da505b40f72af4161b011aa">Curl_ssl_getsock</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                     <span class="keywordtype">int</span> numsocks)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">struct </span><a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl = &amp;conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span>(!numsocks)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span>(connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a8c6d961fbef3442f91a0c29191e83256">ssl_connect_2_writing</a>) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">/* write mode */</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    socks[0] = conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#a9aabda59f0ff87c1db3a2d306a410713">GETSOCK_WRITESOCK</a>(0);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span>(connssl-&gt;<a class="code" href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">connecting_state</a> == <a class="code" href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a83e9e80af0be0e0a560a5c925cc2e216">ssl_connect_2_reading</a>) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">/* read mode */</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    socks[0] = conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#a4ae1fb64a27264765b6a2fe5aca78830">GETSOCK_READSOCK</a>(0);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a665432b41da505b40f72af4161b011aa">Curl_ssl_getsock</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                     <a class="code" href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a> *socks,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                     <span class="keywordtype">int</span> numsocks)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  (void)conn;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  (void)socks;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  (void)numsocks;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">/* USE_OPENSSL || USE_GNUTLS || USE_SCHANNEL || USE_DARWINSSL || USE_NSS */</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#a4b8227a2fd2fbf2d20147513033a8ade">Curl_ssl_close</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;{</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a>((sockindex &lt;= 1) &amp;&amp; (sockindex &gt;= -1));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a6dc7b4efb047c7107ebad236294662ec">close_one</a>(conn, sockindex);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a17b59e5f0576d37fa4b20ac37a6848e9">Curl_ssl_shutdown</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a925cabc8824963843fc4feef4b8898a0">shutdown</a>(conn, sockindex))</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8d39df5d5e9f3ecd4b121021500f68f4">CURLE_SSL_SHUTDOWN_FAILED</a>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">use</a> = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>; <span class="comment">/* get back to ordinary socket usage */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">ssl</a>[sockindex].<a class="code" href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">state</a> = <a class="code" href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa014160d2a4a284f35c6edc4f38dfd8df">ssl_connection_none</a>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">recv</a>[sockindex] = <a class="code" href="sendf_8c.html#a93f532184de8849628a6048c992daf2b">Curl_recv_plain</a>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">send</a>[sockindex] = <a class="code" href="sendf_8c.html#aabefb972f6bc78eb11f4b038a6508ecd">Curl_send_plain</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">/* Selects an SSL crypto engine</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a392119b7e5b7e3cc074654c88c102025">Curl_ssl_set_engine</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *engine)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;{</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a749287dc9e4d4f4f57bb232bf5e211c4">set_engine</a>(<a class="code" href="structdata.html">data</a>, engine);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">/* Selects the default SSL crypto engine</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a87cb30101b924de437acfb2520a35f70">Curl_ssl_set_engine_default</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a7e1330877662aaf6c91de7c74dbc6b68">set_engine_default</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">/* Return list of OpenSSL crypto engine names. */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="vtls_8h.html#aa49025b2e48d587fb3852f2abd2e4be6">Curl_ssl_engines_list</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad563906703cdf28011c0057afb70740d">engines_list</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"> * This sets up a session ID cache to the specified size. Make sure this code</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"> * is agnostic to what underlying SSL technology we use.</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a646fd2a8d6796d8ff481bffc36b371d5">Curl_ssl_initsessions</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keywordtype">size_t</span> amount)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;{</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a> *session;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="structdata.html">data</a>-&gt;state.session)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">/* this is just a precaution to prevent multiple inits */</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  session = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(amount, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcurl__ssl__session.html">curl_ssl_session</a>));</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span>(!session)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">/* store the info in the SSL section */</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;set.general_ssl.max_ssl_sessions = amount;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;state.session = session;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;state.sessionage = 1; <span class="comment">/* this is brand new */</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> Curl_multissl_version(<span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="vtls_8h.html#afeb6f7a003d210b324a5484170a56ca7">Curl_ssl_version</a>(<span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#ifdef CURL_WITH_MULTI_SSL</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">return</span> Curl_multissl_version(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#adc662f96d977f669d06805db2a9093c0">version</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"> * This function tries to determine connection status.</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"> * Return codes:</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> *     1 means the connection is still in place</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"> *     0 means the connection has been closed</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"> *    -1 means the connection status is unknown</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a82bbffffb6866ede7a554960f09690ea">Curl_ssl_check_cxn</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;{</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a7bcabc334ae96ab166d50fdf9d65242d">check_cxn</a>(conn);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#ac50ee79a0869be9ea58bda0388abde58">Curl_ssl_data_pending</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                           <span class="keywordtype">int</span> connindex)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a3f9f9d75e3ee6b746a525dde365f7563">data_pending</a>(conn, connindex);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#aa4cc853c97440333b00f76f160b3af50">Curl_ssl_free_certinfo</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__certinfo.html">curl_certinfo</a> *ci = &amp;<a class="code" href="structdata.html">data</a>-&gt;info.certs;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">if</span>(ci-&gt;<a class="code" href="structcurl__certinfo.html#a9eb8ef837e5a8ddb848ac7bae35ed92f">num_of_certs</a>) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">/* free all individual lists used */</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>&lt;ci-&gt;<a class="code" href="structcurl__certinfo.html#a9eb8ef837e5a8ddb848ac7bae35ed92f">num_of_certs</a>; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = NULL;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>); <span class="comment">/* free the actual array too */</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a> = NULL;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    ci-&gt;<a class="code" href="structcurl__certinfo.html#a9eb8ef837e5a8ddb848ac7bae35ed92f">num_of_certs</a> = 0;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;}</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ssl_init_certinfo(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>, <span class="keywordtype">int</span> num)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__certinfo.html">curl_certinfo</a> *ci = &amp;<a class="code" href="structdata.html">data</a>-&gt;info.certs;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> **table;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">/* Free any previous certificate information structures */</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="code" href="vtls_8h.html#aa4cc853c97440333b00f76f160b3af50">Curl_ssl_free_certinfo</a>(<a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">/* Allocate the required certificate information structures */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  table = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>((<span class="keywordtype">size_t</span>) num, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcurl__slist.html">curl_slist</a> *));</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span>(!table)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  ci-&gt;<a class="code" href="structcurl__certinfo.html#a9eb8ef837e5a8ddb848ac7bae35ed92f">num_of_certs</a> = num;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a> = table;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"> * &#39;value&#39; is NOT a zero terminated string</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ssl_push_certinfo_len(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                    <span class="keywordtype">int</span> certnum,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *label,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                    <span class="keywordtype">size_t</span> valuelen)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;{</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__certinfo.html">curl_certinfo</a> *ci = &amp;<a class="code" href="structdata.html">data</a>-&gt;info.certs;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *nl;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordtype">size_t</span> labellen = strlen(label);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordtype">size_t</span> outlen = labellen + 1 + valuelen + 1; <span class="comment">/* label:value\0 */</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(outlen);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">/* sprintf the label and colon */</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>, outlen, <span class="stringliteral">&quot;%s:&quot;</span>, label);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">/* memcpy the value (it might not be zero terminated) */</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(&amp;<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>[labellen + 1], <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, valuelen);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">/* zero terminate the output */</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>[labellen + 1 + valuelen] = 0;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  nl = <a class="code" href="slist_8c.html#a7982a92d1abe5dcce03e879a402c809b">Curl_slist_append_nodup</a>(ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>[certnum], <a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">if</span>(!nl) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a>(ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>[certnum]);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  ci-&gt;<a class="code" href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">certinfo</a>[certnum] = nl;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment"> * This is a convenience function for push_certinfo_len that takes a zero</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"> * terminated value.</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ssl_push_certinfo(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                <span class="keywordtype">int</span> certnum,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *label,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;{</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">size_t</span> valuelen = strlen(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">return</span> Curl_ssl_push_certinfo_len(<a class="code" href="structdata.html">data</a>, certnum, label, <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>, valuelen);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#aeec761b6ce10b474ec609a3336177da7">Curl_ssl_random</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *entropy,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                         <span class="keywordtype">size_t</span> length)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#aba654e0cf223146bd58cd9bf6dc35834">random</a>(<a class="code" href="structdata.html">data</a>, entropy, length);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"> * Public key pem to der conversion</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> pubkey_pem_to_der(<span class="keyword">const</span> <span class="keywordtype">char</span> *pem,</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **der, <span class="keywordtype">size_t</span> *der_len)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordtype">char</span> *stripped_pem, *begin_pos, *end_pos;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordtype">size_t</span> pem_count, stripped_pem_count = 0, pem_len;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">/* if no pem, exit. */</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span>(!pem)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  begin_pos = strstr(pem, <span class="stringliteral">&quot;-----BEGIN PUBLIC KEY-----&quot;</span>);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span>(!begin_pos)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  pem_count = begin_pos - pem;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">/* Invalid if not at beginning AND not directly following \n */</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span>(0 != pem_count &amp;&amp; <span class="charliteral">&#39;\n&#39;</span> != pem[pem_count - 1])</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">/* 26 is length of &quot;-----BEGIN PUBLIC KEY-----&quot; */</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  pem_count += 26;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">/* Invalid if not directly following \n */</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  end_pos = strstr(pem + pem_count, <span class="stringliteral">&quot;\n-----END PUBLIC KEY-----&quot;</span>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">if</span>(!end_pos)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  pem_len = end_pos - pem;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  stripped_pem = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(pem_len - pem_count + 1);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span>(!stripped_pem)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">   * Here we loop through the pem array one character at a time between the</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">   * correct indices, and place each character that is not &#39;\n&#39; or &#39;\r&#39;</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">   * into the stripped_pem array, which should represent the raw base64 string</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">while</span>(pem_count &lt; pem_len) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;\n&#39;</span> != pem[pem_count] &amp;&amp; <span class="charliteral">&#39;\r&#39;</span> != pem[pem_count])</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      stripped_pem[stripped_pem_count++] = pem[pem_count];</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    ++pem_count;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">/* Place the null terminator in the correct place */</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  stripped_pem[stripped_pem_count] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a3b1d7d4873cc224ffb2ce6ff201bc2e6">Curl_base64_decode</a>(stripped_pem, der, der_len);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(stripped_pem);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"> * Generic pinned public key check.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_pin_peer_pubkey(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *pinnedpubkey,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pubkey, <span class="keywordtype">size_t</span> pubkeylen)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;{</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">FILE</a> *fp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> = NULL, *pem_ptr = NULL;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">long</span> <a class="code" href="mime_8c.html#a6750c6bf3d5e493a9afbf0c278110187">filesize</a>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, pem_len;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> pem_read;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f">CURLE_SSL_PINNEDPUBKEYNOTMATCH</a>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> encode;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordtype">size_t</span> encodedlen, pinkeylen;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordtype">char</span> *encoded, *pinkeycopy, *begin_pos, *end_pos;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sha256sumdigest = NULL;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">/* if a path wasn&#39;t specified, don&#39;t pin */</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span>(!pinnedpubkey)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span>(!pubkey || !pubkeylen)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">/* only do this if pinnedpubkey starts with &quot;sha256//&quot;, length 8 */</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">if</span>(strncmp(pinnedpubkey, <span class="stringliteral">&quot;sha256//&quot;</span>, 8) == 0) {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a612fcbf1ed7cd81a4638219327511f1e">sha256sum</a>) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">/* without sha256 support, this cannot match */</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">/* compute sha256sum of public key */</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    sha256sumdigest = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="vtls_8h.html#a92d73bed4c4dd74c727d2fff527182dc">CURL_SHA256_DIGEST_LENGTH</a>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span>(!sha256sumdigest)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    encode = <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a612fcbf1ed7cd81a4638219327511f1e">sha256sum</a>(pubkey, pubkeylen,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        sha256sumdigest, <a class="code" href="vtls_8h.html#a92d73bed4c4dd74c727d2fff527182dc">CURL_SHA256_DIGEST_LENGTH</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span>(encode != <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keywordflow">return</span> encode;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    encode = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>, (<span class="keywordtype">char</span> *)sha256sumdigest,</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                <a class="code" href="vtls_8h.html#a92d73bed4c4dd74c727d2fff527182dc">CURL_SHA256_DIGEST_LENGTH</a>, &amp;encoded,</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                &amp;encodedlen);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(sha256sumdigest);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span>(encode)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">return</span> encode;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;\t public key hash: sha256//%s\n&quot;</span>, encoded);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">/* it starts with sha256//, copy so we can modify it */</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    pinkeylen = strlen(pinnedpubkey) + 1;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    pinkeycopy = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(pinkeylen);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span>(!pinkeycopy) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(encoded);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(pinkeycopy, pinnedpubkey, pinkeylen);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">/* point begin_pos to the copy, and start extracting keys */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    begin_pos = pinkeycopy;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      end_pos = strstr(begin_pos, <span class="stringliteral">&quot;;sha256//&quot;</span>);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">       * if there is an end_pos, null terminate,</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">       * otherwise it&#39;ll go to the end of the original string</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">if</span>(end_pos)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        end_pos[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="comment">/* compare base64 sha256 digests, 8 is the length of &quot;sha256//&quot; */</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">if</span>(encodedlen == strlen(begin_pos + 8) &amp;&amp;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;         !memcmp(encoded, begin_pos + 8, encodedlen)) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">       * change back the null-terminator we changed earlier,</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">       * and look for next begin</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">if</span>(end_pos) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        end_pos[0] = <span class="charliteral">&#39;;&#39;</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        begin_pos = strstr(end_pos, <span class="stringliteral">&quot;sha256//&quot;</span>);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    } <span class="keywordflow">while</span>(end_pos &amp;&amp; begin_pos);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(encoded);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(pinkeycopy);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  fp = fopen(pinnedpubkey, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">if</span>(!fp)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">/* Determine the file&#39;s size */</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span>(fseek(fp, 0, SEEK_END))</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="mime_8c.html#a6750c6bf3d5e493a9afbf0c278110187">filesize</a> = ftell(fp);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span>(fseek(fp, 0, SEEK_SET))</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">if</span>(filesize &lt; 0 || filesize &gt; <a class="code" href="vtls_8h.html#ad41b64c4881c0ecdfd32c65344faa675">MAX_PINNED_PUBKEY_SIZE</a>)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">     * if the size of our certificate is bigger than the file</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">     * size then it can&#39;t match</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> = <a class="code" href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a>((<a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a>) <a class="code" href="mime_8c.html#a6750c6bf3d5e493a9afbf0c278110187">filesize</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span>(pubkeylen &gt; <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">     * Allocate buffer for the pinned key</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">     * With 1 additional byte for null terminator in case of PEM key</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> + 1);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">/* Returns number of elements read, which should be 1 */</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span>((<span class="keywordtype">int</span>) <a class="code" href="stdcheaders_8h.html#aae22dd41ebe1e64904429c5a31e7e642">fread</a>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>, 1, fp) != 1)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">/* If the sizes are the same, it can&#39;t be base64 encoded, must be der */</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span>(pubkeylen == <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>) {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">if</span>(!memcmp(pubkey, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, pubkeylen))</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">     * Otherwise we will assume it&#39;s PEM and try to decode it</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">     * after placing null terminator</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>[<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    pem_read = pubkey_pem_to_der((<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, &amp;pem_ptr, &amp;pem_len);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">/* if it wasn&#39;t read successfully, exit */</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">if</span>(pem_read)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">     * if the size of our certificate doesn&#39;t match the size of</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">     * the decoded file, they can&#39;t be the same, otherwise compare</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span>(pubkeylen == pem_len &amp;&amp; !memcmp(pubkey, pem_ptr, pubkeylen))</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  } <span class="keywordflow">while</span>(0);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(pem_ptr);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  fclose(fp);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_CRYPTO_AUTH</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ssl_md5sum(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tmp, <span class="comment">/* input */</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                         <span class="keywordtype">size_t</span> tmplen,</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *md5sum, <span class="comment">/* output */</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                         <span class="keywordtype">size_t</span> md5len)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a3c0175748d16e46be4ade09f746bee52">md5sum</a>(tmp, tmplen, md5sum, md5len);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"> * Check whether the SSL backend supports the status_request extension.</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#af7010b022a42f4fd9f6fc7d568fc3a03">Curl_ssl_cert_status_request</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;{</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#acbf00c2f926253c7e3ff442213ab00e8">cert_status_request</a>();</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment"> * Check whether the SSL backend supports false start.</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#ad3a3e43e2c5ff47cf4ea6592a70feaf0">Curl_ssl_false_start</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;{</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a64462bcb53b267e8b31f3a7f397f13b1">false_start</a>();</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"> * Check whether the SSL backend supports setting TLS 1.3 cipher suites</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#a02ca5f1341dc43cd1ce5c8531fffea07">Curl_ssl_tls13_ciphersuites</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad8aeedd93171e98d8db0049085d40f31">supports</a> &amp; <a class="code" href="vtls_8h.html#a486d7ada0cb21188917be26be3d81483">SSLSUPP_TLS13_CIPHERSUITES</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"> * Default implementations for unsupported functions.</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a9fe9fd14fbe2d9fc29d582a6c4ed0f83">Curl_none_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;{</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#ab751ac92e09399d2e4edae147629770a">Curl_none_cleanup</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;{ }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a3c3bb919efb77b74d92b862902071389">Curl_none_shutdown</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                       <span class="keywordtype">int</span> sockindex <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;{</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  (void)conn;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  (void)sockindex;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordtype">int</span> <a class="code" href="vtls_8h.html#a9076c5bbae2cb8510d32eb97d8bce277">Curl_none_check_cxn</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;{</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  (void)conn;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;}</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a04e21d561123bc29f2e018c260ede891">Curl_none_random</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *entropy <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                          <span class="keywordtype">size_t</span> length <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  (void)entropy;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  (void)length;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;}</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#a054a6a646a0108d8f91a503d31a21671">Curl_none_close_all</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keywordtype">void</span> <a class="code" href="vtls_8h.html#abd2be2ec8895660c6eb7e124cfac438e">Curl_none_session_free</a>(<span class="keywordtype">void</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  (void)<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#aba5f776941608a9d5c44fd0b422b1862">Curl_none_data_pending</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                            <span class="keywordtype">int</span> connindex <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;{</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  (void)conn;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  (void)connindex;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;}</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#afd63787510a375221ab2aba491ef2073">Curl_none_cert_status_request</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a7ccc438dc80065afa61534a12f49716b">Curl_none_set_engine</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *engine <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;{</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  (void)engine;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;}</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a06f0fb1d7887e2395f579c430c55e9da">Curl_none_set_engine_default</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;{</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;}</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keyword">struct </span><a class="code" href="structcurl__slist.html">curl_slist</a> *<a class="code" href="vtls_8h.html#a93de8d8215f8110779b3e2ab9d77dbd3">Curl_none_engines_list</a>(<span class="keyword">struct</span> <a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  (void)<a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structcurl__slist.html">curl_slist</a> *)NULL;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;}</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="vtls_8h.html#a0a1d6e1d64672ae38b75216a44d08641">Curl_none_false_start</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;{</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;}</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_CRYPTO_AUTH</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structinput.html">input</a>, <span class="keywordtype">size_t</span> inputlen,</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *md5sum, <span class="keywordtype">size_t</span> md5len <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;{</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="struct_m_d5__context.html">MD5_context</a> *MD5pw;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  (void)md5len;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  MD5pw = <a class="code" href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a>(<a class="code" href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordflow">if</span>(!MD5pw)</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a>(MD5pw, <a class="code" href="structinput.html">input</a>, <a class="code" href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a>(inputlen));</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <a class="code" href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a>(MD5pw, md5sum);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structinput.html">input</a> <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                          <span class="keywordtype">size_t</span> inputlen <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *md5sum <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>,</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                          <span class="keywordtype">size_t</span> md5len <a class="code" href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a>)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  (void)<a class="code" href="structinput.html">input</a>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  (void)inputlen;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  (void)md5sum;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  (void)md5len;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;}</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> Curl_multissl_init(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;{</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span>(multissl_init(NULL))</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a49b2b5753c234a1eb7f05181eea0e61a">init</a>();</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;}</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_multissl_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;{</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span>(multissl_init(NULL))</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7c5e621b8f31e5f941e6044519b4c9c9">CURLE_FAILED_INIT</a>;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad095aecbd9d52877e333ce815c726279">connect</a>(conn, sockindex);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_multissl_connect_nonblocking(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                                  <span class="keywordtype">int</span> sockindex, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;{</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">if</span>(multissl_init(NULL))</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a7c5e621b8f31e5f941e6044519b4c9c9">CURLE_FAILED_INIT</a>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a422cb9e62c56c537d9238c398cd8c4e2">connect_nonblocking</a>(conn, sockindex, done);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;}</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *Curl_multissl_get_internals(<span class="keyword">struct</span> <a class="code" href="structssl__connect__data.html">ssl_connect_data</a> *connssl,</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                         <a class="code" href="curl_8h.html#aabc03ec968a2fdccde5c6709f712dd7b">CURLINFO</a> info)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;{</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">if</span>(multissl_init(NULL))</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#ad0f029e7ced2495420d8394a5ed9d597">get_internals</a>(connssl, info);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Curl_multissl_close(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex)</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span>(multissl_init(NULL))</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a6dc7b4efb047c7107ebad236294662ec">close_one</a>(conn, sockindex);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;}</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> Curl_ssl_multi = {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  { <a class="code" href="curl_8h.html#a908c5b707ac681212b8f8688cf76689da221aaf856b5e48cc0315c0fc62fc8caf">CURLSSLBACKEND_NONE</a>, <span class="stringliteral">&quot;multi&quot;</span> },  <span class="comment">/* info */</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  0, <span class="comment">/* supports nothing */</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  (size_t)-1, <span class="comment">/* something insanely large to be on the safe side */</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  Curl_multissl_init,                <span class="comment">/* init */</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="vtls_8h.html#ab751ac92e09399d2e4edae147629770a">Curl_none_cleanup</a>,                 <span class="comment">/* cleanup */</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  Curl_multissl_version,             <span class="comment">/* version */</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="vtls_8h.html#a9076c5bbae2cb8510d32eb97d8bce277">Curl_none_check_cxn</a>,               <span class="comment">/* check_cxn */</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="vtls_8h.html#a3c3bb919efb77b74d92b862902071389">Curl_none_shutdown</a>,                <span class="comment">/* shutdown */</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="vtls_8h.html#aba5f776941608a9d5c44fd0b422b1862">Curl_none_data_pending</a>,            <span class="comment">/* data_pending */</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="vtls_8h.html#a04e21d561123bc29f2e018c260ede891">Curl_none_random</a>,                  <span class="comment">/* random */</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="vtls_8h.html#afd63787510a375221ab2aba491ef2073">Curl_none_cert_status_request</a>,     <span class="comment">/* cert_status_request */</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  Curl_multissl_connect,             <span class="comment">/* connect */</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  Curl_multissl_connect_nonblocking, <span class="comment">/* connect_nonblocking */</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  Curl_multissl_get_internals,       <span class="comment">/* get_internals */</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  Curl_multissl_close,               <span class="comment">/* close_one */</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="vtls_8h.html#a054a6a646a0108d8f91a503d31a21671">Curl_none_close_all</a>,               <span class="comment">/* close_all */</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <a class="code" href="vtls_8h.html#abd2be2ec8895660c6eb7e124cfac438e">Curl_none_session_free</a>,            <span class="comment">/* session_free */</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <a class="code" href="vtls_8h.html#a7ccc438dc80065afa61534a12f49716b">Curl_none_set_engine</a>,              <span class="comment">/* set_engine */</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="vtls_8h.html#a06f0fb1d7887e2395f579c430c55e9da">Curl_none_set_engine_default</a>,      <span class="comment">/* set_engine_default */</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="vtls_8h.html#a93de8d8215f8110779b3e2ab9d77dbd3">Curl_none_engines_list</a>,            <span class="comment">/* engines_list */</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="vtls_8h.html#a0a1d6e1d64672ae38b75216a44d08641">Curl_none_false_start</a>,             <span class="comment">/* false_start */</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a>,                  <span class="comment">/* md5sum */</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  NULL                               <span class="comment">/* sha256sum */</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;};</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *<a class="code" href="struct_curl__ssl.html">Curl_ssl</a> =</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="preprocessor">#if defined(CURL_WITH_MULTI_SSL)</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  &amp;Curl_ssl_multi;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor">#elif defined(USE_CYASSL)</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  &amp;Curl_ssl_cyassl;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="preprocessor">#elif defined(USE_DARWINSSL)</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  &amp;Curl_ssl_darwinssl;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">#elif defined(USE_GNUTLS)</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  &amp;Curl_ssl_gnutls;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">#elif defined(USE_GSKIT)</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  &amp;Curl_ssl_gskit;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor">#elif defined(USE_MBEDTLS)</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  &amp;Curl_ssl_mbedtls;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor">#elif defined(USE_NSS)</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  &amp;Curl_ssl_nss;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">#elif defined(USE_OPENSSL)</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  &amp;Curl_ssl_openssl;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor">#elif defined(USE_POLARSSL)</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  &amp;Curl_ssl_polarssl;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">#elif defined(USE_SCHANNEL)</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  &amp;Curl_ssl_schannel;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="preprocessor">#elif defined(USE_MESALINK)</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  &amp;Curl_ssl_mesalink;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor">#error &quot;Missing struct Curl_ssl for selected SSL backend&quot;</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *available_backends[] = {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#if defined(USE_CYASSL)</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  &amp;Curl_ssl_cyassl,</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="preprocessor">#if defined(USE_DARWINSSL)</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  &amp;Curl_ssl_darwinssl,</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">#if defined(USE_GNUTLS)</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  &amp;Curl_ssl_gnutls,</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#if defined(USE_GSKIT)</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  &amp;Curl_ssl_gskit,</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">#if defined(USE_MBEDTLS)</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  &amp;Curl_ssl_mbedtls,</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor">#if defined(USE_NSS)</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  &amp;Curl_ssl_nss,</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#if defined(USE_OPENSSL)</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  &amp;Curl_ssl_openssl,</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">#if defined(USE_POLARSSL)</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  &amp;Curl_ssl_polarssl,</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor">#if defined(USE_SCHANNEL)</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  &amp;Curl_ssl_schannel,</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor">#if defined(USE_MESALINK)</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  &amp;Curl_ssl_mesalink,</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  NULL</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;};</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> Curl_multissl_version(<span class="keywordtype">char</span> *<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, <span class="keywordtype">size_t</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *selected;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> backends[200];</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">size_t</span> total;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *current;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  current = <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> == &amp;Curl_ssl_multi ? available_backends[0] : <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">if</span>(current != selected) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = backends;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    selected = current;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>)</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        *(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++) = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">if</span>(selected != available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>])</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        *(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++) = <span class="charliteral">&#39;(&#39;</span>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> += available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;<a class="code" href="struct_curl__ssl.html#adc662f96d977f669d06805db2a9093c0">version</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, backends + <span class="keyword">sizeof</span>(backends) - <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordflow">if</span>(selected != available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>])</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        *(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++) = <span class="charliteral">&#39;)&#39;</span>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    total = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> - backends;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> &lt; total)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, backends, total + 1);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(<a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>, backends, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> - 1);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <a class="code" href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a>[<a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordflow">return</span> total;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> multissl_init(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> *backend)</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;{</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *env;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordtype">char</span> *env_tmp;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="struct_curl__ssl.html">Curl_ssl</a> != &amp;Curl_ssl_multi)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordflow">if</span>(backend) {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> = backend;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span>(!available_backends[0])</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  env = env_tmp = <a class="code" href="curl_8h.html#a613d9e6457f36b84548cbf2006a34e14">curl_getenv</a>(<span class="stringliteral">&quot;CURL_SSL_BACKEND&quot;</span>);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">#ifdef CURL_DEFAULT_SSL_BACKEND</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">if</span>(!env)</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    env = CURL_DEFAULT_SSL_BACKEND;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">if</span>(env) {</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(env, available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#ad9c9173193aa31ef9ebf491974b8996d">name</a>)) {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> = available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>];</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <a class="code" href="curl_8h.html#a87dca8b22dd0cba4eaa880bdf87b8805">curl_free</a>(env_tmp);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      }</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  }</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="comment">/* Fall back to first available backend */</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="struct_curl__ssl.html">Curl_ssl</a> = available_backends[0];</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="curl_8h.html#a87dca8b22dd0cba4eaa880bdf87b8805">curl_free</a>(env_tmp);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946">CURLsslset</a> <a class="code" href="vtls_8c.html#a9c46acf5dfae9aa4b40fbb64c9035768">curl_global_sslset</a>(<a class="code" href="curl_8h.html#a908c5b707ac681212b8f8688cf76689d">curl_sslbackend</a> <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>,</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                              <span class="keyword">const</span> <a class="code" href="structcurl__ssl__backend.html">curl_ssl_backend</a> ***avail)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;{</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">if</span>(avail)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    *avail = (<span class="keyword">const</span> <a class="code" href="structcurl__ssl__backend.html">curl_ssl_backend</a> **)&amp;available_backends;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="struct_curl__ssl.html">Curl_ssl</a> != &amp;Curl_ssl_multi)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">return</span> <span class="keywordtype">id</span> == <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#a9136e3e9b797273b4089097e07ce707e">id</a> ||</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;           (<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, <a class="code" href="struct_curl__ssl.html">Curl_ssl</a>-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#ad9c9173193aa31ef9ebf491974b8996d">name</a>)) ?</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;           <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946ae2e02748c75fb4f1d21599d52d3b3c28">CURLSSLSET_OK</a> :</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;#<span class="keywordflow">if</span> defined(CURL_WITH_MULTI_SSL)</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;           <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946aa6c7024b2ed0ce8791f4746a5d8f295f">CURLSSLSET_TOO_LATE</a>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;           <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946a220e84ecae4a7fde9fda4de043c40928">CURLSSLSET_UNKNOWN_BACKEND</a>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span>(available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#a9136e3e9b797273b4089097e07ce707e">id</a> == <span class="keywordtype">id</span> ||</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;       (<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> &amp;&amp; <a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;<a class="code" href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">info</a>.<a class="code" href="structcurl__ssl__backend.html#ad9c9173193aa31ef9ebf491974b8996d">name</a>, <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>))) {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      multissl_init(available_backends[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946ae2e02748c75fb4f1d21599d52d3b3c28">CURLSSLSET_OK</a>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946a220e84ecae4a7fde9fda4de043c40928">CURLSSLSET_UNKNOWN_BACKEND</a>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* USE_SSL */</span><span class="preprocessor"></span></div><div class="line"><a name="l01337"></a><span class="lineno"><a class="line" href="vtls_8c.html#a9c46acf5dfae9aa4b40fbb64c9035768"> 1337</a></span>&#160;<a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946">CURLsslset</a> <a class="code" href="vtls_8c.html#a9c46acf5dfae9aa4b40fbb64c9035768">curl_global_sslset</a>(<a class="code" href="curl_8h.html#a908c5b707ac681212b8f8688cf76689d">curl_sslbackend</a> <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>,</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                              <span class="keyword">const</span> <a class="code" href="structcurl__ssl__backend.html">curl_ssl_backend</a> ***avail)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;{</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  (void)<span class="keywordtype">id</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  (void)<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  (void)avail;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946abec08c67963954b588c4af0f25998bec">CURLSSLSET_NO_BACKENDS</a>;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !USE_SSL */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="urldata_8h_html_a2ea01ebd139c38e2285c7d2e17a2683fa56d3789a93aa76bfd92fb6bd88720773"><div class="ttname"><a href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa56d3789a93aa76bfd92fb6bd88720773">ssl_connection_negotiating</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00189">urldata.h:189</a></div></div>
<div class="ttc" id="structconnectdata_html_ab6f11cf5c5bc549e9f9af12fc65e2e23"><div class="ttname"><a href="structconnectdata.html#ab6f11cf5c5bc549e9f9af12fc65e2e23">connectdata::ssl</a></div><div class="ttdeci">struct ssl_connect_data ssl[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00885">urldata.h:885</a></div></div>
<div class="ttc" id="curl__setup_8h_html_a32dce3380228f1a23cdc1f784263762b"><div class="ttname"><a href="curl__setup_8h.html#a32dce3380228f1a23cdc1f784263762b">UNUSED_PARAM</a></div><div class="ttdeci">#define UNUSED_PARAM</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup_8h_source.html#l00699">curl_setup.h:699</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a68084094b73391e157c71d993b34582a"><div class="ttname"><a href="struct_curl__ssl.html#a68084094b73391e157c71d993b34582a">Curl_ssl::close_all</a></div><div class="ttdeci">void(* close_all)(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00064">vtls.h:64</a></div></div>
<div class="ttc" id="vtls_8c_html_a20030f6c13c9de65950bb8cac1bfb0f9"><div class="ttname"><a href="vtls_8c.html#a20030f6c13c9de65950bb8cac1bfb0f9">Curl_ssl_config_matches</a></div><div class="ttdeci">bool Curl_ssl_config_matches(struct ssl_primary_config *data, struct ssl_primary_config *needle)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00086">vtls.c:86</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a27c3a3f0b5fb94ca0412cb5fa2f7a634"><div class="ttname"><a href="structcurl__ssl__session.html#a27c3a3f0b5fb94ca0412cb5fa2f7a634">curl_ssl_session::scheme</a></div><div class="ttdeci">const char * scheme</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00259">urldata.h:259</a></div></div>
<div class="ttc" id="share_8h_html"><div class="ttname"><a href="share_8h.html">share.h</a></div></div>
<div class="ttc" id="structconnectdata_html_a9312f162d29fe7f59bc2b5dbeda85d9d"><div class="ttname"><a href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">connectdata::bits</a></div><div class="ttdeci">struct ConnectBits bits</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00894">urldata.h:894</a></div></div>
<div class="ttc" id="struct_connect_bits_html_ae55bdf35c39d2f5556e9ea5576b9b92e"><div class="ttname"><a href="struct_connect_bits.html#ae55bdf35c39d2f5556e9ea5576b9b92e">ConnectBits::conn_to_host</a></div><div class="ttdeci">bool conn_to_host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00383">urldata.h:383</a></div></div>
<div class="ttc" id="curl_8h_html_a87dca8b22dd0cba4eaa880bdf87b8805"><div class="ttname"><a href="curl_8h.html#a87dca8b22dd0cba4eaa880bdf87b8805">curl_free</a></div><div class="ttdeci">CURL_EXTERN void curl_free(void *p)</div><div class="ttdef"><b>Definition:</b> <a href="escape_8c_source.html#l00241">escape.c:241</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="curl_8h_html_a60ecc2082ebefd3b59083c19f6ca2946ae2e02748c75fb4f1d21599d52d3b3c28"><div class="ttname"><a href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946ae2e02748c75fb4f1d21599d52d3b3c28">CURLSSLSET_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02431">curl.h:2431</a></div></div>
<div class="ttc" id="curl_8h_html_a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df"><div class="ttname"><a href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4dadd0b0bf93854f50974d52f324d3259df">CURL_SSLVERSION_MAX_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01985">curl.h:1985</a></div></div>
<div class="ttc" id="vtls_8h_html_aeec761b6ce10b474ec609a3336177da7"><div class="ttname"><a href="vtls_8h.html#aeec761b6ce10b474ec609a3336177da7">Curl_ssl_random</a></div><div class="ttdeci">#define Curl_ssl_random(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00272">vtls.h:272</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_ad563906703cdf28011c0057afb70740d"><div class="ttname"><a href="struct_curl__ssl.html#ad563906703cdf28011c0057afb70740d">Curl_ssl::engines_list</a></div><div class="ttdeci">struct curl_slist *(* engines_list)(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00069">vtls.h:69</a></div></div>
<div class="ttc" id="mime_8c_html_a6750c6bf3d5e493a9afbf0c278110187"><div class="ttname"><a href="mime_8c.html#a6750c6bf3d5e493a9afbf0c278110187">filesize</a></div><div class="ttdeci">#define filesize(name, stat_data)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8c_source.html#l00125">mime.c:125</a></div></div>
<div class="ttc" id="urldata_8h_html_a2ea01ebd139c38e2285c7d2e17a2683fa014160d2a4a284f35c6edc4f38dfd8df"><div class="ttname"><a href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa014160d2a4a284f35c6edc4f38dfd8df">ssl_connection_none</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00188">urldata.h:188</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="structconnectdata_html_aec2de2220c36ec447f6101e85bf0a52b"><div class="ttname"><a href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">connectdata::recv</a></div><div class="ttdeci">Curl_recv * recv[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00879">urldata.h:879</a></div></div>
<div class="ttc" id="curl__md5_8h_html_ab33a834fa1c1d7252ef0b956327256bd"><div class="ttname"><a href="curl__md5_8h.html#ab33a834fa1c1d7252ef0b956327256bd">Curl_DIGEST_MD5</a></div><div class="ttdeci">const MD5_params Curl_DIGEST_MD5[1]</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00497">md5.c:497</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a2e5524f42582a8bea0116656ed301293"><div class="ttname"><a href="structssl__primary__config.html#a2e5524f42582a8bea0116656ed301293">ssl_primary_config::egdsocket</a></div><div class="ttdeci">char * egdsocket</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00220">urldata.h:220</a></div></div>
<div class="ttc" id="structcurl__slist_html"><div class="ttname"><a href="structcurl__slist.html">curl_slist</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02394">curl.h:2394</a></div></div>
<div class="ttc" id="base64_8c_html_a3b1d7d4873cc224ffb2ce6ff201bc2e6"><div class="ttname"><a href="base64_8c.html#a3b1d7d4873cc224ffb2ce6ff201bc2e6">Curl_base64_decode</a></div><div class="ttdeci">CURLcode Curl_base64_decode(const char *src, unsigned char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00099">base64.c:99</a></div></div>
<div class="ttc" id="struct_connect_bits_html_ae84bd59ece78f702a2fcac5438edf7e5"><div class="ttname"><a href="struct_connect_bits.html#ae84bd59ece78f702a2fcac5438edf7e5">ConnectBits::conn_to_port</a></div><div class="ttdeci">bool conn_to_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00385">urldata.h:385</a></div></div>
<div class="ttc" id="struct_curl__ssl_html"><div class="ttname"><a href="struct_curl__ssl.html">Curl_ssl</a></div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00036">vtls.h:36</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a111e5a8e6a18837f049d90c2747bb609"><div class="ttname"><a href="structcurl__ssl__session.html#a111e5a8e6a18837f049d90c2747bb609">curl_ssl_session::idsize</a></div><div class="ttdeci">size_t idsize</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00261">urldata.h:261</a></div></div>
<div class="ttc" id="curl_8h_html_a60ecc2082ebefd3b59083c19f6ca2946"><div class="ttname"><a href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946">CURLsslset</a></div><div class="ttdeci">CURLsslset</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02430">curl.h:2430</a></div></div>
<div class="ttc" id="curl_8h_html_a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95"><div class="ttname"><a href="curl_8h.html#a0ea2c7f23828ae93fb4eb9ab701bf6feac29aeaf619308f144ae4c72526fbdb95">CURL_LOCK_ACCESS_SINGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02619">curl.h:2619</a></div></div>
<div class="ttc" id="structproxy__info_html_ae2cc9c2eb5c4ea0c4b92bf067e391bdc"><div class="ttname"><a href="structproxy__info.html#ae2cc9c2eb5c4ea0c4b92bf067e391bdc">proxy_info::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00752">urldata.h:752</a></div></div>
<div class="ttc" id="progress_8c_html_a1344967836d86ae13b5739ed0a6e6916"><div class="ttname"><a href="progress_8c.html#a1344967836d86ae13b5739ed0a6e6916">Curl_pgrsTime</a></div><div class="ttdeci">void Curl_pgrsTime(struct Curl_easy *data, timerid timer)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00166">progress.c:166</a></div></div>
<div class="ttc" id="urldata_8h_html_a56b23efdd8d04b0179b52224a251bcb7"><div class="ttname"><a href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a></div><div class="ttdeci">#define FIRSTSOCKET</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00480">urldata.h:480</a></div></div>
<div class="ttc" id="slist_8c_html_a7982a92d1abe5dcce03e879a402c809b"><div class="ttname"><a href="slist_8c.html#a7982a92d1abe5dcce03e879a402c809b">Curl_slist_append_nodup</a></div><div class="ttdeci">struct curl_slist * Curl_slist_append_nodup(struct curl_slist *list, char *data)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00059">slist.c:59</a></div></div>
<div class="ttc" id="curl__md5_8h_html_aabf808dd50615b76e263194b075cfcf1"><div class="ttname"><a href="curl__md5_8h.html#aabf808dd50615b76e263194b075cfcf1">Curl_MD5_update</a></div><div class="ttdeci">int Curl_MD5_update(MD5_context *context, const unsigned char *data, unsigned int len)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00548">md5.c:548</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a160d83129b03dc642e91d4b4761b0731"><div class="ttname"><a href="struct_curl__ssl.html#a160d83129b03dc642e91d4b4761b0731">Curl_ssl::session_free</a></div><div class="ttdeci">void(* session_free)(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00065">vtls.h:65</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a65a8746c5666a1b482fd09dc581d3283"><div class="ttname"><a href="structcurl__ssl__session.html#a65a8746c5666a1b482fd09dc581d3283">curl_ssl_session::age</a></div><div class="ttdeci">long age</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00262">urldata.h:262</a></div></div>
<div class="ttc" id="curl_8h_html_af898dd6eb71573ccb1668c3d2380549cae1d5692a2f2f61e7194c5c0eb7227ae1"><div class="ttname"><a href="curl_8h.html#af898dd6eb71573ccb1668c3d2380549cae1d5692a2f2f61e7194c5c0eb7227ae1">CURL_LOCK_DATA_SSL_SESSION</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02609">curl.h:2609</a></div></div>
<div class="ttc" id="_sample_h_i_d_keyboard_8cpp_html_a3baed8fd316b19ffc4765639221cf225"><div class="ttname"><a href="_sample_h_i_d_keyboard_8cpp.html#a3baed8fd316b19ffc4765639221cf225">output</a></div><div class="ttdeci">BLECharacteristic * output</div><div class="ttdef"><b>Definition:</b> <a href="_sample_h_i_d_keyboard_8cpp_source.html#l00020">SampleHIDKeyboard.cpp:20</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a7b1be18084f5fa42645c28a34b75d166"><div class="ttname"><a href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">ssl_primary_config::verifypeer</a></div><div class="ttdeci">bool verifypeer</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00212">urldata.h:212</a></div></div>
<div class="ttc" id="curl__md5_8h_html_a503e57db509e2231c8289f74e55ab597"><div class="ttname"><a href="curl__md5_8h.html#a503e57db509e2231c8289f74e55ab597">Curl_MD5_init</a></div><div class="ttdeci">MD5_context * Curl_MD5_init(const MD5_params *md5params)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00524">md5.c:524</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a3af4ecc297233a8654509762295144af"><div class="ttname"><a href="structcurl__ssl__session.html#a3af4ecc297233a8654509762295144af">curl_ssl_session::conn_to_port</a></div><div class="ttdeci">int conn_to_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00264">urldata.h:264</a></div></div>
<div class="ttc" id="vtls_8h_html_a9fe9fd14fbe2d9fc29d582a6c4ed0f83"><div class="ttname"><a href="vtls_8h.html#a9fe9fd14fbe2d9fc29d582a6c4ed0f83">Curl_none_init</a></div><div class="ttdeci">int Curl_none_init(void)</div></div>
<div class="ttc" id="structcurl__ssl__backend_html_ad9c9173193aa31ef9ebf491974b8996d"><div class="ttname"><a href="structcurl__ssl__backend.html#ad9c9173193aa31ef9ebf491974b8996d">curl_ssl_backend::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02427">curl.h:2427</a></div></div>
<div class="ttc" id="vtls_8h_html_abd2be2ec8895660c6eb7e124cfac438e"><div class="ttname"><a href="vtls_8h.html#abd2be2ec8895660c6eb7e124cfac438e">Curl_none_session_free</a></div><div class="ttdeci">void Curl_none_session_free(void *ptr)</div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="vtls_8h_html_a6d4d2d806ff1ab1428629b690f02e964"><div class="ttname"><a href="vtls_8h.html#a6d4d2d806ff1ab1428629b690f02e964">SSL_SET_OPTION</a></div><div class="ttdeci">#define SSL_SET_OPTION(var)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00136">vtls.h:136</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="structssl__connect__data_html_a2de0f5a8b43b4e4550e22b1b8f3870e1"><div class="ttname"><a href="structssl__connect__data.html#a2de0f5a8b43b4e4550e22b1b8f3870e1">ssl_connect_data::connecting_state</a></div><div class="ttdeci">ssl_connect_state connecting_state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00203">urldata.h:203</a></div></div>
<div class="ttc" id="progress_8h_html_abc090d144fb55d31dff488d24c46fb2aa2234f553d2849429bca27d7d4c898107"><div class="ttname"><a href="progress_8h.html#abc090d144fb55d31dff488d24c46fb2aa2234f553d2849429bca27d7d4c898107">TIMER_APPCONNECT</a></div><div class="ttdef"><b>Definition:</b> <a href="progress_8h_source.html#l00034">progress.h:34</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a64462bcb53b267e8b31f3a7f397f13b1"><div class="ttname"><a href="struct_curl__ssl.html#a64462bcb53b267e8b31f3a7f397f13b1">Curl_ssl::false_start</a></div><div class="ttdeci">bool(* false_start)(void)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00071">vtls.h:71</a></div></div>
<div class="ttc" id="structinput_html"><div class="ttname"><a href="structinput.html">input</a></div><div class="ttdef"><b>Definition:</b> <a href="http2-upload_8c_source.html#l00169">http2-upload.c:169</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="curl_8h_html_a60ecc2082ebefd3b59083c19f6ca2946a220e84ecae4a7fde9fda4de043c40928"><div class="ttname"><a href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946a220e84ecae4a7fde9fda4de043c40928">CURLSSLSET_UNKNOWN_BACKEND</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02432">curl.h:2432</a></div></div>
<div class="ttc" id="base64_8c_html_a1208ff63d0b4ca9cead4a3cdefc033c2"><div class="ttname"><a href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a></div><div class="ttdeci">CURLcode Curl_base64_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00290">base64.c:290</a></div></div>
<div class="ttc" id="structconnectdata_html_ae7924587f916593e1fb682086f298ce8"><div class="ttname"><a href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">connectdata::handler</a></div><div class="ttdeci">const struct Curl_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00905">urldata.h:905</a></div></div>
<div class="ttc" id="structconnectdata_html_ad1a5d617e25de38754bdafb919593c32"><div class="ttname"><a href="structconnectdata.html#ad1a5d617e25de38754bdafb919593c32">connectdata::conn_to_port</a></div><div class="ttdeci">int conn_to_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00841">urldata.h:841</a></div></div>
<div class="ttc" id="vtls_8h_html_a02ca5f1341dc43cd1ce5c8531fffea07"><div class="ttname"><a href="vtls_8h.html#a02ca5f1341dc43cd1ce5c8531fffea07">Curl_ssl_tls13_ciphersuites</a></div><div class="ttdeci">#define Curl_ssl_tls13_ciphersuites()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00275">vtls.h:275</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_a23d7b88872d6ead46c978b567908d587"><div class="ttname"><a href="curl__setup__once_8h.html#a23d7b88872d6ead46c978b567908d587">DEBUGASSERT</a></div><div class="ttdeci">#define DEBUGASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00401">curl_setup_once.h:401</a></div></div>
<div class="ttc" id="vtls_8c_html_aea85d2adf12392399220bffd93ce24bf"><div class="ttname"><a href="vtls_8c.html#aea85d2adf12392399220bffd93ce24bf">SSLSESSION_SHARED</a></div><div class="ttdeci">#define SSLSESSION_SHARED(data)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00072">vtls.c:72</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="multiif_8h_html_a4ae1fb64a27264765b6a2fe5aca78830"><div class="ttname"><a href="multiif_8h.html#a4ae1fb64a27264765b6a2fe5aca78830">GETSOCK_READSOCK</a></div><div class="ttdeci">#define GETSOCK_READSOCK(x)</div><div class="ttdef"><b>Definition:</b> <a href="multiif_8h_source.html#l00051">multiif.h:51</a></div></div>
<div class="ttc" id="vtls_8h_html_a4b8227a2fd2fbf2d20147513033a8ade"><div class="ttname"><a href="vtls_8h.html#a4b8227a2fd2fbf2d20147513033a8ade">Curl_ssl_close</a></div><div class="ttdeci">#define Curl_ssl_close(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00258">vtls.h:258</a></div></div>
<div class="ttc" id="vtls_8h_html_a87cb30101b924de437acfb2520a35f70"><div class="ttname"><a href="vtls_8h.html#a87cb30101b924de437acfb2520a35f70">Curl_ssl_set_engine_default</a></div><div class="ttdeci">#define Curl_ssl_set_engine_default(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00261">vtls.h:261</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_ae98a6ef2da16a32b737c5d86eaf44a3f"><div class="ttname"><a href="structcurl__ssl__session.html#ae98a6ef2da16a32b737c5d86eaf44a3f">curl_ssl_session::remote_port</a></div><div class="ttdeci">int remote_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00263">urldata.h:263</a></div></div>
<div class="ttc" id="curl_8h_html_aabc03ec968a2fdccde5c6709f712dd7b"><div class="ttname"><a href="curl_8h.html#aabc03ec968a2fdccde5c6709f712dd7b">CURLINFO</a></div><div class="ttdeci">CURLINFO</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02498">curl.h:2498</a></div></div>
<div class="ttc" id="vtls_8h_html_a3c3bb919efb77b74d92b862902071389"><div class="ttname"><a href="vtls_8h.html#a3c3bb919efb77b74d92b862902071389">Curl_none_shutdown</a></div><div class="ttdeci">int Curl_none_shutdown(struct connectdata *conn, int sockindex)</div></div>
<div class="ttc" id="struct_curl__ssl_html_a925cabc8824963843fc4feef4b8898a0"><div class="ttname"><a href="struct_curl__ssl.html#a925cabc8824963843fc4feef4b8898a0">Curl_ssl::shutdown</a></div><div class="ttdeci">int(* shutdown)(struct connectdata *conn, int sockindex)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00050">vtls.h:50</a></div></div>
<div class="ttc" id="struct_m_d5__context_html"><div class="ttname"><a href="struct_m_d5__context.html">MD5_context</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__md5_8h_source.html#l00044">curl_md5.h:44</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a3c0175748d16e46be4ade09f746bee52"><div class="ttname"><a href="struct_curl__ssl.html#a3c0175748d16e46be4ade09f746bee52">Curl_ssl::md5sum</a></div><div class="ttdeci">CURLcode(* md5sum)(unsigned char *input, size_t inputlen, unsigned char *md5sum, size_t md5sumlen)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00073">vtls.h:73</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_ad0f029e7ced2495420d8394a5ed9d597"><div class="ttname"><a href="struct_curl__ssl.html#ad0f029e7ced2495420d8394a5ed9d597">Curl_ssl::get_internals</a></div><div class="ttdeci">void *(* get_internals)(struct ssl_connect_data *connssl, CURLINFO info)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00062">vtls.h:62</a></div></div>
<div class="ttc" id="vtls_8h_html_aba5f776941608a9d5c44fd0b422b1862"><div class="ttname"><a href="vtls_8h.html#aba5f776941608a9d5c44fd0b422b1862">Curl_none_data_pending</a></div><div class="ttdeci">bool Curl_none_data_pending(const struct connectdata *conn, int connindex)</div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a785786e70ed591f03e61a7d0175d417f">CURLE_SSL_PINNEDPUBKEYNOTMATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00578">curl.h:578</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00462">curl.h:462</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="urldata_8h_html_a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c"><div class="ttname"><a href="urldata_8h.html#a2ea01ebd139c38e2285c7d2e17a2683fa88a671c415a487b02dbfd68cea24f98c">ssl_connection_complete</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00190">urldata.h:190</a></div></div>
<div class="ttc" id="vtls_8h_html_aab12c9ee7a4c9d065f76d3ab539bdb62"><div class="ttname"><a href="vtls_8h.html#aab12c9ee7a4c9d065f76d3ab539bdb62">Curl_ssl_connect</a></div><div class="ttdeci">#define Curl_ssl_connect(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00256">vtls.h:256</a></div></div>
<div class="ttc" id="vtls_8h_html_aa47defd1c2f78f3225dfc06c638c8689"><div class="ttname"><a href="vtls_8h.html#aa47defd1c2f78f3225dfc06c638c8689">SSLSUPP_HTTPS_PROXY</a></div><div class="ttdeci">#define SSLSUPP_HTTPS_PROXY</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00033">vtls.h:33</a></div></div>
<div class="ttc" id="vtls_8h_html_a5ee046324452a0fe07e54818257fe04c"><div class="ttname"><a href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a></div><div class="ttdeci">#define Curl_ssl_connect_nonblocking(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00270">vtls.h:270</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a8d39df5d5e9f3ecd4b121021500f68f4"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a8d39df5d5e9f3ecd4b121021500f68f4">CURLE_SSL_SHUTDOWN_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00562">curl.h:562</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00533">curl.h:533</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="curl_8h_html_a613d9e6457f36b84548cbf2006a34e14"><div class="ttname"><a href="curl_8h.html#a613d9e6457f36b84548cbf2006a34e14">curl_getenv</a></div><div class="ttdeci">CURL_EXTERN char * curl_getenv(const char *variable)</div><div class="ttdef"><b>Definition:</b> <a href="getenv_8c_source.html#l00051">getenv.c:51</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="unit1308_8c_html_a70a830d3039f37216dde9bcf2460aec2"><div class="ttname"><a href="unit1308_8c.html#a70a830d3039f37216dde9bcf2460aec2">buffer</a></div><div class="ttdeci">char buffer[]</div><div class="ttdef"><b>Definition:</b> <a href="unit1308_8c_source.html#l00048">unit1308.c:48</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a75bdb71feb2246298a5730d61bfed6a6"><div class="ttname"><a href="struct_curl__ssl.html#a75bdb71feb2246298a5730d61bfed6a6">Curl_ssl::cleanup</a></div><div class="ttdeci">void(* cleanup)(void)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00046">vtls.h:46</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a494e2b4279dc064f7ed1d0abd602b28d"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_OFF_T curl_off_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00442">system.h:442</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="structcurl__ssl__backend_html"><div class="ttname"><a href="structcurl__ssl__backend.html">curl_ssl_backend</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02425">curl.h:2425</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a186023a4b2e5503d44a766edb5c1f574"><div class="ttname"><a href="structssl__primary__config.html#a186023a4b2e5503d44a766edb5c1f574">ssl_primary_config::clientcert</a></div><div class="ttdeci">char * clientcert</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00218">urldata.h:218</a></div></div>
<div class="ttc" id="curl_8h_html_a60ecc2082ebefd3b59083c19f6ca2946aa6c7024b2ed0ce8791f4746a5d8f295f"><div class="ttname"><a href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946aa6c7024b2ed0ce8791f4746a5d8f295f">CURLSSLSET_TOO_LATE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02433">curl.h:2433</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a749287dc9e4d4f4f57bb232bf5e211c4"><div class="ttname"><a href="struct_curl__ssl.html#a749287dc9e4d4f4f57bb232bf5e211c4">Curl_ssl::set_engine</a></div><div class="ttdeci">CURLcode(* set_engine)(struct Curl_easy *data, const char *engine)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00067">vtls.h:67</a></div></div>
<div class="ttc" id="structconnectdata_html_a4df63a4042ad767671bb3bfd74aa68fc"><div class="ttname"><a href="structconnectdata.html#a4df63a4042ad767671bb3bfd74aa68fc">connectdata::http_proxy</a></div><div class="ttdeci">struct proxy_info http_proxy</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00837">urldata.h:837</a></div></div>
<div class="ttc" id="vtls_8h_html_ad41b64c4881c0ecdfd32c65344faa675"><div class="ttname"><a href="vtls_8h.html#ad41b64c4881c0ecdfd32c65344faa675">MAX_PINNED_PUBKEY_SIZE</a></div><div class="ttdeci">#define MAX_PINNED_PUBKEY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00113">vtls.h:113</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_ab9de6ce761f38fb588da1cf5cbd73226"><div class="ttname"><a href="structcurl__ssl__session.html#ab9de6ce761f38fb588da1cf5cbd73226">curl_ssl_session::sessionid</a></div><div class="ttdeci">void * sessionid</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00260">urldata.h:260</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="curl_8h_html_a908c5b707ac681212b8f8688cf76689d"><div class="ttname"><a href="curl_8h.html#a908c5b707ac681212b8f8688cf76689d">curl_sslbackend</a></div><div class="ttdeci">curl_sslbackend</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00137">curl.h:137</a></div></div>
<div class="ttc" id="structssl__connect__data_html_a46d3839ea70923be1efa7f85aba7f6a8"><div class="ttname"><a href="structssl__connect__data.html#a46d3839ea70923be1efa7f85aba7f6a8">ssl_connect_data::state</a></div><div class="ttdeci">ssl_connection_state state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00202">urldata.h:202</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a7e1330877662aaf6c91de7c74dbc6b68"><div class="ttname"><a href="struct_curl__ssl.html#a7e1330877662aaf6c91de7c74dbc6b68">Curl_ssl::set_engine_default</a></div><div class="ttdeci">CURLcode(* set_engine_default)(struct Curl_easy *data)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00068">vtls.h:68</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a7bcabc334ae96ab166d50fdf9d65242d"><div class="ttname"><a href="struct_curl__ssl.html#a7bcabc334ae96ab166d50fdf9d65242d">Curl_ssl::check_cxn</a></div><div class="ttdeci">int(* check_cxn)(struct connectdata *cxn)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00049">vtls.h:49</a></div></div>
<div class="ttc" id="timeval_8h_html"><div class="ttname"><a href="timeval_8h.html">timeval.h</a></div></div>
<div class="ttc" id="vtls_8h_html"><div class="ttname"><a href="vtls_8h.html">vtls.h</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="vtls_8h_html_ac50ee79a0869be9ea58bda0388abde58"><div class="ttname"><a href="vtls_8h.html#ac50ee79a0869be9ea58bda0388abde58">Curl_ssl_data_pending</a></div><div class="ttdeci">#define Curl_ssl_data_pending(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00267">vtls.h:267</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a876a1cef5c1d2207132acf10c47a0dda"><div class="ttname"><a href="structssl__primary__config.html#a876a1cef5c1d2207132acf10c47a0dda">ssl_primary_config::CApath</a></div><div class="ttdeci">char * CApath</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00216">urldata.h:216</a></div></div>
<div class="ttc" id="vtls_8h_html_a17b59e5f0576d37fa4b20ac37a6848e9"><div class="ttname"><a href="vtls_8h.html#a17b59e5f0576d37fa4b20ac37a6848e9">Curl_ssl_shutdown</a></div><div class="ttdeci">#define Curl_ssl_shutdown(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00259">vtls.h:259</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="vtls_8h_html_a04e21d561123bc29f2e018c260ede891"><div class="ttname"><a href="vtls_8h.html#a04e21d561123bc29f2e018c260ede891">Curl_none_random</a></div><div class="ttdeci">CURLcode Curl_none_random(struct Curl_easy *data, unsigned char *entropy, size_t length)</div></div>
<div class="ttc" id="vtls_8h_html_a9076c5bbae2cb8510d32eb97d8bce277"><div class="ttname"><a href="vtls_8h.html#a9076c5bbae2cb8510d32eb97d8bce277">Curl_none_check_cxn</a></div><div class="ttdeci">int Curl_none_check_cxn(struct connectdata *conn)</div></div>
<div class="ttc" id="struct_curl__ssl_html_a6dc7b4efb047c7107ebad236294662ec"><div class="ttname"><a href="struct_curl__ssl.html#a6dc7b4efb047c7107ebad236294662ec">Curl_ssl::close_one</a></div><div class="ttdeci">void(* close_one)(struct connectdata *conn, int sockindex)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00063">vtls.h:63</a></div></div>
<div class="ttc" id="share_8c_html_a85cdae024464c8d7e96a232797028d72"><div class="ttname"><a href="share_8c.html#a85cdae024464c8d7e96a232797028d72">Curl_share_unlock</a></div><div class="ttdeci">CURLSHcode Curl_share_unlock(struct Curl_easy *data, curl_lock_data type)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00244">share.c:244</a></div></div>
<div class="ttc" id="progress_8h_html"><div class="ttname"><a href="progress_8h.html">progress.h</a></div></div>
<div class="ttc" id="vtls_8h_html_aa49025b2e48d587fb3852f2abd2e4be6"><div class="ttname"><a href="vtls_8h.html#aa49025b2e48d587fb3852f2abd2e4be6">Curl_ssl_engines_list</a></div><div class="ttdeci">#define Curl_ssl_engines_list(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00262">vtls.h:262</a></div></div>
<div class="ttc" id="structssl__connect__data_html_ad63d8e461921062845bbf07dfc0007c5"><div class="ttname"><a href="structssl__connect__data.html#ad63d8e461921062845bbf07dfc0007c5">ssl_connect_data::use</a></div><div class="ttdeci">bool use</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00201">urldata.h:201</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a92304c3ea3efd40000a0ee48c1b17f85"><div class="ttname"><a href="structcurl__ssl__session.html#a92304c3ea3efd40000a0ee48c1b17f85">curl_ssl_session::conn_to_host</a></div><div class="ttdeci">char * conn_to_host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00258">urldata.h:258</a></div></div>
<div class="ttc" id="curl__md5_8h_html"><div class="ttname"><a href="curl__md5_8h.html">curl_md5.h</a></div></div>
<div class="ttc" id="vtls_8h_html_a0a1d6e1d64672ae38b75216a44d08641"><div class="ttname"><a href="vtls_8h.html#a0a1d6e1d64672ae38b75216a44d08641">Curl_none_false_start</a></div><div class="ttdeci">bool Curl_none_false_start(void)</div></div>
<div class="ttc" id="vtls_8h_html_afeb6f7a003d210b324a5484170a56ca7"><div class="ttname"><a href="vtls_8h.html#afeb6f7a003d210b324a5484170a56ca7">Curl_ssl_version</a></div><div class="ttdeci">#define Curl_ssl_version(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00266">vtls.h:266</a></div></div>
<div class="ttc" id="vtls_8h_html_afd63787510a375221ab2aba491ef2073"><div class="ttname"><a href="vtls_8h.html#afd63787510a375221ab2aba491ef2073">Curl_none_cert_status_request</a></div><div class="ttdeci">bool Curl_none_cert_status_request(void)</div></div>
<div class="ttc" id="vtls_8h_html_a82bbffffb6866ede7a554960f09690ea"><div class="ttname"><a href="vtls_8h.html#a82bbffffb6866ede7a554960f09690ea">Curl_ssl_check_cxn</a></div><div class="ttdeci">#define Curl_ssl_check_cxn(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00268">vtls.h:268</a></div></div>
<div class="ttc" id="structssl__primary__config_html_ad91b52cac0c59e8af54800a84702f311"><div class="ttname"><a href="structssl__primary__config.html#ad91b52cac0c59e8af54800a84702f311">ssl_primary_config::cipher_list</a></div><div class="ttdeci">char * cipher_list</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00221">urldata.h:221</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_adc662f96d977f669d06805db2a9093c0"><div class="ttname"><a href="struct_curl__ssl.html#adc662f96d977f669d06805db2a9093c0">Curl_ssl::version</a></div><div class="ttdeci">size_t(* version)(char *buffer, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00048">vtls.h:48</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a7e4e88d7f01f46a1aa30751906eac785"><div class="ttname"><a href="structssl__primary__config.html#a7e4e88d7f01f46a1aa30751906eac785">ssl_primary_config::sessionid</a></div><div class="ttdeci">bool sessionid</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00215">urldata.h:215</a></div></div>
<div class="ttc" id="vtls_8h_html_a486d7ada0cb21188917be26be3d81483"><div class="ttname"><a href="vtls_8h.html#a486d7ada0cb21188917be26be3d81483">SSLSUPP_TLS13_CIPHERSUITES</a></div><div class="ttdeci">#define SSLSUPP_TLS13_CIPHERSUITES</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00034">vtls.h:34</a></div></div>
<div class="ttc" id="strcase_8c_html_a241521c84255d0726fa6fa2614ec710c"><div class="ttname"><a href="strcase_8c.html#a241521c84255d0726fa6fa2614ec710c">Curl_safe_strcasecompare</a></div><div class="ttdeci">int Curl_safe_strcasecompare(const char *first, const char *second)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8c_source.html#l00124">strcase.c:124</a></div></div>
<div class="ttc" id="vtls_8h_html_a646fd2a8d6796d8ff481bffc36b371d5"><div class="ttname"><a href="vtls_8h.html#a646fd2a8d6796d8ff481bffc36b371d5">Curl_ssl_initsessions</a></div><div class="ttdeci">#define Curl_ssl_initsessions(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00265">vtls.h:265</a></div></div>
<div class="ttc" id="remote-name_8d_html_aa335f8bb20424b03700f57b150bf0aa6"><div class="ttname"><a href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a></div><div class="ttdeci">Long the path is cut off.The file will be saved in the current working directory.If you want the file saved in a different make sure you change the current working directory before invoking curl with this option.The remote file name to use for saving is extracted from the given nothing and if it already exists it will be overwritten.If you want the server to be able to choose the file name refer to remote header name which can be used in addition to this option.If the server chooses a file name and that name already exists it will not be overwritten.There is no URL decoding done on the file name.If it has or other URL encoded parts of the name</div><div class="ttdef"><b>Definition:</b> <a href="remote-name_8d_source.html#l00006">remote-name.d:6</a></div></div>
<div class="ttc" id="vtls_8c_html_a9468007b0049e63d8dac0a8096beb0c4"><div class="ttname"><a href="vtls_8c.html#a9468007b0049e63d8dac0a8096beb0c4">Curl_clone_primary_ssl_config</a></div><div class="ttdeci">bool Curl_clone_primary_ssl_config(struct ssl_primary_config *source, struct ssl_primary_config *dest)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00107">vtls.c:107</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_ad095aecbd9d52877e333ce815c726279"><div class="ttname"><a href="struct_curl__ssl.html#ad095aecbd9d52877e333ce815c726279">Curl_ssl::connect</a></div><div class="ttdeci">CURLcode(* connect)(struct connectdata *conn, int sockindex)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00059">vtls.h:59</a></div></div>
<div class="ttc" id="structssl__connect__data_html"><div class="ttname"><a href="structssl__connect__data.html">ssl_connect_data</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00197">urldata.h:197</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1a8c6d961fbef3442f91a0c29191e83256"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a8c6d961fbef3442f91a0c29191e83256">ssl_connect_2_writing</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00182">urldata.h:182</a></div></div>
<div class="ttc" id="curl__md5_8h_html_a23ad6a1d54ca2af94acfbf3ca2dac046"><div class="ttname"><a href="curl__md5_8h.html#a23ad6a1d54ca2af94acfbf3ca2dac046">Curl_MD5_final</a></div><div class="ttdeci">int Curl_MD5_final(MD5_context *context, unsigned char *result)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00557">md5.c:557</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a834b93d0dc2d501e5730edb273dddba9"><div class="ttname"><a href="struct_curl__ssl.html#a834b93d0dc2d501e5730edb273dddba9">Curl_ssl::info</a></div><div class="ttdeci">curl_ssl_backend info</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00041">vtls.h:41</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a422cb9e62c56c537d9238c398cd8c4e2"><div class="ttname"><a href="struct_curl__ssl.html#a422cb9e62c56c537d9238c398cd8c4e2">Curl_ssl::connect_nonblocking</a></div><div class="ttdeci">CURLcode(* connect_nonblocking)(struct connectdata *conn, int sockindex, bool *done)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00060">vtls.h:60</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a9d3a4c7283e422bfa31cf1d32aeb75a0"><div class="ttname"><a href="structssl__primary__config.html#a9d3a4c7283e422bfa31cf1d32aeb75a0">ssl_primary_config::verifystatus</a></div><div class="ttdeci">bool verifystatus</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00214">urldata.h:214</a></div></div>
<div class="ttc" id="vtls_8c_html_a5f50ad085ea4993229348232d4719407"><div class="ttname"><a href="vtls_8c.html#a5f50ad085ea4993229348232d4719407">Curl_free_primary_ssl_config</a></div><div class="ttdeci">void Curl_free_primary_ssl_config(struct ssl_primary_config *sslc)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00128">vtls.c:128</a></div></div>
<div class="ttc" id="vtls_8h_html_a92d73bed4c4dd74c727d2fff527182dc"><div class="ttname"><a href="vtls_8h.html#a92d73bed4c4dd74c727d2fff527182dc">CURL_SHA256_DIGEST_LENGTH</a></div><div class="ttdeci">#define CURL_SHA256_DIGEST_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00123">vtls.h:123</a></div></div>
<div class="ttc" id="vtls_8h_html_ab751ac92e09399d2e4edae147629770a"><div class="ttname"><a href="vtls_8h.html#ab751ac92e09399d2e4edae147629770a">Curl_none_cleanup</a></div><div class="ttdeci">void Curl_none_cleanup(void)</div></div>
<div class="ttc" id="multiif_8h_html_ad755633cd6d4e90c3df49fefd1052bad"><div class="ttname"><a href="multiif_8h.html#ad755633cd6d4e90c3df49fefd1052bad">GETSOCK_BLANK</a></div><div class="ttdeci">#define GETSOCK_BLANK</div><div class="ttdef"><b>Definition:</b> <a href="multiif_8h_source.html#l00045">multiif.h:45</a></div></div>
<div class="ttc" id="structcurl__certinfo_html"><div class="ttname"><a href="structcurl__certinfo.html">curl_certinfo</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02473">curl.h:2473</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a6f5ec68609ac2c004ca79f37a3822e05"><div class="ttname"><a href="structssl__primary__config.html#a6f5ec68609ac2c004ca79f37a3822e05">ssl_primary_config::cipher_list13</a></div><div class="ttdeci">char * cipher_list13</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00222">urldata.h:222</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_aba654e0cf223146bd58cd9bf6dc35834"><div class="ttname"><a href="struct_curl__ssl.html#aba654e0cf223146bd58cd9bf6dc35834">Curl_ssl::random</a></div><div class="ttdeci">CURLcode(* random)(struct Curl_easy *data, unsigned char *entropy, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00055">vtls.h:55</a></div></div>
<div class="ttc" id="structcurl__certinfo_html_a9eb8ef837e5a8ddb848ac7bae35ed92f"><div class="ttname"><a href="structcurl__certinfo.html#a9eb8ef837e5a8ddb848ac7bae35ed92f">curl_certinfo::num_of_certs</a></div><div class="ttdeci">int num_of_certs</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02474">curl.h:2474</a></div></div>
<div class="ttc" id="structssl__primary__config_html_af116cf82e957a2ca2f0b39eb0c709d43"><div class="ttname"><a href="structssl__primary__config.html#af116cf82e957a2ca2f0b39eb0c709d43">ssl_primary_config::verifyhost</a></div><div class="ttdeci">bool verifyhost</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00213">urldata.h:213</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af47b7606f9b1ac9d655fe959fdefbd7d">CURLE_SSL_CONNECT_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00505">curl.h:505</a></div></div>
<div class="ttc" id="structconnectdata_html_ada83cbd7d295b87033b7ea635c0a5dd5"><div class="ttname"><a href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">connectdata::send</a></div><div class="ttdeci">Curl_send * send[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00880">urldata.h:880</a></div></div>
<div class="ttc" id="multiif_8h_html_a9aabda59f0ff87c1db3a2d306a410713"><div class="ttname"><a href="multiif_8h.html#a9aabda59f0ff87c1db3a2d306a410713">GETSOCK_WRITESOCK</a></div><div class="ttdeci">#define GETSOCK_WRITESOCK(x)</div><div class="ttdef"><b>Definition:</b> <a href="multiif_8h_source.html#l00048">multiif.h:48</a></div></div>
<div class="ttc" id="warnless_8c_html_a20955df32ae739bf660266410d9e6526"><div class="ttname"><a href="warnless_8c.html#a20955df32ae739bf660266410d9e6526">curlx_uztoui</a></div><div class="ttdeci">unsigned int curlx_uztoui(size_t uznum)</div><div class="ttdef"><b>Definition:</b> <a href="warnless_8c_source.html#l00243">warnless.c:243</a></div></div>
<div class="ttc" id="urldata_8h_html_ace0075850efad1d17ded7b56129fb3d1a83e9e80af0be0e0a560a5c925cc2e216"><div class="ttname"><a href="urldata_8h.html#ace0075850efad1d17ded7b56129fb3d1a83e9e80af0be0e0a560a5c925cc2e216">ssl_connect_2_reading</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00181">urldata.h:181</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a6f40ec190b29fc01606043313439328a"><div class="ttname"><a href="struct_curl__handler.html#a6f40ec190b29fc01606043313439328a">Curl_handler::scheme</a></div><div class="ttdeci">const char * scheme</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00629">urldata.h:629</a></div></div>
<div class="ttc" id="curl_8h_html_a05589fbab0657f08285ebdfe93f5ec9ea4fba35de2c7eebf13b096ac6c13d8219"><div class="ttname"><a href="curl_8h.html#a05589fbab0657f08285ebdfe93f5ec9ea4fba35de2c7eebf13b096ac6c13d8219">CURL_SSLVERSION_LAST</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01981">curl.h:1981</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_acbf00c2f926253c7e3ff442213ab00e8"><div class="ttname"><a href="struct_curl__ssl.html#acbf00c2f926253c7e3ff442213ab00e8">Curl_ssl::cert_status_request</a></div><div class="ttdeci">bool(* cert_status_request)(void)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00057">vtls.h:57</a></div></div>
<div class="ttc" id="structssl__primary__config_html_ac1cdc117fe9f6a1317ad585554e1344a"><div class="ttname"><a href="structssl__primary__config.html#ac1cdc117fe9f6a1317ad585554e1344a">ssl_primary_config::random_file</a></div><div class="ttdeci">char * random_file</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00219">urldata.h:219</a></div></div>
<div class="ttc" id="vtls_8h_html_a77767d6781edb481cfa95437ab11f64a"><div class="ttname"><a href="vtls_8h.html#a77767d6781edb481cfa95437ab11f64a">Curl_none_md5sum</a></div><div class="ttdeci">CURLcode Curl_none_md5sum(unsigned char *input, size_t inputlen, unsigned char *md5sum, size_t md5len)</div></div>
<div class="ttc" id="structcurl__ssl__session_html"><div class="ttname"><a href="structcurl__ssl__session.html">curl_ssl_session</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00256">urldata.h:256</a></div></div>
<div class="ttc" id="multiif_8h_html"><div class="ttname"><a href="multiif_8h.html">multiif.h</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="vtls_8h_html_a8b77e1da26e4c27161d4701d268d2056"><div class="ttname"><a href="vtls_8h.html#a8b77e1da26e4c27161d4701d268d2056">Curl_ssl_cleanup</a></div><div class="ttdeci">#define Curl_ssl_cleanup()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00255">vtls.h:255</a></div></div>
<div class="ttc" id="unit1652_8c_html_a1d19b0eef3b3acd31be88886a0277c2e"><div class="ttname"><a href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a></div><div class="ttdeci">memset(input, '\0', sizeof(input))</div></div>
<div class="ttc" id="vtls_8c_html_aff26917e08b2ad824afb880b776dd57c"><div class="ttname"><a href="vtls_8c.html#aff26917e08b2ad824afb880b776dd57c">CLONE_STRING</a></div><div class="ttdeci">#define CLONE_STRING(var)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00076">vtls.c:76</a></div></div>
<div class="ttc" id="structssl__primary__config_html_ac276158be45d7efe6872bfbfc009b417"><div class="ttname"><a href="structssl__primary__config.html#ac276158be45d7efe6872bfbfc009b417">ssl_primary_config::version</a></div><div class="ttdeci">long version</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00210">urldata.h:210</a></div></div>
<div class="ttc" id="vtls_8h_html_a7ccc438dc80065afa61534a12f49716b"><div class="ttname"><a href="vtls_8h.html#a7ccc438dc80065afa61534a12f49716b">Curl_none_set_engine</a></div><div class="ttdeci">CURLcode Curl_none_set_engine(struct Curl_easy *data, const char *engine)</div></div>
<div class="ttc" id="vtls_8h_html_a665432b41da505b40f72af4161b011aa"><div class="ttname"><a href="vtls_8h.html#a665432b41da505b40f72af4161b011aa">Curl_ssl_getsock</a></div><div class="ttdeci">int Curl_ssl_getsock(struct connectdata *conn, curl_socket_t *socks, int numsocks)</div></div>
<div class="ttc" id="structcurl__certinfo_html_abf4b9471e37ce9659080f329a64b1bab"><div class="ttname"><a href="structcurl__certinfo.html#abf4b9471e37ce9659080f329a64b1bab">curl_certinfo::certinfo</a></div><div class="ttdeci">struct curl_slist ** certinfo</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02475">curl.h:2475</a></div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="sendf_8c_html_aabefb972f6bc78eb11f4b038a6508ecd"><div class="ttname"><a href="sendf_8c.html#aabefb972f6bc78eb11f4b038a6508ecd">Curl_send_plain</a></div><div class="ttdeci">ssize_t Curl_send_plain(struct connectdata *conn, int num, const void *mem, size_t len, CURLcode *code)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00371">sendf.c:371</a></div></div>
<div class="ttc" id="stdcheaders_8h_html_aae22dd41ebe1e64904429c5a31e7e642"><div class="ttname"><a href="stdcheaders_8h.html#aae22dd41ebe1e64904429c5a31e7e642">fread</a></div><div class="ttdeci">size_t fread(void *, size_t, size_t, FILE *)</div></div>
<div class="ttc" id="_console_8h_html_ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719"><div class="ttname"><a href="_console_8h.html#ae07e7f0f3d76ae1309217641da872eb2a9fc5887c030f7a3e19821ebec457e719">ArgType_t::FILE</a></div></div>
<div class="ttc" id="curl_8h_html_a908c5b707ac681212b8f8688cf76689da221aaf856b5e48cc0315c0fc62fc8caf"><div class="ttname"><a href="curl_8h.html#a908c5b707ac681212b8f8688cf76689da221aaf856b5e48cc0315c0fc62fc8caf">CURLSSLBACKEND_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00138">curl.h:138</a></div></div>
<div class="ttc" id="vtls_8c_html_a31c6901e598df0934bf3e1464136910c"><div class="ttname"><a href="vtls_8c.html#a31c6901e598df0934bf3e1464136910c">Curl_ssl_backend</a></div><div class="ttdeci">int Curl_ssl_backend(void)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l00143">vtls.c:143</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a49b2b5753c234a1eb7f05181eea0e61a"><div class="ttname"><a href="struct_curl__ssl.html#a49b2b5753c234a1eb7f05181eea0e61a">Curl_ssl::init</a></div><div class="ttdeci">int(* init)(void)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00045">vtls.h:45</a></div></div>
<div class="ttc" id="vtls_8h_html_abbbadc98add94562999814ac8d7298a8"><div class="ttname"><a href="vtls_8h.html#abbbadc98add94562999814ac8d7298a8">Curl_ssl_init</a></div><div class="ttdeci">#define Curl_ssl_init()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00254">vtls.h:254</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a7c5e621b8f31e5f941e6044519b4c9c9"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a7c5e621b8f31e5f941e6044519b4c9c9">CURLE_FAILED_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00460">curl.h:460</a></div></div>
<div class="ttc" id="structconnectdata_html_a13cc2123ad38902e8ad44e67f10ed7aa"><div class="ttname"><a href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">connectdata::sock</a></div><div class="ttdeci">curl_socket_t sock[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00874">urldata.h:874</a></div></div>
<div class="ttc" id="vtls_8h_html_a392119b7e5b7e3cc074654c88c102025"><div class="ttname"><a href="vtls_8h.html#a392119b7e5b7e3cc074654c88c102025">Curl_ssl_set_engine</a></div><div class="ttdeci">#define Curl_ssl_set_engine(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00260">vtls.h:260</a></div></div>
<div class="ttc" id="structssl__primary__config_html_aaaea4d07233992dd9e14488afa8cd390"><div class="ttname"><a href="structssl__primary__config.html#aaaea4d07233992dd9e14488afa8cd390">ssl_primary_config::version_max</a></div><div class="ttdeci">long version_max</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00211">urldata.h:211</a></div></div>
<div class="ttc" id="structconnectdata_html_aaf06c7a3f4e682976ea7c3fc86273aa6"><div class="ttname"><a href="structconnectdata.html#aaf06c7a3f4e682976ea7c3fc86273aa6">connectdata::conn_to_host</a></div><div class="ttdeci">struct hostname conn_to_host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00833">urldata.h:833</a></div></div>
<div class="ttc" id="structconnectdata_html_a4acb6315f331c234b0bdbfd4b1a402e7"><div class="ttname"><a href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">connectdata::ssl_config</a></div><div class="ttdeci">struct ssl_primary_config ssl_config</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00890">urldata.h:890</a></div></div>
<div class="ttc" id="vtls_8h_html_a93de8d8215f8110779b3e2ab9d77dbd3"><div class="ttname"><a href="vtls_8h.html#a93de8d8215f8110779b3e2ab9d77dbd3">Curl_none_engines_list</a></div><div class="ttdeci">struct curl_slist * Curl_none_engines_list(struct Curl_easy *data)</div></div>
<div class="ttc" id="slist_8h_html"><div class="ttname"><a href="slist_8h.html">slist.h</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="vtls_8h_html_a93fc7815a67581a10af46e077c24cb79"><div class="ttname"><a href="vtls_8h.html#a93fc7815a67581a10af46e077c24cb79">Curl_ssl_kill_session</a></div><div class="ttdeci">#define Curl_ssl_kill_session(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00271">vtls.h:271</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="structconnectdata_html_ad7c678f6933c3681e5d4e31d0a2a6494"><div class="ttname"><a href="structconnectdata.html#ad7c678f6933c3681e5d4e31d0a2a6494">connectdata::proxy_ssl_config</a></div><div class="ttdeci">struct ssl_primary_config proxy_ssl_config</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00891">urldata.h:891</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a78312575bac5d2efa2ca67246b06fad7"><div class="ttname"><a href="structssl__primary__config.html#a78312575bac5d2efa2ca67246b06fad7">ssl_primary_config::CAfile</a></div><div class="ttdeci">char * CAfile</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00217">urldata.h:217</a></div></div>
<div class="ttc" id="share_8c_html_a5dcfa53b653176b92395464a33b509cb"><div class="ttname"><a href="share_8c.html#a5dcfa53b653176b92395464a33b509cb">Curl_share_lock</a></div><div class="ttdeci">CURLSHcode Curl_share_lock(struct Curl_easy *data, curl_lock_data type, curl_lock_access accesstype)</div><div class="ttdef"><b>Definition:</b> <a href="share_8c_source.html#l00226">share.c:226</a></div></div>
<div class="ttc" id="sendf_8c_html_a93f532184de8849628a6048c992daf2b"><div class="ttname"><a href="sendf_8c.html#a93f532184de8849628a6048c992daf2b">Curl_recv_plain</a></div><div class="ttdeci">ssize_t Curl_recv_plain(struct connectdata *conn, int num, char *buf, size_t len, CURLcode *code)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00445">sendf.c:445</a></div></div>
<div class="ttc" id="curl_8h_html_a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0"><div class="ttname"><a href="curl_8h.html#a16af7b253440dadd46a80a4b9fddba4da724f1960f9dd1cfe462c0eca7f4e7da0">CURL_SSLVERSION_MAX_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l01986">curl.h:1986</a></div></div>
<div class="ttc" id="vtls_8h_html_af7010b022a42f4fd9f6fc7d568fc3a03"><div class="ttname"><a href="vtls_8h.html#af7010b022a42f4fd9f6fc7d568fc3a03">Curl_ssl_cert_status_request</a></div><div class="ttdeci">#define Curl_ssl_cert_status_request()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00273">vtls.h:273</a></div></div>
<div class="ttc" id="structconnectdata_html_a57fed5d378439f0b8cbad7cc9e916604"><div class="ttname"><a href="structconnectdata.html#a57fed5d378439f0b8cbad7cc9e916604">connectdata::proxy_ssl</a></div><div class="ttdeci">struct ssl_connect_data proxy_ssl[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00886">urldata.h:886</a></div></div>
<div class="ttc" id="structconnectdata_html_ac9d24fcd15a4c660fa7b6fbf55f6451d"><div class="ttname"><a href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">connectdata::port</a></div><div class="ttdeci">long port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00839">urldata.h:839</a></div></div>
<div class="ttc" id="warnless_8h_html"><div class="ttname"><a href="warnless_8h.html">warnless.h</a></div></div>
<div class="ttc" id="vtls_8c_html_a9c46acf5dfae9aa4b40fbb64c9035768"><div class="ttname"><a href="vtls_8c.html#a9c46acf5dfae9aa4b40fbb64c9035768">curl_global_sslset</a></div><div class="ttdeci">CURLsslset curl_global_sslset(curl_sslbackend id, const char *name, const curl_ssl_backend ***avail)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8c_source.html#l01337">vtls.c:1337</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a67125f10866c619561ae6a7d38c4cd6f"><div class="ttname"><a href="struct_curl__ssl.html#a67125f10866c619561ae6a7d38c4cd6f">Curl_ssl::sizeof_ssl_backend_data</a></div><div class="ttdeci">size_t sizeof_ssl_backend_data</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00043">vtls.h:43</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="vtls_8h_html_aa4cc853c97440333b00f76f160b3af50"><div class="ttname"><a href="vtls_8h.html#aa4cc853c97440333b00f76f160b3af50">Curl_ssl_free_certinfo</a></div><div class="ttdeci">#define Curl_ssl_free_certinfo(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00269">vtls.h:269</a></div></div>
<div class="ttc" id="vtls_8h_html_ad3a3e43e2c5ff47cf4ea6592a70feaf0"><div class="ttname"><a href="vtls_8h.html#ad3a3e43e2c5ff47cf4ea6592a70feaf0">Curl_ssl_false_start</a></div><div class="ttdeci">#define Curl_ssl_false_start()</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00274">vtls.h:274</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_ae32e7338526a0b717bbe57225026e892"><div class="ttname"><a href="structcurl__ssl__session.html#ae32e7338526a0b717bbe57225026e892">curl_ssl_session::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00257">urldata.h:257</a></div></div>
<div class="ttc" id="warnless_8c_html_a9b1c2efcef4120b8096d53bc254bfb9b"><div class="ttname"><a href="warnless_8c.html#a9b1c2efcef4120b8096d53bc254bfb9b">curlx_sotouz</a></div><div class="ttdeci">size_t curlx_sotouz(curl_off_t sonum)</div><div class="ttdef"><b>Definition:</b> <a href="warnless_8c_source.html#l00347">warnless.c:347</a></div></div>
<div class="ttc" id="curl_8h_html_adb5a46d02359d2379dc7e0904c987828"><div class="ttname"><a href="curl_8h.html#adb5a46d02359d2379dc7e0904c987828">curl_socket_t</a></div><div class="ttdeci">int curl_socket_t</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00130">curl.h:130</a></div></div>
<div class="ttc" id="curl_8h_html_a60ecc2082ebefd3b59083c19f6ca2946abec08c67963954b588c4af0f25998bec"><div class="ttname"><a href="curl_8h.html#a60ecc2082ebefd3b59083c19f6ca2946abec08c67963954b588c4af0f25998bec">CURLSSLSET_NO_BACKENDS</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02434">curl.h:2434</a></div></div>
<div class="ttc" id="struct_connect_bits_html_aec16dc8e44e2c34947cf23a7e0211b53"><div class="ttname"><a href="struct_connect_bits.html#aec16dc8e44e2c34947cf23a7e0211b53">ConnectBits::proxy_ssl_connected</a></div><div class="ttdeci">bool proxy_ssl_connected[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00441">urldata.h:441</a></div></div>
<div class="ttc" id="url_8h_html_ac1bb6fc72c7dbc5a230d369f9113fd24"><div class="ttname"><a href="url_8h.html#ac1bb6fc72c7dbc5a230d369f9113fd24">CONNECT_PROXY_SSL</a></div><div class="ttdeci">#define CONNECT_PROXY_SSL()</div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00099">url.h:99</a></div></div>
<div class="ttc" id="structcurl__ssl__backend_html_a9136e3e9b797273b4089097e07ce707e"><div class="ttname"><a href="structcurl__ssl__backend.html#a9136e3e9b797273b4089097e07ce707e">curl_ssl_backend::id</a></div><div class="ttdeci">curl_sslbackend id</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l02426">curl.h:2426</a></div></div>
<div class="ttc" id="curl_8h_html_a3a28c84e40db0ef30859b680281c9d36"><div class="ttname"><a href="curl_8h.html#a3a28c84e40db0ef30859b680281c9d36">curl_slist_free_all</a></div><div class="ttdeci">CURL_EXTERN void curl_slist_free_all(struct curl_slist *)</div><div class="ttdef"><b>Definition:</b> <a href="slist_8c_source.html#l00129">slist.c:129</a></div></div>
<div class="ttc" id="structcurl__ssl__session_html_a8452e789a5667cf862731b2e45371fc4"><div class="ttname"><a href="structcurl__ssl__session.html#a8452e789a5667cf862731b2e45371fc4">curl_ssl_session::ssl_config</a></div><div class="ttdeci">struct ssl_primary_config ssl_config</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00265">urldata.h:265</a></div></div>
<div class="ttc" id="url_8h_html"><div class="ttname"><a href="url_8h.html">url.h</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="structssl__primary__config_html"><div class="ttname"><a href="structssl__primary__config.html">ssl_primary_config</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00209">urldata.h:209</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_ad8aeedd93171e98d8db0049085d40f31"><div class="ttname"><a href="struct_curl__ssl.html#ad8aeedd93171e98d8db0049085d40f31">Curl_ssl::supports</a></div><div class="ttdeci">unsigned int supports</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00042">vtls.h:42</a></div></div>
<div class="ttc" id="vtls_8h_html_a06f0fb1d7887e2395f579c430c55e9da"><div class="ttname"><a href="vtls_8h.html#a06f0fb1d7887e2395f579c430c55e9da">Curl_none_set_engine_default</a></div><div class="ttdeci">CURLcode Curl_none_set_engine_default(struct Curl_easy *data)</div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="structconnectdata_html_a82d9732a096255f5d8741c4a0ea990eb"><div class="ttname"><a href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">connectdata::remote_port</a></div><div class="ttdeci">int remote_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00840">urldata.h:840</a></div></div>
<div class="ttc" id="vtls_8h_html_a054a6a646a0108d8f91a503d31a21671"><div class="ttname"><a href="vtls_8h.html#a054a6a646a0108d8f91a503d31a21671">Curl_none_close_all</a></div><div class="ttdeci">void Curl_none_close_all(struct Curl_easy *data)</div></div>
<div class="ttc" id="struct_curl__ssl_html_a3f9f9d75e3ee6b746a525dde365f7563"><div class="ttname"><a href="struct_curl__ssl.html#a3f9f9d75e3ee6b746a525dde365f7563">Curl_ssl::data_pending</a></div><div class="ttdeci">bool(* data_pending)(const struct connectdata *conn, int connindex)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00051">vtls.h:51</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
<div class="ttc" id="struct_curl__ssl_html_a612fcbf1ed7cd81a4638219327511f1e"><div class="ttname"><a href="struct_curl__ssl.html#a612fcbf1ed7cd81a4638219327511f1e">Curl_ssl::sha256sum</a></div><div class="ttdeci">CURLcode(* sha256sum)(const unsigned char *input, size_t inputlen, unsigned char *sha256sum, size_t sha256sumlen)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00075">vtls.h:75</a></div></div>
<div class="ttc" id="vtls_8h_html_a396bfd7b7888300739b9c3b323ab0907"><div class="ttname"><a href="vtls_8h.html#a396bfd7b7888300739b9c3b323ab0907">Curl_ssl_close_all</a></div><div class="ttdeci">#define Curl_ssl_close_all(x)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00257">vtls.h:257</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="dir_c8d0f45061db60a99b5caea59b58f693.html">vtls</a></li><li class="navelem"><a class="el" href="vtls_8c.html">vtls.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
