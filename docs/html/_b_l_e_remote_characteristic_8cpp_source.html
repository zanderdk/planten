<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/cpp_utils/BLERemoteCharacteristic.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_l_e_remote_characteristic_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLERemoteCharacteristic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_b_l_e_remote_characteristic_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * BLERemoteCharacteristic.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Jul 8, 2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_remote_characteristic_8h.html">BLERemoteCharacteristic.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#if defined(CONFIG_BT_ENABLED)</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;esp_gattc_api.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;esp_log.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;esp_err.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_exceptions_8h.html">BLEExceptions.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_utils_8h.html">BLEUtils.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_general_utils_8h.html">GeneralUtils.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_remote_descriptor_8h.html">BLERemoteDescriptor.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifdef ARDUINO_ARCH_ESP32</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;esp32-hal-log.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* LOG_TAG = <span class="stringliteral">&quot;BLERemoteCharacteristic&quot;</span>;   <span class="comment">// The logging tag for this class.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;BLERemoteCharacteristic::BLERemoteCharacteristic(</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        uint16_t             handle,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>              uuid,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        esp_gatt_char_prop_t charProp,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="class_b_l_e_remote_service.html">BLERemoteService</a>*    pRemoteService) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; BLERemoteCharacteristic: handle: %d 0x%d, uuid: %s&quot;</span>, handle, handle, uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    m_handle         = handle;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    m_uuid           = uuid;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    m_charProp       = charProp;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    m_pRemoteService = pRemoteService;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    m_notifyCallback = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    retrieveDescriptors(); <span class="comment">// Get the descriptors for this characteristic</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; BLERemoteCharacteristic&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;} <span class="comment">// BLERemoteCharacteristic</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a3995f3ceaae0b08f2f986705cb5355de">   56</a></span>&#160;<a class="code" href="class_b_l_e_remote_characteristic.html#a3995f3ceaae0b08f2f986705cb5355de">BLERemoteCharacteristic::~BLERemoteCharacteristic</a>() {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    removeDescriptors();   <span class="comment">// Release resources for any descriptor information we may have allocated.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;} <span class="comment">// ~BLERemoteCharacteristic</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aed0b2f6999b0cfae866fbab1ad27fa12">   65</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#aed0b2f6999b0cfae866fbab1ad27fa12">BLERemoteCharacteristic::canBroadcast</a>() {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_BROADCAST) != 0;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;} <span class="comment">// canBroadcast</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aa5ba364fd80043c1d8aed9904007f267">   74</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#aa5ba364fd80043c1d8aed9904007f267">BLERemoteCharacteristic::canIndicate</a>() {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_INDICATE) != 0;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;} <span class="comment">// canIndicate</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a24962dd34383c024f1dfd31eaec77635">   83</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#a24962dd34383c024f1dfd31eaec77635">BLERemoteCharacteristic::canNotify</a>() {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_NOTIFY) != 0;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;} <span class="comment">// canNotify</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a0c9a0f837afb8ea965413fd37222298e">   92</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#a0c9a0f837afb8ea965413fd37222298e">BLERemoteCharacteristic::canRead</a>() {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_READ) != 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;} <span class="comment">// canRead</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a3507fe04b1732cad1e0a0a69ada1c5f4">  101</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#a3507fe04b1732cad1e0a0a69ada1c5f4">BLERemoteCharacteristic::canWrite</a>() {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_WRITE) != 0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;} <span class="comment">// canWrite</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#afba6d6857815ff057fffa039536fffa1">  110</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_remote_characteristic.html#afba6d6857815ff057fffa039536fffa1">BLERemoteCharacteristic::canWriteNoResponse</a>() {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> (m_charProp &amp; ESP_GATT_CHAR_PROP_BIT_WRITE_NR) != 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;} <span class="comment">// canWriteNoResponse</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">static bool compareSrvcId(esp_gatt_srvc_id_t id1, esp_gatt_srvc_id_t id2) {</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    if (id1.id.inst_id != id2.id.inst_id) {</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">        return false;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    if (!BLEUUID(id1.id.uuid).equals(BLEUUID(id2.id.uuid))) {</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">        return false;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    return true;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">} // compareSrvcId</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">static bool compareGattId(esp_gatt_id_t id1, esp_gatt_id_t id2) {</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">    if (id1.inst_id != id2.inst_id) {</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">        return false;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">    if (!BLEUUID(id1.uuid).equals(BLEUUID(id2.uuid))) {</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">        return false;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    return true;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">} // compareCharId</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">void</span> BLERemoteCharacteristic::gattClientEventHandler(esp_gattc_cb_event_t event, esp_gatt_if_t gattc_if, esp_ble_gattc_cb_param_t* evtParam) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">switch</span>(event) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// ESP_GATTC_NOTIFY_EVT</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">// notify</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// - uint16_t           conn_id    - The connection identifier of the server.</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// - esp_bd_addr_t      remote_bda - The device address of the BLE server.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// - uint16_t           handle     - The handle of the characteristic for which the event is being received.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// - uint16_t           value_len  - The length of the received data.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// - uint8_t*           value      - The received data.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// - bool               is_notify  - True if this is a notify, false if it is an indicate.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// We have received a notification event which means that the server wishes us to know about a notification</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// piece of data.  What we must now do is find the characteristic with the associated handle and then</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">// invoke its notification callback (if it has one).</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_NOTIFY_EVT: {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;notify.handle != <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">if</span> (m_notifyCallback != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;Invoking callback for notification on characteristic %s&quot;</span>, <a class="code" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">toString</a>().c_str());</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                m_notifyCallback(<span class="keyword">this</span>, evtParam-&gt;notify.value, evtParam-&gt;notify.value_len, evtParam-&gt;notify.is_notify);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            } <span class="comment">// End we have a callback function ...</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        } <span class="comment">// ESP_GATTC_NOTIFY_EVT</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// ESP_GATTC_READ_CHAR_EVT</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// This event indicates that the server has responded to the read request.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// read:</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// - esp_gatt_status_t  status</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// - uint16_t           conn_id</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// - uint16_t           handle</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">// - uint8_t*           value</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// - uint16_t           value_len</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_READ_CHAR_EVT: {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">// If this event is not for us, then nothing further to do.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;read.handle != <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// At this point, we have determined that the event is for us, so now we save the value</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">// and unlock the semaphore to ensure that the requestor of the data can continue.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;read.status == ESP_GATT_OK) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                m_value = <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a>((<span class="keywordtype">char</span>*) evtParam-&gt;read.value, evtParam-&gt;read.value_len);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">if</span>(m_rawData != <span class="keyword">nullptr</span>) <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(m_rawData);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                m_rawData = (uint8_t*) <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(evtParam-&gt;read.value_len, <span class="keyword">sizeof</span>(uint8_t));</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(m_rawData, evtParam-&gt;read.value, evtParam-&gt;read.value_len);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                m_value = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            m_semaphoreReadCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        } <span class="comment">// ESP_GATTC_READ_CHAR_EVT</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// ESP_GATTC_REG_FOR_NOTIFY_EVT</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// reg_for_notify:</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// - uint16_t          handle</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_REG_FOR_NOTIFY_EVT: {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="comment">// If the request is not for this BLERemoteCharacteristic then move on to the next.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;reg_for_notify.handle != <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">// We have processed the notify registration and can unlock the semaphore.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            m_semaphoreRegForNotifyEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        } <span class="comment">// ESP_GATTC_REG_FOR_NOTIFY_EVT</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// ESP_GATTC_UNREG_FOR_NOTIFY_EVT</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// unreg_for_notify:</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// - uint16_t          handle</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_UNREG_FOR_NOTIFY_EVT: {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;unreg_for_notify.handle != <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="comment">// We have processed the notify un-registration and can unlock the semaphore.</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            m_semaphoreRegForNotifyEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        } <span class="comment">// ESP_GATTC_UNREG_FOR_NOTIFY_EVT:</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// ESP_GATTC_WRITE_CHAR_EVT</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">// write:</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">// - uint16_t          conn_id</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">// - uint16_t          handle</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_WRITE_CHAR_EVT: {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// Determine if this event is for us and, if not, pass onwards.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;write.handle != <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">// There is nothing further we need to do here.  This is merely an indication</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// that the write has completed and we can unlock the caller.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            m_semaphoreWriteCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        } <span class="comment">// ESP_GATTC_WRITE_CHAR_EVT</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    } <span class="comment">// End switch</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}; <span class="comment">// gattClientEventHandler</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordtype">void</span> BLERemoteCharacteristic::retrieveDescriptors() {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; retrieveDescriptors() for characteristic: %s&quot;</span>, <a class="code" href="class_b_l_e_remote_characteristic.html#a4d80b64628f2dcdd28b52ad27c2c2b6c">getUUID</a>().<a class="code" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">toString</a>().c_str());</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    removeDescriptors();   <span class="comment">// Remove any existing descriptors.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Loop over each of the descriptors within the service associated with this characteristic.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// For each descriptor we find, create a BLERemoteDescriptor instance.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    uint16_t offset = 0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    esp_gattc_descr_elem_t <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        uint16_t count = 10;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        esp_gatt_status_t status = ::esp_ble_gattc_get_all_descr(</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            getRemoteService()-&gt;getClient()-&gt;getGattcIf(),</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            getRemoteService()-&gt;getClient()-&gt;getConnId(),</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>(),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            &amp;<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            &amp;count,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            offset</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        );</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (status == ESP_GATT_INVALID_OFFSET) {   <span class="comment">// We have reached the end of the entries.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (status != ESP_GATT_OK) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_get_all_descr: %s&quot;</span>, <a class="code" href="class_b_l_e_utils.html#a2c8470728e8005da46dc32786be63018">BLEUtils::gattStatusToString</a>(status).c_str());</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (count == 0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;Found a descriptor: Handle: %d, UUID: %s&quot;</span>, <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>.handle, <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>.uuid).<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// We now have a new characteristic ... let us add that to our set of known characteristics</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="class_b_l_e_remote_descriptor.html">BLERemoteDescriptor</a>* pNewRemoteDescriptor = <span class="keyword">new</span> <a class="code" href="class_b_l_e_remote_characteristic.html#a37f99c30edf13206595264c25f37aea7">BLERemoteDescriptor</a>(</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>.handle,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>.uuid),</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keyword">this</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        );</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        m_descriptorMap.insert(std::pair&lt;std::string, BLERemoteDescriptor*&gt;(pNewRemoteDescriptor-&gt;getUUID().toString(), pNewRemoteDescriptor));</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        offset++;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    } <span class="comment">// while true</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//m_haveCharacteristics = true; // Remember that we have received the characteristics.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; retrieveDescriptors(): Found %d descriptors.&quot;</span>, offset);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;} <span class="comment">// getDescriptors</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#ae42325e1aec6ca10f034ee869dc48960">  305</a></span>&#160;std::map&lt;std::string, BLERemoteDescriptor*&gt;* <a class="code" href="class_b_l_e_remote_characteristic.html#ae42325e1aec6ca10f034ee869dc48960">BLERemoteCharacteristic::getDescriptors</a>() {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> &amp;m_descriptorMap;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;} <span class="comment">// getDescriptors</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">  314</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">BLERemoteCharacteristic::getHandle</a>() {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;&gt;&gt; getHandle: Characteristic: %s&quot;, getUUID().toString().c_str());</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">//ESP_LOGD(LOG_TAG, &quot;&lt;&lt; getHandle: %d 0x%.2x&quot;, m_handle, m_handle);</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> m_handle;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;} <span class="comment">// getHandle</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a13b0b4fc0975f5e629c7cc2ab4d2d0d3">  326</a></span>&#160;<a class="code" href="class_b_l_e_remote_descriptor.html">BLERemoteDescriptor</a>* <a class="code" href="class_b_l_e_remote_characteristic.html#a13b0b4fc0975f5e629c7cc2ab4d2d0d3">BLERemoteCharacteristic::getDescriptor</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> uuid) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; getDescriptor: uuid: %s&quot;</span>, uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> v = uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_descriptorMap) {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span> (myPair.first == v) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getDescriptor: found&quot;</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">return</span> myPair.second;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getDescriptor: Not found&quot;</span>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;} <span class="comment">// getDescriptor</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<a class="code" href="class_b_l_e_remote_service.html">BLERemoteService</a>* BLERemoteCharacteristic::getRemoteService() {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> m_pRemoteService;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;} <span class="comment">// getRemoteService</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a4d80b64628f2dcdd28b52ad27c2c2b6c">  353</a></span>&#160;<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> <a class="code" href="class_b_l_e_remote_characteristic.html#a4d80b64628f2dcdd28b52ad27c2c2b6c">BLERemoteCharacteristic::getUUID</a>() {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> m_uuid;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;} <span class="comment">// getUUID</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a11e009f6a32a223e3c76a5b73104f38c">  362</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_remote_characteristic.html#a11e009f6a32a223e3c76a5b73104f38c">BLERemoteCharacteristic::readUInt16</a>() {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">readValue</a>();</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 2) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> *(uint16_t*)(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data());</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;} <span class="comment">// readUInt16</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aa0f9d94ac1bbd9d1277f11cb538681ae">  375</a></span>&#160;uint32_t <a class="code" href="class_b_l_e_remote_characteristic.html#aa0f9d94ac1bbd9d1277f11cb538681ae">BLERemoteCharacteristic::readUInt32</a>() {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">readValue</a>();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 4) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">return</span> *(uint32_t*)(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.data());</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;} <span class="comment">// readUInt32</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a0458e9f4a2fcc5027e02337cb297e451">  388</a></span>&#160;uint8_t <a class="code" href="class_b_l_e_remote_characteristic.html#a0458e9f4a2fcc5027e02337cb297e451">BLERemoteCharacteristic::readUInt8</a>() {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a> = <a class="code" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">readValue</a>();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>.length() &gt;= 1) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">return</span> (uint8_t)<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>[0];</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;} <span class="comment">// readUInt8</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">  401</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">BLERemoteCharacteristic::readValue</a>() {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; readValue(): uuid: %s, handle: %d 0x%.2x&quot;</span>, <a class="code" href="class_b_l_e_remote_characteristic.html#a4d80b64628f2dcdd28b52ad27c2c2b6c">getUUID</a>().<a class="code" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">toString</a>().c_str(), <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>(), <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>());</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Check to see that we are connected.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (!getRemoteService()-&gt;getClient()-&gt;isConnected()) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Disconnected&quot;</span>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a>();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    m_semaphoreReadCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;readValue&quot;</span>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Ask the BLE subsystem to retrieve the value for the remote hosted characteristic.</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// This is an asynchronous request which means that we must block waiting for the response</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// to become available.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_read_char(</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>(),    <span class="comment">// The connection ID to the BLE server</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>(),                                   <span class="comment">// The handle of this characteristic</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        ESP_GATT_AUTH_REQ_NONE);                       <span class="comment">// Security</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_read_char: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Block waiting for the event that indicates that the read has completed.  When it has, the std::string found</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// in m_value will contain our data.</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    m_semaphoreReadCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;readValue&quot;</span>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; readValue(): length: %d&quot;</span>, m_value.length());</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> m_value;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;} <span class="comment">// readValue</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#a575a8b67bb544e1eaa079329490a3bb0">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_characteristic.html#a575a8b67bb544e1eaa079329490a3bb0">BLERemoteCharacteristic::registerForNotify</a>(<a class="code" href="_b_l_e_remote_characteristic_8h.html#af7177f2203188fd1e5ebe0807241c0df">notify_callback</a> <a class="code" href="_sample_sensor_tag_8cpp.html#a5c97f7d900f9d2b16a88b89261cd31c4">notifyCallback</a>, <span class="keywordtype">bool</span> notifications) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; registerForNotify(): %s&quot;</span>, <a class="code" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">toString</a>().c_str());</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    m_notifyCallback = <a class="code" href="_sample_sensor_tag_8cpp.html#a5c97f7d900f9d2b16a88b89261cd31c4">notifyCallback</a>;   <span class="comment">// Save the notification callback.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    m_semaphoreRegForNotifyEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;registerForNotify&quot;</span>);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_sample_sensor_tag_8cpp.html#a5c97f7d900f9d2b16a88b89261cd31c4">notifyCallback</a> != <span class="keyword">nullptr</span>) {   <span class="comment">// If we have a callback function, then this is a registration.</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        esp_err_t errRc = ::esp_ble_gattc_register_for_notify(</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            *m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">getPeerAddress</a>().<a class="code" href="class_b_l_e_address.html#a4c11bcce1d6ebf907e9a3c4f318bde2e">getNative</a>(),</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        );</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_register_for_notify: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        uint8_t val[] = {0x01, 0x00};</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">if</span>(!notifications) val[0] = 0x02;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="class_b_l_e_remote_descriptor.html">BLERemoteDescriptor</a>* desc = <a class="code" href="class_b_l_e_remote_characteristic.html#a13b0b4fc0975f5e629c7cc2ab4d2d0d3">getDescriptor</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>((uint16_t)0x2902));</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        desc-&gt;<a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">writeValue</a>(val, 2);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    } <span class="comment">// End Register</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">else</span> {   <span class="comment">// If we weren&#39;t passed a callback function, then this is an unregistration.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        esp_err_t errRc = ::esp_ble_gattc_unregister_for_notify(</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            *m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">getPeerAddress</a>().<a class="code" href="class_b_l_e_address.html#a4c11bcce1d6ebf907e9a3c4f318bde2e">getNative</a>(),</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>()</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        );</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_unregister_for_notify: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        uint8_t val[] = {0x00, 0x00};</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="class_b_l_e_remote_descriptor.html">BLERemoteDescriptor</a>* desc = <a class="code" href="class_b_l_e_remote_characteristic.html#a13b0b4fc0975f5e629c7cc2ab4d2d0d3">getDescriptor</a>((uint16_t)0x2902);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        desc-&gt;<a class="code" href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">writeValue</a>(val, 2);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    } <span class="comment">// End Unregister</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    m_semaphoreRegForNotifyEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;registerForNotify&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; registerForNotify()&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;} <span class="comment">// registerForNotify</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordtype">void</span> BLERemoteCharacteristic::removeDescriptors() {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Iterate through all the descriptors releasing their storage and erasing them from the map.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_descriptorMap) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;       m_descriptorMap.erase(myPair.first);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       <span class="keyword">delete</span> myPair.second;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    m_descriptorMap.clear();   <span class="comment">// Technically not neeeded, but just to be sure.</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;} <span class="comment">// removeCharacteristics</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">  507</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">BLERemoteCharacteristic::toString</a>() {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    std::ostringstream ss;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Characteristic: uuid: &quot;</span> &lt;&lt; m_uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>() &lt;&lt;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="stringliteral">&quot;, handle: &quot;</span> &lt;&lt; <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>() &lt;&lt; <span class="stringliteral">&quot; 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>() &lt;&lt;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="stringliteral">&quot;, props: &quot;</span> &lt;&lt; <a class="code" href="class_b_l_e_utils.html#a93e54bb8f091b8ed120a24e56ca1c967">BLEUtils::characteristicPropertiesToString</a>(m_charProp);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> ss.str();</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;} <span class="comment">// toString</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aba53cd3ce4845678028404b7eec28811">  522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">BLERemoteCharacteristic::writeValue</a>(<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> newValue, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">writeValue</a>((uint8_t*)newValue.c_str(), strlen(newValue.c_str()), response);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aa00bffdf3b2843aee32a27af9b643da5">  535</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">BLERemoteCharacteristic::writeValue</a>(uint8_t newValue, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">writeValue</a>(&amp;newValue, 1, response);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">  546</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">BLERemoteCharacteristic::writeValue</a>(uint8_t* <a class="code" href="structdata.html">data</a>, <span class="keywordtype">size_t</span> length, <span class="keywordtype">bool</span> response) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// writeValue(std::string((char*)data, length), response);</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; writeValue(), length: %d&quot;</span>, length);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// Check to see that we are connected.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> (!getRemoteService()-&gt;getClient()-&gt;isConnected()) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;Disconnected&quot;</span>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a>();</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    m_semaphoreWriteCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;writeValue&quot;</span>);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Invoke the ESP-IDF API to perform the write.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_write_char(</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        m_pRemoteService-&gt;<a class="code" href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">getClient</a>()-&gt;<a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>(),</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">getHandle</a>(),</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        length,</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        response?ESP_GATT_WRITE_TYPE_RSP:ESP_GATT_WRITE_TYPE_NO_RSP,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        ESP_GATT_AUTH_REQ_NONE</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    );</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_write_char: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    m_semaphoreWriteCharEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;writeValue&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; writeValue&quot;</span>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;} <span class="comment">// writeValue</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="class_b_l_e_remote_characteristic.html#acfa35695222036366832380e79559a03">  582</a></span>&#160;uint8_t* <a class="code" href="class_b_l_e_remote_characteristic.html#acfa35695222036366832380e79559a03">BLERemoteCharacteristic::readRawData</a>() {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> m_rawData;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CONFIG_BT_ENABLED */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html">BLEUUID</a></div><div class="ttdoc">A model of a BLE UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8h_source.html#l00018">BLEUUID.h:18</a></div></div>
<div class="ttc" id="_general_utils_8h_html"><div class="ttname"><a href="_general_utils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_aa0f9d94ac1bbd9d1277f11cb538681ae"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#aa0f9d94ac1bbd9d1277f11cb538681ae">BLERemoteCharacteristic::readUInt32</a></div><div class="ttdeci">uint32_t readUInt32()</div><div class="ttdoc">Read an unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00375">BLERemoteCharacteristic.cpp:375</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_ae42325e1aec6ca10f034ee869dc48960"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#ae42325e1aec6ca10f034ee869dc48960">BLERemoteCharacteristic::getDescriptors</a></div><div class="ttdeci">std::map&lt; std::string, BLERemoteDescriptor * &gt; * getDescriptors()</div><div class="ttdoc">Retrieve the map of descriptors keyed by UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00305">BLERemoteCharacteristic.cpp:305</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html_a2506be1a156d23cbba0f417fb92cf1c2"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html#a2506be1a156d23cbba0f417fb92cf1c2">BLERemoteDescriptor::writeValue</a></div><div class="ttdeci">void writeValue(uint8_t *data, size_t length, bool response=false)</div><div class="ttdoc">Write data to the BLE Remote Descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8cpp_source.html#l00134">BLERemoteDescriptor.cpp:134</a></div></div>
<div class="ttc" id="_b_l_e_remote_descriptor_8h_html"><div class="ttname"><a href="_b_l_e_remote_descriptor_8h.html">BLERemoteDescriptor.h</a></div></div>
<div class="ttc" id="_b_l_e_utils_8h_html"><div class="ttname"><a href="_b_l_e_utils_8h.html">BLEUtils.h</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a37f99c30edf13206595264c25f37aea7"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a37f99c30edf13206595264c25f37aea7">BLERemoteCharacteristic::BLERemoteDescriptor</a></div><div class="ttdeci">friend class BLERemoteDescriptor</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8h_source.html#l00059">BLERemoteCharacteristic.h:59</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a13b0b4fc0975f5e629c7cc2ab4d2d0d3"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a13b0b4fc0975f5e629c7cc2ab4d2d0d3">BLERemoteCharacteristic::getDescriptor</a></div><div class="ttdeci">BLERemoteDescriptor * getDescriptor(BLEUUID uuid)</div><div class="ttdoc">Get the descriptor instance with the given UUID that belongs to this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00326">BLERemoteCharacteristic.cpp:326</a></div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_aa5ba364fd80043c1d8aed9904007f267"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#aa5ba364fd80043c1d8aed9904007f267">BLERemoteCharacteristic::canIndicate</a></div><div class="ttdeci">bool canIndicate()</div><div class="ttdoc">Does the characteristic support indications? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00074">BLERemoteCharacteristic.cpp:74</a></div></div>
<div class="ttc" id="class_b_l_e_remote_descriptor_html"><div class="ttname"><a href="class_b_l_e_remote_descriptor.html">BLERemoteDescriptor</a></div><div class="ttdoc">A model of remote BLE descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_descriptor_8h_source.html#l00024">BLERemoteDescriptor.h:24</a></div></div>
<div class="ttc" id="class_b_l_e_remote_service_html"><div class="ttname"><a href="class_b_l_e_remote_service.html">BLERemoteService</a></div><div class="ttdoc">A model of a remote BLE service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_service_8h_source.html#l00027">BLERemoteService.h:27</a></div></div>
<div class="ttc" id="class_b_l_e_disconnected_exception_html"><div class="ttname"><a href="class_b_l_e_disconnected_exception.html">BLEDisconnectedException</a></div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_exceptions_8h_source.html#l00019">BLEExceptions.h:19</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_ad1aa158e37d15363b4441482fae82dd8"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">FreeRTOS::Semaphore::give</a></div><div class="ttdeci">void give()</div><div class="ttdoc">Give a semaphore. The Semaphore is given. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00114">FreeRTOS.cpp:114</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_acfa35695222036366832380e79559a03"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#acfa35695222036366832380e79559a03">BLERemoteCharacteristic::readRawData</a></div><div class="ttdeci">uint8_t * readRawData()</div><div class="ttdoc">Read raw data from remote characteristic as hex bytes. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00582">BLERemoteCharacteristic.cpp:582</a></div></div>
<div class="ttc" id="class_b_l_e_remote_service_html_a4a05b11fa74971db7966639a4423a365"><div class="ttname"><a href="class_b_l_e_remote_service.html#a4a05b11fa74971db7966639a4423a365">BLERemoteService::getClient</a></div><div class="ttdeci">BLEClient * getClient(void)</div><div class="ttdoc">Get the client associated with this service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_service_8cpp_source.html#l00244">BLERemoteService.cpp:244</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a24962dd34383c024f1dfd31eaec77635"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a24962dd34383c024f1dfd31eaec77635">BLERemoteCharacteristic::canNotify</a></div><div class="ttdeci">bool canNotify()</div><div class="ttdoc">Does the characteristic support notifications? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00083">BLERemoteCharacteristic.cpp:83</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a575a8b67bb544e1eaa079329490a3bb0"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a575a8b67bb544e1eaa079329490a3bb0">BLERemoteCharacteristic::registerForNotify</a></div><div class="ttdeci">void registerForNotify(notify_callback _callback, bool notifications=true)</div><div class="ttdoc">Register for notifications. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00441">BLERemoteCharacteristic.cpp:441</a></div></div>
<div class="ttc" id="_b_l_e_remote_characteristic_8h_html_af7177f2203188fd1e5ebe0807241c0df"><div class="ttname"><a href="_b_l_e_remote_characteristic_8h.html#af7177f2203188fd1e5ebe0807241c0df">notify_callback</a></div><div class="ttdeci">void(* notify_callback)(BLERemoteCharacteristic *pBLERemoteCharacteristic, uint8_t *pData, size_t length, bool isNotify)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8h_source.html#l00024">BLERemoteCharacteristic.h:24</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_aecd512f950b6a0151941d139d78b19aa"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">BLERemoteCharacteristic::writeValue</a></div><div class="ttdeci">void writeValue(uint8_t *data, size_t length, bool response=false)</div><div class="ttdoc">Write the new value for the characteristic from a data buffer. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00546">BLERemoteCharacteristic.cpp:546</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a77a59257b14ea766abad17a2e43749c4"><div class="ttname"><a href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">BLEClient::getPeerAddress</a></div><div class="ttdeci">BLEAddress getPeerAddress()</div><div class="ttdoc">Retrieve the address of the peer. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00333">BLEClient.cpp:333</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="class_b_l_e_utils_html_a93e54bb8f091b8ed120a24e56ca1c967"><div class="ttname"><a href="class_b_l_e_utils.html#a93e54bb8f091b8ed120a24e56ca1c967">BLEUtils::characteristicPropertiesToString</a></div><div class="ttdeci">static std::string characteristicPropertiesToString(esp_gatt_char_prop_t prop)</div><div class="ttdoc">Convert characteristic properties into a string representation. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_utils_8cpp_source.html#l00611">BLEUtils.cpp:611</a></div></div>
<div class="ttc" id="_b_l_e_exceptions_8h_html"><div class="ttname"><a href="_b_l_e_exceptions_8h.html">BLEExceptions.h</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a0f6325af99860af39fe15372864c0786"><div class="ttname"><a href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">BLEClient::getConnId</a></div><div class="ttdeci">uint16_t getConnId()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00317">BLEClient.cpp:317</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a3995f3ceaae0b08f2f986705cb5355de"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a3995f3ceaae0b08f2f986705cb5355de">BLERemoteCharacteristic::~BLERemoteCharacteristic</a></div><div class="ttdeci">~BLERemoteCharacteristic()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00056">BLERemoteCharacteristic.cpp:56</a></div></div>
<div class="ttc" id="class_b_l_e_utils_html_a2c8470728e8005da46dc32786be63018"><div class="ttname"><a href="class_b_l_e_utils.html#a2c8470728e8005da46dc32786be63018">BLEUtils::gattStatusToString</a></div><div class="ttdeci">static std::string gattStatusToString(esp_gatt_status_t status)</div><div class="ttdoc">Convert a GATT status to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_utils_8cpp_source.html#l01893">BLEUtils.cpp:1893</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a0c9a0f837afb8ea965413fd37222298e"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a0c9a0f837afb8ea965413fd37222298e">BLERemoteCharacteristic::canRead</a></div><div class="ttdeci">bool canRead()</div><div class="ttdoc">Does the characteristic support reading? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00092">BLERemoteCharacteristic.cpp:92</a></div></div>
<div class="ttc" id="class_general_utils_html_a25e466e54ff002f54bfb7e1f43bd401b"><div class="ttname"><a href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a></div><div class="ttdeci">static const char * errorToString(esp_err_t errCode)</div><div class="ttdoc">Convert an ESP error code to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_general_utils_8cpp_source.html#l00366">GeneralUtils.cpp:366</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a023cb404ff897bb39064b454732ccf21"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">FreeRTOS::Semaphore::wait</a></div><div class="ttdeci">uint32_t wait(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Wait for a semaphore to be released by trying to take it and then releasing it again. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00064">FreeRTOS.cpp:64</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a4d80b64628f2dcdd28b52ad27c2c2b6c"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a4d80b64628f2dcdd28b52ad27c2c2b6c">BLERemoteCharacteristic::getUUID</a></div><div class="ttdeci">BLEUUID getUUID()</div><div class="ttdoc">Get the UUID for this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00353">BLERemoteCharacteristic.cpp:353</a></div></div>
<div class="ttc" id="_b_l_e_remote_characteristic_8h_html"><div class="ttname"><a href="_b_l_e_remote_characteristic_8h.html">BLERemoteCharacteristic.h</a></div></div>
<div class="ttc" id="class_b_l_e_address_html_a4c11bcce1d6ebf907e9a3c4f318bde2e"><div class="ttname"><a href="class_b_l_e_address.html#a4c11bcce1d6ebf907e9a3c4f318bde2e">BLEAddress::getNative</a></div><div class="ttdeci">esp_bd_addr_t * getNative()</div><div class="ttdoc">Return the native representation of the address. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_address_8cpp_source.html#l00069">BLEAddress.cpp:69</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a11e009f6a32a223e3c76a5b73104f38c"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a11e009f6a32a223e3c76a5b73104f38c">BLERemoteCharacteristic::readUInt16</a></div><div class="ttdeci">uint16_t readUInt16()</div><div class="ttdoc">Read an unsigned 16 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00362">BLERemoteCharacteristic.cpp:362</a></div></div>
<div class="ttc" id="_sample_sensor_tag_8cpp_html_a5c97f7d900f9d2b16a88b89261cd31c4"><div class="ttname"><a href="_sample_sensor_tag_8cpp.html#a5c97f7d900f9d2b16a88b89261cd31c4">notifyCallback</a></div><div class="ttdeci">void notifyCallback(BLERemoteCharacteristic *pBLERemoteCharacteristic, uint8_t *data, size_t length, bool isNotify)</div><div class="ttdef"><b>Definition:</b> <a href="_sample_sensor_tag_8cpp_source.html#l00036">SampleSensorTag.cpp:36</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a2bcb1d188fc1d961ea8a9933806fc528"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a2bcb1d188fc1d961ea8a9933806fc528">BLERemoteCharacteristic::getHandle</a></div><div class="ttdeci">uint16_t getHandle()</div><div class="ttdoc">Get the handle for this characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00314">BLERemoteCharacteristic.cpp:314</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_af9ac554d3521539d6618d9d8d55df7e7"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#af9ac554d3521539d6618d9d8d55df7e7">BLERemoteCharacteristic::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Convert a BLERemoteCharacteristic to a string representation;. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00507">BLERemoteCharacteristic.cpp:507</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_afba6d6857815ff057fffa039536fffa1"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#afba6d6857815ff057fffa039536fffa1">BLERemoteCharacteristic::canWriteNoResponse</a></div><div class="ttdeci">bool canWriteNoResponse()</div><div class="ttdoc">Does the characteristic support writing with no response? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00110">BLERemoteCharacteristic.cpp:110</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html_a52e30a254e1ff10a429c2e0a36a6131d"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">BLEUUID::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Get a string representation of the UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8cpp_source.html#l00355">BLEUUID.cpp:355</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a68566b6eeeae65ea12c7b361e1f23add"><div class="ttname"><a href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">BLEClient::getGattcIf</a></div><div class="ttdeci">esp_gatt_if_t getGattcIf()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00323">BLEClient.cpp:323</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a3507fe04b1732cad1e0a0a69ada1c5f4"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a3507fe04b1732cad1e0a0a69ada1c5f4">BLERemoteCharacteristic::canWrite</a></div><div class="ttdeci">bool canWrite()</div><div class="ttdoc">Does the characteristic support writing? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00101">BLERemoteCharacteristic.cpp:101</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_aed0b2f6999b0cfae866fbab1ad27fa12"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#aed0b2f6999b0cfae866fbab1ad27fa12">BLERemoteCharacteristic::canBroadcast</a></div><div class="ttdeci">bool canBroadcast()</div><div class="ttdoc">Does the characteristic support broadcasting? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00065">BLERemoteCharacteristic.cpp:65</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a67fa9bf777be48332a30154e006827fd"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">FreeRTOS::Semaphore::take</a></div><div class="ttdeci">bool take(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Take a semaphore. Take a semaphore and wait indefinitely. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00159">FreeRTOS.cpp:159</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a0458e9f4a2fcc5027e02337cb297e451"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a0458e9f4a2fcc5027e02337cb297e451">BLERemoteCharacteristic::readUInt8</a></div><div class="ttdeci">uint8_t readUInt8()</div><div class="ttdoc">Read a byte value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00388">BLERemoteCharacteristic.cpp:388</a></div></div>
<div class="ttc" id="get_8d_html_a38b0ef81b65f2aee282c8c217a123176"><div class="ttname"><a href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a></div><div class="ttdeci">Long this option will make all data specified with data</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a67b0993e84a032ef1f4dd0601e6a4628"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">BLERemoteCharacteristic::readValue</a></div><div class="ttdeci">std::string readValue()</div><div class="ttdoc">Read the value of the remote characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00401">BLERemoteCharacteristic.cpp:401</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e66062f3a4d2a5b6b6746a6b0f9c85ac.html">cpp_utils</a></li><li class="navelem"><a class="el" href="_b_l_e_remote_characteristic_8cpp.html">BLERemoteCharacteristic.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
