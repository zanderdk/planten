<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: BLE C++ classes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_esp32-snippets_cpp_utils__design_notes__b_l_e_c_p_p.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLE C++ classes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>BLE Server</h1>
<h2>BLE Characteristic callbacks</h2>
<p>When a client connects to us as a BLE Server, it can change a characteristics value or read from a characteristic. The <a class="el" href="class_b_l_e_characteristic_callbacks.html" title="Callbacks that can be associated with a BLE characteristic to inform of events. ">BLECharacteristicCallbacks</a> class provides a handler for such. </p><h1>BLE Client</h1>
<h1>Advertising</h1>
<p>When we are being a BLE server we have the opportunity to perform advertising. Advertising means that we broadcast information about ourselves such that interested parties (presumably clients) can receive that information. The BLE advertising is described in the BLE specifications.</p>
<p>Some key facts:</p>
<ul>
<li>Advertisements can be sent periodically with the period being from 20ms to 10.24 seconds in steps of 0.625 ms.</li>
<li>An advertisement payload can be up to 31 bytes in length.</li>
<li>A payload can contain a sequence of records where a record is composed of a length, type and data.</li>
</ul>
<p>We can build a BLE advertising structure and specify that it should be sent for an advertisement using <code>esp_ble_gap_config_adv_data_raw</code> or sent using a scan response message using <code>esp_ble_gap_config_scan_rsp_data_raw</code>.</p>
<p>Looking at the data structure for advertising we find it consists of records where each record is:</p>
<ul>
<li>1 byte length</li>
<li>1 byte record type</li>
<li>length-1 bytes of data</li>
</ul>
<p>Trailing data (assuming we don't use all 31 bytes) shall be zeros. The advert types that include payload data are:</p>
<ul>
<li>ADV_IND</li>
<li>ADV_NONCONN_IND</li>
<li>ADV_SCAN_IND</li>
</ul>
<p>The following advertising types are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Descrip   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x01  </td><td class="markdownTableBodyNone">Flags   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x02  </td><td class="markdownTableBodyNone">Incomplete list of 16 bit service UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x03  </td><td class="markdownTableBodyNone">Complete list of 16 bit service UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x04  </td><td class="markdownTableBodyNone">Incomplete list of 32 bit service UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x05  </td><td class="markdownTableBodyNone">Complete list of 32 bit UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x06  </td><td class="markdownTableBodyNone">Incomplete list of 128 bit service UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x07  </td><td class="markdownTableBodyNone">Complete list of 128 bit service UUIDs   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x08  </td><td class="markdownTableBodyNone">Shortened local name   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x09  </td><td class="markdownTableBodyNone">Complete local name   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x16  </td><td class="markdownTableBodyNone">Service data (16 bit)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x19  </td><td class="markdownTableBodyNone">Appearance   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x20  </td><td class="markdownTableBodyNone">Service data (32 bit)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x21  </td><td class="markdownTableBodyNone">Service data (128 bit)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0xFF  </td><td class="markdownTableBodyNone">Manufacturer data   </td></tr>
</table>
<p>See also:</p>
<ul>
<li>BLE Spec 4.2 Vol 3 Part C Chapter 11 - Advertising and Scan response data format.</li>
<li><a href="https://www.bluetooth.com/specifications/assigned-numbers/generic-access-profile">Advertisement record types</a></li>
<li><a href="http://www.argenox.com/a-ble-advertising-primer/">A BLE Advertising Primer</a></li>
</ul>
<h2>Exposed functions</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone" colspan="2">Typ   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x01  </td><td class="markdownTableBodyNone"><code>setFlags(uint8_t flag)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x02, 0x04, 0x06  </td><td class="markdownTableBodyNone"><code>setPartialServices(vector&lt;<a class="el" href="class_b_l_e_u_u_i_d.html" title="A model of a BLE UUID. ">BLEUUID</a>&gt;)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x02, 0x04, 0x06  </td><td class="markdownTableBodyNone"><code>setPartialServices(BLEUUID)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x03, 0x05, 0x07  </td><td class="markdownTableBodyNone"><code>setCompleteServices(vector&lt;<a class="el" href="class_b_l_e_u_u_i_d.html" title="A model of a BLE UUID. ">BLEUUID</a>&gt;)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x03, 0x05, 0x07  </td><td class="markdownTableBodyNone"><code>setCompleteServices(BLEUUID)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x08  </td><td class="markdownTableBodyNone"><code>setShortName(std::string)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x09  </td><td class="markdownTableBodyNone"><code>setName(std::string)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x16, 0x20, 0x21  </td><td class="markdownTableBodyNone"><code>setServiceData(BLEUUID, std::string)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x19  </td><td class="markdownTableBodyNone"><code>setAppearance(uint16_t)</code>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">0xFF  </td><td class="markdownTableBodyNone"><code>setManufacturerData(std::string)</code>   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
