<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/ldap.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ldap_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ldap.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ldap_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                      _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project         ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                 / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                 \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_LDAP) &amp;&amp; !defined(USE_OPENLDAP)</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * Notice that USE_OPENLDAP is only a source code selection switch. When</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * libcurl is built with USE_OPENLDAP defined the libcurl source code that</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * gets compiled is the code from openldap.c, otherwise the code that gets</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * compiled is the code from ldap.c.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * When USE_OPENLDAP is defined a recent version of the OpenLDAP library</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * might be required for compilation and runtime. In order to use ancient</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * OpenLDAP library versions, USE_OPENLDAP shall not be defined.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP           </span><span class="comment">/* Use Windows LDAP implementation. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor"># include &lt;winldap.h&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor"># ifndef LDAP_VENDOR_NAME</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#  error Your Platform SDK is NOT sufficient for LDAP support! \</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">         Update your Platform SDK, or disable LDAP support!</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"># else</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#  include &lt;winber.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="ldap_8c.html#a773186efdfc921b5370ec02876fd69f5">   47</a></span>&#160;<span class="preprocessor"># define LDAP_DEPRECATED 1      </span><span class="comment">/* Be sure ldap_init() is defined. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor"># ifdef HAVE_LBER_H</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#  include &lt;lber.h&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor"># include &lt;ldap.h&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor"># if (defined(HAVE_LDAP_SSL) &amp;&amp; defined(HAVE_LDAP_SSL_H))</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#  include &lt;ldap_ssl.h&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"># endif </span><span class="comment">/* HAVE_LDAP_SSL &amp;&amp; HAVE_LDAP_SSL_H */</span><span class="preprocessor"></span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="escape_8h.html">escape.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="progress_8h.html">progress.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="transfer_8h.html">transfer.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strtok_8h.html">strtok.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__ldap_8h.html">curl_ldap.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__multibyte_8h.html">curl_multibyte.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connect_8h.html">connect.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#ifndef HAVE_LDAP_URL_PARSE</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/* Use our own implementation. */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html">   78</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#ab5f094ac9d53f7b2b644eb5fc4c85199">   79</a></span>&#160;  <span class="keywordtype">char</span>   *<a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#ab5f094ac9d53f7b2b644eb5fc4c85199">lud_host</a>;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a1bf03a669277a09d1efc91a0ed3f3897">   80</a></span>&#160;  <span class="keywordtype">int</span>     <a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a1bf03a669277a09d1efc91a0ed3f3897">lud_port</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  TCHAR  *lud_dn;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  TCHAR **lud_attrs;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a7348af0266ef975c61dfe097d7b61724">   85</a></span>&#160;  <span class="keywordtype">char</span>   *<a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a7348af0266ef975c61dfe097d7b61724">lud_dn</a>;</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a519259723457d39272d3ae1222aff967">   86</a></span>&#160;  <span class="keywordtype">char</span>  **<a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a519259723457d39272d3ae1222aff967">lud_attrs</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#adaf79ef53ae0b3c3dac1761206596057">   88</a></span>&#160;  <span class="keywordtype">int</span>     <a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#adaf79ef53ae0b3c3dac1761206596057">lud_scope</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  TCHAR  *lud_filter;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a0b279f1e8f87a918c487686199e283e2">   92</a></span>&#160;  <span class="keywordtype">char</span>   *<a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a0b279f1e8f87a918c487686199e283e2">lud_filter</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#abbabc88410aa87ef3ab1a7ac08336cb9">   94</a></span>&#160;  <span class="keywordtype">char</span>  **<a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#abbabc88410aa87ef3ab1a7ac08336cb9">lud_exts</a>;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#aac4dcadfd708030eee24722b1724eeee">   95</a></span>&#160;  <span class="keywordtype">size_t</span>    <a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#aac4dcadfd708030eee24722b1724eeee">lud_attrs_dups</a>; <span class="comment">/* how many were dup&#39;ed, this field is not in the</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">                               &quot;real&quot; struct so can only be used in code</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">                               without HAVE_LDAP_URL_PARSE defined */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;} <a class="code" href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html">CURL_LDAPURLDesc</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#undef LDAPURLDesc</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">  101</a></span>&#160;<span class="preprocessor">#define LDAPURLDesc             CURL_LDAPURLDesc</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  _ldap_url_parse(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                            <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> **ludp);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _ldap_free_urldesc(<a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#undef ldap_free_urldesc</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">  108</a></span>&#160;<span class="preprocessor">#define ldap_free_urldesc       _ldap_free_urldesc</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#ifdef DEBUG_LDAP</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">  #define LDAP_TRACE(x)   do { \</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">                            _ldap_trace(&quot;%u: &quot;, __LINE__); \</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">                            _ldap_trace x; \</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">                          } WHILE_FALSE</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> _ldap_trace(<span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">  119</a></span>&#160;<span class="preprocessor">  #define LDAP_TRACE(x)   Curl_nop_stmt</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ldap(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * LDAP protocol handler.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="ldap_8c.html#aa1253b14602d68a70ca20be27d768594">  129</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> <a class="code" href="ldap_8c.html#aa1253b14602d68a70ca20be27d768594">Curl_handler_ldap</a> = {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="stringliteral">&quot;LDAP&quot;</span>,                               <span class="comment">/* scheme */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  Curl_ldap,                            <span class="comment">/* do_it */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* done */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connecting */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="urldata_8h.html#a4d9c4d843ff2d52be6c16d1fa1033184">PORT_LDAP</a>,                            <span class="comment">/* defport */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="curl_8h.html#a5588596e963ddd108786b3e331eb09e4">CURLPROTO_LDAP</a>,                       <span class="comment">/* protocol */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="urldata_8h.html#a06e40f8f1e2219fb5b519c74715c3537">PROTOPT_NONE</a>                          <span class="comment">/* flags */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;};</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#ifdef HAVE_LDAP_SSL</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> * LDAPS protocol handler.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> Curl_handler_ldaps = {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="stringliteral">&quot;LDAPS&quot;</span>,                              <span class="comment">/* scheme */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  Curl_ldap,                            <span class="comment">/* do_it */</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* done */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connecting */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="urldata_8h.html#acbe3a40e399b4d170f2bee3500e1b0a4">PORT_LDAPS</a>,                           <span class="comment">/* defport */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="curl_8h.html#aed470ee20e1ed4de6ca0c00708679512">CURLPROTO_LDAPS</a>,                      <span class="comment">/* protocol */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>                           <span class="comment">/* flags */</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;};</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#if defined(USE_WINDOWS_SSPI)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> ldap_win_bind_auth(<a class="code" href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a> *<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *user,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *passwd, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> authflags)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  ULONG <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = 0;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  SEC_WINNT_AUTH_IDENTITY cred;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_AUTH_METHOD_NOT_SUPPORTED;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a>(&amp;cred, 0, <span class="keyword">sizeof</span>(cred));</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#if defined(USE_SPNEGO)</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span>(authflags &amp; <a class="code" href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a>) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = LDAP_AUTH_NEGOTIATE;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#if defined(USE_NTLM)</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">if</span>(authflags &amp; <a class="code" href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a>) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = LDAP_AUTH_NTLM;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_CRYPTO_AUTH)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span>(authflags &amp; <a class="code" href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a>) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = LDAP_AUTH_DIGEST;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">/* required anyway if one of upper preprocessor definitions enabled */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> &amp;&amp; user &amp;&amp; passwd) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = Curl_create_sspi_identity(user, passwd, &amp;cred);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_bind_s(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, NULL, (TCHAR *)&amp;cred, <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      Curl_sspi_free_identity(&amp;cred);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">/* proceed with current user credentials */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = LDAP_AUTH_NEGOTIATE;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_bind_s(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, NULL, NULL, <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* #if defined(USE_WINDOWS_SSPI) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> ldap_win_bind(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a> *<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *user, <span class="keyword">const</span> <span class="keywordtype">char</span> *passwd)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_INVALID_CREDENTIALS;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  PTCHAR inuser = NULL;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  PTCHAR inpass = NULL;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span>(user &amp;&amp; passwd &amp;&amp; (conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#aaf7a8f7fb7d239e2532576b36b5ae5f5">httpauth</a> &amp; <a class="code" href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a>)) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    inuser = Curl_convert_UTF8_to_tchar((<span class="keywordtype">char</span> *) user);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    inpass = Curl_convert_UTF8_to_tchar((<span class="keywordtype">char</span> *) passwd);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a5fbb4cfe8c625de094b8f77e55b3f691">ldap_simple_bind_s</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, inuser, inpass);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    Curl_unicodefree(inuser);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    Curl_unicodefree(inpass);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#if defined(USE_WINDOWS_SSPI)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_win_bind_auth(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, user, passwd, conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">set</a>.<a class="code" href="struct_user_defined.html#aaf7a8f7fb7d239e2532576b36b5ae5f5">httpauth</a>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* #if defined(USE_WIN32_LDAP) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> Curl_ldap(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *<a class="code" href="struct_curl__handler.html#ac77e1b77c701181a1ba5e58922504524">done</a>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = 0;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a> *<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> = NULL;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp = NULL;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  LDAPMessage *ldapmsg = NULL;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  LDAPMessage *entryIterator;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">int</span> num = 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">int</span> ldap_proto = LDAP_VERSION3;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">int</span> ldap_ssl = 0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">char</span> *val_b64 = NULL;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">size_t</span> val_b64_sz = 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a> dlsize = 0;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#ifdef LDAP_OPT_NETWORK_TIMEOUT</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtimeval.html">timeval</a> ldap_timeout = {10, 0}; <span class="comment">/* 10 sec connection/search timeout */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  TCHAR *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = NULL;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = NULL;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">char</span> *user = NULL;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">char</span> *passwd = NULL;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; <span class="comment">/* unconditionally */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: LDAP Vendor = %s ; LDAP Version = %d\n&quot;</span>,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          LDAP_VENDOR_NAME, LDAP_VENDOR_VERSION);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: %s\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;change.url);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#ifdef HAVE_LDAP_URL_PARSE</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#aca3b733600772d0ed1c2401838972aab">ldap_url_parse</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url, &amp;ludp);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = _ldap_url_parse(conn, &amp;ludp);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 0) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a6e98ab70d0724c67536f2f2cebd8f5a6">CURLE_LDAP_INVALID_URL</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">/* Get the URL scheme (either ldap or ldaps) */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">given</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ldap_ssl = 1;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: trying to establish %s connection\n&quot;</span>,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          ldap_ssl ? <span class="stringliteral">&quot;encrypted&quot;</span> : <span class="stringliteral">&quot;cleartext&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = Curl_convert_UTF8_to_tchar(conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a> = conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    user = conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    passwd = conn-&gt;<a class="code" href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">passwd</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#ifdef LDAP_OPT_NETWORK_TIMEOUT</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  ldap_set_option(NULL, LDAP_OPT_NETWORK_TIMEOUT, &amp;ldap_timeout);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  ldap_set_option(NULL, LDAP_OPT_PROTOCOL_VERSION, &amp;ldap_proto);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span>(ldap_ssl) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">#ifdef HAVE_LDAP_SSL</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">/* Win32 LDAP SDK doesn&#39;t support insecure mode without CA! */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> = ldap_sslinit(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, (<span class="keywordtype">int</span>)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>, 1);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    ldap_set_option(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, LDAP_OPT_SSL, LDAP_OPT_ON);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> ldap_option;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">char</span> *ldap_ca = conn-&gt;<a class="code" href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">ssl_config</a>.<a class="code" href="structssl__primary__config.html#a78312575bac5d2efa2ca67246b06fad7">CAfile</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">#if defined(CURL_HAS_NOVELL_LDAPSDK)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldapssl_client_init(NULL, NULL);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ldapssl_client_init %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">ssl_config</a>.<a class="code" href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">verifypeer</a>) {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">/* Novell SDK supports DER or BASE64 files. */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordtype">int</span> cert_type = LDAPSSL_CERT_FILETYPE_B64;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.ssl.cert_type) &amp;&amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         (<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;set.ssl.cert_type, <span class="stringliteral">&quot;DER&quot;</span>)))</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        cert_type = LDAPSSL_CERT_FILETYPE_DER;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">if</span>(!ldap_ca) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR %s CA cert not set!&quot;</span>,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;              (cert_type == LDAPSSL_CERT_FILETYPE_DER ? <span class="stringliteral">&quot;DER&quot;</span> : <span class="stringliteral">&quot;PEM&quot;</span>));</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: using %s CA cert &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              (cert_type == LDAPSSL_CERT_FILETYPE_DER ? <span class="stringliteral">&quot;DER&quot;</span> : <span class="stringliteral">&quot;PEM&quot;</span>),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              ldap_ca);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldapssl_add_trusted_cert(ldap_ca, cert_type);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR setting %s CA cert: %s&quot;</span>,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                (cert_type == LDAPSSL_CERT_FILETYPE_DER ? <span class="stringliteral">&quot;DER&quot;</span> : <span class="stringliteral">&quot;PEM&quot;</span>),</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      ldap_option = LDAPSSL_VERIFY_SERVER;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      ldap_option = LDAPSSL_VERIFY_NONE;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldapssl_set_verify_mode(ldap_option);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR setting cert verify mode: %s&quot;</span>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;              <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> = ldapssl_init(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, (<span class="keywordtype">int</span>)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>, 1);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> == NULL) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: Cannot connect to %s:%ld&quot;</span>,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">dispname</a>, conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#elif defined(LDAP_OPT_X_TLS)</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">ssl_config</a>.<a class="code" href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">verifypeer</a>) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">/* OpenLDAP SDK supports BASE64 files. */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>-&gt;set.ssl.cert_type) &amp;&amp;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         (!<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="structdata.html">data</a>-&gt;set.ssl.cert_type, <span class="stringliteral">&quot;PEM&quot;</span>))) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR OpenLDAP only supports PEM cert-type!&quot;</span>);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span>(!ldap_ca) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR PEM CA cert not set!&quot;</span>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: using PEM CA cert: %s\n&quot;</span>, ldap_ca);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_set_option(NULL, LDAP_OPT_X_TLS_CACERTFILE, ldap_ca);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR setting PEM CA cert: %s&quot;</span>,</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      ldap_option = LDAP_OPT_X_TLS_DEMAND;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      ldap_option = LDAP_OPT_X_TLS_NEVER;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_set_option(NULL, LDAP_OPT_X_TLS_REQUIRE_CERT, &amp;ldap_option);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR setting cert verify mode: %s&quot;</span>,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> = <a class="code" href="setup-os400_8h.html#a27893953ce895e5a66dc2209d01ae59a">ldap_init</a>(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, (<span class="keywordtype">int</span>)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> == NULL) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: Cannot connect to %s:%ld&quot;</span>,</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">dispname</a>, conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    ldap_option = LDAP_OPT_X_TLS_HARD;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_set_option(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, LDAP_OPT_X_TLS, &amp;ldap_option);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ERROR setting SSL/TLS mode: %s&quot;</span>,</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;              <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">    rc = ldap_start_tls_s(server, NULL, NULL);</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">    if(rc != LDAP_SUCCESS) {</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">      failf(data, &quot;LDAP local: ERROR starting SSL/TLS mode: %s&quot;,</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">              ldap_err2string(rc));</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">      result = CURLE_SSL_CERTPROBLEM;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">      goto quit;</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">/* we should probably never come up to here since configure</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">       should check in first place if we can support LDAP SSL/TLS */</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: SSL/TLS not supported with this version &quot;</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="stringliteral">&quot;of the OpenLDAP toolkit\n&quot;</span>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_LDAP_USE_SSL */</span><span class="preprocessor"></span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> = <a class="code" href="setup-os400_8h.html#a27893953ce895e5a66dc2209d01ae59a">ldap_init</a>(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>, (<span class="keywordtype">int</span>)conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a> == NULL) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: Cannot connect to %s:%ld&quot;</span>,</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">dispname</a>, conn-&gt;<a class="code" href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">port</a>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  ldap_set_option(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, LDAP_OPT_PROTOCOL_VERSION, &amp;ldap_proto);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_win_bind(conn, <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, user, passwd);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a5fbb4cfe8c625de094b8f77e55b3f691">ldap_simple_bind_s</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, user, passwd);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span>(!ldap_ssl &amp;&amp; <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 0) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    ldap_proto = LDAP_VERSION2;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    ldap_set_option(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, LDAP_OPT_PROTOCOL_VERSION, &amp;ldap_proto);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_win_bind(conn, <a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, user, passwd);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a5fbb4cfe8c625de094b8f77e55b3f691">ldap_simple_bind_s</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, user, passwd);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 0) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#ifdef USE_WIN32_LDAP</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: bind via ldap_win_bind %s&quot;</span>,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: bind via ldap_simple_bind_s %s&quot;</span>,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#a8c439e9a6cadd244372209ff0a1b59dc">ldap_search_s</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, ludp-&gt;lud_dn, ludp-&gt;lud_scope,</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                     ludp-&gt;lud_filter, ludp-&gt;lud_attrs, 0, &amp;ldapmsg);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != 0 &amp;&amp; <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SIZELIMIT_EXCEEDED) {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP remote: %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">for</span>(num = 0, entryIterator = ldap_first_entry(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, ldapmsg);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      entryIterator;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      entryIterator = ldap_next_entry(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator), num++) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    BerElement *ber = NULL;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    TCHAR *attribute;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">char</span>  *attribute;       </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/* Get the DN and write it to the client */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordtype">size_t</span> name_len;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      TCHAR *dn = <a class="code" href="setup-os400_8h.html#a255292100b84e795282ab770182ddf32">ldap_get_dn</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> = Curl_convert_tchar_to_UTF8(dn);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        ldap_memfree(dn);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordtype">char</span> *dn = <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> = <a class="code" href="setup-os400_8h.html#a255292100b84e795282ab770182ddf32">ldap_get_dn</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      name_len = strlen(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;DN: &quot;</span>, 4);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        Curl_unicodefree(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ldap_memfree(dn);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *) <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>,</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                 name_len);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        Curl_unicodefree(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        ldap_memfree(dn);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 1);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        Curl_unicodefree(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        ldap_memfree(dn);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      dlsize += name_len + 5;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      Curl_unicodefree(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      ldap_memfree(dn);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">/* Get the attributes and write them to the client */</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">for</span>(attribute = <a class="code" href="setup-os400_8h.html#a2587fbf3652690832ee7a1530f4b4a72">ldap_first_attribute</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator, &amp;ber);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        attribute;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        attribute = <a class="code" href="setup-os400_8h.html#ae82d85330f329533276769c56d0f50de">ldap_next_attribute</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator, ber)) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <a class="code" href="setup-os400_8h.html#a0c8480757d81e0ac05e67722a5965a1a">BerValue</a> **vals;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordtype">size_t</span> attr_len;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordtype">char</span> *attr = Curl_convert_tchar_to_UTF8(attribute);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span>(!attr) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          ber_free(ber, 0);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordtype">char</span> *attr = attribute;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      attr_len = strlen(attr);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      vals = <a class="code" href="setup-os400_8h.html#aef10575842ef1465c97b8fdf385a8569">ldap_get_values_len</a>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>, entryIterator, attribute);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">if</span>(vals != NULL) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; (vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] != NULL); <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\t&quot;</span>, 1);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            ldap_value_free_len(vals);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            Curl_unicodefree(attr);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            ldap_memfree(attribute);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;              ber_free(ber, 0);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                     (<span class="keywordtype">char</span> *) attr, attr_len);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            ldap_value_free_len(vals);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            Curl_unicodefree(attr);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            ldap_memfree(attribute);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;              ber_free(ber, 0);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;: &quot;</span>, 2);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            ldap_value_free_len(vals);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            Curl_unicodefree(attr);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            ldap_memfree(attribute);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              ber_free(ber, 0);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          dlsize += attr_len + 3;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <span class="keywordflow">if</span>((attr_len &gt; 7) &amp;&amp;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;             (strcmp(<span class="stringliteral">&quot;;binary&quot;</span>, (<span class="keywordtype">char</span> *) attr + (attr_len - 7)) == 0)) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="comment">/* Binary attribute, encode to base64. */</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                        vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;bv_val,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                        vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;bv_len,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                        &amp;val_b64,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                        &amp;val_b64_sz);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              ldap_value_free_len(vals);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              Curl_unicodefree(attr);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;              ldap_memfree(attribute);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                ber_free(ber, 0);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">if</span>(val_b64_sz &gt; 0) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;              <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, val_b64,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                         val_b64_sz);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;              <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(val_b64);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;              <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                ldap_value_free_len(vals);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                Curl_unicodefree(attr);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                ldap_memfree(attribute);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                  ber_free(ber, 0);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;              }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              dlsize += val_b64_sz;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;bv_val,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                       vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;bv_len);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;              ldap_value_free_len(vals);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;              Curl_unicodefree(attr);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;              ldap_memfree(attribute);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;              <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                ber_free(ber, 0);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;              <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            dlsize += vals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]-&gt;bv_len;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 1);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            ldap_value_free_len(vals);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            Curl_unicodefree(attr);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            ldap_memfree(attribute);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;              ber_free(ber, 0);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          dlsize++;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment">/* Free memory used to store values */</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        ldap_value_free_len(vals);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="comment">/* Free the attribute as we are done with it */</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      Curl_unicodefree(attr);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      ldap_memfree(attribute);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 1);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      dlsize++;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="progress_8c.html#afd65889574fb7bde6ffcec48b0d8debb">Curl_pgrsSetDownloadCounter</a>(<a class="code" href="structdata.html">data</a>, dlsize);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span>(ber)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;       ber_free(ber, 0);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;quit:</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span>(ldapmsg) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    ldap_msgfree(ldapmsg);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a>((<span class="stringliteral">&quot;Received %d entries\n&quot;</span>, num));</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == LDAP_SIZELIMIT_EXCEEDED)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;There are more than %d entries\n&quot;</span>, num);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span>(ludp)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">ldap_free_urldesc</a>(ludp);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    ldap_unbind_s(<a class="code" href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#if defined(HAVE_LDAP_SSL) &amp;&amp; defined(CURL_HAS_NOVELL_LDAPSDK)</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span>(ldap_ssl)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    ldapssl_client_deinit();</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_LDAP_SSL &amp;&amp; CURL_HAS_NOVELL_LDAPSDK */</span><span class="preprocessor"></span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  Curl_unicodefree(<a class="code" href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">/* no data to transfer */</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, -1, -1, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL, -1, NULL);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <a class="code" href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a>(conn, <span class="stringliteral">&quot;LDAP connection always disable re-use&quot;</span>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;}</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#ifdef DEBUG_LDAP</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _ldap_trace(<span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> do_trace = -1;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  va_list args;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span>(do_trace == -1) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *env = <a class="code" href="setup-vms_8h.html#aafc8c101dfb6313ab0416a6c5903ce66">getenv</a>(<span class="stringliteral">&quot;CURL_TRACE&quot;</span>);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    do_trace = (env &amp;&amp; strtol(env, NULL, 10) &gt; 0);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span>(!do_trace)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  va_start(args, fmt);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <a class="code" href="curl__printf_8h.html#a8fdc4bb69d2ce8fe042b88eae7160e6e">vfprintf</a>(stderr, fmt, args);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  va_end(args);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;}</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#ifndef HAVE_LDAP_URL_PARSE</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"> * Return scope-value for a scope-string.</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> str2scope(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;{</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="stringliteral">&quot;one&quot;</span>))</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">return</span> LDAP_SCOPE_ONELEVEL;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="stringliteral">&quot;onetree&quot;</span>))</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">return</span> LDAP_SCOPE_ONELEVEL;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="stringliteral">&quot;base&quot;</span>))</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">return</span> LDAP_SCOPE_BASE;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="stringliteral">&quot;sub&quot;</span>))</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">return</span> LDAP_SCOPE_SUBTREE;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="stringliteral">&quot;subtree&quot;</span>))</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">return</span> LDAP_SCOPE_SUBTREE;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">return</span> (-1);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"> * Split &#39;str&#39; into strings separated by commas.</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"> * Note: out[] points into &#39;str&#39;.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> split_str(<span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="keywordtype">char</span> ***out, <span class="keywordtype">size_t</span> *count)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;{</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordtype">char</span> **res;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">char</span> *lasts;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordtype">char</span> *s;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordtype">size_t</span>  <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordtype">size_t</span> items = 1;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  s = strchr(<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">while</span>(s) {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    items++;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    s = strchr(++s, <span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  res = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(items, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">if</span>(!res)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0, s = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(<a class="code" href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="stringliteral">&quot;,&quot;</span>, &amp;lasts); s &amp;&amp; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; items;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      s = <a class="code" href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a>(NULL, <span class="stringliteral">&quot;,&quot;</span>, &amp;lasts), <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    res[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = s;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  *out = res;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  *count = items;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> * Break apart the pieces of an LDAP URL.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> * Syntax:</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> *   ldap://&lt;hostname&gt;:&lt;port&gt;/&lt;base_dn&gt;?&lt;attributes&gt;?&lt;scope&gt;?&lt;filter&gt;?&lt;ext&gt;</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"> * &lt;hostname&gt; already known from &#39;conn-&gt;host.name&#39;.</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"> * &lt;port&gt;     already known from &#39;conn-&gt;remote_port&#39;.</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"> * extract the rest from &#39;conn-&gt;data-&gt;state.path+1&#39;. All fields are optional.</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> * e.g.</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"> *   ldap://&lt;hostname&gt;:&lt;port&gt;/?&lt;attributes&gt;?&lt;scope&gt;?&lt;filter&gt;</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"> * yields ludp-&gt;lud_dn = &quot;&quot;.</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"> * Defined in RFC4516 section 2.</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> _ldap_url_parse2(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_SUCCESS;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">char</span> *q;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span>(!conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a> ||</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;     !conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#a690e03b393cd252ee5c6aa4a3d1b2126">up</a>.<a class="code" href="structurlpieces.html#aceda10d12cbc9388f7af407287b2333e">path</a> ||</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;     conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#a690e03b393cd252ee5c6aa4a3d1b2126">up</a>.<a class="code" href="structurlpieces.html#aceda10d12cbc9388f7af407287b2333e">path</a>[0] != <span class="charliteral">&#39;/&#39;</span> ||</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;     !<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(<span class="stringliteral">&quot;LDAP&quot;</span>, conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#a690e03b393cd252ee5c6aa4a3d1b2126">up</a>.<a class="code" href="structurlpieces.html#ae4d8065c09a9c92e17a42d0c32435846">scheme</a>))</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">return</span> LDAP_INVALID_SYNTAX;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  ludp-&gt;lud_scope = LDAP_SCOPE_BASE;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  ludp-&gt;lud_port  = conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  ludp-&gt;lud_host  = conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">/* Duplicate the path */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = <a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a> = <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">state</a>.<a class="code" href="struct_url_state.html#a690e03b393cd252ee5c6aa4a3d1b2126">up</a>.<a class="code" href="structurlpieces.html#aceda10d12cbc9388f7af407287b2333e">path</a> + 1);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">return</span> LDAP_NO_MEMORY;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">/* Parse the DN (Distinguished Name) */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  q = strchr(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span>(q)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">char</span> *dn = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">char</span> *unescaped;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a>((<span class="stringliteral">&quot;DN &#39;%s&#39;\n&quot;</span>, dn));</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">/* Unescape the DN */</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, dn, 0, &amp;unescaped, NULL, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">/* Convert the unescaped string to a tchar */</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    ludp-&gt;lud_dn = Curl_convert_UTF8_to_tchar(unescaped);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">/* Free the unescaped string as we are done with it */</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    Curl_unicodefree(unescaped);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">if</span>(!ludp-&gt;lud_dn) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    ludp-&gt;lud_dn = unescaped;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = q;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>)</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">/* Parse the attributes. skip &quot;??&quot; */</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  q = strchr(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordflow">if</span>(q)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">if</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordtype">char</span> **<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">size_t</span> count = 0;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">/* Split the string into an array of attributes */</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span>(!split_str(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, &amp;<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>, &amp;count)) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">/* Allocate our array (+1 for the NULL entry) */</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    ludp-&gt;lud_attrs = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(count + 1, <span class="keyword">sizeof</span>(TCHAR *));</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    ludp-&gt;lud_attrs = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(count + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span>(!ludp-&gt;lud_attrs) {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; count; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordtype">char</span> *unescaped;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <a class="code" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a>((<span class="stringliteral">&quot;attr[%d] &#39;%s&#39;\n&quot;</span>, <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>, <a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="comment">/* Unescape the attribute */</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>], 0, &amp;unescaped, NULL,</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                              <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="comment">/* Convert the unescaped string to a tchar */</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      ludp-&gt;lud_attrs[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = Curl_convert_UTF8_to_tchar(unescaped);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="comment">/* Free the unescaped string as we are done with it */</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      Curl_unicodefree(unescaped);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keywordflow">if</span>(!ludp-&gt;lud_attrs[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      ludp-&gt;lud_attrs[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>] = unescaped;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      ludp-&gt;lud_attrs_dups++;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = q;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">/* Parse the scope. skip &quot;??&quot; */</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  q = strchr(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">if</span>(q)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    ludp-&gt;lud_scope = str2scope(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span>(ludp-&gt;lud_scope == -1) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_INVALID_SYNTAX;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a>((<span class="stringliteral">&quot;scope %d\n&quot;</span>, ludp-&gt;lud_scope));</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = q;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="comment">/* Parse the filter */</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  q = strchr(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, <span class="charliteral">&#39;?&#39;</span>);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">if</span>(q)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">if</span>(*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordtype">char</span> *filter = <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordtype">char</span> *unescaped;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a>((<span class="stringliteral">&quot;filter &#39;%s&#39;\n&quot;</span>, filter));</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">/* Unescape the filter */</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, filter, 0, &amp;unescaped, NULL, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="preprocessor">#if defined(USE_WIN32_LDAP)</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">/* Convert the unescaped string to a tchar */</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    ludp-&gt;lud_filter = Curl_convert_UTF8_to_tchar(unescaped);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">/* Free the unescaped string as we are done with it */</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    Curl_unicodefree(unescaped);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">if</span>(!ludp-&gt;lud_filter) {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_NO_MEMORY;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    ludp-&gt;lud_filter = unescaped;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = q;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> &amp;&amp; !*<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>) {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = LDAP_INVALID_SYNTAX;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">goto</span> quit;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;quit:</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a>);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> _ldap_url_parse(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                           <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> **ludpp)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(*ludp));</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  *ludpp = NULL;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">if</span>(!ludp)</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;     <span class="keywordflow">return</span> LDAP_NO_MEMORY;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = _ldap_url_parse2(conn, ludp);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    _ldap_free_urldesc(ludp);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    ludp = NULL;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  *ludpp = ludp;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;}</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> _ldap_free_urldesc(<a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp)</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;{</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">if</span>(!ludp)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ludp-&gt;lud_dn);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ludp-&gt;lud_filter);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">if</span>(ludp-&gt;lud_attrs) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> &lt; ludp-&gt;lud_attrs_dups; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++)</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ludp-&gt;lud_attrs[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ludp-&gt;lud_attrs);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  }</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(ludp);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;}</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">/* !HAVE_LDAP_URL_PARSE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">/* !CURL_DISABLE_LDAP &amp;&amp; !USE_OPENLDAP */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="anyauth_8d_html_a7eb9744e157c215b8e0de36856880ebf"><div class="ttname"><a href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response thus possibly inducing an extra network round trip.This is used instead of setting a specific authentication method</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="curl__multibyte_8h_html"><div class="ttname"><a href="curl__multibyte_8h.html">curl_multibyte.h</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a15aced4a015c44ff454787debee23520"><div class="ttname"><a href="struct_curl__easy.html#a15aced4a015c44ff454787debee23520">Curl_easy::state</a></div><div class="ttdeci">struct UrlState state</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01795">urldata.h:1795</a></div></div>
<div class="ttc" id="sendf_8h_html_aae18389dfefc98a5057629f6a46fd78f"><div class="ttname"><a href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a></div><div class="ttdeci">#define CLIENTWRITE_BODY</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00050">sendf.h:50</a></div></div>
<div class="ttc" id="structconnectdata_html_a9312f162d29fe7f59bc2b5dbeda85d9d"><div class="ttname"><a href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">connectdata::bits</a></div><div class="ttdeci">struct ConnectBits bits</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00894">urldata.h:894</a></div></div>
<div class="ttc" id="escape_8c_html_a11aa4921a19102059a1d94e2be15477a"><div class="ttname"><a href="escape_8c.html#a11aa4921a19102059a1d94e2be15477a">Curl_urldecode</a></div><div class="ttdeci">CURLcode Curl_urldecode(struct Curl_easy *data, const char *string, size_t length, char **ostring, size_t *olen, bool reject_ctrl)</div><div class="ttdef"><b>Definition:</b> <a href="escape_8c_source.html#l00147">escape.c:147</a></div></div>
<div class="ttc" id="setup-vms_8h_html_aafc8c101dfb6313ab0416a6c5903ce66"><div class="ttname"><a href="setup-vms_8h.html#aafc8c101dfb6313ab0416a6c5903ce66">getenv</a></div><div class="ttdeci">#define getenv</div><div class="ttdef"><b>Definition:</b> <a href="setup-vms_8h_source.html#l00052">setup-vms.h:52</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a5fbb4cfe8c625de094b8f77e55b3f691"><div class="ttname"><a href="setup-os400_8h.html#a5fbb4cfe8c625de094b8f77e55b3f691">ldap_simple_bind_s</a></div><div class="ttdeci">#define ldap_simple_bind_s</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00192">setup-os400.h:192</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a6e98ab70d0724c67536f2f2cebd8f5a6"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a6e98ab70d0724c67536f2f2cebd8f5a6">CURLE_LDAP_INVALID_URL</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00534">curl.h:534</a></div></div>
<div class="ttc" id="curl_8h_html_a71a1fde704d583a1f5dc57f77f1e957b"><div class="ttname"><a href="curl_8h.html#a71a1fde704d583a1f5dc57f77f1e957b">CURLAUTH_BASIC</a></div><div class="ttdeci">#define CURLAUTH_BASIC</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00706">curl.h:706</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="connect_8h_html_a0f98be540dd5a5f56c9ec98dc2489661"><div class="ttname"><a href="connect_8h.html#a0f98be540dd5a5f56c9ec98dc2489661">connclose</a></div><div class="ttdeci">#define connclose(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8h_source.html#l00145">connect.h:145</a></div></div>
<div class="ttc" id="strtok_8h_html"><div class="ttname"><a href="strtok_8h.html">strtok.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00508">curl.h:508</a></div></div>
<div class="ttc" id="structurlpieces_html_ae4d8065c09a9c92e17a42d0c32435846"><div class="ttname"><a href="structurlpieces.html#ae4d8065c09a9c92e17a42d0c32435846">urlpieces::scheme</a></div><div class="ttdeci">char * scheme</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01230">urldata.h:1230</a></div></div>
<div class="ttc" id="struct_curl__handler_html"><div class="ttname"><a href="struct_curl__handler.html">Curl_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00628">urldata.h:628</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a7b1be18084f5fa42645c28a34b75d166"><div class="ttname"><a href="structssl__primary__config.html#a7b1be18084f5fa42645c28a34b75d166">ssl_primary_config::verifypeer</a></div><div class="ttdeci">bool verifypeer</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00212">urldata.h:212</a></div></div>
<div class="ttc" id="connect_8h_html"><div class="ttname"><a href="connect_8h.html">connect.h</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a8c439e9a6cadd244372209ff0a1b59dc"><div class="ttname"><a href="setup-os400_8h.html#a8c439e9a6cadd244372209ff0a1b59dc">ldap_search_s</a></div><div class="ttdeci">#define ldap_search_s</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00193">setup-os400.h:193</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="base64_8c_html_a1208ff63d0b4ca9cead4a3cdefc033c2"><div class="ttname"><a href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a></div><div class="ttdeci">CURLcode Curl_base64_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00290">base64.c:290</a></div></div>
<div class="ttc" id="ldap_8c_html_aa1253b14602d68a70ca20be27d768594"><div class="ttname"><a href="ldap_8c.html#aa1253b14602d68a70ca20be27d768594">Curl_handler_ldap</a></div><div class="ttdeci">const struct Curl_handler Curl_handler_ldap</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00129">ldap.c:129</a></div></div>
<div class="ttc" id="setup-os400_8h_html_aef10575842ef1465c97b8fdf385a8569"><div class="ttname"><a href="setup-os400_8h.html#aef10575842ef1465c97b8fdf385a8569">ldap_get_values_len</a></div><div class="ttdeci">#define ldap_get_values_len</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00194">setup-os400.h:194</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_a0b279f1e8f87a918c487686199e283e2"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a0b279f1e8f87a918c487686199e283e2">CURL_LDAPURLDesc::lud_filter</a></div><div class="ttdeci">char * lud_filter</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00092">ldap.c:92</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_a1bf03a669277a09d1efc91a0ed3f3897"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a1bf03a669277a09d1efc91a0ed3f3897">CURL_LDAPURLDesc::lud_port</a></div><div class="ttdeci">int lud_port</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00080">ldap.c:80</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_a519259723457d39272d3ae1222aff967"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a519259723457d39272d3ae1222aff967">CURL_LDAPURLDesc::lud_attrs</a></div><div class="ttdeci">char ** lud_attrs</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00086">ldap.c:86</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="urldata_8h_html_acbe3a40e399b4d170f2bee3500e1b0a4"><div class="ttname"><a href="urldata_8h.html#acbe3a40e399b4d170f2bee3500e1b0a4">PORT_LDAPS</a></div><div class="ttdeci">#define PORT_LDAPS</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00036">urldata.h:36</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="quote_8d_html_a69d5aa4d733b2b50a0834bb67eff84cf"><div class="ttname"><a href="quote_8d.html#a69d5aa4d733b2b50a0834bb67eff84cf">server</a></div><div class="ttdeci">Long to be exact.To make commands take place after a successful prefix them with a dash.To make commands be sent after curl has changed the working just before the transfer prefix the command with the entire operation will be aborted.You must send syntactically correct FTP commands as RFC defines to FTP or one of the commands listed below to SFTP servers.This option can be used multiple times.When speaking to an FTP server</div><div class="ttdef"><b>Definition:</b> <a href="quote_8d_source.html#l00017">quote.d:17</a></div></div>
<div class="ttc" id="components_2curl_2include_2curl_2_system_8h_html_a494e2b4279dc064f7ed1d0abd602b28d"><div class="ttname"><a href="components_2curl_2include_2curl_2_system_8h.html#a494e2b4279dc064f7ed1d0abd602b28d">curl_off_t</a></div><div class="ttdeci">CURL_TYPEOF_CURL_OFF_T curl_off_t</div><div class="ttdef"><b>Definition:</b> <a href="components_2curl_2include_2curl_2_system_8h_source.html#l00442">system.h:442</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="structconnectdata_html_a4bb3a85b09c8a63a0b526a24f9b1897a"><div class="ttname"><a href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">connectdata::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00864">urldata.h:864</a></div></div>
<div class="ttc" id="urldata_8h_html_ad851f566879d5b859ec9181a21318b64"><div class="ttname"><a href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a></div><div class="ttdeci">#define PROTOPT_SSL</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00706">urldata.h:706</a></div></div>
<div class="ttc" id="ldap_8c_html_aa334b56d2c4f63b26c0ab30339cae195"><div class="ttname"><a href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a></div><div class="ttdeci">#define LDAPURLDesc</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00101">ldap.c:101</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="curl_8h_html_a2947f26fc8cf96c0e438edb33e9e39ae"><div class="ttname"><a href="curl_8h.html#a2947f26fc8cf96c0e438edb33e9e39ae">CURLAUTH_NEGOTIATE</a></div><div class="ttdeci">#define CURLAUTH_NEGOTIATE</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00708">curl.h:708</a></div></div>
<div class="ttc" id="struct_curl__handler_html_ac77e1b77c701181a1ba5e58922504524"><div class="ttname"><a href="struct_curl__handler.html#ac77e1b77c701181a1ba5e58922504524">Curl_handler::done</a></div><div class="ttdeci">Curl_done_func done</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00636">urldata.h:636</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a5ffb4b97de06318ffbd19405b18494f9">CURLE_SSL_CERTPROBLEM</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00529">curl.h:529</a></div></div>
<div class="ttc" id="curlx_8c_html_af6458f5d187f1d7c82fb9ea7ef634b44"><div class="ttname"><a href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a></div><div class="ttdeci">#define ZERO_NULL</div><div class="ttdef"><b>Definition:</b> <a href="curlx_8c_source.html#l00131">curlx.c:131</a></div></div>
<div class="ttc" id="progress_8h_html"><div class="ttname"><a href="progress_8h.html">progress.h</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_ab5f094ac9d53f7b2b644eb5fc4c85199"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#ab5f094ac9d53f7b2b644eb5fc4c85199">CURL_LDAPURLDesc::lud_host</a></div><div class="ttdeci">char * lud_host</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00079">ldap.c:79</a></div></div>
<div class="ttc" id="transfer_8c_html_a8ccd1948f2a90c90b6fd1ac993e44a32"><div class="ttname"><a href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a></div><div class="ttdeci">void Curl_setup_transfer(struct connectdata *conn, int sockindex, curl_off_t size, bool getheader, curl_off_t *bytecountp, int writesockindex, curl_off_t *writecountp)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l01743">transfer.c:1743</a></div></div>
<div class="ttc" id="unit1398_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="unit1398_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00033">unit1398.c:33</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="ldap_8c_html_acbf296f815887ee0c2146ffaa4649c36"><div class="ttname"><a href="ldap_8c.html#acbf296f815887ee0c2146ffaa4649c36">LDAP_TRACE</a></div><div class="ttdeci">#define LDAP_TRACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00119">ldap.c:119</a></div></div>
<div class="ttc" id="setup-os400_8h_html_aca3b733600772d0ed1c2401838972aab"><div class="ttname"><a href="setup-os400_8h.html#aca3b733600772d0ed1c2401838972aab">ldap_url_parse</a></div><div class="ttdeci">#define ldap_url_parse</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00190">setup-os400.h:190</a></div></div>
<div class="ttc" id="curl_8h_html_a5588596e963ddd108786b3e331eb09e4"><div class="ttname"><a href="curl_8h.html#a5588596e963ddd108786b3e331eb09e4">CURLPROTO_LDAP</a></div><div class="ttdeci">#define CURLPROTO_LDAP</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00872">curl.h:872</a></div></div>
<div class="ttc" id="curl_8h_html_aed470ee20e1ed4de6ca0c00708679512"><div class="ttname"><a href="curl_8h.html#aed470ee20e1ed4de6ca0c00708679512">CURLPROTO_LDAPS</a></div><div class="ttdeci">#define CURLPROTO_LDAPS</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00873">curl.h:873</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a7174c428ee924e167e8abb129c3e4c47"><div class="ttname"><a href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a></div><div class="ttdeci">#define ldap_err2string</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00195">setup-os400.h:195</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html">CURL_LDAPURLDesc</a></div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00078">ldap.c:78</a></div></div>
<div class="ttc" id="remote-name_8d_html_aa335f8bb20424b03700f57b150bf0aa6"><div class="ttname"><a href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a></div><div class="ttdeci">Long the path is cut off.The file will be saved in the current working directory.If you want the file saved in a different make sure you change the current working directory before invoking curl with this option.The remote file name to use for saving is extracted from the given nothing and if it already exists it will be overwritten.If you want the server to be able to choose the file name refer to remote header name which can be used in addition to this option.If the server chooses a file name and that name already exists it will not be overwritten.There is no URL decoding done on the file name.If it has or other URL encoded parts of the name</div><div class="ttdef"><b>Definition:</b> <a href="remote-name_8d_source.html#l00006">remote-name.d:6</a></div></div>
<div class="ttc" id="structtimeval_html"><div class="ttname"><a href="structtimeval.html">timeval</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00109">curl_setup_once.h:109</a></div></div>
<div class="ttc" id="url_8d_html_a9ae159ca78135eda1daa81b380b16a71"><div class="ttname"><a href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a></div><div class="ttdeci">Long LDAP</div><div class="ttdef"><b>Definition:</b> <a href="url_8d_source.html#l00010">url.d:10</a></div></div>
<div class="ttc" id="curl__printf_8h_html_a8fdc4bb69d2ce8fe042b88eae7160e6e"><div class="ttname"><a href="curl__printf_8h.html#a8fdc4bb69d2ce8fe042b88eae7160e6e">vfprintf</a></div><div class="ttdeci">#define vfprintf</div><div class="ttdef"><b>Definition:</b> <a href="curl__printf_8h_source.html#l00044">curl_printf.h:44</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a27893953ce895e5a66dc2209d01ae59a"><div class="ttname"><a href="setup-os400_8h.html#a27893953ce895e5a66dc2209d01ae59a">ldap_init</a></div><div class="ttdeci">#define ldap_init</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00191">setup-os400.h:191</a></div></div>
<div class="ttc" id="curl_8h_html_ab0e8299ededa678028a9e5796b0f77ce"><div class="ttname"><a href="curl_8h.html#ab0e8299ededa678028a9e5796b0f77ce">CURLAUTH_NTLM</a></div><div class="ttdeci">#define CURLAUTH_NTLM</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00713">curl.h:713</a></div></div>
<div class="ttc" id="ldap_8c_html_acaa480fe588a3687fdbac0ec502d8c0a"><div class="ttname"><a href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">ldap_free_urldesc</a></div><div class="ttdeci">#define ldap_free_urldesc</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00108">ldap.c:108</a></div></div>
<div class="ttc" id="structconnectdata_html_a878ad8b625208d9aa421852225c33b30"><div class="ttname"><a href="structconnectdata.html#a878ad8b625208d9aa421852225c33b30">connectdata::given</a></div><div class="ttdeci">const struct Curl_handler * given</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00906">urldata.h:906</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_a7348af0266ef975c61dfe097d7b61724"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#a7348af0266ef975c61dfe097d7b61724">CURL_LDAPURLDesc::lud_dn</a></div><div class="ttdeci">char * lud_dn</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00085">ldap.c:85</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_abbabc88410aa87ef3ab1a7ac08336cb9"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#abbabc88410aa87ef3ab1a7ac08336cb9">CURL_LDAPURLDesc::lud_exts</a></div><div class="ttdeci">char ** lud_exts</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00094">ldap.c:94</a></div></div>
<div class="ttc" id="struct_curl__easy_html_abcc5aa61af150adc1388b1a3492c2599"><div class="ttname"><a href="struct_curl__easy.html#abcc5aa61af150adc1388b1a3492c2599">Curl_easy::set</a></div><div class="ttdeci">struct UserDefined set</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01788">urldata.h:1788</a></div></div>
<div class="ttc" id="curl__ldap_8h_html"><div class="ttname"><a href="curl__ldap_8h.html">curl_ldap.h</a></div></div>
<div class="ttc" id="sendf_8c_html_ad59954133649b7538b387f940b86024f"><div class="ttname"><a href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a></div><div class="ttdeci">CURLcode Curl_client_write(struct connectdata *conn, int type, char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00651">sendf.c:651</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a255292100b84e795282ab770182ddf32"><div class="ttname"><a href="setup-os400_8h.html#a255292100b84e795282ab770182ddf32">ldap_get_dn</a></div><div class="ttdeci">#define ldap_get_dn</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00196">setup-os400.h:196</a></div></div>
<div class="ttc" id="urldata_8h_html_a06e40f8f1e2219fb5b519c74715c3537"><div class="ttname"><a href="urldata_8h.html#a06e40f8f1e2219fb5b519c74715c3537">PROTOPT_NONE</a></div><div class="ttdeci">#define PROTOPT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00705">urldata.h:705</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="unit1652_8c_html_a1d19b0eef3b3acd31be88886a0277c2e"><div class="ttname"><a href="unit1652_8c.html#a1d19b0eef3b3acd31be88886a0277c2e">memset</a></div><div class="ttdeci">memset(input, '\0', sizeof(input))</div></div>
<div class="ttc" id="header_8d_html_a1fa2fe05139b1bad1ba9f137f51a222f"><div class="ttname"><a href="header_8d.html#a1fa2fe05139b1bad1ba9f137f51a222f">host</a></div><div class="ttdeci">to send X Custom you should thus fBnot fP add that as a part of the header they will only mess things up for you.Starting this option can take an argument in filename which then adds a header for each line in the input file.Using will make curl read the header file from stdin.See also the user agent and referer options.Starting you need proxy header to send custom headers intended for a proxy.like when told with location.This can lead to the header being sent to other hosts than the original host</div><div class="ttdef"><b>Definition:</b> <a href="header_8d_source.html#l00019">header.d:19</a></div></div>
<div class="ttc" id="strtok_8h_html_abff4e21c5a2026f9982e88f1e686e63a"><div class="ttname"><a href="strtok_8h.html#abff4e21c5a2026f9982e88f1e686e63a">strtok_r</a></div><div class="ttdeci">#define strtok_r</div><div class="ttdef"><b>Definition:</b> <a href="strtok_8h_source.html#l00029">strtok.h:29</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00466">curl.h:466</a></div></div>
<div class="ttc" id="xattr_8d_html_a822052b02ed5257a6cbb09a6148d2426"><div class="ttname"><a href="xattr_8d.html#a822052b02ed5257a6cbb09a6148d2426">attributes</a></div><div class="ttdeci">Long this option tells curl to store certain file metadata in extended file attributes.the URL is stored in the xdg.origin.url attribute for the content type is stored in the mime_type attribute.If the file system does not support extended attributes</div><div class="ttdef"><b>Definition:</b> <a href="xattr_8d_source.html#l00004">xattr.d:4</a></div></div>
<div class="ttc" id="progress_8c_html_afd65889574fb7bde6ffcec48b0d8debb"><div class="ttname"><a href="progress_8c.html#afd65889574fb7bde6ffcec48b0d8debb">Curl_pgrsSetDownloadCounter</a></div><div class="ttdeci">void Curl_pgrsSetDownloadCounter(struct Curl_easy *data, curl_off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="progress_8c_source.html#l00306">progress.c:306</a></div></div>
<div class="ttc" id="structurlpieces_html_aceda10d12cbc9388f7af407287b2333e"><div class="ttname"><a href="structurlpieces.html#aceda10d12cbc9388f7af407287b2333e">urlpieces::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01236">urldata.h:1236</a></div></div>
<div class="ttc" id="structconnectdata_html_a4acb6315f331c234b0bdbfd4b1a402e7"><div class="ttname"><a href="structconnectdata.html#a4acb6315f331c234b0bdbfd4b1a402e7">connectdata::ssl_config</a></div><div class="ttdeci">struct ssl_primary_config ssl_config</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00890">urldata.h:890</a></div></div>
<div class="ttc" id="setup-os400_8h_html_ae82d85330f329533276769c56d0f50de"><div class="ttname"><a href="setup-os400_8h.html#ae82d85330f329533276769c56d0f50de">ldap_next_attribute</a></div><div class="ttdeci">#define ldap_next_attribute</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00198">setup-os400.h:198</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a2fc887b2697c63980406a19108b82a24"><div class="ttname"><a href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">Curl_handler::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00702">urldata.h:702</a></div></div>
<div class="ttc" id="transfer_8h_html"><div class="ttname"><a href="transfer_8h.html">transfer.h</a></div></div>
<div class="ttc" id="escape_8h_html"><div class="ttname"><a href="escape_8h.html">escape.h</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="structssl__primary__config_html_a78312575bac5d2efa2ca67246b06fad7"><div class="ttname"><a href="structssl__primary__config.html#a78312575bac5d2efa2ca67246b06fad7">ssl_primary_config::CAfile</a></div><div class="ttdeci">char * CAfile</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00217">urldata.h:217</a></div></div>
<div class="ttc" id="struct_url_state_html_a690e03b393cd252ee5c6aa4a3d1b2126"><div class="ttname"><a href="struct_url_state.html#a690e03b393cd252ee5c6aa4a3d1b2126">UrlState::up</a></div><div class="ttdeci">struct urlpieces up</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01364">urldata.h:1364</a></div></div>
<div class="ttc" id="urldata_8h_html_a4d9c4d843ff2d52be6c16d1fa1033184"><div class="ttname"><a href="urldata_8h.html#a4d9c4d843ff2d52be6c16d1fa1033184">PORT_LDAP</a></div><div class="ttdeci">#define PORT_LDAP</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00035">urldata.h:35</a></div></div>
<div class="ttc" id="structconnectdata_html_ac9d24fcd15a4c660fa7b6fbf55f6451d"><div class="ttname"><a href="structconnectdata.html#ac9d24fcd15a4c660fa7b6fbf55f6451d">connectdata::port</a></div><div class="ttdeci">long port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00839">urldata.h:839</a></div></div>
<div class="ttc" id="curl_8h_html_ae8273f5a281c589c89d0d3ab2f565a93"><div class="ttname"><a href="curl_8h.html#ae8273f5a281c589c89d0d3ab2f565a93">CURLAUTH_DIGEST</a></div><div class="ttdeci">#define CURLAUTH_DIGEST</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00707">curl.h:707</a></div></div>
<div class="ttc" id="struct_user_defined_html_aaf7a8f7fb7d239e2532576b36b5ae5f5"><div class="ttname"><a href="struct_user_defined.html#aaf7a8f7fb7d239e2532576b36b5ae5f5">UserDefined::httpauth</a></div><div class="ttdeci">unsigned long httpauth</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01504">urldata.h:1504</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_aac4dcadfd708030eee24722b1724eeee"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#aac4dcadfd708030eee24722b1724eeee">CURL_LDAPURLDesc::lud_attrs_dups</a></div><div class="ttdeci">size_t lud_attrs_dups</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00095">ldap.c:95</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00509">curl.h:509</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a2587fbf3652690832ee7a1530f4b4a72"><div class="ttname"><a href="setup-os400_8h.html#a2587fbf3652690832ee7a1530f4b4a72">ldap_first_attribute</a></div><div class="ttdeci">#define ldap_first_attribute</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00197">setup-os400.h:197</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="structhostname_html_aee7d0ff8210c25b87d6fdeacf8ea7939"><div class="ttname"><a href="structhostname.html#aee7d0ff8210c25b87d6fdeacf8ea7939">hostname::dispname</a></div><div class="ttdeci">const char * dispname</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00450">urldata.h:450</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a3bfd8a5d78dc98e435348b877e19f619"><div class="ttname"><a href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">ConnectBits::user_passwd</a></div><div class="ttdeci">bool user_passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00390">urldata.h:390</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="structconnectdata_html_a82d9732a096255f5d8741c4a0ea990eb"><div class="ttname"><a href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">connectdata::remote_port</a></div><div class="ttdeci">int remote_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00840">urldata.h:840</a></div></div>
<div class="ttc" id="structconnectdata_html_a85cb9da7776d42c440612d2940a7fcb4"><div class="ttname"><a href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">connectdata::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00863">urldata.h:863</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a0c8480757d81e0ac05e67722a5965a1a"><div class="ttname"><a href="setup-os400_8h.html#a0c8480757d81e0ac05e67722a5965a1a">BerValue</a></div><div class="ttdeci">#define BerValue</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00188">setup-os400.h:188</a></div></div>
<div class="ttc" id="struct_c_u_r_l___l_d_a_p_u_r_l_desc_html_adaf79ef53ae0b3c3dac1761206596057"><div class="ttname"><a href="struct_c_u_r_l___l_d_a_p_u_r_l_desc.html#adaf79ef53ae0b3c3dac1761206596057">CURL_LDAPURLDesc::lud_scope</a></div><div class="ttdeci">int lud_scope</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00088">ldap.c:88</a></div></div>
<div class="ttc" id="util_8c_html_a3b02c6de5c049804444a246f7fdf46b4"><div class="ttname"><a href="util_8c.html#a3b02c6de5c049804444a246f7fdf46b4">path</a></div><div class="ttdeci">const char * path</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00194">util.c:194</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="ldap_8c.html">ldap.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
