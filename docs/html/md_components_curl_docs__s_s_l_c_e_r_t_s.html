<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: SSL Certificate Verification</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_components_curl_docs__s_s_l_c_e_r_t_s.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SSL Certificate Verification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>SSL is TLS </h2>
<p>SSL is the old name. It is called TLS these days.</p>
<h2>Native SSL </h2>
<p>If libcurl was built with Schannel or Secure Transport support (the native SSL libraries included in Windows and Mac OS X), then this does not apply to you. Scroll down for details on how the OS-native engines handle SSL certificates. If you're not sure, then run "curl -V" and read the results. If the version string says "WinSSL" in it, then it was built with Schannel support.</p>
<h2>It is about trust </h2>
<p>This system is about trust. In your local CA certificate store you have certs from <em>trusted</em> Certificate Authorities that you then can use to verify that the server certificates you see are valid. They're signed by one of the CAs you trust.</p>
<p>Which CAs do you trust? You can decide to trust the same set of companies your operating system trusts, or the set one of the known browsers trust. That's basically trust via someone else you trust. You should just be aware that modern operating systems and browsers are setup to trust <em>hundreds</em> of companies and recent years several such CAs have been found untrustworthy.</p>
<h2>Certificate Verification </h2>
<p>libcurl performs peer SSL certificate verification by default. This is done by using a CA certificate store that the SSL library can use to make sure the peer's server certificate is valid.</p>
<p>If you communicate with HTTPS, FTPS or other TLS-using servers using certificates that are signed by CAs present in the store, you can be sure that the remote server really is the one it claims to be.</p>
<p>If the remote server uses a self-signed certificate, if you don't install a CA cert store, if the server uses a certificate signed by a CA that isn't included in the store you use or if the remote host is an impostor impersonating your favorite site, and you want to transfer files from this server, do one of the following:</p>
<ol type="1">
<li><p class="startli">Tell libcurl to <em>not</em> verify the peer. With libcurl you disable this with <code><a class="el" href="typecheck-gcc_8h.html#af8d527555aeac344caa3754445c6ecba">curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, FALSE)</a>;</code></p>
<p class="startli">With the curl command line tool, you disable this with -k/&ndash;insecure.</p>
</li>
<li><p class="startli">Get a CA certificate that can verify the remote server and use the proper option to point out this CA cert for verification when connecting. For libcurl hackers: <code><a class="el" href="typecheck-gcc_8h.html#af8d527555aeac344caa3754445c6ecba">curl_easy_setopt(curl, CURLOPT_CAPATH, capath)</a>;</code></p>
<p class="startli">With the curl command line tool: &ndash;cacert [file]</p>
</li>
<li><p class="startli">Add the CA cert for your server to the existing default CA certificate store. The default CA certificate store can changed at compile time with the following configure options:</p>
<p class="startli">&ndash;with-ca-bundle=FILE: use the specified file as CA certificate store. CA certificates need to be concatenated in PEM format into this file.</p>
<p class="startli">&ndash;with-ca-path=PATH: use the specified path as CA certificate store. CA certificates need to be stored as individual PEM files in this directory. You may need to run c_rehash after adding files there.</p>
<p class="startli">If neither of the two options is specified, configure will try to auto-detect a setting. It's also possible to explicitly not hardcode any default store but rely on the built in default the crypto library may provide instead. You can achieve that by passing both &ndash;without-ca-bundle and &ndash;without-ca-path to the configure script.</p>
<p class="startli">If you use Internet Explorer, this is one way to get extract the CA cert for a particular server:</p><ul>
<li>View the certificate by double-clicking the padlock</li>
<li>Find out where the CA certificate is kept (Certificate&gt; Authority Information Access&gt;URL)</li>
<li>Get a copy of the crt file using curl</li>
<li>Convert it from crt to PEM using the openssl tool: openssl x509 -inform DES -in yourdownloaded.crt \ -out outcert.pem -text</li>
<li>Add the 'outcert.pem' to the CA certificate store or use it stand-alone as described below.</li>
</ul>
<p class="startli">If you use the 'openssl' tool, this is one way to get extract the CA cert for a particular server:</p><ul>
<li><code>openssl s_client -showcerts -servername server -connect server:443 &gt; cacert.pem</code></li>
<li>type "quit", followed by the "ENTER" key</li>
<li>The certificate will have "BEGIN CERTIFICATE" and "END CERTIFICATE" markers.</li>
<li>If you want to see the data in the certificate, you can do: "openssl
       x509 -inform PEM -in certfile -text -out certdata" where certfile is the cert you extracted from logfile. Look in certdata.</li>
<li>If you want to trust the certificate, you can add it to your CA certificate store or use it stand-alone as described. Just remember that the security is no better than the way you obtained the certificate.</li>
</ul>
</li>
<li><p class="startli">If you're using the curl command line tool, you can specify your own CA cert path by setting the environment variable <code>CURL_CA_BUNDLE</code> to the path of your choice.</p>
<p class="startli">If you're using the curl command line tool on Windows, curl will search for a CA cert file named "curl-ca-bundle.crt" in these directories and in this order:</p><ol type="a">
<li>application's directory</li>
<li>current working directory</li>
<li>Windows <a class="el" href="class_system.html" title="System wide functions. ">System</a> directory (e.g. C:)</li>
<li>Windows Directory (e.g. C:)</li>
<li>all directories along PATH%</li>
</ol>
</li>
<li>Get a better/different/newer CA cert bundle! One option is to extract the one a recent Firefox browser uses by running 'make ca-bundle' in the curl build tree root, or possibly download a version that was generated this way for you: <a href="https://curl.haxx.se/docs/caextract.html">CA Extract</a></li>
</ol>
<p>Neglecting to use one of the above methods when dealing with a server using a certificate that isn't signed by one of the certificates in the installed CA certificate store, will cause SSL to report an error ("certificate verify
failed") during the handshake and SSL will then refuse further communication with that server.</p>
<h2>Certificate Verification with NSS </h2>
<p>If libcurl was built with NSS support, then depending on the OS distribution, it is probably required to take some additional steps to use the system-wide CA cert db. RedHat ships with an additional module, libnsspem.so, which enables NSS to read the OpenSSL PEM CA bundle. On openSUSE you can install p11-kit-nss-trust which makes NSS use the system wide CA certificate store. NSS also has a new <a href="https://wiki.mozilla.org/NSS_Shared_DB">database format</a>.</p>
<p>Starting with version 7.19.7, libcurl automatically adds the 'sql:' prefix to the certdb directory (either the hardcoded default /etc/pki/nssdb or the directory configured with SSL_DIR environment variable). To check which certdb format your distribution provides, examine the default certdb location: /etc/pki/nssdb; the new certdb format can be identified by the filenames cert9.db, key4.db, pkcs11.txt; filenames of older versions are cert8.db, key3.db, secmod.db.</p>
<h2>Certificate Verification with Schannel and Secure Transport </h2>
<p>If libcurl was built with Schannel (Microsoft's native TLS engine) or Secure Transport (Apple's native TLS engine) support, then libcurl will still perform peer certificate verification, but instead of using a CA cert bundle, it will use the certificates that are built into the OS. These are the same certificates that appear in the Internet <a class="el" href="struct_options.html">Options</a> control panel (under Windows) or Keychain Access application (under OS X). Any custom security rules for certificates will be honored.</p>
<p>Schannel will run CRL checks on certificates unless peer verification is disabled. Secure Transport on iOS will run OCSP checks on certificates unless peer verification is disabled. Secure Transport on OS X will run either OCSP or CRL checks on certificates if those features are enabled, and this behavior can be adjusted in the preferences of Keychain Access.</p>
<h2>HTTPS proxy </h2>
<p>Since version 7.52.0, curl can do HTTPS to the proxy separately from the connection to the server. This TLS connection is handled separately from the server connection so instead of <code>--insecure</code> and <code>--cacert</code> to control the certificate verification, you use <code>--proxy-insecure</code> and <code>--proxy-cacert</code>. With these options, you make sure that the TLS connection and the trust of the proxy can be kept totally separate from the TLS connection to the server. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
