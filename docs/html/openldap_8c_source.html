<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/openldap.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('openldap_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">openldap.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="openldap_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                      _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project         ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                 / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                 \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 2010, Howard Chu, &lt;hyc@openldap.org&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Copyright (C) 2011 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#if !defined(CURL_DISABLE_LDAP) &amp;&amp; defined(USE_OPENLDAP)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * Notice that USE_OPENLDAP is only a source code selection switch. When</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * libcurl is built with USE_OPENLDAP defined the libcurl source code that</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * gets compiled is the code from openldap.c, otherwise the code that gets</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * compiled is the code from ldap.c.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * When USE_OPENLDAP is defined a recent version of the OpenLDAP library</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * might be required for compilation and runtime. In order to use ancient</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * OpenLDAP library versions, USE_OPENLDAP shall not be defined.</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;ldap.h&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vtls_8h.html">vtls/vtls.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="transfer_8h.html">transfer.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__ldap_8h.html">curl_ldap.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__base64_8h.html">curl_base64.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connect_8h.html">connect.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/* The last 3 #include files should be in this order */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__printf_8h.html">curl_printf.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * Uncommenting this will enable the built-in debug logging of the openldap</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * library. The debug log level can be set using the CURL_OPENLDAP_TRACE</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * environment variable. The debug output is written to stderr.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> * The library supports the following debug flags:</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> * LDAP_DEBUG_NONE         0x0000</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * LDAP_DEBUG_TRACE        0x0001</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * LDAP_DEBUG_CONSTRUCT    0x0002</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> * LDAP_DEBUG_DESTROY      0x0004</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * LDAP_DEBUG_PARAMETER    0x0008</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> * LDAP_DEBUG_ANY          0xffff</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> * For example, use CURL_OPENLDAP_TRACE=0 for no debug,</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> * CURL_OPENLDAP_TRACE=2 for LDAP_DEBUG_CONSTRUCT messages only,</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * CURL_OPENLDAP_TRACE=65535 for all debug message levels.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/* #define CURL_OPENLDAP_DEBUG */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#ifndef _LDAP_PVT_H</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> ldap_pvt_url_scheme2proto(<span class="keyword">const</span> <span class="keywordtype">char</span> *);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> ldap_init_fd(ber_socket_t fd, <span class="keywordtype">int</span> <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a>,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        <a class="code" href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a> **ld);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_setup_connection(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_done(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a>, <span class="keywordtype">bool</span>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_connecting(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_disconnect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> dead);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">static</span> <a class="code" href="urldata_8h.html#ad073adb2b5b8a2f9ab8eb0dcae415efc">Curl_recv</a> ldap_recv;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> * LDAP protocol handler.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> <a class="code" href="curl__ldap_8h.html#aa1253b14602d68a70ca20be27d768594">Curl_handler_ldap</a> = {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="stringliteral">&quot;LDAP&quot;</span>,                               <span class="comment">/* scheme */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  ldap_setup_connection,                <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ldap_do,                              <span class="comment">/* do_it */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  ldap_done,                            <span class="comment">/* done */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ldap_connect,                         <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  ldap_connecting,                      <span class="comment">/* connecting */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  ldap_disconnect,                      <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="urldata_8h.html#a4d9c4d843ff2d52be6c16d1fa1033184">PORT_LDAP</a>,                            <span class="comment">/* defport */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="curl_8h.html#a5588596e963ddd108786b3e331eb09e4">CURLPROTO_LDAP</a>,                       <span class="comment">/* protocol */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="urldata_8h.html#a06e40f8f1e2219fb5b519c74715c3537">PROTOPT_NONE</a>                          <span class="comment">/* flags */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;};</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * LDAPS protocol handler.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_curl__handler.html">Curl_handler</a> Curl_handler_ldaps = {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="stringliteral">&quot;LDAPS&quot;</span>,                              <span class="comment">/* scheme */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  ldap_setup_connection,                <span class="comment">/* setup_connection */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  ldap_do,                              <span class="comment">/* do_it */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  ldap_done,                            <span class="comment">/* done */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* do_more */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  ldap_connect,                         <span class="comment">/* connect_it */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  ldap_connecting,                      <span class="comment">/* connecting */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* proto_getsock */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* doing_getsock */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* domore_getsock */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* perform_getsock */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  ldap_disconnect,                      <span class="comment">/* disconnect */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* readwrite */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a>,                            <span class="comment">/* connection_check */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="urldata_8h.html#acbe3a40e399b4d170f2bee3500e1b0a4">PORT_LDAPS</a>,                           <span class="comment">/* defport */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="curl_8h.html#a5588596e963ddd108786b3e331eb09e4">CURLPROTO_LDAP</a>,                       <span class="comment">/* protocol */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>                           <span class="comment">/* flags */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;};</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *url_errs[] = {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="stringliteral">&quot;success&quot;</span>,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="stringliteral">&quot;out of memory&quot;</span>,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="stringliteral">&quot;bad parameter&quot;</span>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="stringliteral">&quot;unrecognized scheme&quot;</span>,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="stringliteral">&quot;unbalanced delimiter&quot;</span>,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="stringliteral">&quot;bad URL&quot;</span>,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="stringliteral">&quot;bad host or port&quot;</span>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="stringliteral">&quot;bad or missing attributes&quot;</span>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="stringliteral">&quot;bad or missing scope&quot;</span>,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="stringliteral">&quot;bad or missing filter&quot;</span>,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="stringliteral">&quot;bad or missing extensions&quot;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>ldapconninfo {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a> *ld;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="urldata_8h.html#ad073adb2b5b8a2f9ab8eb0dcae415efc">Curl_recv</a> *recv;  <span class="comment">/* for stacking SSL handler */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="urldata_8h.html#a9f02ef6c16f171ef6fd36b7903e91b41">Curl_send</a> *send;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> msgid;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">bool</span> ssldone;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">bool</span> sslinst;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">bool</span> didbind;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;} ldapconninfo;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>ldapreqinfo {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">int</span> msgid;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">int</span> nument;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;} ldapreqinfo;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_setup_connection(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  ldapconninfo *li;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *lud;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> status;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#aca3b733600772d0ed1c2401838972aab">ldap_url_parse</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url, &amp;lud);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_URL_SUCCESS) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = <span class="stringliteral">&quot;url parsing problem&quot;</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    status = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &gt; LDAP_URL_SUCCESS &amp;&amp; <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt;= LDAP_URL_ERR_BADEXTS) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == LDAP_URL_ERR_MEM)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        status = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = url_errs[<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <span class="stringliteral">&quot;LDAP local: %s&quot;</span>, <a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a> = ldap_pvt_url_scheme2proto(lud-&gt;lud_scheme);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">ldap_free_urldesc</a>(lud);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  li = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(ldapconninfo));</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">if</span>(!li)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  li-&gt;proto = <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a> = li;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a>(conn, <span class="stringliteral">&quot;OpenLDAP default&quot;</span>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">/* TODO:</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">   * - provide option to choose SASL Binds instead of Simple</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">static</span> Sockbuf_IO ldapsb_tls;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_connect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a> = LDAP_VERSION3;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">char</span> hosturl[1024];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  (void)done;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  strcpy(hosturl, <span class="stringliteral">&quot;ldap&quot;</span>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a> = hosturl + 4;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    *<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>++ = <span class="charliteral">&#39;s&#39;</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>, <span class="keyword">sizeof</span>(hosturl)-(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>-hosturl), <span class="stringliteral">&quot;://%s:%d&quot;</span>,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            conn-&gt;<a class="code" href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">host</a>.<a class="code" href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">name</a>, conn-&gt;<a class="code" href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">remote_port</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#ifdef CURL_OPENLDAP_DEBUG</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> do_trace = 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *env = <a class="code" href="setup-vms_8h.html#aafc8c101dfb6313ab0416a6c5903ce66">getenv</a>(<span class="stringliteral">&quot;CURL_OPENLDAP_TRACE&quot;</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  do_trace = (env &amp;&amp; strtol(env, NULL, 10) &gt; 0);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span>(do_trace) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    ldap_set_option(li-&gt;ld, LDAP_OPT_DEBUG_LEVEL, &amp;do_trace);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_init_fd(conn-&gt;<a class="code" href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">sock</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>], li-&gt;proto, hosturl, &amp;li-&gt;ld);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: Cannot connect to %s, %s&quot;</span>,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          hosturl, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  ldap_set_option(li-&gt;ld, LDAP_OPT_PROTOCOL_VERSION, &amp;<a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, &amp;li-&gt;ssldone);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_connecting(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  LDAPMessage *<a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = NULL;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtimeval.html">timeval</a> tv = {0, 1}, *tvp;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, err;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">char</span> *info = NULL;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">handler</a>-&gt;<a class="code" href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">flags</a> &amp; <a class="code" href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a>) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">/* Is the SSL handshake complete yet? */</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span>(!li-&gt;ssldone) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                                     &amp;li-&gt;ssldone);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> || !li-&gt;ssldone)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">/* Have we installed the libcurl SSL handlers into the sockbuf yet? */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span>(!li-&gt;sslinst) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      Sockbuf *sb;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      ldap_get_option(li-&gt;ld, LDAP_OPT_SOCKBUF, &amp;sb);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      ber_sockbuf_add_io(sb, &amp;ldapsb_tls, LBER_SBIOD_LEVEL_TRANSPORT, conn);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      li-&gt;sslinst = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      li-&gt;recv = conn-&gt;<a class="code" href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">recv</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      li-&gt;send = conn-&gt;<a class="code" href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">send</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  tvp = &amp;tv;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  retry:</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(!li-&gt;didbind) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">char</span> *binddn;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">struct </span>berval passwd;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">bits</a>.<a class="code" href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">user_passwd</a>) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      binddn = conn-&gt;<a class="code" href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">user</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      passwd.bv_val = conn-&gt;<a class="code" href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">passwd</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      passwd.bv_len = strlen(passwd.bv_val);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      binddn = NULL;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      passwd.bv_val = NULL;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      passwd.bv_len = 0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_sasl_bind(li-&gt;ld, binddn, LDAP_SASL_SIMPLE, &amp;passwd,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        NULL, NULL, &amp;li-&gt;msgid);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    li-&gt;didbind = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span>(tvp)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_result(li-&gt;ld, li-&gt;msgid, LDAP_MSG_ONE, tvp, &amp;msg);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt; 0) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: bind ldap_result %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == 0) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">/* timed out */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_parse_result(li-&gt;ld, msg, &amp;err, NULL, &amp;info, NULL, NULL, 1);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: bind ldap_parse_result %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">/* Try to fallback to LDAPv2? */</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span>(err == LDAP_PROTOCOL_ERROR) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    ldap_get_option(li-&gt;ld, LDAP_OPT_PROTOCOL_VERSION, &amp;<a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a> == LDAP_VERSION3) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span>(info) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        ldap_memfree(info);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        info = NULL;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a> = LDAP_VERSION2;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      ldap_set_option(li-&gt;ld, LDAP_OPT_PROTOCOL_VERSION, &amp;<a class="code" href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      li-&gt;didbind = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">goto</span> retry;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">if</span>(err) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP remote: bind failed %s %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>),</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          info ? info : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span>(info)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      ldap_memfree(info);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513">CURLE_LOGIN_DENIED</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span>(info)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    ldap_memfree(info);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  conn-&gt;<a class="code" href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">recv</a>[<a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>] = ldap_recv;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_disconnect(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> dead_connection)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  (void) dead_connection;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">if</span>(li) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span>(li-&gt;ld) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      ldap_unbind_ext(li-&gt;ld, NULL, NULL);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      li-&gt;ld = NULL;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a> = NULL;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(li);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_do(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">bool</span> *done)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  ldapreqinfo *lr;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> status = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = 0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a> *ludp = NULL;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span> msgid;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a>(conn, <span class="stringliteral">&quot;OpenLDAP do&quot;</span>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: %s\n&quot;</span>, <a class="code" href="structdata.html">data</a>-&gt;change.url);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = <a class="code" href="setup-os400_8h.html#aca3b733600772d0ed1c2401838972aab">ldap_url_parse</a>(<a class="code" href="structdata.html">data</a>-&gt;change.url, &amp;ludp);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_URL_SUCCESS) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = <span class="stringliteral">&quot;url parsing problem&quot;</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    status = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &gt; LDAP_URL_SUCCESS &amp;&amp; <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt;= LDAP_URL_ERR_BADEXTS) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == LDAP_URL_ERR_MEM)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        status = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = url_errs[<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>];</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <span class="stringliteral">&quot;LDAP local: %s&quot;</span>, <a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_search_ext(li-&gt;ld, ludp-&gt;lud_dn, ludp-&gt;lud_scope,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                       ludp-&gt;lud_filter, ludp-&gt;lud_attrs, 0,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                       NULL, NULL, NULL, 0, &amp;msgid);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">ldap_free_urldesc</a>(ludp);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != LDAP_SUCCESS) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: ldap_search_ext %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  lr = <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, <span class="keyword">sizeof</span>(ldapreqinfo));</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span>(!lr)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  lr-&gt;msgid = msgid;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="structdata.html">data</a>-&gt;req.protop = lr;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, -1, <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL, -1, NULL);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  *done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> ldap_done(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> res,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                          <span class="keywordtype">bool</span> premature)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  ldapreqinfo *lr = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  (void)res;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  (void)premature;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span>(lr) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">/* if there was a search in progress, abandon it */</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span>(lr-&gt;msgid) {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      ldap_abandon_ext(li-&gt;ld, lr-&gt;msgid, NULL, NULL);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      lr-&gt;msgid = 0;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>-&gt;<a class="code" href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">req</a>.<a class="code" href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">protop</a> = NULL;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(lr);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keyword">static</span> <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> ldap_recv(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <span class="keywordtype">int</span> sockindex, <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                         <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> *err)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  ldapreqinfo *lr = <a class="code" href="structdata.html">data</a>-&gt;req.protop;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, ret;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  LDAPMessage *<a class="code" href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">msg</a> = NULL;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  LDAPMessage *ent;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  BerElement *ber = NULL;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keyword">struct </span><a class="code" href="structtimeval.html">timeval</a> tv = {0, 1};</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  (void)<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  (void)<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  (void)sockindex;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_result(li-&gt;ld, lr-&gt;msgid, LDAP_MSG_RECEIVED, &amp;tv, &amp;msg);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt; 0) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: search ldap_result %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  ret = -1;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">/* timed out */</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">if</span>(!msg)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">for</span>(ent = ldap_first_message(li-&gt;ld, msg); ent;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      ent = ldap_next_message(li-&gt;ld, ent)) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keyword">struct </span>berval bv, *bvals;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">int</span> binary = 0, msgtype;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> writeerr;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    msgtype = ldap_msgtype(ent);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span>(msgtype == LDAP_RES_SEARCH_RESULT) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">char</span> *info = NULL;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_parse_result(li-&gt;ld, ent, &amp;<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a>, NULL, &amp;info, NULL, NULL, 0);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>) {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP local: search ldap_parse_result %s&quot;</span>,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;              <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> &amp;&amp; <a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> != LDAP_SIZELIMIT_EXCEEDED) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;LDAP remote: search failed %s %s&quot;</span>, <a class="code" href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>),</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              info ? info : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">/* successful */</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a> == LDAP_SIZELIMIT_EXCEEDED)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          <a class="code" href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;There are more than %d entries\n&quot;</span>, lr-&gt;nument);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.size = <a class="code" href="structdata.html">data</a>-&gt;req.bytecount;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        ret = 0;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      lr-&gt;msgid = 0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      ldap_memfree(info);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(msgtype != LDAP_RES_SEARCH_ENTRY)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    lr-&gt;nument++;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_get_dn_ber(li-&gt;ld, ent, &amp;ber, &amp;bv);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> &lt; 0) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="comment">/* TODO: verify that this is really how this return code should be</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">         handled */</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      *err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;DN: &quot;</span>, 4);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      *err = writeerr;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)bv.bv_val,</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                 bv.bv_len);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      *err = writeerr;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 1);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      *err = writeerr;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += bv.bv_len + 5;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_get_attribute_ber(li-&gt;ld, ent, ber, &amp;bv, &amp;bvals);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == LDAP_SUCCESS;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ldap_get_attribute_ber(li-&gt;ld, ent, ber, &amp;bv, &amp;bvals)) {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span>(bv.bv_val == NULL)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">if</span>(bv.bv_len &gt; 7 &amp;&amp; !strncmp(bv.bv_val + bv.bv_len - 7, <span class="stringliteral">&quot;;binary&quot;</span>, 7))</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        binary = 1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        binary = 0;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span>(bvals == NULL) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\t&quot;</span>, 1);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)bv.bv_val,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                     bv.bv_len);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;:\n&quot;</span>, 2);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += bv.bv_len + 3;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a> = 0; bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val != NULL; <a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>++) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">int</span> binval = 0;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\t&quot;</span>, 1);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)bv.bv_val,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                     bv.bv_len);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;:&quot;</span>, 1);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += bv.bv_len + 2;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span>(!binary) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <span class="comment">/* check for leading or trailing whitespace */</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val[0]) ||</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;             <a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val[bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_len-1]))</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            binval = 1;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="comment">/* check for unprintable characters */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>&lt;bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_len; <a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;              <span class="keywordflow">if</span>(!<a class="code" href="curl__ctype_8h.html#a5587c144df0763ffc7fa8b0e2a933fa8">ISPRINT</a>(bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val[<a class="code" href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>])) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                binval = 1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;              }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span>(binary || binval) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="keywordtype">char</span> *val_b64 = NULL;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="keywordtype">size_t</span> val_b64_sz = 0;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="comment">/* Binary value, encode to base64. */</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> error = <a class="code" href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a>(<a class="code" href="structdata.html">data</a>,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                              bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                              bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_len,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                              &amp;val_b64,</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                              &amp;val_b64_sz);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keywordflow">if</span>(error) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            ber_memfree(bvals);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            ber_free(ber, 0);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            ldap_msgfree(msg);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            *err = error;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>,</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                       (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;: &quot;</span>, 2);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            *err = writeerr;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += 2;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">if</span>(val_b64_sz &gt; 0) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, val_b64,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                         val_b64_sz);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              *err = writeerr;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;              <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(val_b64);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += val_b64_sz;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot; &quot;</span>, 1);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            *err = writeerr;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_val,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                       bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_len);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            *err = writeerr;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <a class="code" href="structdata.html">data</a>-&gt;req.bytecount += bvals[<a class="code" href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>].bv_len + 1;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 0);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          *err = writeerr;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="structdata.html">data</a>-&gt;req.bytecount++;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      ber_memfree(bvals);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 0);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        *err = writeerr;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="structdata.html">data</a>-&gt;req.bytecount++;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    writeerr = <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *)<span class="stringliteral">&quot;\n&quot;</span>, 0);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span>(writeerr) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      *err = writeerr;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="structdata.html">data</a>-&gt;req.bytecount++;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    ber_free(ber, 0);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  ldap_msgfree(msg);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;ldapsb_tls_setup(Sockbuf_IO_Desc *sbiod, <span class="keywordtype">void</span> *arg)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  sbiod-&gt;sbiod_pvt = arg;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;ldapsb_tls_remove(Sockbuf_IO_Desc *sbiod)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;{</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  sbiod-&gt;sbiod_pvt = NULL;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">/* We don&#39;t need to do anything because libcurl does it already */</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;ldapsb_tls_close(Sockbuf_IO_Desc *sbiod)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  (void)sbiod;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;ldapsb_tls_ctrl(Sockbuf_IO_Desc *sbiod, <span class="keywordtype">int</span> opt, <span class="keywordtype">void</span> *arg)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  (void)arg;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span>(opt == LBER_SB_OPT_DATA_READY) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnectdata.html">connectdata</a> *conn = sbiod-&gt;sbiod_pvt;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vtls_8h.html#ac50ee79a0869be9ea58bda0388abde58">Curl_ssl_data_pending</a>(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keyword">static</span> ber_slen_t</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;ldapsb_tls_read(Sockbuf_IO_Desc *sbiod, <span class="keywordtype">void</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, ber_len_t <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keyword">struct </span><a class="code" href="structconnectdata.html">connectdata</a> *conn = sbiod-&gt;sbiod_pvt;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  ber_slen_t ret;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  ret = (li-&gt;recv)(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, &amp;err);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span>(ret &lt; 0 &amp;&amp; err == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a>) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="curl__setup__once_8h.html#ab8ae17eadc286f950af86c7b520e6428">SET_SOCKERRNO</a>(EWOULDBLOCK);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword">static</span> ber_slen_t</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;ldapsb_tls_write(Sockbuf_IO_Desc *sbiod, <span class="keywordtype">void</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, ber_len_t <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keyword">struct </span><a class="code" href="structconnectdata.html">connectdata</a> *conn = sbiod-&gt;sbiod_pvt;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  ldapconninfo *li = conn-&gt;<a class="code" href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">proto</a>.<a class="code" href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">generic</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  ber_slen_t ret;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> err = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  ret = (li-&gt;send)(conn, <a class="code" href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a>, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, &amp;err);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">if</span>(ret &lt; 0 &amp;&amp; err == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a>) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="curl__setup__once_8h.html#ab8ae17eadc286f950af86c7b520e6428">SET_SOCKERRNO</a>(EWOULDBLOCK);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keyword">static</span> Sockbuf_IO ldapsb_tls =</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;{</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  ldapsb_tls_setup,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  ldapsb_tls_remove,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  ldapsb_tls_ctrl,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  ldapsb_tls_read,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  ldapsb_tls_write,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  ldapsb_tls_close</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;};</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SSL */</span><span class="preprocessor"></span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !CURL_DISABLE_LDAP &amp;&amp; USE_OPENLDAP */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="sendf_8h_html_aae18389dfefc98a5057629f6a46fd78f"><div class="ttname"><a href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a></div><div class="ttdeci">#define CLIENTWRITE_BODY</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00050">sendf.h:50</a></div></div>
<div class="ttc" id="proto_8d_html_ac75e793f738d145775d1f1987fbacd4e"><div class="ttname"><a href="proto_8d.html#ac75e793f738d145775d1f1987fbacd4e">proto</a></div><div class="ttdeci">Long are comma and are each a protocol name or optionally prefixed by zero or more modifiers.Available modifiers removing it from the list of protocols already permitted..TP.though subject to later modification by subsequent entries in the comma separated list..RE.IP For but disables ftps.TP.B proto http only enables http and https.TP.B proto</div><div class="ttdef"><b>Definition:</b> <a href="proto_8d_source.html#l00034">proto.d:34</a></div></div>
<div class="ttc" id="structconnectdata_html_a9312f162d29fe7f59bc2b5dbeda85d9d"><div class="ttname"><a href="structconnectdata.html#a9312f162d29fe7f59bc2b5dbeda85d9d">connectdata::bits</a></div><div class="ttdeci">struct ConnectBits bits</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00894">urldata.h:894</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ae6d701fdcc9728db65dadb0ec7d1eec1">CURLE_RECV_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00527">curl.h:527</a></div></div>
<div class="ttc" id="setup-vms_8h_html_aafc8c101dfb6313ab0416a6c5903ce66"><div class="ttname"><a href="setup-vms_8h.html#aafc8c101dfb6313ab0416a6c5903ce66">getenv</a></div><div class="ttdeci">#define getenv</div><div class="ttdef"><b>Definition:</b> <a href="setup-vms_8h_source.html#l00052">setup-vms.h:52</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="structconnectdata_html_aec2de2220c36ec447f6101e85bf0a52b"><div class="ttname"><a href="structconnectdata.html#aec2de2220c36ec447f6101e85bf0a52b">connectdata::recv</a></div><div class="ttdeci">Curl_recv * recv[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00879">urldata.h:879</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a58a5db9f498161b06cd8f245d718b155"><div class="ttname"><a href="struct_curl__easy.html#a58a5db9f498161b06cd8f245d718b155">Curl_easy::msg</a></div><div class="ttdeci">struct Curl_message msg</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01767">urldata.h:1767</a></div></div>
<div class="ttc" id="urldata_8h_html_a56b23efdd8d04b0179b52224a251bcb7"><div class="ttname"><a href="urldata_8h.html#a56b23efdd8d04b0179b52224a251bcb7">FIRSTSOCKET</a></div><div class="ttdeci">#define FIRSTSOCKET</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00480">urldata.h:480</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aa7cd91294b499c96ac4a018e576af06a">CURLE_LDAP_CANNOT_BIND</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00508">curl.h:508</a></div></div>
<div class="ttc" id="struct_curl__handler_html"><div class="ttname"><a href="struct_curl__handler.html">Curl_handler</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00628">urldata.h:628</a></div></div>
<div class="ttc" id="connect_8h_html"><div class="ttname"><a href="connect_8h.html">connect.h</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="unit1608_8c_html_afb9ed1b8a27eb20854efe6e23e297683"><div class="ttname"><a href="unit1608_8c.html#afb9ed1b8a27eb20854efe6e23e297683">code</a></div><div class="ttdeci">CURLcode code</div><div class="ttdef"><b>Definition:</b> <a href="unit1608_8c_source.html#l00047">unit1608.c:47</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="base64_8c_html_a1208ff63d0b4ca9cead4a3cdefc033c2"><div class="ttname"><a href="base64_8c.html#a1208ff63d0b4ca9cead4a3cdefc033c2">Curl_base64_encode</a></div><div class="ttdeci">CURLcode Curl_base64_encode(struct Curl_easy *data, const char *inputbuff, size_t insize, char **outptr, size_t *outlen)</div><div class="ttdef"><b>Definition:</b> <a href="base64_8c_source.html#l00290">base64.c:290</a></div></div>
<div class="ttc" id="structconnectdata_html_ae7924587f916593e1fb682086f298ce8"><div class="ttname"><a href="structconnectdata.html#ae7924587f916593e1fb682086f298ce8">connectdata::handler</a></div><div class="ttdeci">const struct Curl_handler * handler</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00905">urldata.h:905</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_a5587c144df0763ffc7fa8b0e2a933fa8"><div class="ttname"><a href="curl__ctype_8h.html#a5587c144df0763ffc7fa8b0e2a933fa8">ISPRINT</a></div><div class="ttdeci">#define ISPRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00070">curl_ctype.h:70</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a9e0c77963cb42831dba8d5ee1840e80b">CURLE_SEND_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00526">curl.h:526</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a8527394a7d1a590228373b95f55a61a7">CURLE_AGAIN</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00564">curl.h:564</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ab9b2b0dca8aa242d128640dbfde66fc6">CURLE_URL_MALFORMAT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00461">curl.h:461</a></div></div>
<div class="ttc" id="structconnectdata_html_a91d94af5dfef86510940d658476b61cf"><div class="ttname"><a href="structconnectdata.html#a91d94af5dfef86510940d658476b61cf">connectdata::host</a></div><div class="ttdeci">struct hostname host</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00830">urldata.h:830</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="vtls_8h_html_a5ee046324452a0fe07e54818257fe04c"><div class="ttname"><a href="vtls_8h.html#a5ee046324452a0fe07e54818257fe04c">Curl_ssl_connect_nonblocking</a></div><div class="ttdeci">#define Curl_ssl_connect_nonblocking(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00270">vtls.h:270</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="structhostname_html_a9c9ce90bfcab1734f9376c6539d92cdd"><div class="ttname"><a href="structhostname.html#a9c9ce90bfcab1734f9376c6539d92cdd">hostname::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00449">urldata.h:449</a></div></div>
<div class="ttc" id="urldata_8h_html_acbe3a40e399b4d170f2bee3500e1b0a4"><div class="ttname"><a href="urldata_8h.html#acbe3a40e399b4d170f2bee3500e1b0a4">PORT_LDAPS</a></div><div class="ttdeci">#define PORT_LDAPS</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00036">urldata.h:36</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="smooth-gtk-thread_8c_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="smooth-gtk-thread_8c.html#a37d972ae0b47b9099e30983131d31916">j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="smooth-gtk-thread_8c_source.html#l00047">smooth-gtk-thread.c:47</a></div></div>
<div class="ttc" id="unit1303_8c_html_ac8936188af0c1d2f8b9d0cd25fde43b2"><div class="ttname"><a href="unit1303_8c.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a></div><div class="ttdeci">unsigned int i</div><div class="ttdef"><b>Definition:</b> <a href="unit1303_8c_source.html#l00078">unit1303.c:78</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="structconnectdata_html_a4bb3a85b09c8a63a0b526a24f9b1897a"><div class="ttname"><a href="structconnectdata.html#a4bb3a85b09c8a63a0b526a24f9b1897a">connectdata::passwd</a></div><div class="ttdeci">char * passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00864">urldata.h:864</a></div></div>
<div class="ttc" id="urldata_8h_html_ad851f566879d5b859ec9181a21318b64"><div class="ttname"><a href="urldata_8h.html#ad851f566879d5b859ec9181a21318b64">PROTOPT_SSL</a></div><div class="ttdeci">#define PROTOPT_SSL</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00706">urldata.h:706</a></div></div>
<div class="ttc" id="ldap_8c_html_aa334b56d2c4f63b26c0ab30339cae195"><div class="ttname"><a href="ldap_8c.html#aa334b56d2c4f63b26c0ab30339cae195">LDAPURLDesc</a></div><div class="ttdeci">#define LDAPURLDesc</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00101">ldap.c:101</a></div></div>
<div class="ttc" id="curl__printf_8h_html"><div class="ttname"><a href="curl__printf_8h.html">curl_printf.h</a></div></div>
<div class="ttc" id="vtls_8h_html"><div class="ttname"><a href="vtls_8h.html">vtls.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a600c484dc2160f73477f9e1b2d3db513">CURLE_LOGIN_DENIED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00540">curl.h:540</a></div></div>
<div class="ttc" id="vtls_8h_html_ac50ee79a0869be9ea58bda0388abde58"><div class="ttname"><a href="vtls_8h.html#ac50ee79a0869be9ea58bda0388abde58">Curl_ssl_data_pending</a></div><div class="ttdeci">#define Curl_ssl_data_pending(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="vtls_8h_source.html#l00267">vtls.h:267</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="curlx_8c_html_af6458f5d187f1d7c82fb9ea7ef634b44"><div class="ttname"><a href="curlx_8c.html#af6458f5d187f1d7c82fb9ea7ef634b44">ZERO_NULL</a></div><div class="ttdeci">#define ZERO_NULL</div><div class="ttdef"><b>Definition:</b> <a href="curlx_8c_source.html#l00131">curlx.c:131</a></div></div>
<div class="ttc" id="struct_curl__easy_html_a8a13221afd448ab0b91f021b4f5ec7c7"><div class="ttname"><a href="struct_curl__easy.html#a8a13221afd448ab0b91f021b4f5ec7c7">Curl_easy::req</a></div><div class="ttdeci">struct SingleRequest req</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01787">urldata.h:1787</a></div></div>
<div class="ttc" id="transfer_8c_html_a8ccd1948f2a90c90b6fd1ac993e44a32"><div class="ttname"><a href="transfer_8c.html#a8ccd1948f2a90c90b6fd1ac993e44a32">Curl_setup_transfer</a></div><div class="ttdeci">void Curl_setup_transfer(struct connectdata *conn, int sockindex, curl_off_t size, bool getheader, curl_off_t *bytecountp, int writesockindex, curl_off_t *writecountp)</div><div class="ttdef"><b>Definition:</b> <a href="transfer_8c_source.html#l01743">transfer.c:1743</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="setup-os400_8h_html_aca3b733600772d0ed1c2401838972aab"><div class="ttname"><a href="setup-os400_8h.html#aca3b733600772d0ed1c2401838972aab">ldap_url_parse</a></div><div class="ttdeci">#define ldap_url_parse</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00190">setup-os400.h:190</a></div></div>
<div class="ttc" id="curl_8h_html_a5588596e963ddd108786b3e331eb09e4"><div class="ttname"><a href="curl_8h.html#a5588596e963ddd108786b3e331eb09e4">CURLPROTO_LDAP</a></div><div class="ttdeci">#define CURLPROTO_LDAP</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00872">curl.h:872</a></div></div>
<div class="ttc" id="setup-os400_8h_html_a7174c428ee924e167e8abb129c3e4c47"><div class="ttname"><a href="setup-os400_8h.html#a7174c428ee924e167e8abb129c3e4c47">ldap_err2string</a></div><div class="ttdeci">#define ldap_err2string</div><div class="ttdef"><b>Definition:</b> <a href="setup-os400_8h_source.html#l00195">setup-os400.h:195</a></div></div>
<div class="ttc" id="structtimeval_html"><div class="ttname"><a href="structtimeval.html">timeval</a></div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00109">curl_setup_once.h:109</a></div></div>
<div class="ttc" id="url_8d_html_a9ae159ca78135eda1daa81b380b16a71"><div class="ttname"><a href="url_8d.html#a9ae159ca78135eda1daa81b380b16a71">LDAP</a></div><div class="ttdeci">Long LDAP</div><div class="ttdef"><b>Definition:</b> <a href="url_8d_source.html#l00010">url.d:10</a></div></div>
<div class="ttc" id="ldap_8c_html_acaa480fe588a3687fdbac0ec502d8c0a"><div class="ttname"><a href="ldap_8c.html#acaa480fe588a3687fdbac0ec502d8c0a">ldap_free_urldesc</a></div><div class="ttdeci">#define ldap_free_urldesc</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00108">ldap.c:108</a></div></div>
<div class="ttc" id="structconnectdata_html_ada83cbd7d295b87033b7ea635c0a5dd5"><div class="ttname"><a href="structconnectdata.html#ada83cbd7d295b87033b7ea635c0a5dd5">connectdata::send</a></div><div class="ttdeci">Curl_send * send[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00880">urldata.h:880</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="curl__ldap_8h_html"><div class="ttname"><a href="curl__ldap_8h.html">curl_ldap.h</a></div></div>
<div class="ttc" id="sendf_8c_html_ad59954133649b7538b387f940b86024f"><div class="ttname"><a href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a></div><div class="ttdeci">CURLcode Curl_client_write(struct connectdata *conn, int type, char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00651">sendf.c:651</a></div></div>
<div class="ttc" id="urldata_8h_html_a06e40f8f1e2219fb5b519c74715c3537"><div class="ttname"><a href="urldata_8h.html#a06e40f8f1e2219fb5b519c74715c3537">PROTOPT_NONE</a></div><div class="ttdeci">#define PROTOPT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00705">urldata.h:705</a></div></div>
<div class="ttc" id="_b_l_e_eddystone_u_r_l_8h_html_ad62c324cbfcc92532598792c6d0f6494"><div class="ttname"><a href="_b_l_e_eddystone_u_r_l_8h.html#ad62c324cbfcc92532598792c6d0f6494">url</a></div><div class="ttdeci">uint8_t url[16]</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_eddystone_u_r_l_8h_source.html#l00037">BLEEddystoneURL.h:37</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="struct_single_request_html_a5803af0f75195ad74badb6ced9b24b16"><div class="ttname"><a href="struct_single_request.html#a5803af0f75195ad74badb6ced9b24b16">SingleRequest::protop</a></div><div class="ttdeci">void * protop</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00619">urldata.h:619</a></div></div>
<div class="ttc" id="structconnectdata_html_a160efff03fc5af18ef8a16f20a3fe84e"><div class="ttname"><a href="structconnectdata.html#a160efff03fc5af18ef8a16f20a3fe84e">connectdata::generic</a></div><div class="ttdeci">void * generic</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01012">urldata.h:1012</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a90b98fc82c9d84afa3a8a3f82d283388">CURLE_COULDNT_CONNECT</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00466">curl.h:466</a></div></div>
<div class="ttc" id="config-win32_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="config-win32_8h_source.html#l00379">config-win32.h:379</a></div></div>
<div class="ttc" id="structconnectdata_html_a13cc2123ad38902e8ad44e67f10ed7aa"><div class="ttname"><a href="structconnectdata.html#a13cc2123ad38902e8ad44e67f10ed7aa">connectdata::sock</a></div><div class="ttdeci">curl_socket_t sock[2]</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00874">urldata.h:874</a></div></div>
<div class="ttc" id="connect_8h_html_acdca2a91749c4f2ca1805e482bad0f90"><div class="ttname"><a href="connect_8h.html#acdca2a91749c4f2ca1805e482bad0f90">connkeep</a></div><div class="ttdeci">#define connkeep(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="connect_8h_source.html#l00146">connect.h:146</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_ab8ae17eadc286f950af86c7b520e6428"><div class="ttname"><a href="curl__setup__once_8h.html#ab8ae17eadc286f950af86c7b520e6428">SET_SOCKERRNO</a></div><div class="ttdeci">#define SET_SOCKERRNO(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00415">curl_setup_once.h:415</a></div></div>
<div class="ttc" id="urldata_8h_html_ad073adb2b5b8a2f9ab8eb0dcae415efc"><div class="ttname"><a href="urldata_8h.html#ad073adb2b5b8a2f9ab8eb0dcae415efc">Curl_recv</a></div><div class="ttdeci">ssize_t() Curl_recv(struct connectdata *conn, int sockindex, char *buf, size_t len, CURLcode *err)</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00110">urldata.h:110</a></div></div>
<div class="ttc" id="urldata_8h_html_a9f02ef6c16f171ef6fd36b7903e91b41"><div class="ttname"><a href="urldata_8h.html#a9f02ef6c16f171ef6fd36b7903e91b41">Curl_send</a></div><div class="ttdeci">ssize_t() Curl_send(struct connectdata *conn, int sockindex, const void *buf, size_t len, CURLcode *err)</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00103">urldata.h:103</a></div></div>
<div class="ttc" id="unit1652_8c_html_a348cae967f89c4bad8fb37e45a469d1a"><div class="ttname"><a href="unit1652_8c.html#a348cae967f89c4bad8fb37e45a469d1a">msnprintf</a></div><div class="ttdeci">UNITTEST_START msnprintf(input, sizeof(input), &quot;Simple Test&quot;)</div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="struct_curl__handler_html_a2fc887b2697c63980406a19108b82a24"><div class="ttname"><a href="struct_curl__handler.html#a2fc887b2697c63980406a19108b82a24">Curl_handler::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00702">urldata.h:702</a></div></div>
<div class="ttc" id="transfer_8h_html"><div class="ttname"><a href="transfer_8h.html">transfer.h</a></div></div>
<div class="ttc" id="sendf_8h_html_a0056494e05c065643a400059b9318270"><div class="ttname"><a href="sendf_8h.html#a0056494e05c065643a400059b9318270">infof</a></div><div class="ttdeci">#define infof</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00044">sendf.h:44</a></div></div>
<div class="ttc" id="structconnectdata_html_a347307932d5d64be48527b2f3ed666ca"><div class="ttname"><a href="structconnectdata.html#a347307932d5d64be48527b2f3ed666ca">connectdata::proto</a></div><div class="ttdeci">union connectdata::@45 proto</div></div>
<div class="ttc" id="urldata_8h_html_a4d9c4d843ff2d52be6c16d1fa1033184"><div class="ttname"><a href="urldata_8h.html#a4d9c4d843ff2d52be6c16d1fa1033184">PORT_LDAP</a></div><div class="ttdeci">#define PORT_LDAP</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00035">urldata.h:35</a></div></div>
<div class="ttc" id="curl__ldap_8h_html_aa1253b14602d68a70ca20be27d768594"><div class="ttname"><a href="curl__ldap_8h.html#aa1253b14602d68a70ca20be27d768594">Curl_handler_ldap</a></div><div class="ttdeci">const struct Curl_handler Curl_handler_ldap</div><div class="ttdef"><b>Definition:</b> <a href="ldap_8c_source.html#l00129">ldap.c:129</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aa546c6fb1cb084fe89e88f8bf88167bd">CURLE_LDAP_SEARCH_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00509">curl.h:509</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="struct_connect_bits_html_a3bfd8a5d78dc98e435348b877e19f619"><div class="ttname"><a href="struct_connect_bits.html#a3bfd8a5d78dc98e435348b877e19f619">ConnectBits::user_passwd</a></div><div class="ttdeci">bool user_passwd</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00390">urldata.h:390</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="structconnectdata_html_a82d9732a096255f5d8741c4a0ea990eb"><div class="ttname"><a href="structconnectdata.html#a82d9732a096255f5d8741c4a0ea990eb">connectdata::remote_port</a></div><div class="ttdeci">int remote_port</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00840">urldata.h:840</a></div></div>
<div class="ttc" id="structconnectdata_html_a85cb9da7776d42c440612d2940a7fcb4"><div class="ttname"><a href="structconnectdata.html#a85cb9da7776d42c440612d2940a7fcb4">connectdata::user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00863">urldata.h:863</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="curl__base64_8h_html"><div class="ttname"><a href="curl__base64_8h.html">curl_base64.h</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="openldap_8c.html">openldap.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
