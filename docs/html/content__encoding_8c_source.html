<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: components/curl/lib/content_encoding.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('content__encoding_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">content_encoding.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="content__encoding_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                  _   _ ____  _</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Project                     ___| | | |  _ \| |</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                             / __| | | | |_) | |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                             \___|\___/|_| \_\_____|</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 1998 - 2018, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This software is licensed as described in the file COPYING, which</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * you should have received as part of this distribution. The terms</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * KIND, either express or implied.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__setup_8h.html">curl_setup.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="urldata_8h.html">urldata.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="curl_8h.html">curl/curl.h</a>&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifdef HAVE_ZLIB_H</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;zlib.h&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifdef __SYMBIAN32__</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* zlib pollutes the namespace with this definition */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#undef WIN32</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifdef HAVE_BROTLI</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;brotli/decode.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sendf_8h.html">sendf.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http_8h.html">http.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="content__encoding_8h.html">content_encoding.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strdup_8h.html">strdup.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="strcase_8h.html">strcase.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="curl__memory_8h.html">curl_memory.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdebug_8h.html">memdebug.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">   49</a></span>&#160;<span class="preprocessor">#define CONTENT_ENCODING_DEFAULT  &quot;identity&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifndef CURL_DISABLE_HTTP</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">   53</a></span>&#160;<span class="preprocessor">#define DSIZ CURL_MAX_WRITE_SIZE </span><span class="comment">/* buffer size for decompressed data */</span><span class="preprocessor"></span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#ifdef HAVE_LIBZ</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/* Comment this out if zlib is always going to be at least ver. 1.2.0.4</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">   (doing so will reduce code size slightly). */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#define OLD_ZLIB_SUPPORT 1</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#define GZIP_MAGIC_0 0x1f</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#define GZIP_MAGIC_1 0x8b</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/* gzip flag byte */</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#define ASCII_FLAG   0x01 </span><span class="comment">/* bit 0 set: file probably ascii text */</span><span class="preprocessor"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#define HEAD_CRC     0x02 </span><span class="comment">/* bit 1 set: header CRC present */</span><span class="preprocessor"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#define EXTRA_FIELD  0x04 </span><span class="comment">/* bit 2 set: extra field present */</span><span class="preprocessor"></span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define ORIG_NAME    0x08 </span><span class="comment">/* bit 3 set: original file name present */</span><span class="preprocessor"></span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define COMMENT      0x10 </span><span class="comment">/* bit 4 set: file comment present */</span><span class="preprocessor"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define RESERVED     0xE0 </span><span class="comment">/* bits 5..7: reserved */</span><span class="preprocessor"></span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  ZLIB_UNINIT,               <span class="comment">/* uninitialized */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  ZLIB_INIT,                 <span class="comment">/* initialized */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  ZLIB_INFLATING,            <span class="comment">/* inflating started. */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  ZLIB_EXTERNAL_TRAILER,     <span class="comment">/* reading external trailer */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  ZLIB_GZIP_HEADER,          <span class="comment">/* reading gzip header */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  ZLIB_GZIP_INFLATING,       <span class="comment">/* inflating gzip stream */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  ZLIB_INIT_GZIP             <span class="comment">/* initialized in transparent gzip mode */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;} zlibInitState;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/* Writer parameters. */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  zlibInitState zlib_init;   <span class="comment">/* zlib init state */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  uInt trailerlen;           <span class="comment">/* Remaining trailer byte count. */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  z_stream z;                <span class="comment">/* State structure for zlib. */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}  zlib_params;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">static</span> voidpf</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;zalloc_cb(voidpf opaque, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> items, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  (void) opaque;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* not a typo, keep it calloc() */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">return</span> (voidpf) <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(items, <a class="code" href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;zfree_cb(voidpf opaque, voidpf <a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  (void) opaque;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;process_zlib_error(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, z_stream *z)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span>(z-&gt;msg)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Error while processing content unencoding: %s&quot;</span>,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          z-&gt;msg);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(<a class="code" href="structdata.html">data</a>, <span class="stringliteral">&quot;Error while processing content unencoding: &quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="stringliteral">&quot;Unknown failure within decompression software.&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;exit_zlib(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          z_stream *z, zlibInitState *zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span>(*zlib_init == ZLIB_GZIP_HEADER)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a>(z-&gt;next_in);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span>(*zlib_init != ZLIB_UNINIT) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span>(inflateEnd(z) != Z_OK &amp;&amp; <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = process_zlib_error(conn, z);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    *zlib_init = ZLIB_UNINIT;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> process_trailer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, zlib_params *zp)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  z_stream *z = &amp;zp-&gt;z;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  uInt <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = z-&gt;avail_in &lt; zp-&gt;trailerlen? z-&gt;avail_in: zp-&gt;trailerlen;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">/* Consume expected trailer bytes. Terminate stream if exhausted.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">     Issue an error if unexpected bytes follow. */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  zp-&gt;trailerlen -= <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  z-&gt;avail_in -= <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  z-&gt;next_in += <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span>(z-&gt;avail_in)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> || !zp-&gt;trailerlen)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">/* Only occurs for gzip with zlib &lt; 1.2.0.4 or raw deflate. */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    zp-&gt;zlib_init = ZLIB_EXTERNAL_TRAILER;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> inflate_stream(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                               <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer, zlibInitState started)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  z_stream *z = &amp;zp-&gt;z;         <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  uInt nread = z-&gt;avail_in;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  Bytef *orig_in = z-&gt;next_in;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">bool</span> done = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;   <span class="comment">/* Curl_client_write status */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">char</span> *decomp;                 <span class="comment">/* Put the decompressed data here. */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">/* Check state. */</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span>(zp-&gt;zlib_init != ZLIB_INIT &amp;&amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;     zp-&gt;zlib_init != ZLIB_INFLATING &amp;&amp;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     zp-&gt;zlib_init != ZLIB_INIT_GZIP &amp;&amp;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     zp-&gt;zlib_init != ZLIB_GZIP_INFLATING)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">/* Dynamically allocate a buffer for decompression because it&#39;s uncommonly</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">     large to hold on the stack */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  decomp = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span>(decomp == NULL)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">/* because the buffer size is fixed, iteratively decompress and transfer to</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">     the client via downstream_write function. */</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">while</span>(!done) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">int</span> status;                   <span class="comment">/* zlib status */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    done = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">/* (re)set buffer for decompressed output for every iteration */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    z-&gt;next_out = (Bytef *) decomp;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    z-&gt;avail_out = <a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#ifdef Z_BLOCK</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">/* Z_BLOCK is only available in zlib ver. &gt;= 1.2.0.5 */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    status = inflate(z, Z_BLOCK);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">/* fallback for zlib ver. &lt; 1.2.0.5 */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    status = inflate(z, Z_SYNC_FLUSH);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">/* Flush output data if some. */</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span>(z-&gt;avail_out != <a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a>) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span>(status == Z_OK || status == Z_STREAM_END) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        zp-&gt;zlib_init = started;      <span class="comment">/* Data started. */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a>(conn, writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>, decomp,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                     <a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a> - z-&gt;avail_out);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/* Dispatch by inflate() status. */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">switch</span>(status) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">case</span> Z_OK:</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">/* Always loop: there may be unflushed latched data in zlib state. */</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      done = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">case</span> Z_BUF_ERROR:</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">/* No more data to flush: just exit loop. */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">case</span> Z_STREAM_END:</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = process_trailer(conn, zp);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">case</span> Z_DATA_ERROR:</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">/* some servers seem to not generate zlib headers, so this is an attempt</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">         to fix and continue anyway */</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">if</span>(zp-&gt;zlib_init == ZLIB_INIT) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">/* Do not use inflateReset2(): only available since zlib 1.2.3.4. */</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        (void) inflateEnd(z);     <span class="comment">/* don&#39;t care about the return code */</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span>(inflateInit2(z, -MAX_WBITS) == Z_OK) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          z-&gt;next_in = orig_in;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          z-&gt;avail_in = nread;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          zp-&gt;zlib_init = ZLIB_INFLATING;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          zp-&gt;trailerlen = 4; <span class="comment">/* Tolerate up to 4 unknown trailer bytes. */</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          done = <a class="code" href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        zp-&gt;zlib_init = ZLIB_UNINIT;    <span class="comment">/* inflateEnd() already called. */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">/* FALLTHROUGH */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = exit_zlib(conn, z, &amp;zp-&gt;zlib_init, process_zlib_error(conn, z));</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(decomp);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/* We&#39;re about to leave this call so the `nread&#39; data bytes won&#39;t be seen</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">     again. If we are in a state that would wrongly allow restart in raw mode</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">     at the next call, assume output has already started. */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span>(nread &amp;&amp; zp-&gt;zlib_init == ZLIB_INIT)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    zp-&gt;zlib_init = started;      <span class="comment">/* Cannot restart anymore. */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/* Deflate handler. */</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> deflate_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                    <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span>(!writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">/* Initialize zlib */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  z-&gt;zalloc = (alloc_func) zalloc_cb;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  z-&gt;zfree = (free_func) zfree_cb;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">if</span>(inflateInit(z) != Z_OK)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> process_zlib_error(conn, z);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  zp-&gt;zlib_init = ZLIB_INIT;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> deflate_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                       <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">/* Set the compressed input when this function is called */</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  z-&gt;avail_in = (uInt) nbytes;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span>(zp-&gt;zlib_init == ZLIB_EXTERNAL_TRAILER)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> process_trailer(conn, zp);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">/* Now uncompress the data */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">return</span> inflate_stream(conn, writer, ZLIB_INFLATING);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> deflate_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                 <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> deflate_encoding = {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="stringliteral">&quot;deflate&quot;</span>,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  NULL,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  deflate_init_writer,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  deflate_unencode_write,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  deflate_close_writer,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">sizeof</span>(zlib_params)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;};</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/* Gzip handler. */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gzip_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                 <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span>(!writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">/* Initialize zlib */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  z-&gt;zalloc = (alloc_func) zalloc_cb;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  z-&gt;zfree = (free_func) zfree_cb;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span>(strcmp(zlibVersion(), <span class="stringliteral">&quot;1.2.0.4&quot;</span>) &gt;= 0) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">/* zlib ver. &gt;= 1.2.0.4 supports transparent gzip decompressing */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span>(inflateInit2(z, MAX_WBITS + 32) != Z_OK) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">return</span> process_zlib_error(conn, z);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    zp-&gt;zlib_init = ZLIB_INIT_GZIP; <span class="comment">/* Transparent gzip decompress state */</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/* we must parse the gzip header and trailer ourselves */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span>(inflateInit2(z, -MAX_WBITS) != Z_OK) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span> process_zlib_error(conn, z);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    zp-&gt;trailerlen = 8; <span class="comment">/* A CRC-32 and a 32-bit input size (RFC 1952, 2.2) */</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    zp-&gt;zlib_init = ZLIB_INIT; <span class="comment">/* Initial call state */</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#ifdef OLD_ZLIB_SUPPORT</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/* Skip over the gzip header */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  GZIP_OK,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  GZIP_BAD,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  GZIP_UNDERFLOW</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;} check_gzip_header(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *<a class="code" href="structdata.html">data</a>, <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> *headerlen)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;{</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a>, flags;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keyword">const</span> <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> totallen = <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">/* The shortest header is 10 bytes */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt; 10)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="structdata.html">data</a>[0] != GZIP_MAGIC_0) || (<a class="code" href="structdata.html">data</a>[1] != GZIP_MAGIC_1))</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> GZIP_BAD;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> = <a class="code" href="structdata.html">data</a>[2];</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  flags = <a class="code" href="structdata.html">data</a>[3];</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a> != Z_DEFLATED || (flags &amp; RESERVED) != 0) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/* Can&#39;t handle this compression method or unknown flag */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> GZIP_BAD;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">/* Skip over time, xflags, OS code and all previous bytes */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> -= 10;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="structdata.html">data</a> += 10;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span>(flags &amp; EXTRA_FIELD) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> extra_len;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt; 2)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    extra_len = (<a class="code" href="structdata.html">data</a>[1] &lt;&lt; 8) | <a class="code" href="structdata.html">data</a>[0];</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt; (extra_len + 2))</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> -= (extra_len + 2);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="structdata.html">data</a> += (extra_len + 2);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span>(flags &amp; ORIG_NAME) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">/* Skip over NUL-terminated file name */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &amp;&amp; *<a class="code" href="structdata.html">data</a>) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      --<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      ++<a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> || *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">/* Skip over the NUL */</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    --<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    ++<a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">if</span>(flags &amp; COMMENT) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">/* Skip over NUL-terminated comment */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &amp;&amp; *<a class="code" href="structdata.html">data</a>) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      --<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      ++<a class="code" href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> || *<a class="code" href="structdata.html">data</a>)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">/* Skip over the NUL */</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    --<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span>(flags &amp; HEAD_CRC) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &lt; 2)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> GZIP_UNDERFLOW;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> -= 2;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  *headerlen = totallen - <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">return</span> GZIP_OK;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;}</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> gzip_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                    <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span>(zp-&gt;zlib_init == ZLIB_INIT_GZIP) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">/* Let zlib handle the gzip decompression entirely */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    z-&gt;avail_in = (uInt) nbytes;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">/* Now uncompress the data */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> inflate_stream(conn, writer, ZLIB_INIT_GZIP);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#ifndef OLD_ZLIB_SUPPORT</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">/* Support for old zlib versions is compiled away and we are running with</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">     an old version, so return an error. */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">/* This next mess is to get around the potential case where there isn&#39;t</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">   * enough data passed in to skip over the gzip header.  If that happens, we</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">   * malloc a block and copy what we have then wait for the next call.  If</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">   * there still isn&#39;t enough (this is definitely a worst-case scenario), we</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">   * make the block bigger, copy the next part in and keep waiting.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">   * This is only required with zlib versions &lt; 1.2.0.4 as newer versions</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">   * can handle the gzip header themselves.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">switch</span>(zp-&gt;zlib_init) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">/* Skip over gzip header? */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">case</span> ZLIB_INIT:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">/* Initial call state */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> hlen;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">switch</span>(check_gzip_header((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nbytes, &amp;hlen)) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">case</span> GZIP_OK:</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> + hlen;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      z-&gt;avail_in = (uInt) (nbytes - hlen);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      zp-&gt;zlib_init = ZLIB_GZIP_INFLATING; <span class="comment">/* Inflating stream state */</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">case</span> GZIP_UNDERFLOW:</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="comment">/* We need more data so we can find the end of the gzip header.  It&#39;s</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">       * possible that the memory block we malloc here will never be freed if</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">       * the transfer abruptly aborts after this point.  Since it&#39;s unlikely</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">       * that circumstances will be right for this code path to be followed in</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">       * the first place, and it&#39;s even more unlikely for a transfer to fail</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">       * immediately afterwards, it should seldom be a problem.</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      z-&gt;avail_in = (uInt) nbytes;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      z-&gt;next_in = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(z-&gt;avail_in);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">if</span>(z-&gt;next_in == NULL) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(z-&gt;next_in, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, z-&gt;avail_in);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      zp-&gt;zlib_init = ZLIB_GZIP_HEADER;  <span class="comment">/* Need more gzip header data state */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">/* We don&#39;t have any data to inflate yet */</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">case</span> GZIP_BAD:</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, process_zlib_error(conn, z));</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">case</span> ZLIB_GZIP_HEADER:</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">/* Need more gzip header data state */</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> hlen;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    z-&gt;avail_in += (uInt) nbytes;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    z-&gt;next_in = <a class="code" href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a>(z-&gt;next_in, z-&gt;avail_in);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span>(z-&gt;next_in == NULL) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">/* Append the new block of data to the previous one */</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a>(z-&gt;next_in + z-&gt;avail_in - nbytes, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nbytes);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">switch</span>(check_gzip_header(z-&gt;next_in, z-&gt;avail_in, &amp;hlen)) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">case</span> GZIP_OK:</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="comment">/* This is the zlib stream data */</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(z-&gt;next_in);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="comment">/* Don&#39;t point into the malloced block since we just freed it */</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a> + hlen + nbytes - z-&gt;avail_in;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      z-&gt;avail_in = (uInt) (z-&gt;avail_in - hlen);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      zp-&gt;zlib_init = ZLIB_GZIP_INFLATING;   <span class="comment">/* Inflating stream state */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">case</span> GZIP_UNDERFLOW:</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="comment">/* We still don&#39;t have any data to inflate! */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">case</span> GZIP_BAD:</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">return</span> exit_zlib(conn, z, &amp;zp-&gt;zlib_init, process_zlib_error(conn, z));</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">case</span> ZLIB_EXTERNAL_TRAILER:</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    z-&gt;avail_in = (uInt) nbytes;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">return</span> process_trailer(conn, zp);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">case</span> ZLIB_GZIP_INFLATING:</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">/* Inflating stream state */</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    z-&gt;next_in = (Bytef *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    z-&gt;avail_in = (uInt) nbytes;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span>(z-&gt;avail_in == 0) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/* We don&#39;t have any data to inflate; wait until next time */</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">/* We&#39;ve parsed the header, now uncompress the data */</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">return</span> inflate_stream(conn, writer, ZLIB_GZIP_INFLATING);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> gzip_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                              <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  zlib_params *zp = (zlib_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  z_stream *z = &amp;zp-&gt;z;     <span class="comment">/* zlib state structure */</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  exit_zlib(conn, z, &amp;zp-&gt;zlib_init, <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> gzip_encoding = {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="stringliteral">&quot;gzip&quot;</span>,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="stringliteral">&quot;x-gzip&quot;</span>,</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  gzip_init_writer,</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  gzip_unencode_write,</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  gzip_close_writer,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keyword">sizeof</span>(zlib_params)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;};</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_LIBZ */</span><span class="preprocessor"></span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#ifdef HAVE_BROTLI</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/* Writer parameters. */</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  BrotliDecoderState *br;    <span class="comment">/* State structure for brotli. */</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}  brotli_params;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> brotli_map_error(BrotliDecoderErrorCode be)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;{</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">switch</span>(be) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_PADDING_1:</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_FORMAT_PADDING_2:</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">#ifdef BROTLI_DECODER_ERROR_COMPOUND_DICTIONARY</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_COMPOUND_DICTIONARY:</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#ifdef BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">case</span> BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> brotli_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                   <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  brotli_params *bp = (brotli_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  (<span class="keywordtype">void</span>) conn;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span>(!writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  bp-&gt;br = BrotliDecoderCreateInstance(NULL, NULL, NULL);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">return</span> bp-&gt;br? <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>: <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> brotli_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                      <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  brotli_params *bp = (brotli_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keyword">const</span> uint8_t *src = (<span class="keyword">const</span> uint8_t *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">char</span> *decomp;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  uint8_t *dst;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">size_t</span> dstleft;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  BrotliDecoderResult r = BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">if</span>(!bp-&gt;br)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;  <span class="comment">/* Stream already ended. */</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  decomp = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">if</span>(!decomp)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">while</span>((nbytes || r == BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT) &amp;&amp;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> == <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    dst = (uint8_t *) decomp;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    dstleft = <a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    r = BrotliDecoderDecompressStream(bp-&gt;br,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                      &amp;nbytes, &amp;src, &amp;dstleft, &amp;dst, NULL);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a>(conn, writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>,</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                 decomp, <a class="code" href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a> - dstleft);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">switch</span>(r) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">case</span> BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">case</span> BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">case</span> BROTLI_DECODER_RESULT_SUCCESS:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      BrotliDecoderDestroyInstance(bp-&gt;br);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      bp-&gt;br = NULL;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">if</span>(nbytes)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a> = brotli_map_error(BrotliDecoderGetErrorCode(bp-&gt;br));</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(decomp);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> brotli_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  brotli_params *bp = (brotli_params *) &amp;writer-&gt;<a class="code" href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">params</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  (<span class="keywordtype">void</span>) conn;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">if</span>(bp-&gt;br) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    BrotliDecoderDestroyInstance(bp-&gt;br);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    bp-&gt;br = NULL;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> brotli_encoding = {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="stringliteral">&quot;br&quot;</span>,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  NULL,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  brotli_init_writer,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  brotli_unencode_write,</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  brotli_close_writer,</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keyword">sizeof</span>(brotli_params)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;};</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">/* Identity handler. */</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> identity_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                     <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;{</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  (void) conn;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">return</span> writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>? <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>: <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> identity_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                        <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a>(conn, writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nbytes);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> identity_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                  <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  (void) conn;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  (void) writer;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> identity_encoding = {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="stringliteral">&quot;identity&quot;</span>,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="stringliteral">&quot;none&quot;</span>,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  identity_init_writer,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  identity_unencode_write,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  identity_close_writer,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  0</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;};</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">/* supported content encodings table. */</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> * <span class="keyword">const</span> encodings[] = {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  &amp;identity_encoding,</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">#ifdef HAVE_LIBZ</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  &amp;deflate_encoding,</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  &amp;gzip_encoding,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">#ifdef HAVE_BROTLI</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  &amp;brotli_encoding,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  NULL</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;};</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">/* Return a list of comma-separated names of supported encodings. */</span></div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="content__encoding_8h.html#a2ae698f01d6cf152dce42349217ca238">  762</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="content__encoding_8c.html#a2ae698f01d6cf152dce42349217ca238">Curl_all_content_encodings</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;{</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> * <span class="keyword">const</span> *cep;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> *ce;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordtype">char</span> *ace;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">for</span>(cep = encodings; *cep; cep++) {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    ce = *cep;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>, <a class="code" href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">CONTENT_ENCODING_DEFAULT</a>))</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += strlen(ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>) + 2;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">CONTENT_ENCODING_DEFAULT</a>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  ace = <a class="code" href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a>(<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">if</span>(ace) {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> = ace;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">for</span>(cep = encodings; *cep; cep++) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      ce = *cep;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a>(ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>, <a class="code" href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">CONTENT_ENCODING_DEFAULT</a>)) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        strcpy(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>, ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a> += strlen(<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++ = <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        *<a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>++ = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a>[-2] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">return</span> ace;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">/* Real client writer: no downstream. */</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> client_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                   <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;{</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  (void) conn;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">return</span> writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>? <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>: <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> client_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                      <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;{</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_single_request.html">SingleRequest</a> *k = &amp;<a class="code" href="structdata.html">data</a>-&gt;req;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  (void) writer;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span>(!nbytes || k-&gt;<a class="code" href="struct_single_request.html#a6ded6fbb86cb5457049ff225c7ee8827">ignorebody</a>)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a>(conn, <a class="code" href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a>, (<span class="keywordtype">char</span> *) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nbytes);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> client_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;{</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  (void) conn;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  (void) writer;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;}</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> client_encoding = {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  NULL,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  NULL,</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  client_init_writer,</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  client_unencode_write,</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  client_close_writer,</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  0</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;};</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">/* Deferred error dummy writer. */</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> error_init_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                  <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;{</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  (void) conn;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">return</span> writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>? <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>: <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keyword">static</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> error_unencode_write(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                     <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;{</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="proto_8d.html#ac43d17bf16fbd3acee8096864462daae">all</a> = <a class="code" href="content__encoding_8c.html#a2ae698f01d6cf152dce42349217ca238">Curl_all_content_encodings</a>();</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  (void) writer;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  (void) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  (void) nbytes;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="proto_8d.html#ac43d17bf16fbd3acee8096864462daae">all</a>)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <a class="code" href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a>(conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>, <span class="stringliteral">&quot;Unrecognized content encoding type. &quot;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    <span class="stringliteral">&quot;libcurl understands %s content encodings.&quot;</span>, <a class="code" href="proto_8d.html#ac43d17bf16fbd3acee8096864462daae">all</a>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(<a class="code" href="proto_8d.html#ac43d17bf16fbd3acee8096864462daae">all</a>);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> error_close_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                               <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;{</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  (void) conn;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  (void) writer;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;}</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> error_encoding = {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  NULL,</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  NULL,</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  error_init_writer,</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  error_unencode_write,</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  error_close_writer,</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  0</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;};</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">/* Create an unencoding writer stage using the given handler. */</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keyword">static</span> <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *new_unencoding_writer(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> *handler,</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                             <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *downstream)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordtype">size_t</span> sz = offsetof(<a class="code" href="structcontenc__writer__s.html">contenc_writer</a>, params) + handler-&gt;<a class="code" href="structcontent__encoding__s.html#a746cf1d2f7f8027f6da0741148ed67b9">paramsize</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer = (<a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *) <a class="code" href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a>(1, sz);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span>(writer) {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    writer-&gt;<a class="code" href="structcontenc__writer__s.html#af11db43a7da9858d292a0dc2cf2140fe">handler</a> = handler;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a> = downstream;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span>(handler-&gt;<a class="code" href="structcontent__encoding__s.html#a09abb22c58b5f7b70585d0bd04941e4b">init_writer</a>(conn, writer)) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(writer);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      writer = NULL;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">return</span> writer;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">/* Write data using an unencoding writer stack. */</span></div><div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="content__encoding_8h.html#aa026433194b6ea0fde7a6e8682148f32">  900</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span>(!nbytes)</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">return</span> writer-&gt;<a class="code" href="structcontenc__writer__s.html#af11db43a7da9858d292a0dc2cf2140fe">handler</a>-&gt;<a class="code" href="structcontent__encoding__s.html#acbf13241f57426fb4a588fb460173425">unencode_write</a>(conn, writer, <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, nbytes);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;}</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">/* Close and clean-up the connection&#39;s writer stack. */</span></div><div class="line"><a name="l00909"></a><span class="lineno"><a class="line" href="content__encoding_8h.html#ab341f4f03f5aa236c5e5b2b25e5ff806">  909</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="content__encoding_8c.html#ab341f4f03f5aa236c5e5b2b25e5ff806">Curl_unencode_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;{</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_single_request.html">SingleRequest</a> *k = &amp;<a class="code" href="structdata.html">data</a>-&gt;req;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer = k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">while</span>(writer) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a> = writer-&gt;<a class="code" href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">downstream</a>;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    writer-&gt;<a class="code" href="structcontenc__writer__s.html#af11db43a7da9858d292a0dc2cf2140fe">handler</a>-&gt;<a class="code" href="structcontent__encoding__s.html#ae2884773c7018f7780e559d3ced29b3f">close_writer</a>(conn, writer);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a>(writer);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    writer = k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">/* Find the content encoding by name. */</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> *find_encoding(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, <span class="keywordtype">size_t</span> <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;{</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> * <span class="keyword">const</span> *cep;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">for</span>(cep = encodings; *cep; cep++) {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> *ce = *cep;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) &amp;&amp; !ce-&gt;<a class="code" href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">name</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>]) ||</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;       (ce-&gt;<a class="code" href="structcontent__encoding__s.html#a1333d29c8da540e4f1af1022c26b68a5">alias</a> &amp;&amp; <a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, ce-&gt;<a class="code" href="structcontent__encoding__s.html#a1333d29c8da540e4f1af1022c26b68a5">alias</a>, <a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) &amp;&amp; !ce-&gt;<a class="code" href="structcontent__encoding__s.html#a1333d29c8da540e4f1af1022c26b68a5">alias</a>[<a class="code" href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>]))</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keywordflow">return</span> ce;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">/* Set-up the unencoding stack from the Content-Encoding header value.</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"> * See RFC 7231 section 3.1.2.2. */</span></div><div class="line"><a name="l00939"></a><span class="lineno"><a class="line" href="content__encoding_8h.html#a4bb1030923af3fb6cd027301fc4dd1db">  939</a></span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *enclist, <span class="keywordtype">int</span> maybechunked)</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;{</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_curl__easy.html">Curl_easy</a> *<a class="code" href="structdata.html">data</a> = conn-&gt;<a class="code" href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">data</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_single_request.html">SingleRequest</a> *k = &amp;<a class="code" href="structdata.html">data</a>-&gt;req;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordtype">size_t</span> namelen;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">/* Parse a single encoding name. */</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*enclist) || *enclist == <span class="charliteral">&#39;,&#39;</span>)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      enclist++;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> = enclist;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">for</span>(namelen = 0; *enclist &amp;&amp; *enclist != <span class="charliteral">&#39;,&#39;</span>; enclist++)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a>(*enclist))</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        namelen = enclist - <a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a> + 1;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">/* Special case: chunked encoding is handled at the reader level. */</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span>(maybechunked &amp;&amp; namelen == 7 &amp;&amp; <a class="code" href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a>(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, <span class="stringliteral">&quot;chunked&quot;</span>, 7)) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      k-&gt;<a class="code" href="struct_single_request.html#a3018293fe5f120a8a4c77d16207ab5da">chunk</a> = <a class="code" href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;             <span class="comment">/* chunks coming our way. */</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <a class="code" href="http_8h.html#a845cdb069bb2bb79c5e1a496289eb613">Curl_httpchunk_init</a>(conn);   <span class="comment">/* init our chunky engine. */</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(namelen) {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keyword">const</span> <a class="code" href="structcontent__encoding__s.html">content_encoding</a> *<a class="code" href="compressed_8d.html#a6c2ffb0bf7f4a1f29bfe33d42329479b">encoding</a> = find_encoding(<a class="code" href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a>, namelen);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a>) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a> = new_unencoding_writer(conn, &amp;client_encoding, NULL);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">if</span>(!k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a>)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="compressed_8d.html#a6c2ffb0bf7f4a1f29bfe33d42329479b">encoding</a>)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="compressed_8d.html#a6c2ffb0bf7f4a1f29bfe33d42329479b">encoding</a> = &amp;error_encoding;  <span class="comment">/* Defer error at stack use. */</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="comment">/* Stack the unencoding stage. */</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      writer = new_unencoding_writer(conn, <a class="code" href="compressed_8d.html#a6c2ffb0bf7f4a1f29bfe33d42329479b">encoding</a>, k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a>);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">if</span>(!writer)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      k-&gt;<a class="code" href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">writer_stack</a> = writer;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  } <span class="keywordflow">while</span>(*enclist);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;}</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">/* Stubs for builds without HTTP. */</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn,</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *enclist, <span class="keywordtype">int</span> maybechunked)</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;{</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  (void) conn;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  (void) enclist;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  (void) maybechunked;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<a class="code" href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a> <a class="code" href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn, <a class="code" href="structcontenc__writer__s.html">contenc_writer</a> *writer,</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>, <span class="keywordtype">size_t</span> nbytes)</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;{</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  (void) conn;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  (void) writer;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  (void) <a class="code" href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  (void) nbytes;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordtype">void</span> <a class="code" href="content__encoding_8c.html#ab341f4f03f5aa236c5e5b2b25e5ff806">Curl_unencode_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="structconnectdata.html">connectdata</a> *conn)</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  (void) conn;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="content__encoding_8c.html#a2ae698f01d6cf152dce42349217ca238">Curl_all_content_encodings</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a>(<a class="code" href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">CONTENT_ENCODING_DEFAULT</a>);  <span class="comment">/* Satisfy caller. */</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;}</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CURL_DISABLE_HTTP */</span><span class="preprocessor"></span></div><div class="ttc" id="curl__memory_8h_html_a9cc854374299a1dd933bf62029761768"><div class="ttname"><a href="curl__memory_8h.html#a9cc854374299a1dd933bf62029761768">free</a></div><div class="ttdeci">#define free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00130">curl_memory.h:130</a></div></div>
<div class="ttc" id="anyauth_8d_html_a7eb9744e157c215b8e0de36856880ebf"><div class="ttname"><a href="anyauth_8d.html#a7eb9744e157c215b8e0de36856880ebf">method</a></div><div class="ttdeci">Long and use the most secure one the remote site claims to support.This is done by first doing a request and checking the response thus possibly inducing an extra network round trip.This is used instead of setting a specific authentication method</div><div class="ttdef"><b>Definition:</b> <a href="anyauth_8d_source.html#l00006">anyauth.d:6</a></div></div>
<div class="ttc" id="structcontenc__writer__s_html_aee0ea37ed58e82f302f04b5ad4c9e8c7"><div class="ttname"><a href="structcontenc__writer__s.html#aee0ea37ed58e82f302f04b5ad4c9e8c7">contenc_writer_s::params</a></div><div class="ttdeci">void * params</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00033">content_encoding.h:33</a></div></div>
<div class="ttc" id="sendf_8h_html_aae18389dfefc98a5057629f6a46fd78f"><div class="ttname"><a href="sendf_8h.html#aae18389dfefc98a5057629f6a46fd78f">CLIENTWRITE_BODY</a></div><div class="ttdeci">#define CLIENTWRITE_BODY</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00050">sendf.h:50</a></div></div>
<div class="ttc" id="content__encoding_8c_html_a592409dca77b0bc0d9abf5e5aaed368d"><div class="ttname"><a href="content__encoding_8c.html#a592409dca77b0bc0d9abf5e5aaed368d">CONTENT_ENCODING_DEFAULT</a></div><div class="ttdeci">#define CONTENT_ENCODING_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00049">content_encoding.c:49</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html"><div class="ttname"><a href="structcontent__encoding__s.html">content_encoding_s</a></div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00037">content_encoding.h:37</a></div></div>
<div class="ttc" id="proto_8d_html_ac43d17bf16fbd3acee8096864462daae"><div class="ttname"><a href="proto_8d.html#ac43d17bf16fbd3acee8096864462daae">all</a></div><div class="ttdeci">Long are comma and are each a protocol name or all</div><div class="ttdef"><b>Definition:</b> <a href="proto_8d_source.html#l00008">proto.d:8</a></div></div>
<div class="ttc" id="struct_curl__easy_html"><div class="ttname"><a href="struct_curl__easy.html">Curl_easy</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l01755">urldata.h:1755</a></div></div>
<div class="ttc" id="strcase_8h_html"><div class="ttname"><a href="strcase_8h.html">strcase.h</a></div></div>
<div class="ttc" id="structcontenc__writer__s_html"><div class="ttname"><a href="structcontenc__writer__s.html">contenc_writer_s</a></div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00030">content_encoding.h:30</a></div></div>
<div class="ttc" id="content__encoding_8c_html_a3a264e697cf79ff701b222364d3990db"><div class="ttname"><a href="content__encoding_8c.html#a3a264e697cf79ff701b222364d3990db">DSIZ</a></div><div class="ttdeci">#define DSIZ</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00053">content_encoding.c:53</a></div></div>
<div class="ttc" id="http_8h_html_a845cdb069bb2bb79c5e1a496289eb613"><div class="ttname"><a href="http_8h.html#a845cdb069bb2bb79c5e1a496289eb613">Curl_httpchunk_init</a></div><div class="ttdeci">void Curl_httpchunk_init(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="http__chunks_8c_source.html#l00090">http_chunks.c:90</a></div></div>
<div class="ttc" id="sendf_8h_html_ae8e06000059e436c9c404603126718d6"><div class="ttname"><a href="sendf_8h.html#ae8e06000059e436c9c404603126718d6">failf</a></div><div class="ttdeci">#define failf</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8h_source.html#l00048">sendf.h:48</a></div></div>
<div class="ttc" id="sendf_8h_html"><div class="ttname"><a href="sendf_8h.html">sendf.h</a></div></div>
<div class="ttc" id="curl__memory_8h_html_aa3f578f8f1eaebf25b2e2313db31cb40"><div class="ttname"><a href="curl__memory_8h.html#aa3f578f8f1eaebf25b2e2313db31cb40">strdup</a></div><div class="ttdeci">#define strdup(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00122">curl_memory.h:122</a></div></div>
<div class="ttc" id="struct_single_request_html_a6ded6fbb86cb5457049ff225c7ee8827"><div class="ttname"><a href="struct_single_request.html#a6ded6fbb86cb5457049ff225c7ee8827">SingleRequest::ignorebody</a></div><div class="ttdeci">bool ignorebody</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00591">urldata.h:591</a></div></div>
<div class="ttc" id="unit1330_8c_html_a367d241c5c363105ee629417d1dfba75"><div class="ttname"><a href="unit1330_8c.html#a367d241c5c363105ee629417d1dfba75">ptr</a></div><div class="ttdeci">UNITTEST_START char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="unit1330_8c_source.html#l00038">unit1330.c:38</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951">CURLcode</a></div><div class="ttdeci">CURLcode</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00457">curl.h:457</a></div></div>
<div class="ttc" id="content__encoding_8c_html_aa026433194b6ea0fde7a6e8682148f32"><div class="ttname"><a href="content__encoding_8c.html#aa026433194b6ea0fde7a6e8682148f32">Curl_unencode_write</a></div><div class="ttdeci">CURLcode Curl_unencode_write(struct connectdata *conn, contenc_writer *writer, const char *buf, size_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00900">content_encoding.c:900</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951ac92786e19b828c0c4a8fa5f7d6b1e01e">CURLE_NOT_BUILT_IN</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00462">curl.h:462</a></div></div>
<div class="ttc" id="curl_8h_html"><div class="ttname"><a href="curl_8h.html">curl.h</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951a15efbfbaf6168d954cd0cc855fc73553">CURLE_BAD_CONTENT_ENCODING</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00533">curl.h:533</a></div></div>
<div class="ttc" id="strcase_8h_html_a4b6a8324b9a93ddfa5413308a22bfa44"><div class="ttname"><a href="strcase_8h.html#a4b6a8324b9a93ddfa5413308a22bfa44">strcasecompare</a></div><div class="ttdeci">#define strcasecompare(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00035">strcase.h:35</a></div></div>
<div class="ttc" id="curl__memory_8h_html_a2eb0b03d1a9de9615a291b1205969069"><div class="ttname"><a href="curl__memory_8h.html#a2eb0b03d1a9de9615a291b1205969069">malloc</a></div><div class="ttdeci">#define malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00124">curl_memory.h:124</a></div></div>
<div class="ttc" id="curl__ctype_8h_html_aad859b17f001ee9fd0b0e49a7deb27b2"><div class="ttname"><a href="curl__ctype_8h.html#aad859b17f001ee9fd0b0e49a7deb27b2">ISSPACE</a></div><div class="ttdeci">#define ISSPACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="curl__ctype_8h_source.html#l00064">curl_ctype.h:64</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_ae2884773c7018f7780e559d3ced29b3f"><div class="ttname"><a href="structcontent__encoding__s.html#ae2884773c7018f7780e559d3ced29b3f">content_encoding_s::close_writer</a></div><div class="ttdeci">void(* close_writer)(struct connectdata *conn, contenc_writer *writer)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00043">content_encoding.h:43</a></div></div>
<div class="ttc" id="compressed_8d_html_a6c2ffb0bf7f4a1f29bfe33d42329479b"><div class="ttname"><a href="compressed_8d.html#a6c2ffb0bf7f4a1f29bfe33d42329479b">encoding</a></div><div class="ttdeci">Long and save the uncompressed document.If this option is used and the server sends an unsupported encoding</div><div class="ttdef"><b>Definition:</b> <a href="compressed_8d_source.html#l00005">compressed.d:5</a></div></div>
<div class="ttc" id="unit1304_8c_html_a937d4dd628a8858b443a399410d2600b"><div class="ttname"><a href="unit1304_8c.html#a937d4dd628a8858b443a399410d2600b">result</a></div><div class="ttdeci">UNITTEST_START int result</div><div class="ttdef"><b>Definition:</b> <a href="unit1304_8c_source.html#l00049">unit1304.c:49</a></div></div>
<div class="ttc" id="unit1394_8c_html_a0fb9c3165f64b5b79f3928b404818be9"><div class="ttname"><a href="unit1394_8c.html#a0fb9c3165f64b5b79f3928b404818be9">p</a></div><div class="ttdeci">const char ** p</div><div class="ttdef"><b>Definition:</b> <a href="unit1394_8c_source.html#l00079">unit1394.c:79</a></div></div>
<div class="ttc" id="content__encoding_8h_html"><div class="ttname"><a href="content__encoding_8h.html">content_encoding.h</a></div></div>
<div class="ttc" id="content__encoding_8c_html_a2ae698f01d6cf152dce42349217ca238"><div class="ttname"><a href="content__encoding_8c.html#a2ae698f01d6cf152dce42349217ca238">Curl_all_content_encodings</a></div><div class="ttdeci">char * Curl_all_content_encodings(void)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00762">content_encoding.c:762</a></div></div>
<div class="ttc" id="curl__sasl_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="curl__sasl_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="curl__sasl_8c_source.html#l00055">curl_sasl.c:55</a></div></div>
<div class="ttc" id="http_8h_html"><div class="ttname"><a href="http_8h.html">http.h</a></div></div>
<div class="ttc" id="unit1304_8c_html_a82a69fcfe92d9db6dd585ccc532a2ab7"><div class="ttname"><a href="unit1304_8c.html#a82a69fcfe92d9db6dd585ccc532a2ab7">memcpy</a></div><div class="ttdeci">memcpy(filename, filename1, strlen(filename1))</div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951aba5a22c9f705ed27933344be221fe937">CURLE_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00493">curl.h:493</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_a09abb22c58b5f7b70585d0bd04941e4b"><div class="ttname"><a href="structcontent__encoding__s.html#a09abb22c58b5f7b70585d0bd04941e4b">content_encoding_s::init_writer</a></div><div class="ttdeci">CURLcode(* init_writer)(struct connectdata *conn, contenc_writer *writer)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00040">content_encoding.h:40</a></div></div>
<div class="ttc" id="curl__setup__once_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="curl__setup__once_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="curl__setup__once_8h_source.html#l00327">curl_setup_once.h:327</a></div></div>
<div class="ttc" id="structcontenc__writer__s_html_af11db43a7da9858d292a0dc2cf2140fe"><div class="ttname"><a href="structcontenc__writer__s.html#af11db43a7da9858d292a0dc2cf2140fe">contenc_writer_s::handler</a></div><div class="ttdeci">const content_encoding * handler</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00031">content_encoding.h:31</a></div></div>
<div class="ttc" id="structcontenc__writer__s_html_ac652165a083d0246f4f24db7fd70e565"><div class="ttname"><a href="structcontenc__writer__s.html#ac652165a083d0246f4f24db7fd70e565">contenc_writer_s::downstream</a></div><div class="ttdeci">contenc_writer * downstream</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00032">content_encoding.h:32</a></div></div>
<div class="ttc" id="content__encoding_8c_html_a4bb1030923af3fb6cd027301fc4dd1db"><div class="ttname"><a href="content__encoding_8c.html#a4bb1030923af3fb6cd027301fc4dd1db">Curl_build_unencoding_stack</a></div><div class="ttdeci">CURLcode Curl_build_unencoding_stack(struct connectdata *conn, const char *enclist, int maybechunked)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00939">content_encoding.c:939</a></div></div>
<div class="ttc" id="strcase_8h_html_a48c605aaef9b3681c41d91096b6baad0"><div class="ttname"><a href="strcase_8h.html#a48c605aaef9b3681c41d91096b6baad0">strncasecompare</a></div><div class="ttdeci">#define strncasecompare(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="strcase_8h_source.html#l00036">strcase.h:36</a></div></div>
<div class="ttc" id="strdup_8c_html_a3a3f98ad97deebcb223f165b377f3879"><div class="ttname"><a href="strdup_8c.html#a3a3f98ad97deebcb223f165b377f3879">Curl_saferealloc</a></div><div class="ttdeci">void * Curl_saferealloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="strdup_8c_source.html#l00093">strdup.c:93</a></div></div>
<div class="ttc" id="remote-name_8d_html_aa335f8bb20424b03700f57b150bf0aa6"><div class="ttname"><a href="remote-name_8d.html#aa335f8bb20424b03700f57b150bf0aa6">name</a></div><div class="ttdeci">Long the path is cut off.The file will be saved in the current working directory.If you want the file saved in a different make sure you change the current working directory before invoking curl with this option.The remote file name to use for saving is extracted from the given nothing and if it already exists it will be overwritten.If you want the server to be able to choose the file name refer to remote header name which can be used in addition to this option.If the server chooses a file name and that name already exists it will not be overwritten.There is no URL decoding done on the file name.If it has or other URL encoded parts of the name</div><div class="ttdef"><b>Definition:</b> <a href="remote-name_8d_source.html#l00006">remote-name.d:6</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_afb47bf58e5f61d94be8fa55518740eb0"><div class="ttname"><a href="structcontent__encoding__s.html#afb47bf58e5f61d94be8fa55518740eb0">content_encoding_s::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00038">content_encoding.h:38</a></div></div>
<div class="ttc" id="curl__memory_8h_html"><div class="ttname"><a href="curl__memory_8h.html">curl_memory.h</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_acbf13241f57426fb4a588fb460173425"><div class="ttname"><a href="structcontent__encoding__s.html#acbf13241f57426fb4a588fb460173425">content_encoding_s::unencode_write</a></div><div class="ttdeci">CURLcode(* unencode_write)(struct connectdata *conn, contenc_writer *writer, const char *buf, size_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00041">content_encoding.h:41</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951af2fb280cf805aa199f6b63a2a27c318b">CURLE_OK</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00458">curl.h:458</a></div></div>
<div class="ttc" id="strdup_8h_html"><div class="ttname"><a href="strdup_8h.html">strdup.h</a></div></div>
<div class="ttc" id="sendf_8c_html_ad59954133649b7538b387f940b86024f"><div class="ttname"><a href="sendf_8c.html#ad59954133649b7538b387f940b86024f">Curl_client_write</a></div><div class="ttdeci">CURLcode Curl_client_write(struct connectdata *conn, int type, char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="sendf_8c_source.html#l00651">sendf.c:651</a></div></div>
<div class="ttc" id="memdebug_8h_html_a795660f73c902cc80ac0fe6cda0dbd1c"><div class="ttname"><a href="memdebug_8h.html#a795660f73c902cc80ac0fe6cda0dbd1c">Curl_safefree</a></div><div class="ttdeci">#define Curl_safefree(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memdebug_8h_source.html#l00176">memdebug.h:176</a></div></div>
<div class="ttc" id="curl__setup_8h_html"><div class="ttname"><a href="curl__setup_8h.html">curl_setup.h</a></div></div>
<div class="ttc" id="progress-bar_8d_html_ab8db689d5132c4523a63d67bedf23c8a"><div class="ttname"><a href="progress-bar_8d.html#ab8db689d5132c4523a63d67bedf23c8a">size</a></div><div class="ttdeci">Short more meter.This progress bar draws a single line of shows a percentage if the transfer size is known.For transfers without a known size</div><div class="ttdef"><b>Definition:</b> <a href="progress-bar_8d_source.html#l00006">progress-bar.d:6</a></div></div>
<div class="ttc" id="config-win32_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="config-win32_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="config-win32_8h_source.html#l00379">config-win32.h:379</a></div></div>
<div class="ttc" id="curl_8h_html_af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314"><div class="ttname"><a href="curl_8h.html#af0691941698240652e0a391394217951acaaed2faf20c957350e90a68282ae314">CURLE_WRITE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00489">curl.h:489</a></div></div>
<div class="ttc" id="content__encoding_8c_html_ab341f4f03f5aa236c5e5b2b25e5ff806"><div class="ttname"><a href="content__encoding_8c.html#ab341f4f03f5aa236c5e5b2b25e5ff806">Curl_unencode_cleanup</a></div><div class="ttdeci">void Curl_unencode_cleanup(struct connectdata *conn)</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8c_source.html#l00909">content_encoding.c:909</a></div></div>
<div class="ttc" id="unit1398_8c_html_aee5a1edd73e85934dcbe27ccbb1ef1ad"><div class="ttname"><a href="unit1398_8c.html#aee5a1edd73e85934dcbe27ccbb1ef1ad">buf</a></div><div class="ttdeci">char buf[3]</div><div class="ttdef"><b>Definition:</b> <a href="unit1398_8c_source.html#l00032">unit1398.c:32</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_a1333d29c8da540e4f1af1022c26b68a5"><div class="ttname"><a href="structcontent__encoding__s.html#a1333d29c8da540e4f1af1022c26b68a5">content_encoding_s::alias</a></div><div class="ttdeci">const char * alias</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00039">content_encoding.h:39</a></div></div>
<div class="ttc" id="urldata_8h_html"><div class="ttname"><a href="urldata_8h.html">urldata.h</a></div></div>
<div class="ttc" id="multi-debugcallback_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="multi-debugcallback_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="multi-debugcallback_8c_source.html#l00038">multi-debugcallback.c:38</a></div></div>
<div class="ttc" id="structcontent__encoding__s_html_a746cf1d2f7f8027f6da0741148ed67b9"><div class="ttname"><a href="structcontent__encoding__s.html#a746cf1d2f7f8027f6da0741148ed67b9">content_encoding_s::paramsize</a></div><div class="ttdeci">size_t paramsize</div><div class="ttdef"><b>Definition:</b> <a href="content__encoding_8h_source.html#l00044">content_encoding.h:44</a></div></div>
<div class="ttc" id="memdebug_8h_html"><div class="ttname"><a href="memdebug_8h.html">memdebug.h</a></div></div>
<div class="ttc" id="get_8d_html_a38b0ef81b65f2aee282c8c217a123176"><div class="ttname"><a href="get_8d.html#a38b0ef81b65f2aee282c8c217a123176">data</a></div><div class="ttdeci">Long this option will make all data specified with data</div><div class="ttdef"><b>Definition:</b> <a href="get_8d_source.html#l00005">get.d:5</a></div></div>
<div class="ttc" id="structconnectdata_html"><div class="ttname"><a href="structconnectdata.html">connectdata</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00782">urldata.h:782</a></div></div>
<div class="ttc" id="struct_single_request_html"><div class="ttname"><a href="struct_single_request.html">SingleRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00533">urldata.h:533</a></div></div>
<div class="ttc" id="struct_single_request_html_a3018293fe5f120a8a4c77d16207ab5da"><div class="ttname"><a href="struct_single_request.html#a3018293fe5f120a8a4c77d16207ab5da">SingleRequest::chunk</a></div><div class="ttdeci">bool chunk</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00610">urldata.h:610</a></div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="curl__memory_8h_html_abc013d1a27cb591a5316801c509c781f"><div class="ttname"><a href="curl__memory_8h.html#abc013d1a27cb591a5316801c509c781f">calloc</a></div><div class="ttdeci">#define calloc(nbelem, size)</div><div class="ttdef"><b>Definition:</b> <a href="curl__memory_8h_source.html#l00126">curl_memory.h:126</a></div></div>
<div class="ttc" id="struct_single_request_html_a7170a3761d03bcd51596bd54abc2a23c"><div class="ttname"><a href="struct_single_request.html#a7170a3761d03bcd51596bd54abc2a23c">SingleRequest::writer_stack</a></div><div class="ttdeci">struct contenc_writer_s * writer_stack</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00578">urldata.h:578</a></div></div>
<div class="ttc" id="structconnectdata_html_a3df7eee97914936f17a228eb2cf84eed"><div class="ttname"><a href="structconnectdata.html#a3df7eee97914936f17a228eb2cf84eed">connectdata::data</a></div><div class="ttdeci">struct Curl_easy * data</div><div class="ttdef"><b>Definition:</b> <a href="urldata_8h_source.html#l00786">urldata.h:786</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_e9014474357f0c50c4c87dd9066e36b7.html">curl</a></li><li class="navelem"><a class="el" href="dir_efb6013f246e7f8b3181c5014844a411.html">lib</a></li><li class="navelem"><a class="el" href="content__encoding_8c.html">content_encoding.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
