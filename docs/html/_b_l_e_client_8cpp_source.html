<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plante: esp32-snippets/cpp_utils/BLEClient.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plante
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_l_e_client_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLEClient.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_b_l_e_client_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * BLEDevice.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Mar 22, 2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: kolban</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#if defined(CONFIG_BT_ENABLED)</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;esp_log.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;esp_bt.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;esp_bt_main.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;esp_gap_ble_api.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;esp_gattc_api.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_client_8h.html">BLEClient.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_utils_8h.html">BLEUtils.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_service_8h.html">BLEService.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_general_utils_8h.html">GeneralUtils.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_b_l_e_device_8h.html">BLEDevice.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifdef ARDUINO_ARCH_ESP32</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;esp32-hal-log.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * Design</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * ------</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * When we perform a searchService() requests, we are asking the BLE server to return each of the services</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * that it exposes.  For each service, we received an ESP_GATTC_SEARCH_RES_EVT event which contains details</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * of the exposed service including its UUID.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * The objects we will invent for a BLEClient will be as follows:</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * * BLERemoteService - A model of a remote service.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * * BLERemoteCharacteristic - A model of a remote characteristic</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * * BLERemoteDescriptor - A model of a remote descriptor.</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * Since there is a hierarchical relationship here, we will have the idea that from a BLERemoteService will own</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * zero or more remote characteristics and a BLERemoteCharacteristic will own zero or more remote BLEDescriptors.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * We will assume that a BLERemoteService contains a map that maps BLEUUIDs to the set of owned characteristics</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * and that a BLECharacteristic contains a map that maps BLEUUIDs to the set of owned descriptors.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* LOG_TAG = <span class="stringliteral">&quot;BLEClient&quot;</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#ac97e0fc24717030e89d034ba0028f434">   48</a></span>&#160;<a class="code" href="class_b_l_e_client.html#ac97e0fc24717030e89d034ba0028f434">BLEClient::BLEClient</a>() {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    m_pClientCallbacks = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    m_conn_id          = ESP_GATT_IF_NONE;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    m_gattc_if         = ESP_GATT_IF_NONE;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    m_haveServices     = <span class="keyword">false</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    m_isConnected      = <span class="keyword">false</span>;  <span class="comment">// Initially, we are flagged as not connected.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;} <span class="comment">// BLEClient</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a2b88183c446949416774e833755b0e81">   60</a></span>&#160;<a class="code" href="class_b_l_e_client.html#a2b88183c446949416774e833755b0e81">BLEClient::~BLEClient</a>() {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// We may have allocated service references associated with this client.  Before we are finished</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// with the client, we must release resources.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_servicesMap) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       <span class="keyword">delete</span> myPair.second;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    m_servicesMap.clear();</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;} <span class="comment">// ~BLEClient</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">void</span> BLEClient::clearServices() {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; clearServices&quot;</span>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Delete all the services.</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_servicesMap) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       <span class="keyword">delete</span> myPair.second;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    m_servicesMap.clear();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    m_haveServices = <span class="keyword">false</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; clearServices&quot;</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;} <span class="comment">// clearServices</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#ac12af63aaf2f5048de66f30d69914dda">   88</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_client.html#ac12af63aaf2f5048de66f30d69914dda">BLEClient::connect</a>(<a class="code" href="class_b_l_e_advertised_device.html">BLEAdvertisedDevice</a>* device) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_b_l_e_address.html">BLEAddress</a> address =  device-&gt;<a class="code" href="class_b_l_e_advertised_device.html#a2584fc39d2caa62ea38e2d7bfcf2ccc9">getAddress</a>();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    esp_ble_addr_type_t <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a> = device-&gt;<a class="code" href="class_b_l_e_advertised_device.html#aa8c9eecbe892a94813f3faaf0e7a680d">getAddressType</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_b_l_e_client.html#ac12af63aaf2f5048de66f30d69914dda">connect</a>(address, <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#adc977714c20994be106dd55f3f3f445f">   99</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_client.html#ac12af63aaf2f5048de66f30d69914dda">BLEClient::connect</a>(<a class="code" href="class_b_l_e_address.html">BLEAddress</a> address, esp_ble_addr_type_t <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; connect(%s)&quot;</span>, address.<a class="code" href="class_b_l_e_address.html#a495521811cabfb55acd38e393f701508">toString</a>().c_str());</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// We need the connection handle that we get from registering the application.  We register the app</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// and then block on its completion.  When the event has arrived, we will have the handle.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="class_b_l_e_client.html#a2eebb9473747614b522219bf61598778">m_appId</a> = <a class="code" href="class_b_l_e_device.html#a9c83ccd1b47eaa043f33688d588429ae">BLEDevice::m_appId</a>++;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="class_b_l_e_device.html#a5c7aa94032cc83fb2ac81b4cd7381b8b">BLEDevice::addPeerDevice</a>(<span class="keyword">this</span>, <span class="keyword">true</span>, <a class="code" href="class_b_l_e_client.html#a2eebb9473747614b522219bf61598778">m_appId</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    m_semaphoreRegEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;connect&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// clearServices(); // we dont need to delete services since every client is unique?</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_app_register(<a class="code" href="class_b_l_e_client.html#a2eebb9473747614b522219bf61598778">m_appId</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_app_register: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    m_semaphoreRegEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;connect&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    m_peerAddress = address;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Perform the open connection request against the target BLE Server.</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    m_semaphoreOpenEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;connect&quot;</span>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    errRc = ::esp_ble_gattc_open(</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        m_gattc_if,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        *<a class="code" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">getPeerAddress</a>().getNative(), <span class="comment">// address</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>,          <span class="comment">// Note: This was added on 2018-04-03 when the latest ESP-IDF was detected to have changed the signature.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        1                              <span class="comment">// direct connection &lt;-- maybe needs to be changed in case of direct indirect connection???</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    );</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_open: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    uint32_t <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = m_semaphoreOpenEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;connect&quot;</span>);   <span class="comment">// Wait for the connection to complete.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; connect(), rc=%d&quot;</span>, <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>==ESP_GATT_OK);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> == ESP_GATT_OK;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;} <span class="comment">// connect</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a967a3ce9f960232db674f5b130894f47">  142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_client.html#a967a3ce9f960232db674f5b130894f47">BLEClient::disconnect</a>() {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; disconnect()&quot;</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    esp_err_t errRc = ::esp_ble_gattc_close(<a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(), <a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>());</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_close: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; disconnect()&quot;</span>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;} <span class="comment">// disconnect</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">void</span> BLEClient::gattClientEventHandler(</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    esp_gattc_cb_event_t      event,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    esp_gatt_if_t             gattc_if,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    esp_ble_gattc_cb_param_t* evtParam) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;gattClientEventHandler [esp_gatt_if: %d] ... %s&quot;</span>,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        gattc_if, <a class="code" href="class_b_l_e_utils.html#a0cc7ec1c40c17c7f04ed31e2166e656c">BLEUtils::gattClientEventTypeToString</a>(event).c_str());</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Execute handler code based on the type of event received.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">switch</span>(event) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_SRVC_CHG_EVT:</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            ESP_LOGI(LOG_TAG, <span class="stringliteral">&quot;SERVICE CHANGED&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_CLOSE_EVT: {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="comment">// esp_ble_gattc_app_unregister(m_appId);</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="comment">// BLEDevice::removePeerDevice(m_gattc_if, true);</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// ESP_GATTC_DISCONNECT_EVT</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">// disconnect:</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// - uint16_t          conn_id</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// - esp_bd_addr_t     remote_bda</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_DISCONNECT_EVT: {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="comment">// If we receive a disconnect event, set the class flag that indicates that we are</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="comment">// no longer connected.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                m_isConnected = <span class="keyword">false</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">if</span> (m_pClientCallbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    m_pClientCallbacks-&gt;<a class="code" href="class_b_l_e_client_callbacks.html#a2b863cf853b84f2dccddfe5b67e2e50e">onDisconnect</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <a class="code" href="class_b_l_e_device.html#a239ac61bffa6e3fbc95a68591de0063b">BLEDevice::removePeerDevice</a>(<a class="code" href="class_b_l_e_client.html#a2eebb9473747614b522219bf61598778">m_appId</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                esp_ble_gattc_app_unregister(m_gattc_if);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                m_semaphoreRssiCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                m_semaphoreSearchCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>(1);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        } <span class="comment">// ESP_GATTC_DISCONNECT_EVT</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// ESP_GATTC_OPEN_EVT</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// open:</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// - uint16_t          conn_id</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// - esp_bd_addr_t     remote_bda</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_OPEN_EVT: {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            m_conn_id = evtParam-&gt;open.conn_id;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">if</span> (m_pClientCallbacks != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                m_pClientCallbacks-&gt;<a class="code" href="class_b_l_e_client_callbacks.html#a82bc1491252b8f9b003c9162096389d7">onConnect</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">if</span> (evtParam-&gt;open.status == ESP_GATT_OK) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                m_isConnected = <span class="keyword">true</span>;   <span class="comment">// Flag us as connected.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            m_semaphoreOpenEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>(evtParam-&gt;open.status);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        } <span class="comment">// ESP_GATTC_OPEN_EVT</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">// ESP_GATTC_REG_EVT</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// reg:</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// esp_gatt_status_t status</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// uint16_t          app_id</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_REG_EVT: {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            m_gattc_if = gattc_if;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            m_semaphoreRegEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        } <span class="comment">// ESP_GATTC_REG_EVT</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_CFG_MTU_EVT:</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">if</span>(evtParam-&gt;cfg_mtu.status != ESP_GATT_OK) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                ESP_LOGE(LOG_TAG,<span class="stringliteral">&quot;Config mtu failed&quot;</span>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            m_mtu = evtParam-&gt;cfg_mtu.mtu;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_CONNECT_EVT: {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <a class="code" href="class_b_l_e_device.html#ae4ce2ef9c6b3b5db6682dda4912e7915">BLEDevice::updatePeerDevice</a>(<span class="keyword">this</span>, <span class="keyword">true</span>, m_gattc_if);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            esp_err_t errRc = esp_ble_gattc_send_mtu_req(gattc_if, evtParam-&gt;connect.conn_id);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_send_mtu_req: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">#ifdef CONFIG_BLE_SMP_ENABLE   // Check that BLE SMP (security) is configured in make menuconfig</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_b_l_e_device.html#acbb5c622e4fb754495919d1216e47808">BLEDevice::m_securityLevel</a>){</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                esp_ble_set_encryption(evtParam-&gt;connect.remote_bda, <a class="code" href="class_b_l_e_device.html#acbb5c622e4fb754495919d1216e47808">BLEDevice::m_securityLevel</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif  // CONFIG_BLE_SMP_ENABLE</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        } <span class="comment">// ESP_GATTC_CONNECT_EVT</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// ESP_GATTC_SEARCH_CMPL_EVT</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// search_cmpl:</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// - esp_gatt_status_t status</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// - uint16_t          conn_id</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_SEARCH_CMPL_EVT: {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            esp_ble_gattc_cb_param_t* p_data = (esp_ble_gattc_cb_param_t*)evtParam;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (p_data-&gt;search_cmpl.status != ESP_GATT_OK){</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;search service failed, error status = %x&quot;</span>, p_data-&gt;search_cmpl.status);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#ifndef ARDUINO_ARCH_ESP32</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">// commented out just for now to keep backward compatibility            </span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">// if(p_data-&gt;search_cmpl.searched_service_source == ESP_GATT_SERVICE_FROM_REMOTE_DEVICE) {</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">//  ESP_LOGI(LOG_TAG, &quot;Get service information from remote device&quot;);</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">// } else if (p_data-&gt;search_cmpl.searched_service_source == ESP_GATT_SERVICE_FROM_NVS_FLASH) {</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">//  ESP_LOGI(LOG_TAG, &quot;Get service information from flash&quot;);</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// } else {</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">//  ESP_LOGI(LOG_TAG, &quot;unknown service source&quot;);</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">// }</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            m_semaphoreSearchCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>(0);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        } <span class="comment">// ESP_GATTC_SEARCH_CMPL_EVT</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// ESP_GATTC_SEARCH_RES_EVT</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// search_res:</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// - uint16_t      conn_id</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// - uint16_t      start_handle</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// - uint16_t      end_handle</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// - esp_gatt_id_t srvc_id</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">case</span> ESP_GATTC_SEARCH_RES_EVT: {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> uuid = <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(evtParam-&gt;search_res.srvc_id);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="class_b_l_e_remote_service.html">BLERemoteService</a>* pRemoteService = <span class="keyword">new</span> <a class="code" href="class_b_l_e_client.html#a43613776d3f39890c4b6b01079c46b0c">BLERemoteService</a>(</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                evtParam-&gt;search_res.srvc_id,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keyword">this</span>,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                evtParam-&gt;search_res.start_handle,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                evtParam-&gt;search_res.end_handle</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            m_servicesMap.insert(std::pair&lt;std::string, BLERemoteService*&gt;(uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>(), pRemoteService));</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            m_servicesMapByInstID.insert(std::pair&lt;BLERemoteService *, uint16_t&gt;(pRemoteService, evtParam-&gt;search_res.srvc_id.inst_id));</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        } <span class="comment">// ESP_GATTC_SEARCH_RES_EVT</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    } <span class="comment">// Switch</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Pass the request on to all services.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_servicesMap) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;       myPair.second-&gt;gattClientEventHandler(event, gattc_if, evtParam);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;} <span class="comment">// gattClientEventHandler</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">  317</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">BLEClient::getConnId</a>() {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> m_conn_id;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;} <span class="comment">// getConnId</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">  323</a></span>&#160;esp_gatt_if_t <a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">BLEClient::getGattcIf</a>() {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> m_gattc_if;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;} <span class="comment">// getGattcIf</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">  333</a></span>&#160;<a class="code" href="class_b_l_e_address.html">BLEAddress</a> <a class="code" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">BLEClient::getPeerAddress</a>() {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> m_peerAddress;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;} <span class="comment">// getAddress</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a3035501ca754a8e620cd7740a9f25e0a">  342</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_b_l_e_client.html#a3035501ca754a8e620cd7740a9f25e0a">BLEClient::getRssi</a>() {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; getRssi()&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_b_l_e_client.html#a1e31adfb0084ccc4d93748b694575a5b">isConnected</a>()) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getRssi(): Not connected&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// We make the API call to read the RSSI value which is an asynchronous operation.  We expect to receive</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// an ESP_GAP_BLE_READ_RSSI_COMPLETE_EVT to indicate completion.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    m_semaphoreRssiCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;getRssi&quot;</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    esp_err_t <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> = ::esp_ble_gap_read_rssi(*<a class="code" href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">getPeerAddress</a>().getNative());</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a> != ESP_OK) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getRssi: esp_ble_gap_read_rssi: rc=%d %s&quot;</span>, <a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(<a class="code" href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">rc</a>));</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">int</span> rssiValue = m_semaphoreRssiCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;getRssi&quot;</span>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getRssi(): %d&quot;</span>, rssiValue);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> rssiValue;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;} <span class="comment">// getRssi</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">  368</a></span>&#160;<a class="code" href="class_b_l_e_remote_service.html">BLERemoteService</a>* <a class="code" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">BLEClient::getService</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* uuid) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">getService</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a>(uuid));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;} <span class="comment">// getService</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a4e3287e8bbb4a716a0294e3416f6fece">  379</a></span>&#160;<a class="code" href="class_b_l_e_remote_service.html">BLERemoteService</a>* <a class="code" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">BLEClient::getService</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> uuid) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; getService: uuid: %s&quot;</span>, uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">// Design</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">// ------</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">// We wish to retrieve the service given its UUID.  It is possible that we have not yet asked the</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">// device what services it has in which case we have nothing to match against.  If we have not</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">// asked the device about its services, then we do that now.  Once we get the results we can then</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">// examine the services map to see if it has the service we are looking for.</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (!m_haveServices) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="class_b_l_e_client.html#a3a11760460b78b3f0fa368c5811c575e">getServices</a>();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> uuidStr = uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_servicesMap) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">if</span> (myPair.first == uuidStr) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getService: found the service with uuid: %s&quot;</span>, uuid.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">return</span> myPair.second;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    } <span class="comment">// End of each of the services.</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getService: not found&quot;</span>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;} <span class="comment">// getService</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a3a11760460b78b3f0fa368c5811c575e">  408</a></span>&#160;std::map&lt;std::string, BLERemoteService*&gt;* <a class="code" href="class_b_l_e_client.html#a3a11760460b78b3f0fa368c5811c575e">BLEClient::getServices</a>() {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> * Design</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> * ------</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> * We invoke esp_ble_gattc_search_service.  This will request a list of the service exposed by the</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> * peer BLE partner to be returned as events.  Each event will be an an instance of ESP_GATTC_SEARCH_RES_EVT</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> * and will culminate with an ESP_GATTC_SEARCH_CMPL_EVT when all have been received.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; getServices&quot;</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">// TODO implement retrieving services from cache</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    clearServices(); <span class="comment">// Clear any services that may exist.</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    esp_err_t errRc = esp_ble_gattc_search_service(</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">getGattcIf</a>(),</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">getConnId</a>(),</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        NULL            <span class="comment">// Filter UUID</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    );</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    m_semaphoreSearchCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">take</a>(<span class="stringliteral">&quot;getServices&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (errRc != ESP_OK) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        ESP_LOGE(LOG_TAG, <span class="stringliteral">&quot;esp_ble_gattc_search_service: rc=%d %s&quot;</span>, errRc, <a class="code" href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a>(errRc));</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span> &amp;m_servicesMap;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// If sucessfull, remember that we now have services.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    m_haveServices = (m_semaphoreSearchCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">wait</a>(<span class="stringliteral">&quot;getServices&quot;</span>) == 0);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; getServices&quot;</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> &amp;m_servicesMap;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;} <span class="comment">// getServices</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a577ea2d5045eff78930bc7a8566bf54c">  444</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_client.html#a577ea2d5045eff78930bc7a8566bf54c">BLEClient::getValue</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> serviceUUID, <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> characteristicUUID) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; getValue: serviceUUID: %s, characteristicUUID: %s&quot;</span>, serviceUUID.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str(), characteristicUUID.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> ret = <a class="code" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">getService</a>(serviceUUID)-&gt;<a class="code" href="class_b_l_e_remote_service.html#afa7ce75f76f9c905eef0593449854ce1">getCharacteristic</a>(characteristicUUID)-&gt;<a class="code" href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">readValue</a>();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt;getValue&quot;</span>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;} <span class="comment">// getValue</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a26f856ebef790cc89dc99d3ff5a185b4">  458</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_client.html#a26f856ebef790cc89dc99d3ff5a185b4">BLEClient::handleGAPEvent</a>(</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        esp_gap_ble_cb_event_t  event,</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        esp_ble_gap_cb_param_t* param) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;BLEClient ... handling GAP event!&quot;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">switch</span> (event) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// ESP_GAP_BLE_READ_RSSI_COMPLETE_EVT</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="comment">// read_rssi_cmpl</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">// - esp_bt_status_t status</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">// - int8_t rssi</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">// - esp_bd_addr_t remote_addr</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">case</span> ESP_GAP_BLE_READ_RSSI_COMPLETE_EVT: {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            m_semaphoreRssiCmplEvt.<a class="code" href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">give</a>((uint32_t) param-&gt;read_rssi_cmpl.rssi);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        } <span class="comment">// ESP_GAP_BLE_READ_RSSI_COMPLETE_EVT</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;} <span class="comment">// handleGAPEvent</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a1e31adfb0084ccc4d93748b694575a5b">  486</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_b_l_e_client.html#a1e31adfb0084ccc4d93748b694575a5b">BLEClient::isConnected</a>() {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> m_isConnected;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;} <span class="comment">// isConnected</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a59ed8aa19238140b1c022e7adc75f79c">  496</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_client.html#a59ed8aa19238140b1c022e7adc75f79c">BLEClient::setClientCallbacks</a>(<a class="code" href="class_b_l_e_client_callbacks.html">BLEClientCallbacks</a>* pClientCallbacks) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    m_pClientCallbacks = pClientCallbacks;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;} <span class="comment">// setClientCallbacks</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a10927bbdd67bfb76fd80c64d9a4b7b9b">  507</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_b_l_e_client.html#a10927bbdd67bfb76fd80c64d9a4b7b9b">BLEClient::setValue</a>(<a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> serviceUUID, <a class="code" href="class_b_l_e_u_u_i_d.html">BLEUUID</a> characteristicUUID, <a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&gt;&gt; setValue: serviceUUID: %s, characteristicUUID: %s&quot;</span>, serviceUUID.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str(), characteristicUUID.<a class="code" href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">toString</a>().c_str());</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">getService</a>(serviceUUID)-&gt;<a class="code" href="class_b_l_e_remote_service.html#afa7ce75f76f9c905eef0593449854ce1">getCharacteristic</a>(characteristicUUID)-&gt;<a class="code" href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">writeValue</a>(<a class="code" href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    ESP_LOGD(LOG_TAG, <span class="stringliteral">&quot;&lt;&lt; setValue&quot;</span>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;} <span class="comment">// setValue</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#afd5eb1de1f593ab56e9c82320315c75c">  513</a></span>&#160;uint16_t <a class="code" href="class_b_l_e_client.html#afd5eb1de1f593ab56e9c82320315c75c">BLEClient::getMTU</a>() {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> m_mtu;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="class_b_l_e_client.html#a55209904b6c007e197fc3fd637ce0a6f">  521</a></span>&#160;<a class="code" href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">std::string</a> <a class="code" href="class_b_l_e_client.html#a55209904b6c007e197fc3fd637ce0a6f">BLEClient::toString</a>() {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    std::ostringstream ss;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;peer address: &quot;</span> &lt;&lt; m_peerAddress.<a class="code" href="class_b_l_e_address.html#a495521811cabfb55acd38e393f701508">toString</a>();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;\nServices:\n&quot;</span>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;myPair : m_servicesMap) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        ss &lt;&lt; myPair.second-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="comment">// myPair.second is the value</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> ss.str();</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;} <span class="comment">// toString</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#endif // CONFIG_BT_ENABLED</span></div><div class="ttc" id="class_b_l_e_u_u_i_d_html"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html">BLEUUID</a></div><div class="ttdoc">A model of a BLE UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8h_source.html#l00018">BLEUUID.h:18</a></div></div>
<div class="ttc" id="_general_utils_8h_html"><div class="ttname"><a href="_general_utils_8h.html">GeneralUtils.h</a></div></div>
<div class="ttc" id="class_b_l_e_address_html"><div class="ttname"><a href="class_b_l_e_address.html">BLEAddress</a></div><div class="ttdoc">A BLE device address. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_address_8h_source.html#l00021">BLEAddress.h:21</a></div></div>
<div class="ttc" id="_b_l_e_utils_8h_html"><div class="ttname"><a href="_b_l_e_utils_8h.html">BLEUtils.h</a></div></div>
<div class="ttc" id="_b_l_e_device_8h_html"><div class="ttname"><a href="_b_l_e_device_8h.html">BLEDevice.h</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a3a11760460b78b3f0fa368c5811c575e"><div class="ttname"><a href="class_b_l_e_client.html#a3a11760460b78b3f0fa368c5811c575e">BLEClient::getServices</a></div><div class="ttdeci">std::map&lt; std::string, BLERemoteService * &gt; * getServices()</div><div class="ttdoc">Ask the remote BLE server for its services. A BLE Server exposes a set of services for its partners...</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00408">BLEClient.cpp:408</a></div></div>
<div class="ttc" id="connect-to_8d_html_a450c41f520f7661f0a48b8fd2597a74c"><div class="ttname"><a href="connect-to_8d.html#a450c41f520f7661f0a48b8fd2597a74c">string</a></div><div class="ttdeci">Long connect to e.g.at a specific cluster node in a cluster of servers.This option is only used to establish the network connection.It does NOT affect the hostname port that is used for TLS meaning any host port.HOST2 and PORT2 may also be the empty string</div><div class="ttdef"><b>Definition:</b> <a href="connect-to_8d_source.html#l00014">connect-to.d:14</a></div></div>
<div class="ttc" id="class_b_l_e_utils_html_a0cc7ec1c40c17c7f04ed31e2166e656c"><div class="ttname"><a href="class_b_l_e_utils.html#a0cc7ec1c40c17c7f04ed31e2166e656c">BLEUtils::gattClientEventTypeToString</a></div><div class="ttdeci">static std::string gattClientEventTypeToString(esp_gattc_cb_event_t eventType)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_utils_8cpp_source.html#l00863">BLEUtils.cpp:863</a></div></div>
<div class="ttc" id="namespacedictserver_html_aeb700c49a1a229869c3b36509a6c6c32"><div class="ttname"><a href="namespacedictserver.html#aeb700c49a1a229869c3b36509a6c6c32">dictserver.rc</a></div><div class="ttdeci">def rc</div><div class="ttdef"><b>Definition:</b> <a href="dictserver_8py_source.html#l00153">dictserver.py:153</a></div></div>
<div class="ttc" id="class_b_l_e_device_html_ae4ce2ef9c6b3b5db6682dda4912e7915"><div class="ttname"><a href="class_b_l_e_device.html#ae4ce2ef9c6b3b5db6682dda4912e7915">BLEDevice::updatePeerDevice</a></div><div class="ttdeci">static void updatePeerDevice(void *peer, bool _client, uint16_t conn_id)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_device_8cpp_source.html#l00577">BLEDevice.cpp:577</a></div></div>
<div class="ttc" id="class_b_l_e_remote_service_html"><div class="ttname"><a href="class_b_l_e_remote_service.html">BLERemoteService</a></div><div class="ttdoc">A model of a remote BLE service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_service_8h_source.html#l00027">BLERemoteService.h:27</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_ad1aa158e37d15363b4441482fae82dd8"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#ad1aa158e37d15363b4441482fae82dd8">FreeRTOS::Semaphore::give</a></div><div class="ttdeci">void give()</div><div class="ttdoc">Give a semaphore. The Semaphore is given. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00114">FreeRTOS.cpp:114</a></div></div>
<div class="ttc" id="class_b_l_e_remote_service_html_afa7ce75f76f9c905eef0593449854ce1"><div class="ttname"><a href="class_b_l_e_remote_service.html#afa7ce75f76f9c905eef0593449854ce1">BLERemoteService::getCharacteristic</a></div><div class="ttdeci">BLERemoteCharacteristic * getCharacteristic(const char *uuid)</div><div class="ttdoc">Get the remote characteristic object for the characteristic UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_service_8cpp_source.html#l00128">BLERemoteService.cpp:128</a></div></div>
<div class="ttc" id="class_b_l_e_client_callbacks_html_a2b863cf853b84f2dccddfe5b67e2e50e"><div class="ttname"><a href="class_b_l_e_client_callbacks.html#a2b863cf853b84f2dccddfe5b67e2e50e">BLEClientCallbacks::onDisconnect</a></div><div class="ttdeci">virtual void onDisconnect(BLEClient *pClient)=0</div></div>
<div class="ttc" id="class_b_l_e_client_html_ac97e0fc24717030e89d034ba0028f434"><div class="ttname"><a href="class_b_l_e_client.html#ac97e0fc24717030e89d034ba0028f434">BLEClient::BLEClient</a></div><div class="ttdeci">BLEClient()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00048">BLEClient.cpp:48</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_ac12af63aaf2f5048de66f30d69914dda"><div class="ttname"><a href="class_b_l_e_client.html#ac12af63aaf2f5048de66f30d69914dda">BLEClient::connect</a></div><div class="ttdeci">bool connect(BLEAdvertisedDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00088">BLEClient.cpp:88</a></div></div>
<div class="ttc" id="class_b_l_e_advertised_device_html_aa8c9eecbe892a94813f3faaf0e7a680d"><div class="ttname"><a href="class_b_l_e_advertised_device.html#aa8c9eecbe892a94813f3faaf0e7a680d">BLEAdvertisedDevice::getAddressType</a></div><div class="ttdeci">esp_ble_addr_type_t getAddressType()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_advertised_device_8cpp_source.html#l00514">BLEAdvertisedDevice.cpp:514</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_aecd512f950b6a0151941d139d78b19aa"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#aecd512f950b6a0151941d139d78b19aa">BLERemoteCharacteristic::writeValue</a></div><div class="ttdeci">void writeValue(uint8_t *data, size_t length, bool response=false)</div><div class="ttdoc">Write the new value for the characteristic from a data buffer. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00546">BLERemoteCharacteristic.cpp:546</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a77a59257b14ea766abad17a2e43749c4"><div class="ttname"><a href="class_b_l_e_client.html#a77a59257b14ea766abad17a2e43749c4">BLEClient::getPeerAddress</a></div><div class="ttdeci">BLEAddress getPeerAddress()</div><div class="ttdoc">Retrieve the address of the peer. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00333">BLEClient.cpp:333</a></div></div>
<div class="ttc" id="form_8d_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="form_8d.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="form_8d_source.html#l00048">form.d:48</a></div></div>
<div class="ttc" id="class_b_l_e_device_html_a239ac61bffa6e3fbc95a68591de0063b"><div class="ttname"><a href="class_b_l_e_device.html#a239ac61bffa6e3fbc95a68591de0063b">BLEDevice::removePeerDevice</a></div><div class="ttdeci">static void removePeerDevice(uint16_t conn_id, bool client)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_device_8cpp_source.html#l00604">BLEDevice.cpp:604</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a1e31adfb0084ccc4d93748b694575a5b"><div class="ttname"><a href="class_b_l_e_client.html#a1e31adfb0084ccc4d93748b694575a5b">BLEClient::isConnected</a></div><div class="ttdeci">bool isConnected()</div><div class="ttdoc">Are we connected to a partner? </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00486">BLEClient.cpp:486</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a59ed8aa19238140b1c022e7adc75f79c"><div class="ttname"><a href="class_b_l_e_client.html#a59ed8aa19238140b1c022e7adc75f79c">BLEClient::setClientCallbacks</a></div><div class="ttdeci">void setClientCallbacks(BLEClientCallbacks *pClientCallbacks)</div><div class="ttdoc">Set the callbacks that will be invoked. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00496">BLEClient.cpp:496</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a0f6325af99860af39fe15372864c0786"><div class="ttname"><a href="class_b_l_e_client.html#a0f6325af99860af39fe15372864c0786">BLEClient::getConnId</a></div><div class="ttdeci">uint16_t getConnId()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00317">BLEClient.cpp:317</a></div></div>
<div class="ttc" id="class_b_l_e_device_html_acbb5c622e4fb754495919d1216e47808"><div class="ttname"><a href="class_b_l_e_device.html#acbb5c622e4fb754495919d1216e47808">BLEDevice::m_securityLevel</a></div><div class="ttdeci">static esp_ble_sec_act_t m_securityLevel</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_device_8h_source.html#l00065">BLEDevice.h:65</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_ad46efb4c86113700133a7ec15dd78ff5"><div class="ttname"><a href="class_b_l_e_client.html#ad46efb4c86113700133a7ec15dd78ff5">BLEClient::getService</a></div><div class="ttdeci">BLERemoteService * getService(const char *uuid)</div><div class="ttdoc">Get the service BLE Remote Service instance corresponding to the uuid. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00368">BLEClient.cpp:368</a></div></div>
<div class="ttc" id="class_general_utils_html_a25e466e54ff002f54bfb7e1f43bd401b"><div class="ttname"><a href="class_general_utils.html#a25e466e54ff002f54bfb7e1f43bd401b">GeneralUtils::errorToString</a></div><div class="ttdeci">static const char * errorToString(esp_err_t errCode)</div><div class="ttdoc">Convert an ESP error code to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_general_utils_8cpp_source.html#l00366">GeneralUtils.cpp:366</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a023cb404ff897bb39064b454732ccf21"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a023cb404ff897bb39064b454732ccf21">FreeRTOS::Semaphore::wait</a></div><div class="ttdeci">uint32_t wait(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Wait for a semaphore to be released by trying to take it and then releasing it again. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00064">FreeRTOS.cpp:64</a></div></div>
<div class="ttc" id="class_b_l_e_device_html_a5c7aa94032cc83fb2ac81b4cd7381b8b"><div class="ttname"><a href="class_b_l_e_device.html#a5c7aa94032cc83fb2ac81b4cd7381b8b">BLEDevice::addPeerDevice</a></div><div class="ttdeci">static void addPeerDevice(void *peer, bool is_client, uint16_t conn_id)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_device_8cpp_source.html#l00593">BLEDevice.cpp:593</a></div></div>
<div class="ttc" id="class_b_l_e_address_html_a495521811cabfb55acd38e393f701508"><div class="ttname"><a href="class_b_l_e_address.html#a495521811cabfb55acd38e393f701508">BLEAddress::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Convert a BLE address to a string. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_address_8cpp_source.html#l00085">BLEAddress.cpp:85</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a26f856ebef790cc89dc99d3ff5a185b4"><div class="ttname"><a href="class_b_l_e_client.html#a26f856ebef790cc89dc99d3ff5a185b4">BLEClient::handleGAPEvent</a></div><div class="ttdeci">void handleGAPEvent(esp_gap_ble_cb_event_t event, esp_ble_gap_cb_param_t *param)</div><div class="ttdoc">Handle a received GAP event. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00458">BLEClient.cpp:458</a></div></div>
<div class="ttc" id="_b_l_e_client_8h_html"><div class="ttname"><a href="_b_l_e_client_8h.html">BLEClient.h</a></div></div>
<div class="ttc" id="class_b_l_e_device_html_a9c83ccd1b47eaa043f33688d588429ae"><div class="ttname"><a href="class_b_l_e_device.html#a9c83ccd1b47eaa043f33688d588429ae">BLEDevice::m_appId</a></div><div class="ttdeci">static uint16_t m_appId</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_device_8h_source.html#l00053">BLEDevice.h:53</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a2b88183c446949416774e833755b0e81"><div class="ttname"><a href="class_b_l_e_client.html#a2b88183c446949416774e833755b0e81">BLEClient::~BLEClient</a></div><div class="ttdeci">~BLEClient()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00060">BLEClient.cpp:60</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a3035501ca754a8e620cd7740a9f25e0a"><div class="ttname"><a href="class_b_l_e_client.html#a3035501ca754a8e620cd7740a9f25e0a">BLEClient::getRssi</a></div><div class="ttdeci">int getRssi()</div><div class="ttdoc">Ask the BLE server for the RSSI value. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00342">BLEClient.cpp:342</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a577ea2d5045eff78930bc7a8566bf54c"><div class="ttname"><a href="class_b_l_e_client.html#a577ea2d5045eff78930bc7a8566bf54c">BLEClient::getValue</a></div><div class="ttdeci">std::string getValue(BLEUUID serviceUUID, BLEUUID characteristicUUID)</div><div class="ttdoc">Get the value of a specific characteristic associated with a specific service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00444">BLEClient.cpp:444</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a43613776d3f39890c4b6b01079c46b0c"><div class="ttname"><a href="class_b_l_e_client.html#a43613776d3f39890c4b6b01079c46b0c">BLEClient::BLERemoteService</a></div><div class="ttdeci">friend class BLERemoteService</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8h_source.html#l00064">BLEClient.h:64</a></div></div>
<div class="ttc" id="_b_l_e_service_8h_html"><div class="ttname"><a href="_b_l_e_service_8h.html">BLEService.h</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a2eebb9473747614b522219bf61598778"><div class="ttname"><a href="class_b_l_e_client.html#a2eebb9473747614b522219bf61598778">BLEClient::m_appId</a></div><div class="ttdeci">uint16_t m_appId</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8h_source.html#l00061">BLEClient.h:61</a></div></div>
<div class="ttc" id="unit1602_8c_html_a1f81d06f9ccd5ec47176a7fc466b6030"><div class="ttname"><a href="unit1602_8c.html#a1f81d06f9ccd5ec47176a7fc466b6030">value</a></div><div class="ttdeci">UNITTEST_START int * value</div><div class="ttdef"><b>Definition:</b> <a href="unit1602_8c_source.html#l00051">unit1602.c:51</a></div></div>
<div class="ttc" id="class_b_l_e_u_u_i_d_html_a52e30a254e1ff10a429c2e0a36a6131d"><div class="ttname"><a href="class_b_l_e_u_u_i_d.html#a52e30a254e1ff10a429c2e0a36a6131d">BLEUUID::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Get a string representation of the UUID. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_u_u_i_d_8cpp_source.html#l00355">BLEUUID.cpp:355</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a68566b6eeeae65ea12c7b361e1f23add"><div class="ttname"><a href="class_b_l_e_client.html#a68566b6eeeae65ea12c7b361e1f23add">BLEClient::getGattcIf</a></div><div class="ttdeci">esp_gatt_if_t getGattcIf()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00323">BLEClient.cpp:323</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a967a3ce9f960232db674f5b130894f47"><div class="ttname"><a href="class_b_l_e_client.html#a967a3ce9f960232db674f5b130894f47">BLEClient::disconnect</a></div><div class="ttdeci">void disconnect()</div><div class="ttdoc">Disconnect from the peer. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00142">BLEClient.cpp:142</a></div></div>
<div class="ttc" id="class_b_l_e_advertised_device_html_a2584fc39d2caa62ea38e2d7bfcf2ccc9"><div class="ttname"><a href="class_b_l_e_advertised_device.html#a2584fc39d2caa62ea38e2d7bfcf2ccc9">BLEAdvertisedDevice::getAddress</a></div><div class="ttdeci">BLEAddress getAddress()</div><div class="ttdoc">Get the address. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_advertised_device_8cpp_source.html#l00055">BLEAdvertisedDevice.cpp:55</a></div></div>
<div class="ttc" id="class_free_r_t_o_s_1_1_semaphore_html_a67fa9bf777be48332a30154e006827fd"><div class="ttname"><a href="class_free_r_t_o_s_1_1_semaphore.html#a67fa9bf777be48332a30154e006827fd">FreeRTOS::Semaphore::take</a></div><div class="ttdeci">bool take(std::string owner=&quot;&lt;Unknown&gt;&quot;)</div><div class="ttdoc">Take a semaphore. Take a semaphore and wait indefinitely. </div><div class="ttdef"><b>Definition:</b> <a href="_free_r_t_o_s_8cpp_source.html#l00159">FreeRTOS.cpp:159</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a10927bbdd67bfb76fd80c64d9a4b7b9b"><div class="ttname"><a href="class_b_l_e_client.html#a10927bbdd67bfb76fd80c64d9a4b7b9b">BLEClient::setValue</a></div><div class="ttdeci">void setValue(BLEUUID serviceUUID, BLEUUID characteristicUUID, std::string value)</div><div class="ttdoc">Set the value of a specific characteristic associated with a specific service. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00507">BLEClient.cpp:507</a></div></div>
<div class="ttc" id="class_b_l_e_remote_characteristic_html_a67b0993e84a032ef1f4dd0601e6a4628"><div class="ttname"><a href="class_b_l_e_remote_characteristic.html#a67b0993e84a032ef1f4dd0601e6a4628">BLERemoteCharacteristic::readValue</a></div><div class="ttdeci">std::string readValue()</div><div class="ttdoc">Read the value of the remote characteristic. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_remote_characteristic_8cpp_source.html#l00401">BLERemoteCharacteristic.cpp:401</a></div></div>
<div class="ttc" id="class_b_l_e_advertised_device_html"><div class="ttname"><a href="class_b_l_e_advertised_device.html">BLEAdvertisedDevice</a></div><div class="ttdoc">A representation of a BLE advertised device found by a scan. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_advertised_device_8h_source.html#l00028">BLEAdvertisedDevice.h:28</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_a55209904b6c007e197fc3fd637ce0a6f"><div class="ttname"><a href="class_b_l_e_client.html#a55209904b6c007e197fc3fd637ce0a6f">BLEClient::toString</a></div><div class="ttdeci">std::string toString()</div><div class="ttdoc">Return a string representation of this client. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00521">BLEClient.cpp:521</a></div></div>
<div class="ttc" id="class_b_l_e_client_html_afd5eb1de1f593ab56e9c82320315c75c"><div class="ttname"><a href="class_b_l_e_client.html#afd5eb1de1f593ab56e9c82320315c75c">BLEClient::getMTU</a></div><div class="ttdeci">uint16_t getMTU()</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8cpp_source.html#l00513">BLEClient.cpp:513</a></div></div>
<div class="ttc" id="class_b_l_e_client_callbacks_html"><div class="ttname"><a href="class_b_l_e_client_callbacks.html">BLEClientCallbacks</a></div><div class="ttdoc">Callbacks associated with a BLE client. </div><div class="ttdef"><b>Definition:</b> <a href="_b_l_e_client_8h_source.html#l00095">BLEClient.h:95</a></div></div>
<div class="ttc" id="class_b_l_e_client_callbacks_html_a82bc1491252b8f9b003c9162096389d7"><div class="ttname"><a href="class_b_l_e_client_callbacks.html#a82bc1491252b8f9b003c9162096389d7">BLEClientCallbacks::onConnect</a></div><div class="ttdeci">virtual void onConnect(BLEClient *pClient)=0</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b66d65f09a100230911d819a169d69c.html">esp32-snippets</a></li><li class="navelem"><a class="el" href="dir_e66062f3a4d2a5b6b6746a6b0f9c85ac.html">cpp_utils</a></li><li class="navelem"><a class="el" href="_b_l_e_client_8cpp.html">BLEClient.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
